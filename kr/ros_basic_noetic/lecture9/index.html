<!DOCTYPE html>
<html lang="kr" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.104.1" />
    <meta name="description" content="COM2018 OOP Class Lecture Note">
<meta name="author" content="Soo Young Kim">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Lecture9 - ROS TF and Examples - Documentation for Hugo Learn Theme</title>

    
    <link href="/css/nucleus.css?1683853056" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1683853056" rel="stylesheet">
    <link href="/css/hybrid.css?1683853056" rel="stylesheet">
    <link href="/css/featherlight.min.css?1683853056" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1683853056" rel="stylesheet">
    <link href="/css/auto-complete.css?1683853056" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1683853056" rel="stylesheet">
    <link href="/css/theme.css?1683853056" rel="stylesheet">
    <link href="/css/tabs.css?1683853056" rel="stylesheet">
    <link href="/css/hugo-theme.css?1683853056" rel="stylesheet">
    
    <link href="/css/theme-green.css?1683853056" rel="stylesheet">
    
    <link href="/css/foo.css?1683853056" rel="stylesheet"><link href="/css/bar.css?1683853056" rel="stylesheet">

    <script src="/js/jquery-3.3.1.min.js?1683853056"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/kr/ros_basic_noetic/lecture9/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <img width="1097" alt="image" src="https://user-images.githubusercontent.com/12381733/209764275-05dcbdbf-cef7-47ad-94a6-6d61febad01e.png">
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1683853056"></script>
<script type="text/javascript" src="/js/auto-complete.js?1683853056"></script>
<script type="text/javascript">
    
        var baseurl = "\/\/kr";
    
</script>
<script type="text/javascript" src="/js/search.js?1683853056"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/kr'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/kr/ros_basic_noetic/" title="ROS Basics" class="dd-item
        parent
        
        
        ">
      <a href="/kr/ros_basic_noetic/">
          <b>ROS Noetic. </b>ROS Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture1/" title="Lecture1 - Introduction to ROS" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture1/">
        Lecture1 - Introduction to ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture2/" title="Lecture2 - Dev Env Setup" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture2/">
        Lecture2 - Dev Env Setup
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture3/" title="Lecture3 - Core of ROS" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture3/">
        Lecture3 - Core of ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture4/" title="Lecture4 - ROS Launch, RViz" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture4/">
        Lecture4 - ROS Launch, RViz
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture5/" title="Lecture5 - First Programming, ROS Topic" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture5/">
        Lecture5 - First Programming, ROS Topic
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture6/" title="Lecture6 - ROS Service, Parameter" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture6/">
        Lecture6 - ROS Service, Parameter
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture7/" title="Lecture7 - Rqt Tools and rosbag, ROS Time" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture7/">
        Lecture7 - Rqt Tools and rosbag, ROS Time
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture8/" title="Lecture8 - Deal with Open Source Projects, Custom Interfaces" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture8/">
        Lecture8 - Deal with Open Source Projects, Custom Interfaces
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture9/" title="Lecture9 - ROS TF and Examples" class="dd-item active">
        <a href="/kr/ros_basic_noetic/lecture9/">
        Lecture9 - ROS TF and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture10/" title="Lecture10 - TF2 Examples, Outro" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture10/">
        Lecture10 - TF2 Examples, Outro
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/advanced_contents_ros1/" title="ROS" class="dd-item
        
        
        
        ">
      <a href="/kr/advanced_contents_ros1/">
          <b>Advanced Contents. </b>ROS
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture1/" title="Lecture1 - ROSCPP" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture1/">
        Lecture1 - ROSCPP
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture2/" title="Lecture2 - More About ROS System" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture2/">
        Lecture2 - More About ROS System
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture3/" title="Lecture3 - SROS" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture3/">
        Lecture3 - SROS
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros2_basic_foxy/" title="ROS 2 Basics" class="dd-item
        
        
        
        ">
      <a href="/kr/ros2_basic_foxy/">
          <b>[Old]ROS 2 Foxy. </b>ROS 2 Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture1/" title="Lecture1 - Introduction to ROS 2" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture1/">
        Lecture1 - Introduction to ROS 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture2/" title="Lecture2 - ROS 2 Node, Package" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture2/">
        Lecture2 - ROS 2 Node, Package
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture3/" title="Lecture3 - ROS 2 Node Programming, ROS 2 parameter" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture3/">
        Lecture3 - ROS 2 Node Programming, ROS 2 parameter
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture4/" title="Lecture4 - ROS 2 Node C&#43;&#43; Programming" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture4/">
        Lecture4 - ROS 2 Node C&#43;&#43; Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture5/" title="Lecture5 - ROS 2 Topic and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture5/">
        Lecture5 - ROS 2 Topic and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture6/" title="Lecture6 - ROS 2 Service and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture6/">
        Lecture6 - ROS 2 Service and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture7/" title="Lecture7 - Useful ROS 2 Example, Navigation2" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture7/">
        Lecture7 - Useful ROS 2 Example, Navigation2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture8/" title="Lecture8 - ROS 2 Action and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture8/">
        Lecture8 - ROS 2 Action and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture9/" title="Lecture9 - C&#43;&#43; Programming Again, Outro" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture9/">
        Lecture9 - C&#43;&#43; Programming Again, Outro
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros2_foxy/" title="ROS 2 Basics" class="dd-item
        
        
        
        ">
      <a href="/kr/ros2_foxy/">
          <b>[New]ROS 2 Foxy. </b>ROS 2 Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture1/" title="Lecture1. What is ROS?" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture1/">
        Lecture1. What is ROS?
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture2/" title="Lecture2. Dev Env Setup" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture2/">
        Lecture2. Dev Env Setup
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture3/" title="Lecture3. Core of ROS" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture3/">
        Lecture3. Core of ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture4/" title="Lecture4. ROS 2 Node and Parameter Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture4/">
        Lecture4. ROS 2 Node and Parameter Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture5/" title="Lecture5. ROS 2 Communication Mechanisms" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture5/">
        Lecture5. ROS 2 Communication Mechanisms
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture6/" title="Lecture6. ROS 2 Tools" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture6/">
        Lecture6. ROS 2 Tools
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture7/" title="Lecture7. ROS 2 Topic and Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture7/">
        Lecture7. ROS 2 Topic and Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture8/" title="Lecture8. ROS 2 Service and Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture8/">
        Lecture8. ROS 2 Service and Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture9/" title="Lecture9. ROS 2 Action Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture9/">
        Lecture9. ROS 2 Action Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture10/" title="Lecture10. TF and ROS 2" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture10/">
        Lecture10. TF and ROS 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture11/" title="Lecture11. About Gazebo - 1" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture11/">
        Lecture11. About Gazebo - 1
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture12/" title="Lecture12. About Gazebo - 2" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture12/">
        Lecture12. About Gazebo - 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture13/" title="Lecture13. Useful ROS 2 Examples (Sensor Part)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture13/">
        Lecture13. Useful ROS 2 Examples (Sensor Part)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture14/" title="Lecture14. Useful ROS 2 Examples (Control Part)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture14/">
        Lecture14. Useful ROS 2 Examples (Control Part)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture15/" title="Lecture15. Advanced ROS 2, Package Management" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture15/">
        Lecture15. Advanced ROS 2, Package Management
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture16/" title="Lecture16. Useful ROS 2 Examples (Misc)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture16/">
        Lecture16. Useful ROS 2 Examples (Misc)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture17/" title="Lecture17. Real Hardware Examples" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture17/">
        Lecture17. Real Hardware Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture18/" title="Lecture18. Point Cloud Deep Learning Example (PointNet)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture18/">
        Lecture18. Point Cloud Deep Learning Example (PointNet)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture19/" title="Lecture19. NVIDIA Isaac Sim" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture19/">
        Lecture19. NVIDIA Isaac Sim
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture20/" title="Lecture20. NVIDIA Jetson Platform" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture20/">
        Lecture20. NVIDIA Jetson Platform
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/advanced_contents_ros2/" title="ROS 2" class="dd-item
        
        
        
        ">
      <a href="/kr/advanced_contents_ros2/">
          <b>Advanced Contents. </b>ROS 2
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture1/" title="Lecture1 - About DDS" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture1/">
        Lecture1 - About DDS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture2/" title="Lecture11 - About DDS (2)" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture2/">
        Lecture11 - About DDS (2)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture3/" title="Lecture12 - SROS2" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture3/">
        Lecture12 - SROS2
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros_and_gazebo/" title="Gazebo and ROS" class="dd-item
        
        
        
        ">
      <a href="/kr/ros_and_gazebo/">
          <b>Gazebo. </b>Gazebo and ROS
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_and_gazebo/lecture1/" title="Lecture1 - Gazebo and Robot" class="dd-item ">
        <a href="/kr/ros_and_gazebo/lecture1/">
        Lecture1 - Gazebo and Robot
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_and_gazebo/lecture2/" title="Lecture2 - Gazebo and Robot(2)" class="dd-item ">
        <a href="/kr/ros_and_gazebo/lecture2/">
        Lecture2 - Gazebo and Robot(2)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/RB2023ROS/du2023-ros1"><i class='fab fa-fw fa-github'></i> GitHub repo - ROS 1</a>
              </li>
          
              <li>
                  <a class="padding" href="https://github.com/RB2023ROS/du2023-ros2"><i class='fab fa-fw fa-github'></i> GitHub repo - ROS 2</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="kr" value="/kr/ros_basic_noetic/lecture9/" selected>Korean</option>
                    
                  
              
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      

      
      </ul>
    </section>
    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='' href="https://github.com/com2018-fa22/hugo-blog/tree/main/content/ros_basic_noetic/lecture9.kr.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text"></span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                   Lecture9 - ROS TF and Examples
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#tf-broadcaster">tf broadcaster</a></li>
        <li><a href="#tf-listener">tf listener</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Lecture9 - ROS TF and Examples
            </h1>
          

        


<blockquote>
<p>대부분의 로보틱스 과정들에서 가장 먼저 다루는 것이 바로 <strong>좌표계 변환(Transformation)</strong> 입니다. 로봇은 수많은 joint와 link로 이루어져 있기 때문에 좌표계를 다루는 일이 매우 빈번합니다.</p>
</blockquote>
<p>ROS에서는 <strong>TF</strong>라는 특수한 형태로 이 좌표계와 시간을 함께 다루고 있습니다. 예시와 설명을 통해 ROS의 TF에 대해 배워봅시다 😊</p>
<p><img src="/kr/ros_basic_noetic/images9/lec8_0.png?height=300px" alt="lec8_0"></p>
<ul>
<li>image from : <a href="https://ethz.ch/content/dam/ethz/special-interest/mavt/robotics-n-intelligent-systems/rsl-dam/documents/RobotDynamics2017/RD_HS2017script.pdf">eth robot dynamics lecture notes</a></li>
</ul>
<p>ROS는 오픈소스이니만큼 사용자들이 원하는 기능들에 맞추어 변화가 빠릅니다. 하지만 이것이 단점이 되는 경우도 있는데, 이전 버전과 최신 버전의 호환성 문제가 종종 발생합니다.</p>
<p>tf 또한 tf2로 개편되면서 코드의 수정이 있었으며, 이번 강의에서는 tf2를 중심으로 살펴보겠습니다.</p>
<p><img src="/kr/ros_basic_noetic/images9/lec8_1.png" alt="lec8_1"></p>
<ul>
<li>image from : <a href="http://wiki.ros.org/tf/Tutorials">wiki.ros</a></li>
</ul>
<blockquote>
<p>예시를 먼저 살펴봅시다.</p>
</blockquote>
<h3 id="tf-broadcaster">tf broadcaster</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># setup example</span>
</span></span><span style="display:flex;"><span>catkin build py_tf2_tutorial
</span></span><span style="display:flex;"><span>source devel<span style="color:#f92672">/</span>setup<span style="color:#f92672">.</span>bash
</span></span><span style="display:flex;"><span>roscore
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1</span>
</span></span><span style="display:flex;"><span>rosrun turtlesim turtlesim_node
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2</span>
</span></span><span style="display:flex;"><span>rosrun py_tf2_tutorial turtle_tf2_broadcaster<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 3</span>
</span></span><span style="display:flex;"><span>rosrun turtlesim turtle_teleop_key
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 4</span>
</span></span><span style="display:flex;"><span>rviz
</span></span></code></pre></div><ul>
<li>rviz를 실행한 뒤 아래와 같이 설정합니다.</li>
</ul>
<p><img src="/kr/ros_basic_noetic/images9/tf_broadcaster.gif?height=400px" alt="tf_broadcaster.gif"></p>
<p>rviz에서 보이는 세가지 색상의 막대가 바로 <strong>tf</strong> 입니다.</p>
<p>x,y,z의 각 축을 각기 다른 색으로 표현하였으며, 연관된 좌표계끼리는 노란 선을 통해 연결한 모습이 보입니다.</p>
<p><img src="/kr/ros_basic_noetic/images9/lec8_2.png?height=400px" alt="lec8_2"></p>
<ul>
<li>Terminal 1에서 실행시킨 프로그램은 <a href="http://wiki.ros.org/turtlesim">turtlesim</a>이라는 것으로, 2차원 평면에서 거북이 형태의 로봇을 시뮬레이션한 프로그램입니다.</li>
</ul>
<p><img src="/kr/ros_basic_noetic/images9/lec8_3.png?height=300px" alt="lec8_3"></p>
<ul>
<li>이제, Terminal 3에 커서를 두고 거북이를 움직이면서, rviz와 turtlesim의 변화를 살펴보세요.</li>
</ul>
<p><img src="/kr/ros_basic_noetic/images9/tf_ts.gif?height=400px" alt="tf_ts.gif"></p>
<p>거북이를 조종함에 따라 변화하는 rviz 화면을 확인할 수 있습니다.</p>
<p>전체 코드는 아래 링크에서 확인할 수 있으며, 지금은 필요한 부분만 집중적으로 분석해보겠습니다.</p>
<p><a href="https://github.com/RB2023ROS/du2023-ros1/blob/main/py_tf2_tutorial/scripts/turtle_tf2_broadcaster.py">https://github.com/RB2023ROS/du2023-ros1/blob/main/py_tf2_tutorial/scripts/turtle_tf2_broadcaster.py</a></p>
<hr>
<ul>
<li>tf 또한 하나의 Package입니다. 이에 따라 관련된 python import가 필요합니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> rospy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Because of transformations</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> tf_conversions
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> tf2_ros
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> geometry_msgs.msg
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> turtlesim.msg
</span></span></code></pre></div><ul>
<li>tf의 데이터 송출은 <strong>broadcast</strong>라고 부릅니다. topic의 publisher와 같이 tf에서는 TransformBroadcaster를 사용하며 <strong>sendTransform</strong>이라는 메소드를 사용합니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">handle_turtle_pose</span>(msg, turtlename):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># tf requires broadbaster</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Be Careful, !!TF IS NOT A TOPIC!!</span>
</span></span><span style="display:flex;"><span>    br <span style="color:#f92672">=</span> tf2_ros<span style="color:#f92672">.</span>TransformBroadcaster()
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>		br<span style="color:#f92672">.</span>sendTransform(t)
</span></span></code></pre></div><ul>
<li>TransformBroadcaster가 사용하는 데이터 타입은 <strong>geometry_msgs.msg.TransformStamped</strong>입니다. 해당 데이터 타입에는 3차원 좌표계에서의 위치, 방향, 그리고 <strong>시간</strong>이 포함되어 있습니다.</li>
</ul>
<p><img src="/kr/ros_basic_noetic/images9/lec8_4.png?height=400px" alt="lec8_4.png"></p>
<p>image from : <a href="http://docs.ros.org/en/noetic/api/geometry_msgs/html/msg/TransformStamped.html">docs.ros.org</a></p>
<ul>
<li>해당 데이터 타입에 적절한 값을 채워넣어준 다음, 최종 <strong>broadcast</strong>가 진행됩니다. 주의할 점으로 쿼터니언 각도 체계를 사용했다는 점입니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># prepare tf msg</span>
</span></span><span style="display:flex;"><span>t <span style="color:#f92672">=</span> geometry_msgs<span style="color:#f92672">.</span>msg<span style="color:#f92672">.</span>TransformStamped()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>t<span style="color:#f92672">.</span>header<span style="color:#f92672">.</span>stamp <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>Time<span style="color:#f92672">.</span>now()
</span></span><span style="display:flex;"><span>t<span style="color:#f92672">.</span>header<span style="color:#f92672">.</span>frame_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;world&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>t<span style="color:#f92672">.</span>child_frame_id <span style="color:#f92672">=</span> turtlename
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>translation<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> msg<span style="color:#f92672">.</span>x
</span></span><span style="display:flex;"><span>t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>translation<span style="color:#f92672">.</span>y <span style="color:#f92672">=</span> msg<span style="color:#f92672">.</span>y
</span></span><span style="display:flex;"><span>t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>translation<span style="color:#f92672">.</span>z <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> tf_conversions<span style="color:#f92672">.</span>transformations<span style="color:#f92672">.</span>quaternion_from_euler(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, msg<span style="color:#f92672">.</span>theta)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>rotation<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> q[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>rotation<span style="color:#f92672">.</span>y <span style="color:#f92672">=</span> q[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>rotation<span style="color:#f92672">.</span>z <span style="color:#f92672">=</span> q[<span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>rotation<span style="color:#f92672">.</span>w <span style="color:#f92672">=</span> q[<span style="color:#ae81ff">3</span>]
</span></span></code></pre></div>
<div class="notices tip" ><p>쿼터니언은 직관적으로 이해하기는 힘든 각도 체계입니다. 계산의 편의를 위해 다음과 같은 사이트를 사용할 수 있습니다. &gt; <a href="https://www.andre-gaschler.com/rotationconverter/">3D Rotation Converter</a></p>
</div>

<blockquote>
<p>tf의 사용 시 주의해야 할 점을 언급하고자 합니다.</p>
</blockquote>
<ul>
<li>turtle_tf2_broadcaster.py 수정 - Experiment라고 되어 있는 부분을 주석 해제한 다음 다시 실행해봅시다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">handle_turtle_pose</span>(msg, turtlename):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># tf requires broadbaster</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Be Careful, !!TF IS NOT A TOPIC!!</span>
</span></span><span style="display:flex;"><span>    br <span style="color:#f92672">=</span> tf2_ros<span style="color:#f92672">.</span>TransformBroadcaster()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># prepare tf msg</span>
</span></span><span style="display:flex;"><span>    t <span style="color:#f92672">=</span> geometry_msgs<span style="color:#f92672">.</span>msg<span style="color:#f92672">.</span>TransformStamped()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># t.header.stamp = rospy.Time.now()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Experiment, Late tf2</span>
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>header<span style="color:#f92672">.</span>stamp <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>Time<span style="color:#f92672">.</span>now() <span style="color:#f92672">-</span> rospy<span style="color:#f92672">.</span>Duration(<span style="color:#ae81ff">60</span>)
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>header<span style="color:#f92672">.</span>frame_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;world&#34;</span>
</span></span></code></pre></div><ul>
<li>rviz를 실행시킨 터미널에서 아래와 같은 에러가 발생합니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span> WARN<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>1671940248.738235698<span style="color:#f92672">]</span>: TF_REPEATED_DATA ignoring data with redundant
</span></span><span style="display:flex;"><span>timestamp <span style="color:#66d9ef">for</span> frame turtle1 at time 1671940148.738096 according to authority unknown_publisher
</span></span></code></pre></div><p>tf에는 시간 데이터가 포함되어 있습니다. 따라서 현재 시간과 tf에 담기 시간의 차이가 크다면 ROS는 이를 안정적이지 못한 것으로 판단해 무시합니다. (위 에러는 아마 로봇 개발을 하면서 마주치게 되는 Warning Top3안에 들지 않을까 싶습니다.)</p>
<ul>
<li>이번 예시에는 터미널이 4개나 필요하였습니다. 예시의 빠른 실행을 위해 <strong>launch file</strong>을 만들 수 있습니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;launch&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;node</span> <span style="color:#a6e22e">pkg=</span><span style="color:#e6db74">&#34;turtlesim&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;turtlesim_node&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;sim&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;node</span> <span style="color:#a6e22e">pkg=</span><span style="color:#e6db74">&#34;turtlesim&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;turtle_teleop_key&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;teleop&#34;</span> <span style="color:#a6e22e">output=</span><span style="color:#e6db74">&#34;screen&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;node</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;turtle1_tf2_broadcaster&#34;</span> <span style="color:#a6e22e">pkg=</span><span style="color:#e6db74">&#34;py_tf2_tutorial&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;turtle_tf2_broadcaster.py&#34;</span> <span style="color:#a6e22e">respawn=</span><span style="color:#e6db74">&#34;false&#34;</span> <span style="color:#a6e22e">output=</span><span style="color:#e6db74">&#34;screen&#34;</span> <span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;param</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;turtle&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;string&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;turtle1&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/node&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;node</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;rviz&#34;</span> <span style="color:#a6e22e">pkg=</span><span style="color:#e6db74">&#34;rviz&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;rviz&#34;</span> <span style="color:#a6e22e">args=</span><span style="color:#e6db74">&#34;-d $(find py_tf2_tutorial)/rviz/turtlesim_tf.rviz&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/launch&gt;</span>
</span></span></code></pre></div><hr>
<h3 id="tf-listener">tf listener</h3>
<p>tf broadcaster의 다음으로 tf listener에 대해 배워봅시다.</p>
<ul>
<li>turtlesim follow demo</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>roslaunch py_tf2_tutorial follow_demo.launch
</span></span></code></pre></div><ul>
<li>
<p>사진과 같이 우리가 조종하는 첫번째 거북이를 두번째 거북이가 따라오게 됩니다.
<img src="/kr/ros_basic_noetic/images9/tf_follow.gif?height=400px" alt="tf_follow.gif"></p>
</li>
<li>
<p>rviz를 통해 tf들 사이에 어떠한 변화가 있는지도 직접 확인해보세요
<img src="/kr/ros_basic_noetic/images9/lec8_5.png?height=400px" alt="lec8_5.png"></p>
</li>
<li>
<p>launch 파일은 다음과 같은 내용을 포함하고 있습니다.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;launch&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;node</span> <span style="color:#a6e22e">pkg=</span><span style="color:#e6db74">&#34;turtlesim&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;turtlesim_node&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;sim&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;node</span> <span style="color:#a6e22e">pkg=</span><span style="color:#e6db74">&#34;turtlesim&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;turtle_teleop_key&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;teleop&#34;</span> <span style="color:#a6e22e">output=</span><span style="color:#e6db74">&#34;screen&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;node</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;turtle1_tf2_broadcaster&#34;</span> <span style="color:#a6e22e">pkg=</span><span style="color:#e6db74">&#34;py_tf2_tutorial&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;turtle_tf2_broadcaster.py&#34;</span> <span style="color:#a6e22e">respawn=</span><span style="color:#e6db74">&#34;false&#34;</span> <span style="color:#a6e22e">output=</span><span style="color:#e6db74">&#34;screen&#34;</span> <span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;param</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;turtle&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;string&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;turtle1&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/node&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;node</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;turtle2_tf2_broadcaster&#34;</span> <span style="color:#a6e22e">pkg=</span><span style="color:#e6db74">&#34;py_tf2_tutorial&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;turtle_tf2_broadcaster.py&#34;</span> <span style="color:#a6e22e">respawn=</span><span style="color:#e6db74">&#34;false&#34;</span> <span style="color:#a6e22e">output=</span><span style="color:#e6db74">&#34;screen&#34;</span> <span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;param</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;turtle&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;string&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;turtle2&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/node&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;node</span> <span style="color:#a6e22e">pkg=</span><span style="color:#e6db74">&#34;py_tf2_tutorial&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;turtle_tf2_listener.py&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;listener&#34;</span> <span style="color:#a6e22e">output=</span><span style="color:#e6db74">&#34;screen&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/launch&gt;</span>
</span></span></code></pre></div><ol>
<li>turtlesim 실행</li>
<li>teleop key 실행</li>
<li>turtle1의 tf broadcaster</li>
<li>turtle2의 tf broadcaster</li>
<li><strong>tf listener</strong></li>
</ol>
<blockquote>
<p>이번 예제에서 살펴보고자 하는 것은 tf listener입니다.</p>
</blockquote>
<ul>
<li><strong>TransformListener</strong> 클래스는 생성되는 순간부터 <strong>/tf</strong> topic에 귀기울이기 시작합니다. Buffer는 정해진 사이즈만큼 tf 데이터를 품게 되며, TransformListener에 전달하게 되면, tf topic data를 받아 Buffer에 쌓아두는 것입니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>init_node(<span style="color:#e6db74">&#39;tf2_turtle_listener&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    tfBuffer <span style="color:#f92672">=</span> tf2_ros<span style="color:#f92672">.</span>Buffer()
</span></span><span style="display:flex;"><span>    listener <span style="color:#f92672">=</span> tf2_ros<span style="color:#f92672">.</span>TransformListener(tfBuffer)
</span></span></code></pre></div><ul>
<li>Buffer의 lookup_transform 메소드는 두 frame 사이의 translation, rotation 변환을 계산해줍니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>	<span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> rospy<span style="color:#f92672">.</span>is_shutdown():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># calculate transformation btw two dynamic tfs</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># those tfs were broadcasted from TransformBroadcaster</span>
</span></span><span style="display:flex;"><span>            trans <span style="color:#f92672">=</span> tfBuffer<span style="color:#f92672">.</span>lookup_transform(turtle_name, <span style="color:#e6db74">&#39;turtle1&#39;</span>, rospy<span style="color:#f92672">.</span>Time(), rospy<span style="color:#f92672">.</span>Duration(<span style="color:#ae81ff">1.0</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span> (tf2_ros<span style="color:#f92672">.</span>LookupException, tf2_ros<span style="color:#f92672">.</span>ConnectivityException, tf2_ros<span style="color:#f92672">.</span>ExtrapolationException):
</span></span><span style="display:flex;"><span>            rate<span style="color:#f92672">.</span>sleep()
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span></code></pre></div><ul>
<li>lookup_transform 메소드의 원형은 다음과 같습니다.</li>
</ul>
<p><img src="/kr/ros_basic_noetic/images9/lec8_6.png" alt="lec8_6.png"></p>
<ul>
<li>image from : <a href="https://docs.ros2.org/foxy/api/tf2_ros/classtf2__ros_1_1Buffer.html#a3ab502cc1e8b608957a96ad350815aee">docs.ros2.org</a></li>
</ul>
<p><strong>lookup_transform</strong>의 계산 결과를 직접 살펴보고자 print 문을 추가하였으며, 캡쳐 사진을 통해 간단히 함께 살펴봅시다.</p>
<p><img src="/kr/ros_basic_noetic/images9/lec8_7.png?height=400px" alt="lec8_7.png"></p>
<ul>
<li><strong>translation</strong>은 두 거북이의 frame사이 수평 거리를 보여주며</li>
<li><strong>rotation</strong>은 두 frame사이 회전을 쿼터니언으로 보여줍니다.</li>
<li>기준이 되는 frame과 목표 frame은 id로 구분하며, 현재 turtle1, turtle2로 구분하고 있습니다.</li>
</ul>
<blockquote>
<p>현 상황을 그림으로 간단히 정리하자면 다음과 같습니다.</p>
</blockquote>
<p><em>lookup_transform의 계산 결과는 target frame인 turtle2의 위치가 source frame인 turtle1 기준에서는 어떠한 좌표를 갖는지를 포함합니다.</em></p>
<p><img src="/kr/ros_basic_noetic/images9/lec8_8.png?height=400px" alt="lec8_8.png"></p>
<ul>
<li>image from : <a href="https://web2.qatar.cmu.edu/~gdicaro/16311-Fall17/slides/16311-2-3-Pose-representation-and-transformation.pdf">CMU Qatar</a></li>
</ul>
<p>로보틱스에서 이러한 좌표 변환은 매우 자주 사용되며, 일반적으로 <strong>Homogeneous Matrix</strong>의 형태로 표현합니다.</p>
<p><img src="/kr/ros_basic_noetic/images9/lec8_9.png?height=400px" alt="lec8_9.png"></p>
<ul>
<li>from : <a href="https://ethz.ch/content/dam/ethz/special-interest/mavt/robotics-n-intelligent-systems/rsl-dam/documents/RobotDynamics2017/RD_HS2017script.pdf">eth robotics lecture notes</a></li>
</ul>
<blockquote>
<p>그 밖에, 코드에서 구현된 기능을 간단히 살펴보며 마무리하겠습니다.</p>
</blockquote>
<ul>
<li>두번째 거북이를 등장시키는 <strong>service client</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#75715e"># Spawn second turtle</span>
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>wait_for_service(<span style="color:#e6db74">&#39;spawn&#39;</span>)
</span></span><span style="display:flex;"><span>    spawner <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>ServiceProxy(<span style="color:#e6db74">&#39;spawn&#39;</span>, turtlesim<span style="color:#f92672">.</span>srv<span style="color:#f92672">.</span>Spawn)
</span></span><span style="display:flex;"><span>    turtle_name <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>get_param(<span style="color:#e6db74">&#39;turtle&#39;</span>, <span style="color:#e6db74">&#39;turtle2&#39;</span>)
</span></span><span style="display:flex;"><span>    spawner(<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>, turtle_name)
</span></span></code></pre></div><ul>
<li>거북이를 제어하기 위한 <strong>Twist msg topic publisher</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#75715e"># turtle2 controller</span>
</span></span><span style="display:flex;"><span>    turtle_vel <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>Publisher(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">/cmd_vel&#39;</span> <span style="color:#f92672">%</span> turtle_name, geometry_msgs<span style="color:#f92672">.</span>msg<span style="color:#f92672">.</span>Twist, queue_size<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    rate <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>Rate(<span style="color:#ae81ff">50.0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> rospy<span style="color:#f92672">.</span>is_shutdown():
</span></span><span style="display:flex;"><span>				<span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>        turtle_vel<span style="color:#f92672">.</span>publish(msg)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        rate<span style="color:#f92672">.</span>sleep()
</span></span></code></pre></div><p>이렇게 tf에 대해서 turtlesim 예시와 함께 살펴보았습니다. 로보틱스에서 자주 사용되는 좌표계와 그들 사이의 변환을 시간 데이터와 함께 표현하는 것이 ROS의 tf2입니다.</p>
<blockquote>
<p>다음 강의에 계속 이어집니다.</p>
</blockquote>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/kr/ros_basic_noetic/lecture8/" title="Lecture8 - Deal with Open Source Projects, Custom Interfaces"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/kr/ros_basic_noetic/lecture10/" title="Lecture10 - TF2 Examples, Outro" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1683853056"></script>
    <script src="/js/perfect-scrollbar.min.js?1683853056"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1683853056"></script>
    <script src="/js/jquery.sticky.js?1683853056"></script>
    <script src="/js/featherlight.min.js?1683853056"></script>
    <script src="/js/highlight.pack.js?1683853056"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1683853056"></script>
    <script src="/js/learn.js?1683853056"></script>
    <script src="/js/hugo-learn.js?1683853056"></script>
    
        
            <script src="https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

