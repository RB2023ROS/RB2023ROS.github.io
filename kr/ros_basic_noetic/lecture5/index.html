<!DOCTYPE html>
<html lang="kr" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.104.1" />
    <meta name="description" content="COM2018 OOP Class Lecture Note">
<meta name="author" content="Soo Young Kim">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Lecture5 - First Programming, ROS Topic - Documentation for Hugo Learn Theme</title>

    
    <link href="/css/nucleus.css?1688985563" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1688985563" rel="stylesheet">
    <link href="/css/hybrid.css?1688985563" rel="stylesheet">
    <link href="/css/featherlight.min.css?1688985563" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1688985563" rel="stylesheet">
    <link href="/css/auto-complete.css?1688985563" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1688985563" rel="stylesheet">
    <link href="/css/theme.css?1688985563" rel="stylesheet">
    <link href="/css/tabs.css?1688985563" rel="stylesheet">
    <link href="/css/hugo-theme.css?1688985563" rel="stylesheet">
    
    <link href="/css/theme-green.css?1688985563" rel="stylesheet">
    
    <link href="/css/foo.css?1688985563" rel="stylesheet"><link href="/css/bar.css?1688985563" rel="stylesheet">

    <script src="/js/jquery-3.3.1.min.js?1688985563"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/kr/ros_basic_noetic/lecture5/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <img width="1097" alt="image" src="https://user-images.githubusercontent.com/12381733/209764275-05dcbdbf-cef7-47ad-94a6-6d61febad01e.png">
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1688985563"></script>
<script type="text/javascript" src="/js/auto-complete.js?1688985563"></script>
<script type="text/javascript">
    
        var baseurl = "\/\/kr";
    
</script>
<script type="text/javascript" src="/js/search.js?1688985563"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/kr'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/kr/ros_basic_noetic/" title="ROS Basics" class="dd-item
        parent
        
        
        ">
      <a href="/kr/ros_basic_noetic/">
          <b>ROS Noetic. </b>ROS Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture1/" title="Lecture1 - Introduction to ROS" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture1/">
        Lecture1 - Introduction to ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture2/" title="Lecture2 - Dev Env Setup" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture2/">
        Lecture2 - Dev Env Setup
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture3/" title="Lecture3 - Core of ROS" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture3/">
        Lecture3 - Core of ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture4/" title="Lecture4 - ROS Launch, RViz" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture4/">
        Lecture4 - ROS Launch, RViz
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture5/" title="Lecture5 - First Programming, ROS Topic" class="dd-item active">
        <a href="/kr/ros_basic_noetic/lecture5/">
        Lecture5 - First Programming, ROS Topic
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture6/" title="Lecture6 - ROS Service, Parameter" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture6/">
        Lecture6 - ROS Service, Parameter
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture7/" title="Lecture7 - Rqt Tools and rosbag, ROS Time" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture7/">
        Lecture7 - Rqt Tools and rosbag, ROS Time
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture8/" title="Lecture8 - Deal with Open Source Projects, Custom Interfaces" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture8/">
        Lecture8 - Deal with Open Source Projects, Custom Interfaces
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture9/" title="Lecture9 - ROS TF and Examples" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture9/">
        Lecture9 - ROS TF and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture10/" title="Lecture10 - TF2 Examples, Outro" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture10/">
        Lecture10 - TF2 Examples, Outro
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/advanced_contents_ros1/" title="ROS" class="dd-item
        
        
        
        ">
      <a href="/kr/advanced_contents_ros1/">
          <b>Advanced Contents. </b>ROS
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture1/" title="Lecture1 - ROSCPP" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture1/">
        Lecture1 - ROSCPP
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture2/" title="Lecture2 - More About ROS System" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture2/">
        Lecture2 - More About ROS System
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture3/" title="Lecture3 - SROS" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture3/">
        Lecture3 - SROS
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros2_basic_foxy/" title="ROS 2 Basics" class="dd-item
        
        
        
        ">
      <a href="/kr/ros2_basic_foxy/">
          <b>[Old]ROS 2 Foxy. </b>ROS 2 Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture1/" title="Lecture1 - Introduction to ROS 2" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture1/">
        Lecture1 - Introduction to ROS 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture2/" title="Lecture2 - ROS 2 Node, Package" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture2/">
        Lecture2 - ROS 2 Node, Package
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture3/" title="Lecture3 - ROS 2 Node Programming, ROS 2 parameter" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture3/">
        Lecture3 - ROS 2 Node Programming, ROS 2 parameter
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture4/" title="Lecture4 - ROS 2 Node C&#43;&#43; Programming" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture4/">
        Lecture4 - ROS 2 Node C&#43;&#43; Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture5/" title="Lecture5 - ROS 2 Topic and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture5/">
        Lecture5 - ROS 2 Topic and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture6/" title="Lecture6 - ROS 2 Service and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture6/">
        Lecture6 - ROS 2 Service and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture7/" title="Lecture7 - Useful ROS 2 Example, Navigation2" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture7/">
        Lecture7 - Useful ROS 2 Example, Navigation2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture8/" title="Lecture8 - ROS 2 Action and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture8/">
        Lecture8 - ROS 2 Action and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture9/" title="Lecture9 - C&#43;&#43; Programming Again, Outro" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture9/">
        Lecture9 - C&#43;&#43; Programming Again, Outro
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros2_foxy/" title="ROS 2 Basics" class="dd-item
        
        
        
        ">
      <a href="/kr/ros2_foxy/">
          <b>[New]ROS 2 Foxy. </b>ROS 2 Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture1/" title="Lecture1. What is ROS?" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture1/">
        Lecture1. What is ROS?
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture2/" title="Lecture2. Dev Env Setup" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture2/">
        Lecture2. Dev Env Setup
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture3/" title="Lecture3. Core of ROS" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture3/">
        Lecture3. Core of ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture4/" title="Lecture4. ROS 2 Node and Parameter Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture4/">
        Lecture4. ROS 2 Node and Parameter Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture5/" title="Lecture5. ROS 2 Communication Mechanisms" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture5/">
        Lecture5. ROS 2 Communication Mechanisms
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture6/" title="Lecture6. ROS 2 Tools" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture6/">
        Lecture6. ROS 2 Tools
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture7/" title="Lecture7. ROS 2 Topic and Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture7/">
        Lecture7. ROS 2 Topic and Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture8/" title="Lecture8. ROS 2 Service and Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture8/">
        Lecture8. ROS 2 Service and Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture9/" title="Lecture9. ROS 2 Action Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture9/">
        Lecture9. ROS 2 Action Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture10/" title="Lecture10. TF and ROS 2" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture10/">
        Lecture10. TF and ROS 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture11/" title="Lecture11. About Gazebo - 1" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture11/">
        Lecture11. About Gazebo - 1
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture12/" title="Lecture12. About Gazebo - 2" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture12/">
        Lecture12. About Gazebo - 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture13/" title="Lecture13. Useful ROS 2 Examples (Sensor Part)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture13/">
        Lecture13. Useful ROS 2 Examples (Sensor Part)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture14/" title="Lecture14. Useful ROS 2 Examples (Control Part)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture14/">
        Lecture14. Useful ROS 2 Examples (Control Part)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture15/" title="Lecture15. Advanced ROS 2, Package Management" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture15/">
        Lecture15. Advanced ROS 2, Package Management
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture16/" title="Lecture16. Useful ROS 2 Examples (Misc)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture16/">
        Lecture16. Useful ROS 2 Examples (Misc)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture17/" title="Lecture17. Real Hardware Examples" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture17/">
        Lecture17. Real Hardware Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture18/" title="Lecture18. Point Cloud Deep Learning Example (PointNet)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture18/">
        Lecture18. Point Cloud Deep Learning Example (PointNet)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture19/" title="Lecture19. Orbbec ROS 2 Package - Final" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture19/">
        Lecture19. Orbbec ROS 2 Package - Final
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture20/" title="Lecture20. NVIDIA Jetson Platform" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture20/">
        Lecture20. NVIDIA Jetson Platform
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/advanced_contents_ros2/" title="ROS 2" class="dd-item
        
        
        
        ">
      <a href="/kr/advanced_contents_ros2/">
          <b>Advanced Contents. </b>ROS 2
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture1/" title="Lecture1 - About DDS" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture1/">
        Lecture1 - About DDS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture2/" title="Lecture11 - About DDS (2)" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture2/">
        Lecture11 - About DDS (2)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture3/" title="Lecture12 - SROS2" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture3/">
        Lecture12 - SROS2
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros_and_gazebo/" title="Gazebo and ROS" class="dd-item
        
        
        
        ">
      <a href="/kr/ros_and_gazebo/">
          <b>Gazebo. </b>Gazebo and ROS
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_and_gazebo/lecture1/" title="Lecture1 - Gazebo and Robot" class="dd-item ">
        <a href="/kr/ros_and_gazebo/lecture1/">
        Lecture1 - Gazebo and Robot
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_and_gazebo/lecture2/" title="Lecture2 - Gazebo and Robot(2)" class="dd-item ">
        <a href="/kr/ros_and_gazebo/lecture2/">
        Lecture2 - Gazebo and Robot(2)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/RB2023ROS/du2023-ros1"><i class='fab fa-fw fa-github'></i> GitHub repo - ROS 1</a>
              </li>
          
              <li>
                  <a class="padding" href="https://github.com/RB2023ROS/du2023-ros2"><i class='fab fa-fw fa-github'></i> GitHub repo - ROS 2</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="kr" value="/kr/ros_basic_noetic/lecture5/" selected>Korean</option>
                    
                  
              
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      

      
      </ul>
    </section>
    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='' href="https://github.com/com2018-fa22/hugo-blog/tree/main/content/ros_basic_noetic/lecture5.kr.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text"></span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                   Lecture5 - First Programming, ROS Topic
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#ros-node-programming">ROS Node Programming</a>
      <ul>
        <li></li>
        <li><a href="#ros-timer">ROS Timer</a></li>
        <li><a href="#oop-node-programming">OOP Node Programming</a></li>
      </ul>
    </li>
    <li><a href="#ros-topic">ROS Topic</a>
      <ul>
        <li><a href="#topic은-node들-사이에-데이터message가-오가는-길bus의-이름입니다">Topic은 Node들 사이에 데이터(Message)가 오가는 길(Bus)의 이름입니다.</a></li>
      </ul>
    </li>
    <li><a href="#topic-message">Topic Message</a>
      <ul>
        <li><a href="#publisher-프로그래밍">Publisher 프로그래밍</a></li>
      </ul>
    </li>
    <li><a href="#subscriber-프로그래밍">Subscriber 프로그래밍</a>
      <ul>
        <li><a href="#과제---물체-회피하기">과제 - 물체 회피하기</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Lecture5 - First Programming, ROS Topic
            </h1>
          

        


<h4 id="이번-강의부터-본격적인-프로그래밍이-시작됩니다">이번 강의부터, 본격적인 프로그래밍이 시작됩니다.</h4>
<blockquote>
<p>첫번째로 Node의 프로그래밍을 살펴보고자 하며, 시작 전 간단한 복습을 진행하고 시작하겠습니다.</p>
</blockquote>
<p><img src="/kr/ros_basic_noetic/images5/lec4_0.png?height=300px" alt="lec4_0.png"></p>
<p>image from : <a href="http://www.clearpathrobotics.com/assets/guides/kinetic/ros/Intro%20to%20the%20Robot%20Operating%20System.html">clearpathrobotics</a></p>
<ul>
<li>Workspace와 패키지</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span># WS 생성
</span></span><span style="display:flex;"><span>mkdir -p catkin_ws/src
</span></span><span style="display:flex;"><span>cd catkin_ws
</span></span><span style="display:flex;"><span>catkin config --init
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Package 생성
</span></span><span style="display:flex;"><span>catkin_create_pkg <span style="color:#f92672">&lt;pkg-name&gt;</span> <span style="color:#f92672">&lt;depend1&gt;</span> <span style="color:#f92672">&lt;depend2&gt;</span> ...
</span></span></code></pre></div><h2 id="ros-node-programming">ROS Node Programming</h2>
<ul>
<li>C++ 코드는 src 폴더 안에, 파이썬 코드는 <strong>scripts</strong>라는 폴더 안에 위치시키는 것이 일반적입니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>cd <span style="color:#f92672">&lt;pkg-name&gt;</span>
</span></span><span style="display:flex;"><span>mkdir scripts
</span></span></code></pre></div><blockquote>
<p>지금부터, 직접 명령어를 한줄씩 따라치면서 실습하셔도 좋고, 제가 미리 준비해둔 Package를 사용하셔도 좋습니다.</p>
</blockquote>
<p>다음으로, 파이썬 코드를 작성하고 패키지를 빌드해봅시다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>cd scripts
</span></span><span style="display:flex;"><span># my_first_node.py 생성
</span></span></code></pre></div><blockquote>
<p>첫번째 프로그래밍 코드는 Node의 기본입니다.</p>
</blockquote>

<div class="notices note" ><p>모든 소스코드는 <a href="https://github.com/RB2022ROS/du2023-ros1">github repo</a>에서 확인 가능합니다.</p>
</div>

<ul>
<li><strong>my_first_node.py</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> rospy
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> std_msgs.msg <span style="color:#f92672">import</span> String
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_first_node</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ROS nodes require initialization</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># It contains master registration, uploading parameters</span>
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>init_node(<span style="color:#e6db74">&#39;my_first_node&#39;</span>, anonymous<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ROS safe timer</span>
</span></span><span style="display:flex;"><span>    rate <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>Rate(<span style="color:#ae81ff">10</span>) <span style="color:#75715e"># 10hz</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Loop control Example</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> rospy<span style="color:#f92672">.</span>is_shutdown():
</span></span><span style="display:flex;"><span>        hello_du <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hello du </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> rospy<span style="color:#f92672">.</span>get_time()
</span></span><span style="display:flex;"><span>        rospy<span style="color:#f92672">.</span>loginfo(hello_du)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Below line calls sleep method in Python internally.</span>
</span></span><span style="display:flex;"><span>        rate<span style="color:#f92672">.</span>sleep()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        my_first_node()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> rospy<span style="color:#f92672">.</span>ROSInterruptException:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span></code></pre></div><ul>
<li>코드를 새로 작성한 다음에는 습관적으로 패키지를 빌드하고 실행합니다. 파이썬 코드의 경우 파일의 실행 권한이 주어져 있어야 합니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd scripts
</span></span><span style="display:flex;"><span>chmod +x *
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cd ~/catkin_ws
</span></span><span style="display:flex;"><span>catkin build my_first_pkg
</span></span></code></pre></div><ul>
<li>작성한 node를 실행해봅시다. 반복해서 터미널 로그가 남을 것입니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span># Terminal 1
</span></span><span style="display:flex;"><span>roscore
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Terminal 2
</span></span><span style="display:flex;"><span>rosrun my_first_package my_first_node.py
</span></span></code></pre></div><p><img src="/kr/ros_basic_noetic/images5/my_first_node.gif?height=300px" alt="my_first_node.gif"></p>
<hr>
<h4 id="코드-분석">코드 분석</h4>
<blockquote>
<p>첫 코드인 만큼 자세하게 분석하고 넘어가보려 합니다.</p>
</blockquote>
<ul>
<li><strong>ROS Noetic은 Python 3</strong>를 사용합니다. 가상환경의 파이썬, 직접 설치한 파이썬 등 여러 버전이 설치되어 있을 것입니다. 공식 문서에서는 이러한 혼란을 방지하기 위해 코드의 제일 처음 아래 라인을 추가하는 것을 추천하고 있습니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span></code></pre></div><ul>
<li>Python을 사용하여 ROS를 다루기 위해 사용되는 패키지는 <strong>rospy</strong>입니다. import를 사용해도 좋고 from / import를 통해 특정 클래스만 가져올 수도 있습니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> rospy
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> std_msgs.msg <span style="color:#f92672">import</span> String
</span></span></code></pre></div><ul>
<li>당장 사용하지는 않지만 Test Code를 작성해야 하는 경우가 있습니다. 이러한 상황에 대비하기 위해 main 함수를 따로 두고 아래와 같이 프로그램을 시작하기를 권장합니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        my_first_node()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> rospy<span style="color:#f92672">.</span>ROSInterruptException:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span></code></pre></div><ul>
<li>이제, my_first_node를 분석해 보겠습니다. Node의 실행을 위해 Master에 등록하고, 초기화하는 작업이 필요하며, 이를 위해 별도로 <strong>init_node</strong>라는 메소드를 실행해주어야 합니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_first_node</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ROS nodes require initialization</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># It contains master registration, uploading parameters</span>
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>init_node(<span style="color:#e6db74">&#39;my_first_node&#39;</span>, anonymous<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><ul>
<li>ROS 시스템은 기본적으로 <strong>무한 Loop</strong>입니다. 이 Loop가 한차례 반복되는 주기를 설정하는 부분입니다. ROS의 시간 체계에 대해서는 이후 한번 더 다루겠습니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#75715e"># ROS safe timer</span>
</span></span><span style="display:flex;"><span>    rate <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>Rate(<span style="color:#ae81ff">10</span>) <span style="color:#75715e"># 10hz</span>
</span></span></code></pre></div><ul>
<li>rospy를 통해 실행 중인 Node의 상태를 확인할 수 있으며, <code>is_shutdown()</code>은 예기치 못한 에러가 발생하거나 사용자의 종료를 인지할 수 있습니다. 10Hz를 맞추기 위해 Loop마다 sleep을 걸어주고 있습니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#75715e"># Loop control Example</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> rospy<span style="color:#f92672">.</span>is_shutdown():
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>        rate<span style="color:#f92672">.</span>sleep()
</span></span></code></pre></div><ul>
<li>ROS에서 콘솔 로그를 얻는 방법으로 print 보다 <code>rospy.log</code>를 사용하기를 추천합니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>        hello_du <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hello du </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> rospy<span style="color:#f92672">.</span>get_time()
</span></span><span style="display:flex;"><span>        rospy<span style="color:#f92672">.</span>loginfo(hello_du)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Below line calls sleep method in Python internally.</span>
</span></span></code></pre></div><p><img src="/kr/ros_basic_noetic/images5/lec4_1.png?height=300px" alt="lec4_1.png"></p>
<hr>
<h3 id="ros-timer">ROS Timer</h3>
<p>ROS는 기본적으로 무한 Loop를 하나의 프로세스 안에서 동작시키는 프로그램입니다. Timer를 통해 일정 시간마다 동작하는 코드를 구현할 수 있습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd my_first_pkg/scripts
</span></span><span style="display:flex;"><span><span style="color:#75715e"># spin_node.py 생성</span>
</span></span></code></pre></div><ul>
<li>spin_node.py</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> rospy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># callback method requires event, which is TimerEvent</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello_du</span>(event<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>    hello_du <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hello du </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> rospy<span style="color:#f92672">.</span>get_time()
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>loginfo(hello_du)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_first_node</span>():
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>init_node(<span style="color:#e6db74">&#39;my_first_node&#39;</span>, anonymous<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Timer Class is kind of Thread.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># It&#39;s rule is execute sleep in certain period with given event.</span>
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>Timer(rospy<span style="color:#f92672">.</span>Duration(<span style="color:#ae81ff">1.0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">100.0</span>), hello_du)
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>spin()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        my_first_node()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> rospy<span style="color:#f92672">.</span>ROSInterruptException:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span></code></pre></div><p>코드의 실행 결과는 이전과 같기 때문에 Timer와 spin에 대해서만 짚고 넘어가겠습니다.</p>
<ul>
<li>Timer는 크게 두가지 매개변수를 받습니다. 실행 주기와 Callback 함수입니다. 해당 주기마다 Callback 함수를 실행시킵니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>Timer(rospy<span style="color:#f92672">.</span>Duration(<span style="color:#ae81ff">1.0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">100.0</span>), hello_du)
</span></span></code></pre></div><ul>
<li>앞으로 여러분들은 직접 while loop를 구현하기보다 <code>rospy.spin()</code>을 더 많이 사용하시게 될 겁니다. Timer를 선언한 이후, 하나의 Thread에서 막혀버리는 것을 방지하는 역할을 수행합니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>Timer(rospy<span style="color:#f92672">.</span>Duration(<span style="color:#ae81ff">1.0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">100.0</span>), hello_du)
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>spin()
</span></span></code></pre></div><p><img src="/kr/ros_basic_noetic/images5/lec4_2.png?height=200px" alt="lec4_2.png"></p>
<p>image from : <a href="https://www.pythontutorial.net/python-concurrency/python-threading/">python tutorial</a></p>
<h3 id="oop-node-programming">OOP Node Programming</h3>
<ul>
<li>my_first_oop_node.py</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> rospy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OOPNode</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>counter_ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>timer_ <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>Timer(rospy<span style="color:#f92672">.</span>Duration(<span style="color:#ae81ff">1.0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">100.0</span>), self<span style="color:#f92672">.</span>hello_du)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello_du</span>(self, event<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        hello_du <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;hello du </span><span style="color:#e6db74">{</span>rospy<span style="color:#f92672">.</span>get_time()<span style="color:#e6db74">}</span><span style="color:#e6db74">, counter: </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>counter_<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        rospy<span style="color:#f92672">.</span>loginfo(hello_du)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>counter_ <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_first_oop_node</span>():
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>init_node(<span style="color:#e6db74">&#39;my_first_oop_node&#39;</span>, anonymous<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    oop_node <span style="color:#f92672">=</span> OOPNode()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>spin()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        my_first_oop_node()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> rospy<span style="color:#f92672">.</span>ROSInterruptException:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span></code></pre></div><p>이후의 실습들을 위해 한가지 예시만 더 살펴보고자 합니다. <strong>객체 지향을 사용한 ROS Node 작성</strong>방법입니다. 파이썬에서 OOP를 사용하기 위해 Class 키워드를 사용하며, self등 OOP와 관련된 내용은 모두 알고 있다는 상태에서 진행하겠습니다.</p>
<ul>
<li>OOP를 사용하면 main 메소드가 매우 간편해진다는 장점이 있습니다. 클래스를 생성하고, spin을 하기만 하면 됩니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_first_oop_node</span>():
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>init_node(<span style="color:#e6db74">&#39;my_first_oop_node&#39;</span>, anonymous<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    oop_node <span style="color:#f92672">=</span> OOPNode()
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>spin()
</span></span></code></pre></div><ul>
<li>OOP로 전환되면서 변경된 구현에 주목합시다. Timer의 Callback 함수로 클래스 메소드가 사용되었으며, 클래스 변수인 counter를 사용하여 구현한 점에 주목합니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OOPNode</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>counter_ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>timer_ <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>Timer(rospy<span style="color:#f92672">.</span>Duration(<span style="color:#ae81ff">1.0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">100.0</span>), self<span style="color:#f92672">.</span>hello_du)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello_du</span>(self, event<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        hello_du <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;hello du </span><span style="color:#e6db74">{</span>rospy<span style="color:#f92672">.</span>get_time()<span style="color:#e6db74">}</span><span style="color:#e6db74">, counter: </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>counter_<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        rospy<span style="color:#f92672">.</span>loginfo(hello_du)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>counter_ <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span></code></pre></div><p>앞으로, 대부분의 코드는 OOP 기반으로 작성됩니다. 파이썬의 클래스에 대해 숙지가 되어있지 않다면 꼭 복습하고 다음 강의를 청취하세요!</p>
<hr>
<h2 id="ros-topic">ROS Topic</h2>
<p>다시 개념 학습으로 돌아와보았습니다. 아래 그림은 지난 강의의 rqt_graph입니다.</p>
<p><img src="/kr/ros_basic_noetic/images5/lec4_3.png" alt="lec4_3.png"></p>
<p>위 그림에서 동그라미는 Node를 뜻하고, 화살표는 topic을 뜻합니다.</p>
<blockquote>
<p>이번 시간에는 이 Topic이 무엇인지 배워보고자 합니다.</p>
</blockquote>
<h3 id="topic은-node들-사이에-데이터message가-오가는-길bus의-이름입니다">Topic은 Node들 사이에 데이터(Message)가 오가는 길(Bus)의 이름입니다.</h3>
<p><img src="/kr/ros_basic_noetic/images5/topic.gif?height=300px" alt="topic.gif"></p>
<ul>
<li>image from : <a href="https://docs.ros.org/en/foxy/Tutorials/Topics/Understanding-ROS2-Topics.html">docs.ros.org</a></li>
</ul>
<blockquote>
<p>그림에서와 같이 ROS Topic은</p>
</blockquote>
<ul>
<li><strong>Publisher(발행자) Subscriber(구독자)로 나누어 Topic의 송신, 수신자를 구분합니다.</strong></li>
<li><strong>Publisher, Subscriber는 Node안에서 생성되며 별도로 사용할 수는 없습니다.</strong></li>
<li><strong>Pub/Sub 사이에 Message가 전달되며, 이 길의 이름이 Topic인 것입니다.</strong></li>
<li>주의할 점은, <strong>Publisher, Subscriber는 오로지 Topic의 이름으로 소통한다는 것입니다.</strong> 어떤 Node에 publish 할지 Publisher는 전혀 모르며 오로지 Topic이 같은 Subscriber가 데이터를 받게 됩니다.</li>
</ul>
<p>더불어, Topic은 여러 Node들로 부터 데이터를 받을 수 있고, 전송 시에도 여러 Node들에게 전송이 가능한 방식입니다. ⇒ Topic의 중요한 속성이니 꼭 알아두셨으면 좋겠습니다.</p>
<p><img src="/kr/ros_basic_noetic/images5/topic2.gif?height=300px" alt="topic2.gif"></p>
<ul>
<li>image from : <a href="https://docs.ros.org/en/foxy/Tutorials/Topics/Understanding-ROS2-Topics.html">docs.ros.org</a></li>
</ul>
<p><strong>Node와 Topic의 개념을 다시 한 번 다잡고 갑시다.</strong></p>
<ul>
<li>Node는 실행되는 프로그램이며, ROS Master에 등록하고 관리됩니다.</li>
</ul>
<p><img src="/kr/ros_basic_noetic/images5/lec4_4.png?height=200px" alt="lec4_4.png"></p>
<ul>
<li>Node들 사이의 통신 메커니즘 중 Topic이라는 것이 있으며, 이는 Publisher와 Subscriber라는 개념을 갖고 있습니다.</li>
</ul>
<p><img src="/kr/ros_basic_noetic/images5/lec4_5.png?height=250px" alt="lec4_5.png"></p>
<ul>
<li>Publisher와 Subscriber 사이의 오가는 데이터는 특정한 타입을 갖습니다. 이를 Message라고 부릅니다.</li>
</ul>
<p><img src="/kr/ros_basic_noetic/images5/lec4_6.png?height=300px" alt="lec4_6.png"></p>
<hr>
<h2 id="topic-message">Topic Message</h2>
<ul>
<li>로봇 프로그래밍 시에는 다양한 센서 데이터들이 다뤄집니다.</li>
</ul>
<p><img src="/kr/ros_basic_noetic/images5/lec4_7.png?height=200px" alt="lec4_7.png"></p>
<ul>
<li>센서 뿐만 아니라, 제어 데이터도 주고 받아야 합니다.</li>
</ul>
<p><img src="/kr/ros_basic_noetic/images5/lec4_8.png?height=200px" alt="lec4_8.png"></p>
<p>ROS에서는 주로 사용되는 이러한 데이터 형식을 <strong>Message</strong>라는 이름으로 지칭하며, 여러 기본 형태를 제공합니다. 더불어 사용자가 직접 Message를 커스터마이징할 수도 있습니다.</p>
<ul>
<li>일전 예시의 분석을 통해 Topic과 Message에 대해 다시 한 번 살펴봅시다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1</span>
</span></span><span style="display:flex;"><span>roscore
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2</span>
</span></span><span style="display:flex;"><span>rosrun roscpp_tutorials talker
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 3</span>
</span></span><span style="display:flex;"><span>rosrun roscpp_tutorials listener
</span></span></code></pre></div><p><img src="/kr/ros_basic_noetic/images5/talker_listener.gif?height=400px" alt="talker_listener.gif"></p>
<p>두 프로그램이 실행되고 있는 상태를 유지하면서, 아래 내용을 따라와주세요</p>
<ul>
<li>rostopic list를 통해 사용중인 topic들을 모두 조회 가능합니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rostopic list
</span></span><span style="display:flex;"><span>/chatter
</span></span><span style="display:flex;"><span>/rosout
</span></span><span style="display:flex;"><span>/rosout_agg
</span></span></code></pre></div><ul>
<li>특정 topic에 대한 자세한 정보를 알고 싶다면 rostopic info를 사용합니다. <strong>talker</strong>와 <strong>listener</strong>가 조회된 모습도 보입니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rostopic info /chatter
</span></span><span style="display:flex;"><span>Type: std_msgs/String
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Publishers:
</span></span><span style="display:flex;"><span> * /talker_215337_1671763968667 <span style="color:#f92672">(</span>http://192.168.55.236:37863/<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Subscribers:
</span></span><span style="display:flex;"><span> * /listener_215355_1671763970127 <span style="color:#f92672">(</span>http://192.168.55.236:44969/<span style="color:#f92672">)</span>
</span></span></code></pre></div><ul>
<li>해당 topic이 사용중인 Message를 조회하기 위해 rostopic type을 사용합니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rostopic type /chatter
</span></span><span style="display:flex;"><span>std_msgs/String
</span></span></code></pre></div><ul>
<li>rosmsg show를 통해 Message의 원형을 확인할 수 있습니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rosmsg show std_msgs/String
</span></span><span style="display:flex;"><span>string data
</span></span></code></pre></div><ul>
<li>topic 데이터를 엿볼 수 있는 rostopic echo입니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rostopic echo /chatter
</span></span><span style="display:flex;"><span>data: <span style="color:#e6db74">&#34;hello world 1671764088.1913402&#34;</span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>data: <span style="color:#e6db74">&#34;hello world 1671764088.2913551&#34;</span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><ul>
<li>rostopic hz로 topic의 pub/sub 주기를 분석할 수 있습니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rostopic hz /chatter
</span></span><span style="display:flex;"><span>subscribed to <span style="color:#f92672">[</span>/chatter<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>average rate: 10.000
</span></span><span style="display:flex;"><span>	min: 0.100s max: 0.100s std dev: 0.00014s window: <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>average rate: 9.999
</span></span><span style="display:flex;"><span>	min: 0.099s max: 0.100s std dev: 0.00023s window: <span style="color:#ae81ff">20</span>
</span></span></code></pre></div><p>마지막으로 rqt_graph를 다시 한 번 살펴봅시다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span>rqt_graph
</span></span></code></pre></div><p><img src="/kr/ros_basic_noetic/images5/lec4_9.png?height=80px" alt="lec4_9.png"></p>
<blockquote>
<p>방금 살펴본 커멘드 라인들을 충분히 숙지하시기 바랍니다. 그러한 의미에서, 이번에는 Gazebo 예시를 분석해볼까 합니다.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1</span>
</span></span><span style="display:flex;"><span>roslaunch smb_gazebo smb_gazebo.launch
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2</span>
</span></span><span style="display:flex;"><span>rosrun teleop_twist_keyboard teleop_twist_keyboard.py
</span></span></code></pre></div><p><img src="/kr/ros_basic_noetic/images5/lec4_10.png?height=400px" alt="lec4_10.png"></p>
<ul>
<li>rostopic list 결과</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rostopic list
</span></span><span style="display:flex;"><span>/clicked_point
</span></span><span style="display:flex;"><span>/clock
</span></span><span style="display:flex;"><span>/cmd_vel
</span></span><span style="display:flex;"><span>/diagnostics
</span></span><span style="display:flex;"><span>/e_stop
</span></span><span style="display:flex;"><span>/gazebo/link_states
</span></span><span style="display:flex;"><span>/gazebo/model_states
</span></span><span style="display:flex;"><span>/gazebo/parameter_descriptions
</span></span><span style="display:flex;"><span>/gazebo/parameter_updates
</span></span><span style="display:flex;"><span>/gazebo/performance_metrics
</span></span><span style="display:flex;"><span>/gazebo/set_link_state
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>우리가 집중하고자 하는 topic은 로봇을 제어하는 <strong>/cmd_vel</strong>입니다.</p>
<ul>
<li>rostopic info 결과</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rostopic info /cmd_vel
</span></span><span style="display:flex;"><span>Type: geometry_msgs/Twist
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Publishers:
</span></span><span style="display:flex;"><span> * /teleop_twist_keyboard <span style="color:#f92672">(</span>http://192.168.55.236:33903/<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Subscribers:
</span></span><span style="display:flex;"><span> * /twist_mux <span style="color:#f92672">(</span>http://192.168.55.236:38201/<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span> * /gazebo <span style="color:#f92672">(</span>http://192.168.55.236:33033/<span style="color:#f92672">)</span>
</span></span></code></pre></div><ul>
<li>rostopic type 결과</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rostopic type /cmd_vel
</span></span><span style="display:flex;"><span>geometry_msgs/Twist
</span></span></code></pre></div><ul>
<li>geometry_msgs/Twist의 rosmsg show 결과</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rosmsg show geometry_msgs/Twist
</span></span><span style="display:flex;"><span>geometry_msgs/Vector3 linear
</span></span><span style="display:flex;"><span>  float64 x
</span></span><span style="display:flex;"><span>  float64 y
</span></span><span style="display:flex;"><span>  float64 z
</span></span><span style="display:flex;"><span>geometry_msgs/Vector3 angular
</span></span><span style="display:flex;"><span>  float64 x
</span></span><span style="display:flex;"><span>  float64 y
</span></span><span style="display:flex;"><span>  float64 z
</span></span></code></pre></div><ul>
<li>/scan의 rostopic echo 결과</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rostopic echo /scan
</span></span><span style="display:flex;"><span>header:
</span></span><span style="display:flex;"><span>  seq: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  stamp:
</span></span><span style="display:flex;"><span>    secs: <span style="color:#ae81ff">204</span>
</span></span><span style="display:flex;"><span>    nsecs: <span style="color:#ae81ff">678000000</span>
</span></span><span style="display:flex;"><span>  frame_id: <span style="color:#e6db74">&#34;rslidar&#34;</span>
</span></span><span style="display:flex;"><span>angle_min: -1.5707999467849731
</span></span><span style="display:flex;"><span>angle_max: 1.5707999467849731
</span></span><span style="display:flex;"><span>angle_increment: 0.008700000122189522
</span></span><span style="display:flex;"><span>time_increment: 0.0
</span></span><span style="display:flex;"><span>scan_time: 0.033330000936985016
</span></span><span style="display:flex;"><span>range_min: 0.44999998807907104
</span></span><span style="display:flex;"><span>range_max: 50.0
</span></span><span style="display:flex;"><span>ranges: <span style="color:#f92672">[</span>inf, inf, inf, inf, inf, inf, inf, inf, inf, inf, inf, ...
</span></span></code></pre></div><ul>
<li>/scan의 rostopic hz결과</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rostopic hz /scan
</span></span><span style="display:flex;"><span>subscribed to <span style="color:#f92672">[</span>/scan<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>WARNING: may be using simulated time
</span></span><span style="display:flex;"><span>average rate: 10.000
</span></span><span style="display:flex;"><span>	min: 0.100s max: 0.100s std dev: 0.00000s window: <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>average rate: 10.000
</span></span><span style="display:flex;"><span>	min: 0.100s max: 0.100s std dev: 0.00000s window: <span style="color:#ae81ff">17</span>
</span></span></code></pre></div><p>rqt_graph에서 /cmd_vel을 찾아볼까요?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span>rqt_graph
</span></span></code></pre></div><p><img src="/kr/ros_basic_noetic/images5/lec4_11.png?height=200px" alt="lec4_11.png"></p>
<hr>
<h3 id="publisher-프로그래밍">Publisher 프로그래밍</h3>
<p>이번 시간 사용할 Package는 py_topic_pkg 입니다. 실습 전 실행부터 해보겠습니다.</p>
<ul>
<li>Package Build</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span>cd <span style="color:#f92672">~/</span>catkin_ws
</span></span><span style="display:flex;"><span>catkin build py_topic_pkg
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">source</span> devel<span style="color:#f92672">/</span>setup.bash
</span></span></code></pre></div><ul>
<li>예제 실행</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1</span>
</span></span><span style="display:flex;"><span>roslaunch smb_gazebo smb_gazebo.launch
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2</span>
</span></span><span style="display:flex;"><span>rosrun py_topic_pkg cmd_vel_pub.py
</span></span></code></pre></div><p>로봇이 아래와 같이 원을 그리며 움직일 것입니다.</p>
<p><img src="/kr/ros_basic_noetic/images5/smb_circle.gif?height=300px" alt="smb_circle.gif"></p>
<ul>
<li>cmd_vel_pub.py</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> rospy
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> geometry_msgs.msg <span style="color:#f92672">import</span> Twist
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CmdVelPubNode</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Publisher requires 3 paramters</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#  1. topic name</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#  2. topic msg type</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#  3. topic queue size</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>cmd_vel_pub_ <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>Publisher(<span style="color:#e6db74">&#34;cmd_vel&#34;</span>, Twist, queue_size<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>timer_ <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>Timer(rospy<span style="color:#f92672">.</span>Duration(<span style="color:#ae81ff">1.0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10.0</span>), self<span style="color:#f92672">.</span>pub_msg)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>twist_ <span style="color:#f92672">=</span> Twist()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">pub_msg</span>(self, event<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># geometry_msgs.Twist</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ref: http://docs.ros.org/en/melodic/api/geometry_msgs/html/msg/Twist.html</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>twist_<span style="color:#f92672">.</span>linear<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>twist_<span style="color:#f92672">.</span>angular<span style="color:#f92672">.</span>z <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>cmd_vel_pub_<span style="color:#f92672">.</span>publish(self<span style="color:#f92672">.</span>twist_)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cmd_vel_node</span>():
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>init_node(<span style="color:#e6db74">&#39;cmd_vel_node&#39;</span>, anonymous<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    cmd_vel_pub_node <span style="color:#f92672">=</span> CmdVelPubNode()
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>spin()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        cmd_vel_node()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> rospy<span style="color:#f92672">.</span>ROSInterruptException:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span></code></pre></div><ul>
<li>파이썬 ros 프로그래밍을 위한 rospy, 로봇의 속도 제어에 필요한 Message type인 Twist를 import 하고 있습니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> rospy
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> geometry_msgs.msg <span style="color:#f92672">import</span> Twist
</span></span></code></pre></div><ul>
<li>rospy.Publisher를 통해 publisher를 생성할 수 있습니다. 이는 최소 3개의 매개변수를 필요로 합니다.</li>
</ul>
<ol>
<li><strong>topic 이름</strong></li>
<li><strong>topic type</strong></li>
<li><strong>queue size</strong></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>self.cmd_vel_pub_ <span style="color:#f92672">=</span> rospy.Publisher<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;cmd_vel&#34;</span>, Twist, queue_size<span style="color:#f92672">=</span>10<span style="color:#f92672">)=</span>
</span></span></code></pre></div><ul>
<li>우리는 로봇의 제어 신호를 주기적으로 전송하고자 합니다. 따라서 <strong>Timer</strong>도 선언하였습니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>self.timer_ <span style="color:#f92672">=</span> rospy.Timer<span style="color:#f92672">(</span>rospy.Duration<span style="color:#f92672">(</span>1.0/10.0<span style="color:#f92672">)</span>, self.pub_msg<span style="color:#f92672">)</span>
</span></span></code></pre></div><ul>
<li>다음으로, Message Type인 <strong>geometry_msgs/Twist</strong> 값을 채웁니다. 현재 우리 로봇은 2차원 평면에서 움직이며, 로봇 형태 때문에 앞뒤 선속도와 각속도를 갖게 됩니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>        self.twist_ <span style="color:#f92672">=</span> Twist<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    def pub_msg<span style="color:#f92672">(</span>self, event<span style="color:#f92672">=</span>None<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>        self.twist_.linear.x <span style="color:#f92672">=</span> 0.5
</span></span><span style="display:flex;"><span>        self.twist_.angular.z <span style="color:#f92672">=</span> 1.0
</span></span></code></pre></div><blockquote>
<p>Message의 종류는 매우 많습니다. 구글을 통해 검색하면서 코딩하는 습관을 들여봅시다.</p>
</blockquote>
<p><img src="/kr/ros_basic_noetic/images5/lec4_12.png?height=350px" alt="lec4_12.png"></p>
<ul>
<li>from : <a href="http://docs.ros.org/en/melodic/api/geometry_msgs/html/msg/Twist.html">http://docs.ros.org/</a></li>
</ul>

<div class="notices note" ><p>linear의 단위는 m/s 이며, angular의 단위는 rad/s 입니다. pi = 3.14</p>
</div>

<ul>
<li>마지막, 가장 중요한 topic publish는 생성한 Publisher의 publish() 메소드를 사용합니다. 미리 준비해둔 topic message를 사용합시다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">pub_msg</span>(self, event<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># geometry_msgs.Twist</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ref: http://docs.ros.org/en/melodic/api/geometry_msgs/html/msg/Twist.html</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>twist_<span style="color:#f92672">.</span>linear<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>twist_<span style="color:#f92672">.</span>angular<span style="color:#f92672">.</span>z <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>cmd_vel_pub_<span style="color:#f92672">.</span>publish(self<span style="color:#f92672">.</span>twist_)
</span></span></code></pre></div><p>이 Node를 실행하면, 우리의 ROS가 일정 주기에 맞추어 알맞게 topic publish를 실행시켜줄 것입니다. 우리는 정해진 구현에 맞추어 코드만 작성하면 되는 것이지요 😊</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cmd_vel_node</span>():
</span></span><span style="display:flex;"><span>        rospy<span style="color:#f92672">.</span>init_node(<span style="color:#e6db74">&#39;cmd_vel_node&#39;</span>, anonymous<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>        cmd_vel_pub_node <span style="color:#f92672">=</span> CmdVelPubNode()
</span></span><span style="display:flex;"><span>        rospy<span style="color:#f92672">.</span>spin()
</span></span></code></pre></div><hr>
<h2 id="subscriber-프로그래밍">Subscriber 프로그래밍</h2>
<ul>
<li>이번 예시에는 로봇에 장착된 라이다 센서를 사용해보려 합니다. 예시를 실행해보겠습니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1</span>
</span></span><span style="display:flex;"><span>roslaunch smb_gazebo smb_gazebo<span style="color:#f92672">.</span>launch
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2</span>
</span></span><span style="display:flex;"><span>rosrun py_topic_pkg laser_scan_sub<span style="color:#f92672">.</span>py
</span></span></code></pre></div><ul>
<li>실행 이후, 영상과 같이 박스를 로봇의 전방에 배치해봅시다.</li>
</ul>
<p><img src="/kr/ros_basic_noetic/images5/box_gazebo.gif?height=400px" alt="box_gazebo.gif"></p>
<blockquote>
<p>터미널에 등장하는 문구에 집중해보세요. 박스가 추가되면서 출력창에 어떠한 변화가 생기나요?</p>
</blockquote>
<p><img src="/kr/ros_basic_noetic/images5/lec4_13.png?height=200px" alt="lec4_13.png"></p>
<p>로봇에 부착된 라이다 센서는 전방 180도 사방으로 360개의 레이저를 흩뿌립니다.</p>
<p>레이저의 특성상 물체를 맞고 되돌아오게 되며, 이 시간을 통해 물체와의 거리를 알 수 있습니다.</p>
<p><img src="/kr/ros_basic_noetic/images5/lec4_14.png?height=300px" alt="lec4_14.png"></p>
<p>예시의 프로그램은 로봇에 부착된 레이저에서 <strong>publish</strong>되는 데이터를 <strong>subscribe</strong>한 것입니다. 이를 프로그래밍하면서 python으로 subscriber를 다루는 방법에 대해 배워봅시다.</p>
<ul>
<li><strong>laser_scan_sub.py</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> rospy
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sensor_msgs.msg <span style="color:#f92672">import</span> LaserScan
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LaserSubNode</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Publisher requires 3 paramters</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#  1. topic name</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#  2. topic msg type</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#  3. sub callback method</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>laser_sub_ <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>Subscriber(<span style="color:#e6db74">&#34;scan&#34;</span>, LaserScan, self<span style="color:#f92672">.</span>laser_cb)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># first param of callback method is always topic msg</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">laser_cb</span>(self, data):
</span></span><span style="display:flex;"><span>        rospy<span style="color:#f92672">.</span>loginfo( len(data<span style="color:#f92672">.</span>ranges))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        data.ranges[0]: </span><span style="color:#e6db74">{</span>data<span style="color:#f92672">.</span>ranges[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        data.ranges[90]: </span><span style="color:#e6db74">{</span>data<span style="color:#f92672">.</span>ranges[<span style="color:#ae81ff">90</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        data.ranges[179]: </span><span style="color:#e6db74">{</span>data<span style="color:#f92672">.</span>ranges[<span style="color:#ae81ff">179</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        data.ranges[270]: </span><span style="color:#e6db74">{</span>data<span style="color:#f92672">.</span>ranges[<span style="color:#ae81ff">270</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        data.ranges[360]: </span><span style="color:#e6db74">{</span>data<span style="color:#f92672">.</span>ranges[<span style="color:#ae81ff">360</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">laser_sub_node</span>():
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>init_node(<span style="color:#e6db74">&#39;laser_sub_node&#39;</span>, anonymous<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    laser_sub_node <span style="color:#f92672">=</span> LaserSubNode()
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>spin()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        laser_sub_node()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> rospy<span style="color:#f92672">.</span>ROSInterruptException:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span></code></pre></div><ul>
<li>이번에 사용하는 topic message는 <a href="http://docs.ros.org/en/melodic/api/sensor_msgs/html/msg/LaserScan.html">sensor_msgs/LaserScan</a>입니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> rospy
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sensor_msgs.msg <span style="color:#f92672">import</span> LaserScan
</span></span></code></pre></div><p>subscriber는 publisher와 달리 <strong>Timer가 필요하지 않습니다.</strong> publish되는 데이터가 없으면 아무 동작을 할 수 없으며, publish 주기에 맞추어 subscribe할 수밖에 없는 것이지요.</p>
<ul>
<li>subscriber는 rospy.Subscriber로 생성하며 최소 3개의 매개변수를 요구합니다.</li>
</ul>
<ol>
<li><strong>topic 이름</strong></li>
<li><strong>topic message 이름</strong></li>
<li><strong>subscribe 마다 실행되는 callback 메소드</strong></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LaserSubNode</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Publisher requires 3 paramters</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#  1. topic name</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#  2. topic msg type</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#  3. sub callback method</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>laser_sub_ <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>Subscriber(<span style="color:#e6db74">&#34;scan&#34;</span>, LaserScan, self<span style="color:#f92672">.</span>laser_cb)
</span></span></code></pre></div><ul>
<li>이 callback 메소드에서 주의해야 할 점은, 항상 callback method의 매개변수가 subscribe된 데이터라는 점입니다. 지금의 경우 LaserScan 타입의 데이터일 것입니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>		<span style="color:#75715e"># first param of callback method is always topic msg</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">laser_cb</span>(self, data):
</span></span><span style="display:flex;"><span>        rospy<span style="color:#f92672">.</span>loginfo( len(data<span style="color:#f92672">.</span>ranges))
</span></span><span style="display:flex;"><span>				<span style="color:#f92672">...</span>
</span></span></code></pre></div><ul>
<li>마지막으로, 깔끔한 터미널 출력을 위해 print 함수를 사용하였습니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    data.ranges[0]: </span><span style="color:#e6db74">{</span>data<span style="color:#f92672">.</span>ranges[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    data.ranges[90]: </span><span style="color:#e6db74">{</span>data<span style="color:#f92672">.</span>ranges[<span style="color:#ae81ff">90</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    data.ranges[179]: </span><span style="color:#e6db74">{</span>data<span style="color:#f92672">.</span>ranges[<span style="color:#ae81ff">179</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    data.ranges[270]: </span><span style="color:#e6db74">{</span>data<span style="color:#f92672">.</span>ranges[<span style="color:#ae81ff">270</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    data.ranges[360]: </span><span style="color:#e6db74">{</span>data<span style="color:#f92672">.</span>ranges[<span style="color:#ae81ff">360</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>)
</span></span></code></pre></div><p>Subscriber 실행 시에는 항상 <code>rospy.spin()</code>을 잊지 말도록 합니다. spin 되지 않는다면 특정 쓰레드가 자원을 점유하기 때문에 subscriber의 상태를 갱신할 수 없습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">laser_sub_node</span>():
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>init_node(<span style="color:#e6db74">&#39;laser_sub_node&#39;</span>, anonymous<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    laser_sub_node <span style="color:#f92672">=</span> LaserSubNode()
</span></span><span style="display:flex;"><span>    rospy<span style="color:#f92672">.</span>spin()
</span></span></code></pre></div><hr>
<h3 id="과제---물체-회피하기">과제 - 물체 회피하기</h3>
<blockquote>
<p>pub/sub의 개념을 잘 이해하였는지 알아볼 수 있는 과제를 준비해보았습니다.
정답이 따로 있는 것은 아니기에 부담 없이 해보시고, 저의 답안도 한번 살펴보세요.</p>
</blockquote>
<ul>
<li>예제 실행</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1</span>
</span></span><span style="display:flex;"><span>roslaunch smb_gazebo smb_gazebo<span style="color:#f92672">.</span>launch
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Ternimal 2</span>
</span></span><span style="display:flex;"><span>rosrun py_topic_pkg collision_aviod<span style="color:#f92672">.</span>py
</span></span></code></pre></div><ul>
<li>Gazebo 예제를 실행하였다면, 로봇의 전방에 장애물을 놓아 진로를 막아봅니다.</li>
<li>여러분께서 구현해야 하는 것은, 라이다 센서를 사용하여 로봇이 회피 주행을 하도록 만드는 것입니다.</li>
</ul>
<p><img src="/kr/ros_basic_noetic/images5/lec4_15.png?height=350px" alt="lec4_15.png"></p>
<p>일종의 템플렛 코드를 첨부하였으며, <strong>my_collision_aviod.py</strong>라는 이름의 코드입니다.</p>
<p>해당 코드의 TODO 부분을 작성하여 여러분만의 회피 알고리즘을 만들어 보세요!</p>
<ul>
<li>로봇의 라이다 데이터인 <strong>LaserScan</strong>을 Subscribe하여 Twist Type을 사용하는 scan topic으로 publish를 하게 됩니다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CollisionAvoidNode</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>laser_sub_ <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>Subscriber(<span style="color:#e6db74">&#34;scan&#34;</span>, LaserScan, self<span style="color:#f92672">.</span>laser_cb)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>cmd_vel_pub_ <span style="color:#f92672">=</span> rospy<span style="color:#f92672">.</span>Publisher(<span style="color:#e6db74">&#34;cmd_vel&#34;</span>, Twist, queue_size<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>twist_ <span style="color:#f92672">=</span> Twist()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">laser_cb</span>(self, data):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># TODO: Prevent robot from collision</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># make your own logic to do that</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span></code></pre></div>
<div class="notices note" ><p>제가 작성한 예시를 수정하여 더욱 똑똑한 로봇을 구현하셔도 좋고, 자유롭게 실습해보시기 바랍니다.</p>
</div>

<hr>
<p><strong>참고자료</strong></p>
<ul>
<li><a href="https://rsl.ethz.ch/education-students/lectures/ros.html">https://rsl.ethz.ch/education-students/lectures/ros.html</a></li>
<li><a href="https://docs.ros.org/en/foxy/index.html">https://docs.ros.org/en/foxy/index.html</a></li>
<li><a href="http://wiki.ros.org/msg">http://wiki.ros.org/msg</a></li>
</ul>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/kr/ros_basic_noetic/lecture4/" title="Lecture4 - ROS Launch, RViz"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/kr/ros_basic_noetic/lecture6/" title="Lecture6 - ROS Service, Parameter" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1688985563"></script>
    <script src="/js/perfect-scrollbar.min.js?1688985563"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1688985563"></script>
    <script src="/js/jquery.sticky.js?1688985563"></script>
    <script src="/js/featherlight.min.js?1688985563"></script>
    <script src="/js/highlight.pack.js?1688985563"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1688985563"></script>
    <script src="/js/learn.js?1688985563"></script>
    <script src="/js/hugo-learn.js?1688985563"></script>
    
        
            <script src="https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

