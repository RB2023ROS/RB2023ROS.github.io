<!DOCTYPE html>
<html lang="kr" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.104.1" />
    <meta name="description" content="COM2018 OOP Class Lecture Note">
<meta name="author" content="Soo Young Kim">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Lecture13. Useful ROS 2 Examples (Sensor Part) - Documentation for Hugo Learn Theme</title>

    
    <link href="/css/nucleus.css?1684950311" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1684950311" rel="stylesheet">
    <link href="/css/hybrid.css?1684950311" rel="stylesheet">
    <link href="/css/featherlight.min.css?1684950311" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1684950311" rel="stylesheet">
    <link href="/css/auto-complete.css?1684950311" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1684950311" rel="stylesheet">
    <link href="/css/theme.css?1684950311" rel="stylesheet">
    <link href="/css/tabs.css?1684950311" rel="stylesheet">
    <link href="/css/hugo-theme.css?1684950311" rel="stylesheet">
    
    <link href="/css/theme-green.css?1684950311" rel="stylesheet">
    
    <link href="/css/foo.css?1684950311" rel="stylesheet"><link href="/css/bar.css?1684950311" rel="stylesheet">

    <script src="/js/jquery-3.3.1.min.js?1684950311"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/kr/ros2_foxy/lecture13/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <img width="1097" alt="image" src="https://user-images.githubusercontent.com/12381733/209764275-05dcbdbf-cef7-47ad-94a6-6d61febad01e.png">
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1684950311"></script>
<script type="text/javascript" src="/js/auto-complete.js?1684950311"></script>
<script type="text/javascript">
    
        var baseurl = "\/\/kr";
    
</script>
<script type="text/javascript" src="/js/search.js?1684950311"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/kr'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/kr/ros_basic_noetic/" title="ROS Basics" class="dd-item
        
        
        
        ">
      <a href="/kr/ros_basic_noetic/">
          <b>ROS Noetic. </b>ROS Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture1/" title="Lecture1 - Introduction to ROS" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture1/">
        Lecture1 - Introduction to ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture2/" title="Lecture2 - Dev Env Setup" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture2/">
        Lecture2 - Dev Env Setup
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture3/" title="Lecture3 - Core of ROS" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture3/">
        Lecture3 - Core of ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture4/" title="Lecture4 - ROS Launch, RViz" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture4/">
        Lecture4 - ROS Launch, RViz
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture5/" title="Lecture5 - First Programming, ROS Topic" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture5/">
        Lecture5 - First Programming, ROS Topic
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture6/" title="Lecture6 - ROS Service, Parameter" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture6/">
        Lecture6 - ROS Service, Parameter
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture7/" title="Lecture7 - Rqt Tools and rosbag, ROS Time" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture7/">
        Lecture7 - Rqt Tools and rosbag, ROS Time
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture8/" title="Lecture8 - Deal with Open Source Projects, Custom Interfaces" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture8/">
        Lecture8 - Deal with Open Source Projects, Custom Interfaces
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture9/" title="Lecture9 - ROS TF and Examples" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture9/">
        Lecture9 - ROS TF and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture10/" title="Lecture10 - TF2 Examples, Outro" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture10/">
        Lecture10 - TF2 Examples, Outro
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/advanced_contents_ros1/" title="ROS" class="dd-item
        
        
        
        ">
      <a href="/kr/advanced_contents_ros1/">
          <b>Advanced Contents. </b>ROS
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture1/" title="Lecture1 - ROSCPP" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture1/">
        Lecture1 - ROSCPP
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture2/" title="Lecture2 - More About ROS System" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture2/">
        Lecture2 - More About ROS System
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture3/" title="Lecture3 - SROS" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture3/">
        Lecture3 - SROS
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros2_basic_foxy/" title="ROS 2 Basics" class="dd-item
        
        
        
        ">
      <a href="/kr/ros2_basic_foxy/">
          <b>[Old]ROS 2 Foxy. </b>ROS 2 Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture1/" title="Lecture1 - Introduction to ROS 2" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture1/">
        Lecture1 - Introduction to ROS 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture2/" title="Lecture2 - ROS 2 Node, Package" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture2/">
        Lecture2 - ROS 2 Node, Package
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture3/" title="Lecture3 - ROS 2 Node Programming, ROS 2 parameter" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture3/">
        Lecture3 - ROS 2 Node Programming, ROS 2 parameter
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture4/" title="Lecture4 - ROS 2 Node C&#43;&#43; Programming" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture4/">
        Lecture4 - ROS 2 Node C&#43;&#43; Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture5/" title="Lecture5 - ROS 2 Topic and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture5/">
        Lecture5 - ROS 2 Topic and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture6/" title="Lecture6 - ROS 2 Service and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture6/">
        Lecture6 - ROS 2 Service and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture7/" title="Lecture7 - Useful ROS 2 Example, Navigation2" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture7/">
        Lecture7 - Useful ROS 2 Example, Navigation2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture8/" title="Lecture8 - ROS 2 Action and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture8/">
        Lecture8 - ROS 2 Action and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture9/" title="Lecture9 - C&#43;&#43; Programming Again, Outro" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture9/">
        Lecture9 - C&#43;&#43; Programming Again, Outro
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros2_foxy/" title="ROS 2 Basics" class="dd-item
        parent
        
        
        ">
      <a href="/kr/ros2_foxy/">
          <b>[New]ROS 2 Foxy. </b>ROS 2 Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture1/" title="Lecture1. What is ROS?" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture1/">
        Lecture1. What is ROS?
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture2/" title="Lecture2. Dev Env Setup" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture2/">
        Lecture2. Dev Env Setup
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture3/" title="Lecture3. Core of ROS" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture3/">
        Lecture3. Core of ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture4/" title="Lecture4. ROS 2 Node and Parameter Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture4/">
        Lecture4. ROS 2 Node and Parameter Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture5/" title="Lecture5. ROS 2 Communication Mechanisms" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture5/">
        Lecture5. ROS 2 Communication Mechanisms
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture6/" title="Lecture6. ROS 2 Tools" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture6/">
        Lecture6. ROS 2 Tools
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture7/" title="Lecture7. ROS 2 Topic and Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture7/">
        Lecture7. ROS 2 Topic and Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture8/" title="Lecture8. ROS 2 Service and Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture8/">
        Lecture8. ROS 2 Service and Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture9/" title="Lecture9. ROS 2 Action Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture9/">
        Lecture9. ROS 2 Action Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture10/" title="Lecture10. TF and ROS 2" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture10/">
        Lecture10. TF and ROS 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture11/" title="Lecture11. About Gazebo - 1" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture11/">
        Lecture11. About Gazebo - 1
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture12/" title="Lecture12. About Gazebo - 2" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture12/">
        Lecture12. About Gazebo - 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture13/" title="Lecture13. Useful ROS 2 Examples (Sensor Part)" class="dd-item active">
        <a href="/kr/ros2_foxy/lecture13/">
        Lecture13. Useful ROS 2 Examples (Sensor Part)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture14/" title="Lecture14. Useful ROS 2 Examples (Control Part)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture14/">
        Lecture14. Useful ROS 2 Examples (Control Part)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture15/" title="Lecture15. Advanced ROS 2, Package Management" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture15/">
        Lecture15. Advanced ROS 2, Package Management
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture16/" title="Lecture16. Useful ROS 2 Examples (Misc)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture16/">
        Lecture16. Useful ROS 2 Examples (Misc)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture17/" title="Lecture17. Real Hardware Examples" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture17/">
        Lecture17. Real Hardware Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture18/" title="Lecture18. Point Cloud Deep Learning Example (PointNet)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture18/">
        Lecture18. Point Cloud Deep Learning Example (PointNet)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture19/" title="Lecture19. NVIDIA Isaac Sim" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture19/">
        Lecture19. NVIDIA Isaac Sim
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture20/" title="Lecture20. NVIDIA Jetson Platform" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture20/">
        Lecture20. NVIDIA Jetson Platform
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/advanced_contents_ros2/" title="ROS 2" class="dd-item
        
        
        
        ">
      <a href="/kr/advanced_contents_ros2/">
          <b>Advanced Contents. </b>ROS 2
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture1/" title="Lecture1 - About DDS" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture1/">
        Lecture1 - About DDS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture2/" title="Lecture11 - About DDS (2)" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture2/">
        Lecture11 - About DDS (2)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture3/" title="Lecture12 - SROS2" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture3/">
        Lecture12 - SROS2
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros_and_gazebo/" title="Gazebo and ROS" class="dd-item
        
        
        
        ">
      <a href="/kr/ros_and_gazebo/">
          <b>Gazebo. </b>Gazebo and ROS
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_and_gazebo/lecture1/" title="Lecture1 - Gazebo and Robot" class="dd-item ">
        <a href="/kr/ros_and_gazebo/lecture1/">
        Lecture1 - Gazebo and Robot
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_and_gazebo/lecture2/" title="Lecture2 - Gazebo and Robot(2)" class="dd-item ">
        <a href="/kr/ros_and_gazebo/lecture2/">
        Lecture2 - Gazebo and Robot(2)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/RB2023ROS/du2023-ros1"><i class='fab fa-fw fa-github'></i> GitHub repo - ROS 1</a>
              </li>
          
              <li>
                  <a class="padding" href="https://github.com/RB2023ROS/du2023-ros2"><i class='fab fa-fw fa-github'></i> GitHub repo - ROS 2</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="kr" value="/kr/ros2_foxy/lecture13/" selected>Korean</option>
                    
                  
              
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      

      
      </ul>
    </section>
    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='' href="https://github.com/com2018-fa22/hugo-blog/tree/main/content/ros2_foxy/lecture13.kr.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text"></span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                   Lecture13. Useful ROS 2 Examples (Sensor Part)
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#useful-ros-2-examples-sensor-part">Useful ROS 2 Examples (Sensor Part)</a>
      <ul>
        <li><a href="#cv2-and-ros-2">CV2 and ROS 2</a></li>
        <li><a href="#cv2-and-rclpy">cv2 and rclpy</a></li>
        <li><a href="#ì½”ë“œ-ë¶„ì„">ì½”ë“œ ë¶„ì„</a></li>
        <li><a href="#image-subscribe---python">Image Subscribe - Python</a></li>
        <li><a href="#rosbag2-to-seperate-image">rosbag2 to seperate image</a></li>
      </ul>
    </li>
    <li><a href="#cv2-and-rclcpp">CV2 and rclcpp</a>
      <ul>
        <li><a href="#image-publish---python-1">Image Publish - Python</a></li>
        <li><a href="#image-subscribe---python-1">Image Subscribe - Python</a></li>
      </ul>
    </li>
    <li><a href="#pcl-and-ros-2">PCL and ROS 2</a>
      <ul>
        <li><a href="#about-point-cloud">About Point Cloud</a></li>
        <li><a href="#pcd-format">PCD Format</a></li>
        <li><a href="#pcl-ì„¤ì¹˜">PCL ì„¤ì¹˜</a></li>
        <li><a href="#pcl-python">PCL python</a></li>
        <li><a href="#voxel-grid-sampling">Voxel Grid Sampling</a></li>
        <li><a href="#pass-through-filter">Pass Through Filter</a></li>
        <li><a href="#ransac-plane-fitting">RANSAC Plane Fitting</a></li>
        <li><a href="#statistical-outlier-removal-filter">Statistical Outlier Removal Filter</a></li>
        <li><a href="#kd-tree-search">KD-Tree Search</a></li>
        <li><a href="#euclidean-clustering-dbscan">Euclidean Clustering (DBSCAN)</a></li>
      </ul>
    </li>
    <li><a href="#pcl-python-ros-2-ì—°ë™">PCL python ROS 2 ì—°ë™</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Lecture13. Useful ROS 2 Examples (Sensor Part)
            </h1>
          

        


<h2 id="useful-ros-2-examples-sensor-part">Useful ROS 2 Examples (Sensor Part)</h2>
<blockquote>
<p>Topic, Service, Action, Gazebo ì˜ˆì‹œë“¤ì„ ì§„í–‰í•˜ë©´ì„œ ë‹¤ì–‘í•œ ì„¼ì„œ ë°ì´í„°ë“¤ì„ ë‹¤ë£¨ì–´ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ë²ˆ ì‹œê°„ì—ëŠ” ì˜ˆì‹œë“¤ê³¼ í•¨ê»˜ í•´ë‹¹ ì„¼ì„œ ë°ì´í„°ë“¤ì˜ ROS 2 ì—°ë™ í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
</blockquote>
<h3 id="cv2-and-ros-2">CV2 and ROS 2</h3>
<p><img src="/kr/ros2_foxy/images13/Untitled.png?height=300px" alt="Untitled.png"></p>
<p>ë‹¤ì–‘í•œ ì»´í“¨í„° ë¹„ì „ ì•Œê³ ë¦¬ì¦˜ì„ ë‹´ê³  ìˆëŠ” ì˜¤í”ˆì†ŒìŠ¤ ë¹„ì „ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ OpenCVë¥¼ ROS 2ì™€ ì—°ë™í•˜ì—¬ ì‚¬ìš©í•´ ë´…ì‹œë‹¤.</p>
<h3 id="cv2-and-rclpy">cv2 and rclpy</h3>
<blockquote>
<p>ì²«ë²ˆì§¸ ì‹œê°„ìœ¼ë¡œ ROS 2ì˜ ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ OpenCV Python, cv2ì™€ ì—°ë™í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.</p>
</blockquote>
<h4 id="image-publish---python">Image Publish - Python</h4>
<ul>
<li>ìš°ì„ , í•­ìƒ ê·¸ë ‡ë“¯ì´ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤.</li>
</ul>
<ol>
<li>ì˜¨ë¼ì¸ìƒì—ì„œ ì•„ë¬´ ì˜ìƒ í•˜ë‚˜ë¥¼ ë‹¤ìš´ë°›ì•„ ìœ„ì¹˜ë¥¼ ê¸°ì–µí•´ì£¼ì„¸ìš”.</li>
<li>img_pub.py ì½”ë“œì˜ VIDEO_FILE_ROOT ë³€ìˆ˜ë¥¼ í•´ë‹¹ ìœ„ì¹˜ë¡œ ë³€ê²½í•´ì¤ë‹ˆë‹¤.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Import the necessary libraries</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> rclpy <span style="color:#75715e"># Python Client Library for ROS 2</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rclpy.node <span style="color:#f92672">import</span> Node <span style="color:#75715e"># Handles the creation of nodes</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sensor_msgs.msg <span style="color:#f92672">import</span> Image <span style="color:#75715e"># Image is the message type</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> cv_bridge <span style="color:#f92672">import</span> CvBridge <span style="color:#75715e"># Package to convert between ROS and OpenCV Images</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> cv2 <span style="color:#75715e"># OpenCV library</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>VIDEO_FILE_ROOT <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/home/kimsooyoung/ros2_ws/rosbag2/img_pub_test.mp4&#34;</span>
</span></span></code></pre></div><ul>
<li>íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œí•œ ë’¤, ì˜ˆì‹œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1 - pkg build and run</span>
</span></span><span style="display:flex;"><span>cbp py_cv_tutorial <span style="color:#f92672">&amp;&amp;</span> source install<span style="color:#f92672">/</span>local_setup<span style="color:#f92672">.</span>bash
</span></span><span style="display:flex;"><span>ros2 run py_cv_tutorial img_pub
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2 - rqt_image_view</span>
</span></span><span style="display:flex;"><span>ros2 run rqt_image_view rqt_image_view
</span></span></code></pre></div><p>â‡’ rqt image viewëŠ” ì´ë¯¸ì§€ topicë§Œì„ ìœ„í•œ rqt toolë¡œ ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ì‹œê°í™”í•´ì¤ë‹ˆë‹¤.</p>
<p><img src="/kr/ros2_foxy/images13/Untitled1.png?height=400px" alt="Untitled1.png"></p>
<h3 id="ì½”ë“œ-ë¶„ì„">ì½”ë“œ ë¶„ì„</h3>
<ul>
<li>OpenCVì—ì„œëŠ” ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ë‹¤ë£° ë•Œ cv::Matë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë°˜ë©´ ROS 2ëŠ” sensor_msgs/msg/Imageë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë”°ë¼ì„œ Image &lt;=&gt; Mat ë³€í™˜ì„ ìœ„í•´ <strong>CV Bridge</strong>ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> cv_bridge <span style="color:#f92672">import</span> CvBridge <span style="color:#75715e"># Package to convert between ROS and OpenCV Images</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> cv2 <span style="color:#75715e"># OpenCV library</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ImagePublisher</span>(Node):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Create an ImagePublisher class, which is a subclass of the Node class.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Used to convert between ROS and OpenCV images</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>br <span style="color:#f92672">=</span> CvBridge()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">timer_callback</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ret <span style="color:#f92672">==</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Publish the image.</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># The &#39;cv2_to_imgmsg&#39; method converts an OpenCV</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># image to a ROS 2 image message</span>
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>publisher_<span style="color:#f92672">.</span>publish(self<span style="color:#f92672">.</span>br<span style="color:#f92672">.</span>cv2_to_imgmsg(frame, encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;bgr8&#34;</span>))
</span></span></code></pre></div><p>â‡’ CvBridge ê°ì²´ì˜ imgmsg_to_cv2ë¥¼ ì‚¬ìš©í•˜ë©´ ì†ì‰½ê²Œ Image dataë¡œ ë³€í™˜ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
<h3 id="image-subscribe---python">Image Subscribe - Python</h3>
<blockquote>
<p>ì¼ì „ í•™ìŠµí•˜ì˜€ë˜ rosbag2ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë³´ê³ ì í•©ë‹ˆë‹¤. ì œê°€ ë¯¸ë¦¬ ì¤€ë¹„í•œ ë°ì´í„°ì…‹ì„ ì œê³µë“œë¦¬ë‹ˆ, ê¸°ì–µí•˜ê¸° ì‰¬ìš´ ìœ„ì¹˜ì— ë‹¤ìš´ë°›ì•„ ì£¼ì„¸ìš”.</p>
</blockquote>
<p>ğŸ“ <a href="https://drive.google.com/file/d/1HYLQHlbKDzDz6f5WP7esofm-k3X-2b7B/view?usp=sharing">quadrupped_train.zip</a></p>

<div class="notices note" ><p>Windows + WSL2 ìœ ì €ì˜ ê²½ìš° <code>explorer.exe</code> ëª…ë ¹ì–´ë¥¼ í†µí•´ íŒŒì¼ íƒìƒ‰ê¸°ë¥¼ ì—´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</div>

<ul>
<li>íŒŒì¼ì„ ì ë‹¹í•œ ìœ„ì¹˜ì— ì €ì¥í•˜ê³  replay í•´ë´…ì‹œë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ì˜ˆì œ ì‹¤í–‰ ì¤€ë¹„</span>
</span></span><span style="display:flex;"><span>colcon build --packages-select py_cv_tutorial
</span></span><span style="display:flex;"><span>source install/local_setup.bash
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1 â€“ ë°ì´í„° ìœ„ì¹˜ë¡œ ì´ë™í•˜ì—¬ ros2 bag ì‹¤í–‰</span>
</span></span><span style="display:flex;"><span>cd &lt;ë°ì´í„°ë¥¼ ì €ì¥í•œ ìœ„ì¹˜&gt;
</span></span><span style="display:flex;"><span>ros2 bag play quadrupped_train.bag_0.db3
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2 â€“ image_view ì‹¤í–‰</span>
</span></span><span style="display:flex;"><span>ros2 run rqt_image_view rqt_image_view
</span></span></code></pre></div>
<div class="notices note" ><p>ì‚¬ì§„ê³¼ ê°™ì´ ê¸°ì°¨ ì„ ë¡œ ëª¨ìŠµì´ ë³´ì¸ë‹¤ë©´ ì„±ê³µì…ë‹ˆë‹¤.</p>
</div>

<p><img src="/kr/ros2_foxy/images13/Untitled2.png?height=300px" alt="Untitled2.png"></p>
<p>í•´ë‹¹ ë°ì´í„°ì…‹ì€ <strong>ê¸°ì°¨ ì„ ë¡œì—ì„œ ì£¼í–‰í•˜ëŠ” 4ì¡± ë³´í–‰ ë¡œë´‡</strong>ìœ¼ë¡œë¶€í„° ì·¨ë“í•œ ê²ƒì…ë‹ˆë‹¤. ê¸°ì°¨ ì„ ë¡œëŠ” ì£¼ê¸°ì ìœ¼ë¡œ ê´€ë¦¬ê°€ í•„ìš”í•˜ë©°, ê¸¸ê³  ê¸´ ì„ ë¡œë¥¼ ë¡œë´‡ì´ ìë™ìœ¼ë¡œ ê²€ì‚¬í•´ì¤€ë‹¤ë©´ ì•„ì£¼ ìœ ìš©í•  ê²ƒì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ìƒìƒì„ í•´ë³´ë©´ì„œ ì‹¤ìŠµì— ì„í•´ë´…ì‹œë‹¤.</p>
<p><img src="/kr/ros2_foxy/images13/Untitled3.png?height=400px" alt="Untitled3.png"></p>
<ul>
<li>ë‹¤ìŒì€ ros2 bagì„ ì¬ìƒí•˜ë©´ì„œ ìƒê¸°ëŠ” Image topicì„ subscribeí•œ ë’¤, ì´ë¥¼ cv2.imshow()ë¡œ ì‹œê°í™”í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1</span>
</span></span><span style="display:flex;"><span>$ cd &lt;bag íŒŒì¼ ìœ„ì¹˜&gt;
</span></span><span style="display:flex;"><span>$ ros2 bag play quadruped_train/quadruped_train.bag_0.db3
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>1667077909.362223100<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>rosbag2_storage<span style="color:#f92672">]</span>: Opened database <span style="color:#e6db74">&#39;quadrupped_train/quadrupped_train.bag_0.db3&#39;</span> <span style="color:#66d9ef">for</span> READ_ONLY.
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2</span>
</span></span><span style="display:flex;"><span>$ ros2 run py_cv_tutorial img_sub
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>1667077909.613586300<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>image_subscriber<span style="color:#f92672">]</span>: Receiving video frame
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>1667077910.934147000<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>image_subscriber<span style="color:#f92672">]</span>: Receiving video frame
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><ul>
<li>ì´ë²ˆì—ëŠ” ROS2 msgë¥¼ cvë°ì´í„° í¬ë©§ìœ¼ë¡œ ë³€í™˜í•´ì•¼ í•˜ì§€ìš”? cv_bridgeë¥¼ í†µí•´ imgmsg_to_cv2 í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ì—¬ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> cv_bridge <span style="color:#f92672">import</span> CvBridge <span style="color:#75715e"># Package to convert between ROS and OpenCV Images</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> cv2 <span style="color:#75715e"># OpenCV library</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ImageSubscriber</span>(Node):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Used to convert between ROS and OpenCV images</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>br <span style="color:#f92672">=</span> CvBridge()
</span></span><span style="display:flex;"><span>				<span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">listener_callback</span>(self, data):
</span></span><span style="display:flex;"><span>				<span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Convert ROS Image message to OpenCV image</span>
</span></span><span style="display:flex;"><span>        current_frame <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>br<span style="color:#f92672">.</span>imgmsg_to_cv2(data, <span style="color:#e6db74">&#34;bgr8&#34;</span>)
</span></span><span style="display:flex;"><span>        edge_frame <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>hough_transform(current_frame)
</span></span></code></pre></div><ul>
<li>imgmsg_to_cv2ë¥¼ í†µí•´ CV::Matìœ¼ë¡œ ë³€í™˜ëœ ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ OpenCVì˜ ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤ê³¼ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì½”ë“œì˜ imshow ë¶€ë¶„ì„ ìœ„ì™€ ê°™ì´ ì£¼ì„ í† ê¸€í•˜ì—¬ ì´ë¯¸ì§€ ì²˜ë¦¬ë¥¼ ì ìš©í•´ ë´…ì‹œë‹¤. ì˜ˆì‹œë¥¼ ìœ„í•´ ì§ì„ ê²€ì¶œ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.</li>
</ul>
<p><img src="/kr/ros2_foxy/images13/Untitled4.png?height=300px" alt="Untitled4.png"></p>
<blockquote>
<p>ì§ì„  ê²€ì¶œì„ ìœ„í•´ ì‚¬ìš©ëœ OpenCV ê¸°ëŠ¥ë“¤ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. ë¡œì§ì„ ì—…ê·¸ë ˆì´ë“œí•˜ì—¬ ì—¬ëŸ¬ë¶„ë§Œì˜ ë¡œì§ì„ ë§Œë“¤ì–´ ë³´ì„¸ìš”!</p>
</blockquote>
<ul>
<li><a href="https://opencv-python.readthedocs.io/en/latest/doc/11.imageSmoothing/imageSmoothing.html">cv2.GaussianBlur</a></li>
<li><a href="https://www.geeksforgeeks.org/draw-a-filled-polygon-using-the-opencv-function-fillpoly/">cv2.fillPoly</a> / <a href="https://opencv-python.readthedocs.io/en/latest/doc/07.imageArithmetic/imageArithmetic.html">cv2.bitwise_and</a> ROI ì„¤ì •</li>
<li><a href="https://opencv-python.readthedocs.io/en/latest/doc/25.imageHoughLineTransform/imageHoughLineTransform.html">cv2.HoughLinesP</a></li>
</ul>
<h3 id="rosbag2-to-seperate-image">rosbag2 to seperate image</h3>
<blockquote>
<p>ì»´í“¨í„° ë¹„ì „ë§Œìœ¼ë¡œ ì™„ë²½í•œ ì„ ë¡œ ì¸ì‹ì„ êµ¬í˜„í•˜ê¸°ëŠ” ë„ˆë¬´ë‚˜ í˜ë“­ë‹ˆë‹¤. ë”¥ëŸ¬ë‹ì„ ì‚¬ìš©í•´ì„œ ì´ë¥¼ ê·¹ë³µí•  ìˆ˜ ìˆì„ ê²ƒì´ë©°, ë°ì´í„°ì…‹ì˜ ì œì‘ì„ ìœ„í•´ rosbag2 ë°ì´í„°ì—ì„œ ì´ë¯¸ì§€ë¥¼ ì¶”ì¶œí•˜ëŠ” ì˜ˆì‹œë¥¼ ì¤€ë¹„í•˜ì˜€ìŠµë‹ˆë‹¤.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ros2 run py_cv_tutorial rosbag2_to_timedimg
</span></span><span style="display:flex;"><span>/home/kimsooyoung/ros2_ws/rosbag2/quadrupped_train/quadrupped_train.bag_0.db3
</span></span><span style="display:flex;"><span>saved: color_1666796292992515592.png
</span></span><span style="display:flex;"><span>saved: color_1666796293035428479.png
</span></span><span style="display:flex;"><span>saved: color_1666796293079139778.png
</span></span><span style="display:flex;"><span>saved: color_1666796293120768031.png
</span></span><span style="display:flex;"><span>saved: color_1666796293161406687.png
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><ul>
<li>ì˜ˆì œ ì‹¤í–‰ ì „ main í•¨ìˆ˜ì—ì„œ bag íŒŒì¼ì˜ ìœ„ì¹˜ë¥¼ ì—¬ëŸ¬ë¶„ì˜ ê²ƒìœ¼ë¡œ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>(args<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Change below roots to your ros2 bag locations</span>
</span></span><span style="display:flex;"><span>    ROOT_DIR <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/home/kimsooyoung/ros2_ws/rosbag2/quadrupped_train&#34;</span>
</span></span><span style="display:flex;"><span>    FILENAME <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/quadrupped_train.bag_0.db3&#34;</span>
</span></span><span style="display:flex;"><span>    DESCRIPTION <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;color_&#34;</span>
</span></span></code></pre></div><ul>
<li>ì˜ˆì œ ì‹¤í–‰ í›„ ì‚¬ì§„ê³¼ ê°™ì´ ìƒì„±ëœ ì´ë¯¸ì§€ë“¤ì´ ë³´ì¸ë‹¤ë©´ ì„±ê³µì…ë‹ˆë‹¤. wslì„ ì‚¬ìš©ì¤‘ì´ì‹  ë¶„ë“¤ì€ ì•„ë˜ì™€ ê°™ì´ íŒŒì¼ íƒìƒ‰ê¸°ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”</li>
</ul>
<p><img src="/kr/ros2_foxy/images13/Untitled5.png?height=400px" alt="Untitled5.png"></p>
<h2 id="cv2-and-rclcpp">CV2 and rclcpp</h2>
<blockquote>
<p>íŒŒì´ì¬ì„ í†µí•´ ROS 2ì™€ OpenCVë¥¼ ì—°ë™í•˜ëŠ” ê¸°ë³¸ì ì¸ ë§¥ë½ì€ ì´í•´í•˜ì…¨ìœ¼ë¦¬ë¼ ìƒê°í•©ë‹ˆë‹¤. ë™ì¼í•œì‘ì—…ì„ C++ì—ì„œ ì‘ì—…í•˜ë©´ì„œ ëª‡ê°€ì§€ ìœ ì˜ì ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>
</blockquote>
<ul>
<li>ì½”ë”©ì„ ì‹œì‘í•˜ê¸° ì „ì—, ì œê°€ ì‚¬ìš©í•œ opencv ë²„ì „ì„ í™•ì¸í•˜ê³  ê°€ê² ìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> pkg<span style="color:#f92672">-</span>config <span style="color:#f92672">--</span>modversion opencv4
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4.2.0</span>
</span></span></code></pre></div><h3 id="image-publish---python-1">Image Publish - Python</h3>
<ul>
<li>ì´ë²ˆì— ì‚¬ìš©ë˜ëŠ” íŒŒì¼ì€ img_pub.cppì´ë©°, ì •ìƒ ì‹¤í–‰ì„ ìœ„í•´ VIDEO_FILE_ROOT ë³€ìˆ˜ë¥¼ ì—¬ëŸ¬ë¶„ì˜ ì˜ìƒ ê²½ë¡œë¡œ ìˆ˜ì •í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;rclcpp/rclcpp.hpp&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;std_msgs/msg/header.hpp&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;sensor_msgs/msg/image.hpp&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// cv_bridge converts between ROS 2 image messages and OpenCV image representations.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;cv_bridge/cv_bridge.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">// Using image_transport allows us to publish and subscribe to compressed image streams in ROS2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;image_transport/image_transport.hpp&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">// We include everything about OpenCV as we don&#39;t care much about compilation time at the moment.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;opencv2/opencv.hpp&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string VIDEO_FILE_ROOT <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/home/kimsooyoung/ros2_ws/go1_lidar.mp4&#34;</span>;
</span></span></code></pre></div><ul>
<li>ì˜ˆì‹œ ìì²´ëŠ” pythonê³¼ ë™ì¼í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1 - run demo</span>
</span></span><span style="display:flex;"><span>ros2 run cpp_cv_tutorial img_pub
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2 - rqt_image_view</span>
</span></span><span style="display:flex;"><span>ros2 run rqt_image_view rqt_image_view
</span></span></code></pre></div><ul>
<li>c++ì—ì„œëŠ” CvImage ê°ì²´ë¥¼ êµ³ì´ ìƒì„±í•´ì•¼ í•  í•„ìš” ì—†ì´ toImageMsgë¥¼ ì‚¬ìš©í•´ ë³€í™˜í•©ë‹ˆë‹¤. ëŒ€ì‹  ì‹¤ì œ msgë¡œ ì‚¬ìš©í•  ë•ŒëŠ” get() í•¨ìˆ˜ë¥¼ í†µí•œ forwardingì´ í•„ìš”í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;cv_bridge/cv_bridge.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;image_transport/image_transport.hpp&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;opencv2/opencv.hpp&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> timer_callback() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// // Create a new 640x480 image
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// cv::Mat my_image(cv::Size(640, 480), CV_8UC3);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//--- GRAB AND WRITE LOOP
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    cap.read(my_img);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (my_img.empty()){
</span></span><span style="display:flex;"><span>      std<span style="color:#f92672">::</span>cerr <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;ERROR! blank frame grabbed</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
</span></span><span style="display:flex;"><span>      rclcpp<span style="color:#f92672">::</span>shutdown();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Write message to be sent. Member function toImageMsg() converts a CvImage
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// into a ROS image message
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    img_msg <span style="color:#f92672">=</span> cv_bridge<span style="color:#f92672">::</span>CvImage(std_msgs<span style="color:#f92672">::</span>msg<span style="color:#f92672">::</span>Header(), <span style="color:#e6db74">&#34;bgr8&#34;</span>, my_img).toImageMsg();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Publish the image to the topic defined in the publisher
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    image_pub<span style="color:#f92672">-&gt;</span>publish(<span style="color:#f92672">*</span>img_msg.get());
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><h3 id="image-subscribe---python-1">Image Subscribe - Python</h3>
<ul>
<li>ì˜ˆì œ ì‹¤í–‰ì„ ìœ„í•´ gazebo worldë¥¼ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ros2 launch chess_world chess_world.launch.py
</span></span></code></pre></div><p><img src="/kr/ros2_foxy/images13/chess_world.png?height=400px" alt="chess_world.png"></p>
<ul>
<li>ì‚¬ìš©í•˜ê³  ì‹¶ì€ topic ì´ë¦„ì„ img_sub.cppì— ë°˜ì˜í•œ ë’¤ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ImageSubscriber</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> rclcpp<span style="color:#f92672">::</span>Node{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  rclcpp<span style="color:#f92672">::</span>Subscription<span style="color:#f92672">&lt;</span>Image<span style="color:#f92672">&gt;::</span>SharedPtr m_img_sub;
</span></span><span style="display:flex;"><span>  rclcpp<span style="color:#f92672">::</span>Publisher<span style="color:#f92672">&lt;</span>Image<span style="color:#f92672">&gt;::</span>SharedPtr m_img_pub;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  ImageSubscriber()<span style="color:#f92672">:</span> Node(<span style="color:#e6db74">&#34;image_subscriber&#34;</span>){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>string topic_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;video_frames&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    m_img_sub <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>create_subscription<span style="color:#f92672">&lt;</span>Image<span style="color:#f92672">&gt;</span>(
</span></span><span style="display:flex;"><span>      topic_name, <span style="color:#ae81ff">10</span>, std<span style="color:#f92672">::</span>bind(<span style="color:#f92672">&amp;</span>ImageSubscriber<span style="color:#f92672">::</span>image_cb, <span style="color:#66d9ef">this</span>, std<span style="color:#f92672">::</span>placeholders<span style="color:#f92672">::</span>_1)
</span></span><span style="display:flex;"><span>    );
</span></span></code></pre></div><ul>
<li>ì˜ˆì‹œ ì‹¤í–‰ - ì•„ë§ˆ ë‹¨ìˆœ ì´ë¯¸ì§€ í”„ë ˆì„ë§Œ ë°˜ë³µë  ê²ƒì…ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ros2 run cpp_cv_tutorial img_sub
</span></span></code></pre></div><ul>
<li>ì´ë²ˆ ì˜ˆì‹œëŠ” ì¼ì¢…ì˜ template ì²˜ëŸ¼ ì‘ì„±í•´ë³´ì•˜ìŠµë‹ˆë‹¤.</li>
</ul>
<ol>
<li>image topicì„ ë°›ì•„</li>
<li>í”„ë¡œì„¸ì‹±ì„ ê±°ì¹˜ê³ </li>
<li>ì´ ê²°ê³¼ë¥¼ í™”ë©´ì— ë³´ì—¬ì£¼ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>cv<span style="color:#f92672">::</span>Mat image_processing(<span style="color:#66d9ef">const</span> cv<span style="color:#f92672">::</span>Mat img_in){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Create output image
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  cv<span style="color:#f92672">::</span>Mat img_out;
</span></span><span style="display:flex;"><span>  cv<span style="color:#f92672">::</span>Mat img_small;
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> img_out;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">image_cb</span>(<span style="color:#66d9ef">const</span> Image<span style="color:#f92672">::</span>SharedPtr msg) <span style="color:#66d9ef">const</span>{
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Convert ROS Image to CV Image
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  cv<span style="color:#f92672">::</span>Mat frame <span style="color:#f92672">=</span> cv_bridge<span style="color:#f92672">::</span>toCvCopy(
</span></span><span style="display:flex;"><span>    msg, sensor_msgs<span style="color:#f92672">::</span>image_encodings<span style="color:#f92672">::</span>BGR8
</span></span><span style="display:flex;"><span>  )<span style="color:#f92672">-&gt;</span>image;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Image processing
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  cv<span style="color:#f92672">::</span>Mat proced_img <span style="color:#f92672">=</span> image_processing(frame);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>í˜„ ì‹œìŠ¤í…œì—ì„œ OpenCVëŠ” CMakeì˜ find_packageë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— C++ ì˜ˆì‹œë¥¼ ë¹Œë“œí•  ë•Œ CMakeLists.txtì—ì„œ <strong>ament_target_dependenciesë¥¼</strong> ëª…ì‹œí•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>find_package(OpenCV REQUIRED)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>add_executable(img_pub src<span style="color:#f92672">/</span>img_pub.cpp)
</span></span><span style="display:flex;"><span>ament_target_dependencies(img_pub rclcpp std_msgs sensor_msgs cv_bridge image_transport OpenCV)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>add_executable(img_sub src<span style="color:#f92672">/</span>img_sub.cpp)
</span></span><span style="display:flex;"><span>ament_target_dependencies(img_sub rclcpp std_msgs sensor_msgs cv_bridge image_transport OpenCV)
</span></span></code></pre></div><h2 id="pcl-and-ros-2">PCL and ROS 2</h2>
<p><img src="/kr/ros2_foxy/images13/Untitled6.png?height=200px" alt="Untitled6.png"></p>
<blockquote>
<p>ì´ë²ˆ ì‹œê°„ë¶€í„° 3D PointCloud Data ì²˜ë¦¬ë¥¼ ìœ„í•œ ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” PCL(Point Cloud Library)ì„ ì‹¤ìŠµí•˜ê³  ROS 2ì™€ ì—°ë™í•´ë³´ê³ ì í•©ë‹ˆë‹¤.</p>
</blockquote>

<div class="notices note" ><p>ì‚¬ì‹¤ ê¸°ë³¸ì ì¸ PCLì— ëŒ€í•œ ì´í•´ê°€ ìˆë‹¤ë©´ ì¼ì „ cv2 ì˜ˆì‹œì²˜ëŸ¼ ROS 2 â‡’ PCL, PCL â‡’ ROS 2ì˜ Mapping ì‘ì—…ë§Œ ì˜ ìˆ˜í–‰í•˜ë©´ ë˜ëŠ”ë°ìš”. ë”°ë¼ì„œ python, c++ì—ì„œ pclì„ ë‹¤ë£¨ëŠ” ë°©ë²•ì— ëŒ€í•´ ë¨¼ì € ìµìˆ™í•´ì§„ ë’¤ ROS 2ì—ì„œ ì´ë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.</p>
</div>

<h3 id="about-point-cloud">About Point Cloud</h3>
<ul>
<li>Point Cloud DataëŠ” ìˆ˜ë§ì€ 3ì°¨ì› ìƒì˜ ë°ì´í„°ë“¤ì´ ëª¨ì¸ ì§‘í•©ì²´ì…ë‹ˆë‹¤.</li>
</ul>
<p><img src="/kr/ros2_foxy/images13/Untitled7.png?height=300px" alt="Untitled7.png"></p>
<p>â‡’ í•˜ì§€ë§Œ x,y,zë¥¼ ë¹„ë¡¯í•´ì„œ Point Cloudì˜ ì¶”ê°€ ë°ì´í„° í•­ëª©ë“¤ì´ ìˆìŠµë‹ˆë‹¤. ìì£¼ ì‚¬ìš©ë˜ëŠ” point cloud í¬ë©§ë“¤ì„ ì‚´í´ë´…ì‹œë‹¤.</p>
<h4 id="pointxyz">PointXYZ</h4>
<p>ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ xyz ìœ„ì¹˜ ë°ì´í„°ë§Œ ë‹´ê³  ìˆìŠµë‹ˆë‹¤.</p>
<p><img src="/kr/ros2_foxy/images13/Untitled8.png?height=300px" alt="Untitled8.png"></p>
<h4 id="pointxyzi">PointXYZI</h4>
<p>intensityë¼ëŠ” í•„ë“œê°€ ì¶”ê°€ëœ í˜•íƒœë¡œ ì´ëŠ” ë¬¼ì²´ë¡œë¶€í„° ë˜ëŒì•„ì˜¨ ë¹›ì˜ ì–‘ì„ ëœ»í•©ë‹ˆë‹¤. ë°”ë‹¥ì— ê³ ì¸ ë¬¼ì´ë‚˜ íˆ¬ëª…í•œ ë¬¼ì²´ì˜ ê²½ìš° ì´ I í•„ë“œë¥¼ í†µí•´ detection ê°€ëŠ¥í•˜ì—¬ ìµœê·¼ í™œë°œíˆ ì—°êµ¬ë˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
<p><img src="/kr/ros2_foxy/images13/Untitled9.png?height=300px" alt="Untitled9.png"></p>
<h4 id="pointxyzrgb">PointXYZRGB</h4>
<p>RGB 3ìƒ‰ì´ í¬í•¨ëœ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ rgbd cameraì—ì„œ ì£¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>
<p><img src="/kr/ros2_foxy/images13/Untitled10.png?height=400px" alt="Untitled10.png"></p>
<h3 id="pcd-format">PCD Format</h3>
<p>Point CloudëŠ” ì—¬ëŸ¬ ë°ì´í„° í¬ë§·ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥í•˜ì§€ë§Œ ê°€ì¥ ìì£¼ ì‚¬ìš©ë˜ëŠ” ê²ƒì€ pcd í¬ë§·ì…ë‹ˆë‹¤. ì´ëŠ” í¬ê²Œ header/dataë¡œ êµ¬ë¶„ë˜ì–´ ìˆìœ¼ë©° ì˜ˆì‹œë¥¼ í†µí•´ í•¨ê»˜ ìµìˆ™í•´ì ¸ë³´ê² ìŠµë‹ˆë‹¤.</p>
<table>
<thead>
<tr>
<th></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header</td>
<td>ì „ì²´ í¬ì¸íŠ¸ ìˆ˜, ë°ì´í„° íƒ€ì…, í¬ê¸° ë“±ì˜ ì •ë³´</td>
</tr>
<tr>
<td>Data</td>
<td>x,y,z ë˜ëŠ” x,y,z + ì¶”ê°€ì •ë³´</td>
</tr>
</tbody>
</table>
<ul>
<li>example - xyzrgb format</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># .PCD v0.7 - Point Cloud Data file format</span>
</span></span><span style="display:flex;"><span>VERSION <span style="color:#ae81ff">0.7</span>
</span></span><span style="display:flex;"><span>FIELDS x y z rgb
</span></span><span style="display:flex;"><span>SIZE <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>TYPE F F F U
</span></span><span style="display:flex;"><span>COUNT <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>WIDTH <span style="color:#ae81ff">4421</span>
</span></span><span style="display:flex;"><span>HEIGHT <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>VIEWPOINT <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>POINTS <span style="color:#ae81ff">4421</span>
</span></span><span style="display:flex;"><span>DATA ascii
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span><span style="color:#ae81ff">0.8739934</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.342802</span> <span style="color:#ae81ff">0.73930842</span> <span style="color:#ae81ff">1577997</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span><span style="color:#ae81ff">0.86556709</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.342802</span> <span style="color:#ae81ff">0.73930842</span> <span style="color:#ae81ff">1577997</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span><span style="color:#ae81ff">0.85433203</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.3428019</span> <span style="color:#ae81ff">0.73930848</span> <span style="color:#ae81ff">1577997</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span><span style="color:#ae81ff">0.84450132</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.3428019</span> <span style="color:#ae81ff">0.73930854</span> <span style="color:#ae81ff">1577997</span>
</span></span></code></pre></div><ul>
<li>ROS 2ì—ì„œ ì‚¬ìš©í•˜ëŠ” PointCloud ë°ì´í„° í¬ë§·ì€ í¬ê²Œ ë‘ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<ol>
<li>sensor_msgs/msg/PointCloud</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>std_msgs<span style="color:#f92672">/</span>Header header
</span></span><span style="display:flex;"><span>geometry_msgs<span style="color:#f92672">/</span>Point32[] points
</span></span><span style="display:flex;"><span>ChannelFloat32[] channels
</span></span></code></pre></div><ol start="2">
<li>sensor_msgs/msg/PointCloud2</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>std_msgs<span style="color:#f92672">/</span>Header header
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>uint32 height
</span></span><span style="display:flex;"><span>uint32 width
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PointField[] fields
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>bool    is_bigendian <span style="color:#75715e"># Is this data bigendian?</span>
</span></span><span style="display:flex;"><span>uint32  point_step   <span style="color:#75715e"># Length of a point in bytes</span>
</span></span><span style="display:flex;"><span>uint32  row_step     <span style="color:#75715e"># Length of a row in bytes</span>
</span></span><span style="display:flex;"><span>uint8[] data         <span style="color:#75715e"># Actual point data, size is (row_step*height)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>bool is_dense        <span style="color:#75715e"># True if there are no invalid points</span>
</span></span></code></pre></div>
<div class="notices note" ><p>PointCloud2ê°€ ë”ìš± í’ë¶€í•œ ë°ì´í„°ë¥¼ ë‹´ê³  ìˆëŠ”ë°ìš”. ROS 2 Foxy ì´ìƒë¶€í„° PointCloud2ë¥¼ ì§€ì›í•˜ë©° ê·¸ ì´í›„ ë²„ì „ë¶€í„° PointCloudëŠ” ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
</div>

<h3 id="pcl-ì„¤ì¹˜">PCL ì„¤ì¹˜</h3>
<p>PCL c++ì€ ROS 2 ì„¤ì¹˜ ì‹œ ìë™ìœ¼ë¡œ ì„¤ì¹˜ë˜ë¯€ë¡œ ë³„ë„ ì„¤ì¹˜ëŠ” í•„ìš” ì—†ìŠµë‹ˆë‹¤. (ì˜¤íˆë ¤ ì˜ëª» ê±´ë“¤ë©´ ë³µì¡í•´ì§€ë¯€ë¡œ ê°€ë§Œíˆ ëƒ…ë‘¡ì‹œë‹¤.) PCL pythonì€ ubuntu ë²„ì „ì— ë”°ë¼ ì„¤ì¹˜ ë°©ë²•ì´ ë‹¤ë¦…ë‹ˆë‹¤.</p>
<ul>
<li>ubuntu â‰¤ 18.04</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> sudo pip install cython
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> sudo apt<span style="color:#f92672">-</span>get install pcl<span style="color:#f92672">-</span>tools
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> sudo apt install python3<span style="color:#f92672">-</span>pcl
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> sudo add<span style="color:#f92672">-</span>apt<span style="color:#f92672">-</span>repository ppa:sweptlaser<span style="color:#f92672">/</span>python3<span style="color:#f92672">-</span>pcl
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> sudo apt update
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> sudo apt install python3<span style="color:#f92672">-</span>pcl
</span></span></code></pre></div><ul>
<li>ubuntu â‰¥ 20.04</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> sudo apt install python3<span style="color:#f92672">-</span>pcl
</span></span></code></pre></div><ul>
<li>ì„¤ì¹˜ê°€ ì˜ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ë´…ì‹œë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> python3
</span></span><span style="display:flex;"><span>Python <span style="color:#ae81ff">3.8.10</span>
</span></span><span style="display:flex;"><span>[GCC <span style="color:#ae81ff">9.4.0</span>] on linux
</span></span><span style="display:flex;"><span>Type <span style="color:#e6db74">&#34;help&#34;</span>, <span style="color:#e6db74">&#34;copyright&#34;</span>, <span style="color:#e6db74">&#34;credits&#34;</span> <span style="color:#f92672">or</span> <span style="color:#e6db74">&#34;license&#34;</span> <span style="color:#66d9ef">for</span> more information<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#f92672">import</span> pcl
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span>
</span></span></code></pre></div><h3 id="pcl-python">PCL python</h3>
<blockquote>
<p>ì•„ë˜ í‘œì™€ ê°™ì´ pclì€ ë‹¤ì–‘í•œ ì•Œê³ ë¦¬ì¦˜ì„ API í˜•íƒœë¡œ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì— ìµìˆ™í•´ì§€ê¸° ìœ„í•´ python pclì„ ì‚¬ìš©í•˜ì—¬ ì‹¤ìŠµì„ í•´ë³¸ ë’¤, ì‹¤ì œ ROS 2 topicì„ ì²˜ë¦¬í•´ë³´ê³ , c++ë¡œë„ ì‚¬ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
</blockquote>
<table>
<thead>
<tr>
<th>Fuction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pcl_visualization</td>
<td>PointCloud ì‹œê°í™” ë„êµ¬</td>
</tr>
<tr>
<td>pcl_surface</td>
<td>3ì°¨ì› ê³¡ë©´ ë³µì›</td>
</tr>
<tr>
<td>pcl_segmentation</td>
<td>PointCloudì˜ Clusteringê³¼ Classification ê¸°ëŠ¥</td>
</tr>
<tr>
<td>pcl_sample_consensus</td>
<td>ì„ , í‰ë©´, ì‹¤ë¦°ë” ë“± ëª¨ë¸ ì¶”ì •ì„ ìœ„í•œ ì•Œê³ ë¦¬ì¦˜</td>
</tr>
<tr>
<td>pcl_kdtree</td>
<td>ë¹ ë¥¸ ì²˜ë¦¬, íƒìƒ‰ì„ ìœ„í•œ ìë£Œ êµ¬ì¡°</td>
</tr>
<tr>
<td>pcl_features</td>
<td>PointCloudë¡œë¶€í„° íŠ¹ì§• ì¶”ì¶œì„ ìœ„í•œ ìë£Œ êµ¬ì¡°ì™€ ë°©ë²•ë“¤</td>
</tr>
<tr>
<td>pcl_registration</td>
<td>ICPì™€ ê°™ì´ ì„œë¡œ ë‹¤ë¥¸ PointCloudë¥¼ Aligní•˜ê³  ì •í•©í•˜ê¸° ìœ„í•œ ë°©ë²•ë“¤</td>
</tr>
<tr>
<td>pcl_keypoints</td>
<td>Key point ê²€ì¶œ ì•Œê³ ë¦¬ì¦˜ (BRISK, Harris Corner, NARF, SIFT, SUSAN ë“±)</td>
</tr>
<tr>
<td>pcl_io 3D</td>
<td>ì„¼ì„œë¡œë¶€í„° PointCloud ë°ì´í„°ë¥¼ ì§ì ‘ ì½ê³  ì“°ê¸° ìœ„í•œ ì¸í„°í˜ì´ìŠ¤</td>
</tr>
</tbody>
</table>
<h4 id="pcl-io">PCL IO</h4>
<ul>
<li>pcd í¬ë©§ì˜ point cloud ë°ì´í„°ë¥¼ ì½ê³ , ì €ì¥í•˜ê³ , ì‹œê°í™”í•˜ëŠ” ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</li>
</ul>
<pre tabindex="0"><code>cd py_pcl_tutorial/exercise
python3 example1_load_and_view.py
</code></pre><ul>
<li>example1_load_and_view.py</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pcl
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pcl.pcl_visualization
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Load point cloud file</span>
</span></span><span style="display:flex;"><span>cloud <span style="color:#f92672">=</span> pcl<span style="color:#f92672">.</span>load_XYZRGB(<span style="color:#e6db74">&#39;./data/pcl_sub_node.pcd&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create pcl built-in viewer</span>
</span></span><span style="display:flex;"><span>visual <span style="color:#f92672">=</span> pcl<span style="color:#f92672">.</span>pcl_visualization<span style="color:#f92672">.</span>CloudViewing()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##### Visualize APIs #####</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># &#39;ShowColorACloud&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># &#39;ShowColorCloud&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># &#39;ShowGrayCloud&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># &#39;ShowMonochromeCloud&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># &#39;WasStopped&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;example_save.pcd&#39;</span>
</span></span><span style="display:flex;"><span>pcl<span style="color:#f92672">.</span>save(cloud, filename)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>visual<span style="color:#f92672">.</span>ShowColorCloud(cloud, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;cloud&#39;</span>)
</span></span><span style="display:flex;"><span>v <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> v:
</span></span><span style="display:flex;"><span>    v <span style="color:#f92672">=</span> <span style="color:#f92672">not</span>(visual<span style="color:#f92672">.</span>WasStopped())
</span></span></code></pre></div>
<div class="notices note" ><p>pcl_sub_node.pcdëŠ” lidar worldì—ì„œ ì œê°€ ë¯¸ë¦¬ ì¶”ì¶œí•´ ë‘” pointcloud ì…ë‹ˆë‹¤.</p>
</div>

<p><img src="/kr/ros2_foxy/images13/Untitled11.png?height=400px" alt="Untitled11.png"></p>
<table>
<thead>
<tr>
<th></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pcl.load_XYZRGB(<!-- raw HTML omitted -->)</td>
<td>pcd dataë¥¼ loadí•©ë‹ˆë‹¤. ë‹¨, ì €ì¥ëœ ìœ í˜•ì— ë”°ë¼ load_XYZ, load_XYZI ë“± ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ê°€ ë‹¤ë¦…ë‹ˆë‹¤.</td>
</tr>
<tr>
<td>pcl.pcl_visualization.CloudViewing()</td>
<td>ì‹œê°í™”ë¥¼ ìœ„í•œ ë·°ì–´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</td>
</tr>
<tr>
<td>pcl.save(<!-- raw HTML omitted -->, <!-- raw HTML omitted -->)</td>
<td>ì²˜ë¦¬í•œ cloudë¥¼ ì €ì¥í•©ë‹ˆë‹¤.</td>
</tr>
</tbody>
</table>
<h3 id="voxel-grid-sampling">Voxel Grid Sampling</h3>
<p>ìˆ˜ë§ì€ point cloudë“¤ì„ ëª¨ë‘ ê°ê° ì²˜ë¦¬í•˜ëŠ” ê²ƒì€ ë§¤ìš° ë§ì€ ì—°ì‚°ì„ ìš”í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ë³´í†µ ì´ë¥¼ 3ì°¨ì› ê²©ìì˜ Voxel í˜•íƒœë¡œ Sampling í•©ë‹ˆë‹¤. Voxelì´ë€, ë§ˆì¹˜ ê²Œì„ ê·¸ë˜í”½ì²˜ëŸ¼ í•´ìƒë„ë¥¼ ë‚®ì¶˜ íë¸Œì´ë©° Voxel ë‚´ ì  êµ° ìœ /ë¬´ì— ë”°ë¼ ì¤‘ì‹¬ì ì„ ìƒ˜í”Œë§í•©ë‹ˆë‹¤.</p>
<p><img src="/kr/ros2_foxy/images13/Untitled12.png?height=200px" alt="Untitled12.png">
<img src="/kr/ros2_foxy/images13/Untitled13.png?height=200px" alt="Untitled13.png"></p>
<ul>
<li>example2_voxelgrid.py</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Voxel Grid filter</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create a VoxelGrid filter object for our input point cloud</span>
</span></span><span style="display:flex;"><span>vox <span style="color:#f92672">=</span> cloud<span style="color:#f92672">.</span>make_voxel_grid_filter()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Choose a voxel (also known as leaf) size</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Note: this (1) is a poor choice of leaf size</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Experiment and find the appropriate size!</span>
</span></span><span style="display:flex;"><span>LEAF_SIZE <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.01</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Set the voxel (or leaf) size</span>
</span></span><span style="display:flex;"><span>vox<span style="color:#f92672">.</span>set_leaf_size(LEAF_SIZE, LEAF_SIZE, LEAF_SIZE)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Call the filter function to obtain the resultant downsampled point cloud</span>
</span></span><span style="display:flex;"><span>cloud_voxed <span style="color:#f92672">=</span> vox<span style="color:#f92672">.</span>filter()
</span></span></code></pre></div><p><img src="/kr/ros2_foxy/images13/Untitled14.png?height=400px" alt="Untitled14.png"></p>

<div class="notices note" ><p>LEAF_SIZE = 0.01</p>
</div>

<p><img src="/kr/ros2_foxy/images13/Untitled15.png?height=400px" alt="Untitled15.png"></p>

<div class="notices note" ><p>LEAF_SIZE = 0.1</p>
</div>

<h3 id="pass-through-filter">Pass Through Filter</h3>
<p>ROI(Region of Interest)ë¥¼ ì„¤ì •í•˜ê³  ì›í•˜ëŠ” ìœ„ì¹˜ì˜ point cloudë“¤ë§Œ ì¶”ë ¤ë‚´ë³´ê² ìŠµë‹ˆë‹¤. ì£¼ë¡œ ë°”ë‹¥ ì§€ì ì´ë‚˜, í…Œì´ë¸” ìœ„ ë¬¼ì²´ì—ì„œ ë¬¼ì²´ ë¶€ë¶„ë§Œ ì¶”ì¶œí•˜ëŠ” ê²½ìš° ì‚¬ìš©ë©ë‹ˆë‹¤.</p>
<p><img src="/kr/ros2_foxy/images13/Untitled16.png?height=200px" alt="Untitled16.png"></p>
<ul>
<li>example3_roi_filter.py</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Pass Through filter</span>
</span></span><span style="display:flex;"><span>passthrough <span style="color:#f92672">=</span> cloud_voxed<span style="color:#f92672">.</span>make_passthrough_filter()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Assign axis and range to the passthrough filter object.</span>
</span></span><span style="display:flex;"><span>filter_axis <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;z&#39;</span>
</span></span><span style="display:flex;"><span>passthrough<span style="color:#f92672">.</span>set_filter_field_name(filter_axis)
</span></span><span style="display:flex;"><span>axis_min <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>axis_max <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>passthrough<span style="color:#f92672">.</span>set_filter_limits(axis_min, axis_max)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cloud_filtered <span style="color:#f92672">=</span> passthrough<span style="color:#f92672">.</span>filter()
</span></span></code></pre></div><p>â‡’ í˜„ì¬ zì¶•ì„ ê¸°ì¤€ìœ¼ë¡œ -1.1 ~ 1.1 ì˜ì—­ì„ í•„í„°ë§í•˜ì˜€ìŠµë‹ˆë‹¤. x y ì¶•ì— ëŒ€í•´ì„œë„ ë™ì¼ ì‘ì—…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
<p><img src="/kr/ros2_foxy/images13/Untitled17.png?height=400px" alt="Untitled17.png"></p>
<h3 id="ransac-plane-fitting">RANSAC Plane Fitting</h3>
<p>ì§ì„ ì€ 2ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¡œ, í‰ë©´ì€ 3ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ëª¨ë¸ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. PCLì—ì„œëŠ” ì´ëŸ° ëª¨ë¸ ê¸°ë°˜ Consensusë¥¼ ì‚¬ìš©í•˜ëŠ” ê°€ì¥ ëŒ€í‘œì ì¸ ì˜ˆì‹œì¸ RANSACì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
<p><img src="/kr/ros2_foxy/images13/Untitled18.png?height=200px" alt="Untitled18.png"></p>
<ul>
<li>Model Hypothesisë¥¼ í†µí•´ ë§¤ê°œë³€ìˆ˜ë¥¼ êµ¬í–ˆë‹¤ë©´, í•´ë‹¹ ëª¨ë¸ì— í¬í•¨ë˜ëŠ” inlierì™€ outlierë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤. ì´ë•Œ inlierì˜ ì„ê³„ê°’ìœ¼ë¡œ í—ˆìš©í•˜ëŠ” ìµœëŒ€ ê±°ë¦¬ê°€ max_distanceì…ë‹ˆë‹¤.</li>
<li>seg.segment()ë¥¼ í†µí•´ ë„ì¶œí•œ inlier index ë“¤ë¡œ ê¸°ì¡´ point cloudì—ì„œ inliner/outlierë“¤ì„ ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
negative=True â‡’ outlier extraction
negative=False â‡’ inlier extraction</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># RANSAC plane segmentation</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create the segmentation object</span>
</span></span><span style="display:flex;"><span>seg <span style="color:#f92672">=</span> cloud_filtered<span style="color:#f92672">.</span>make_segmenter()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Set the model you wish to fit</span>
</span></span><span style="display:flex;"><span>seg<span style="color:#f92672">.</span>set_model_type(pcl<span style="color:#f92672">.</span>SACMODEL_PLANE)
</span></span><span style="display:flex;"><span>seg<span style="color:#f92672">.</span>set_method_type(pcl<span style="color:#f92672">.</span>SAC_RANSAC)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Max distance for a point to be considered fitting the model</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Experiment with different values for max_distance</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># for segmenting the table</span>
</span></span><span style="display:flex;"><span>max_distance <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.01</span>
</span></span><span style="display:flex;"><span>seg<span style="color:#f92672">.</span>set_distance_threshold(max_distance)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Call the segment function to obtain set of inlier indices and model coefficients</span>
</span></span><span style="display:flex;"><span>inliers, coefficients <span style="color:#f92672">=</span> seg<span style="color:#f92672">.</span>segment()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Extract inliers</span>
</span></span><span style="display:flex;"><span>extracted_inliers <span style="color:#f92672">=</span> cloud_filtered<span style="color:#f92672">.</span>extract(inliers, negative<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p><img src="/kr/ros2_foxy/images13/Untitled19.png?height=400px" alt="Untitled19.png"></p>

<div class="notices note" ><p>ëª©ì  ìì²´ëŠ” ë°”ë‹¥ì„ ì œê±°í•œë‹¤ëŠ” ì ì—ì„œ Pass Through Filterì™€ ë™ì¼í•˜ì§€ë§Œ, ì‚¬ìš©ë˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì—ì„œ ì°¨ì´ë¥¼ ê°–ìŠµë‹ˆë‹¤.</p>
</div>

<h3 id="statistical-outlier-removal-filter">Statistical Outlier Removal Filter</h3>
<blockquote>
<p>ì‹¤ì œ ì„¼ì„œë¥¼ ì‚¬ìš©í•˜ë‹¤ë³´ë©´ ì‚¬ì§„ê³¼ ê°™ì´ ë…¸ì´ì¦ˆë„ ì‹¬í•˜ê³ , ì˜ë„ì¹˜ ì•ŠëŠ” ë¹„ì •ìƒì ì¸ ì´ìƒì¹˜ê°€ ë°œìƒí•©ë‹ˆë‹¤. PCLì—ì„œëŠ” ì¼ì¢…ì˜ í‰ê·  í•„í„°ë¥¼ í†µí•´ ì´ë¥¼ ì œê±°í•˜ëŠ” í•¨ìˆ˜ë¥¼ ê°–ê³  ìˆìŠµë‹ˆë‹¤.</p>
</blockquote>
<p><img src="/kr/ros2_foxy/images13/Untitled20.png?height=200px" alt="Untitled20.png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Much like the previous filters, we start by creating a filter object:</span>
</span></span><span style="display:flex;"><span>outlier_filter <span style="color:#f92672">=</span> cloud_filtered<span style="color:#f92672">.</span>make_statistical_outlier_filter()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Set the number of neighboring points to analyze for any given point</span>
</span></span><span style="display:flex;"><span>outlier_filter<span style="color:#f92672">.</span>set_mean_k(<span style="color:#ae81ff">50</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Set threshold scale factor</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Any point with a mean distance larger than global (mean distance+x*std_dev) will be considered outlier</span>
</span></span><span style="display:flex;"><span>outlier_filter<span style="color:#f92672">.</span>set_std_dev_mul_thresh(x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Finally call the filter function for magic</span>
</span></span><span style="display:flex;"><span>cloud_filtered <span style="color:#f92672">=</span> outlier_filter<span style="color:#f92672">.</span>filter()
</span></span></code></pre></div><p>â‡’ í˜„ì¬ ìš°ë¦¬ ì˜ˆì‹œëŠ” Gazeboì—ì„œ ì¶”ì¶œí•œì§€ë¼ ì´ í•„í„°ì˜ ì˜í–¥ì´ ê±°ì˜ ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì˜ˆì œ ì½”ë“œëŠ” ìƒëµí•˜ê² ìŠµë‹ˆë‹¤.</p>
<h3 id="kd-tree-search">KD-Tree Search</h3>
<blockquote>
<p>KD-TreeëŠ” Binary Treeë¥¼ ì‘ìš©í•œ K ì°¨ì›ì˜ ìë£Œ êµ¬ì¡°ì…ë‹ˆë‹¤. x,y,z 3ì°¨ì›ì— ëŒ€í•œ KD-Treeë¥¼ êµ¬ì¶•í•˜ê³ , ì´ ì•ˆì— ëª¨ë“  pointë“¤ì„ ê°€ì§€ëŸ°íˆ ì¶”ê°€í•´ë‘ë©´, ì´í›„ ê±°ë¦¬ ê³„ì‚° ë“± ì—°ì‚° ì‹œ ë§¤ìš° ë¹ ë¥¸ íƒìƒ‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
</blockquote>
<p><img src="/kr/ros2_foxy/images13/Untitled21.png?height=200px" alt="Untitled21.png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># create kd tree for the search method of extraction</span>
</span></span><span style="display:flex;"><span>tree <span style="color:#f92672">=</span> extracted_inliers<span style="color:#f92672">.</span>make_kdtree()
</span></span></code></pre></div><p>â‡’ XYZRGB ë°ì´í„°ëŠ” make_kdtree_flann()ì´ë¼ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<h3 id="euclidean-clustering-dbscan">Euclidean Clustering (DBSCAN)</h3>
<blockquote>
<p>Point Cloudë“¤ì„ ë¶„ë¥˜í•˜ì—¬ êµ°ì§‘í™”ë¥¼ í•´ì•¼ ë¬¼ì²´ ì¸ì‹ê³¼ ì¶”ì •ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. êµ°ì§‘ê³¼ ì•Œê³ ë¦¬ì¦˜ì—ëŠ” ì—¬ëŸ¬ ì¢…ë¥˜ê°€ ìˆì§€ë§Œ ì´ë²ˆ ì‹¤ìŠµì—ì„œëŠ” ë°€ì§‘ë„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë¶„ë¥˜í•˜ëŠ” Euclidean Clusteringì„ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.</p>
</blockquote>

<div class="notices tip" ><p>ì´ ë°©ì‹ì€ í´ëŸ¬ìŠ¤í„° ìˆ˜ë¥¼ ì§€ì •í•˜ì§€ ì•Šì•„ë„ ì•Œì•„ì„œ í´ëŸ¬ìŠ¤í„° ìˆ˜ë„ ê²°ì •í•˜ê³ , ë¶ˆíŠ¹ì •í•œ í˜•ìƒì˜ í´ëŸ¬ìŠ¤í„°ë„ ë¶„ë¥˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¿ë§Œ ì•„ë‹ˆë¼ ë…¸ì´ì¦ˆì—ë„ ê°•ì¸í•œ ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤.</p>
</div>

<p><img src="/kr/ros2_foxy/images13/Untitled22.png?height=200px" alt="Untitled22.png"></p>
<ul>
<li>example5_clustering.py</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Load point cloud file</span>
</span></span><span style="display:flex;"><span>cloud <span style="color:#f92672">=</span> pcl<span style="color:#f92672">.</span>load_XYZRGB(<span style="color:#e6db74">&#39;./data/pcl_sub_node.pcd&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># eliminate color from cloud for clustering</span>
</span></span><span style="display:flex;"><span>while_cloud <span style="color:#f92672">=</span> XYZRGB_to_XYZ(cloud)
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create a cluster extraction object</span>
</span></span><span style="display:flex;"><span>ec <span style="color:#f92672">=</span> extracted_inliers<span style="color:#f92672">.</span>make_EuclideanClusterExtraction()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Set tolerances for distance threshold</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># as well as minimum and maximum cluster size (in points)</span>
</span></span><span style="display:flex;"><span>ec<span style="color:#f92672">.</span>set_ClusterTolerance(<span style="color:#ae81ff">0.07</span>)
</span></span><span style="display:flex;"><span>ec<span style="color:#f92672">.</span>set_MinClusterSize(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>ec<span style="color:#f92672">.</span>set_MaxClusterSize(<span style="color:#ae81ff">25000</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Search the k-d tree for clusters</span>
</span></span><span style="display:flex;"><span>ec<span style="color:#f92672">.</span>set_SearchMethod(tree)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Extract indices for each of the discovered clusters</span>
</span></span><span style="display:flex;"><span>cluster_indices <span style="color:#f92672">=</span> ec<span style="color:#f92672">.</span>Extract()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create Cluster-Mask Point Cloud to visualize each cluster separately</span>
</span></span><span style="display:flex;"><span>get_color_list<span style="color:#f92672">.</span>color_list <span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>cluster_color <span style="color:#f92672">=</span> get_color_list(len(cluster_indices))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Assign a color corresponding to each segmented object in scene</span>
</span></span><span style="display:flex;"><span>color_cluster_point_list <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> j, indices <span style="color:#f92672">in</span> enumerate(cluster_indices):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i, indice <span style="color:#f92672">in</span> enumerate(indices):
</span></span><span style="display:flex;"><span>        color_cluster_point_list<span style="color:#f92672">.</span>append([extracted_inliers[indice][<span style="color:#ae81ff">0</span>],
</span></span><span style="display:flex;"><span>                                        extracted_inliers[indice][<span style="color:#ae81ff">1</span>],
</span></span><span style="display:flex;"><span>                                        extracted_inliers[indice][<span style="color:#ae81ff">2</span>],
</span></span><span style="display:flex;"><span>                                        rgb_to_float(cluster_color[j])])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Create new cloud containing all clusters, each with unique color</span>
</span></span><span style="display:flex;"><span>cluster_cloud <span style="color:#f92672">=</span> pcl<span style="color:#f92672">.</span>PointCloud_PointXYZRGB()
</span></span><span style="display:flex;"><span>cluster_cloud<span style="color:#f92672">.</span>from_list(color_cluster_point_list)
</span></span></code></pre></div><ul>
<li>ì´ì „ ì˜ˆì‹œì™€ ë‹¬ë¦¬, clusteringì„ ìœ„í•´ í•„ìš”ì—†ëŠ” ìƒ‰ìƒ ë°ì´í„°ëŠ” ì œê±°í•˜ì˜€ìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Load point cloud file</span>
</span></span><span style="display:flex;"><span>cloud <span style="color:#f92672">=</span> pcl<span style="color:#f92672">.</span>load_XYZRGB(<span style="color:#e6db74">&#39;./data/pcl_sub_node.pcd&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># eliminate color from cloud for clustering</span>
</span></span><span style="display:flex;"><span>while_cloud <span style="color:#f92672">=</span> XYZRGB_to_XYZ(cloud)
</span></span></code></pre></div><ul>
<li>make_EuclideanClusterExtraction()ì„ í†µí•´ filterë¥¼ êµ¬ì„±í•˜ê³  ë§¤ê°œë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Create a cluster extraction object</span>
</span></span><span style="display:flex;"><span>ec <span style="color:#f92672">=</span> extracted_inliers<span style="color:#f92672">.</span>make_EuclideanClusterExtraction()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Set tolerances for distance threshold</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># as well as minimum and maximum cluster size (in points)</span>
</span></span><span style="display:flex;"><span>ec<span style="color:#f92672">.</span>set_ClusterTolerance(<span style="color:#ae81ff">0.07</span>)
</span></span><span style="display:flex;"><span>ec<span style="color:#f92672">.</span>set_MinClusterSize(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>ec<span style="color:#f92672">.</span>set_MaxClusterSize(<span style="color:#ae81ff">25000</span>)
</span></span></code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>set_ClusterTolerance</td>
<td>point clout ì²˜ë¦¬ ì‹œ clusterë¡œ íŒë‹¨í•˜ëŠ” ê¸°ì¤€ ê±°ë¦¬</td>
</tr>
<tr>
<td>set_MinClusterSize</td>
<td>clusterê°€ ë˜ê¸° ìœ„í•œ ìµœì†Œ point cloud ê°œìˆ˜</td>
</tr>
<tr>
<td>set_MaxClusterSize</td>
<td>clusterê°€ ë˜ê¸° ìœ„í•œ ìµœëŒ€ point cloud ê°œìˆ˜</td>
</tr>
</tbody>
</table>
<ul>
<li>clusterë¥¼ íŒë‹¨í•˜ê¸° ìœ„í•´ ê±°ë¦¬ê³„ì‚°ì´ í•„ìš”í•˜ë©°, ì´ëŠ” ì¼ì „ ìƒì„±í•œ KD treeë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ec<span style="color:#f92672">.</span>set_SearchMethod(tree)
</span></span></code></pre></div><ul>
<li>clusteringì˜ ê²°ê³¼ëŠ” point cloud setì´ ì•„ë‹ˆë¼ clusterì™€ ì´ì— í•´ë‹¹í•˜ëŠ” pointë“¤ì˜ indexì…ë‹ˆë‹¤. ë”°ë¼ì„œ extract ì´í›„ ë³„ë„ì˜ í›„ì²˜ë¦¬ ê³¼ì •ì´ í•„ìš”í•©ë‹ˆë‹¤. í˜„ì¬ëŠ” ì„œë¡œ ë‹¤ë¥¸ cluster ë§ˆë‹¤ ìƒ‰ìƒì„ ë¶€ì—¬í•˜ì—¬ ì‹œê°í™”í•˜ê³  ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Extract indices for each of the discovered clusters</span>
</span></span><span style="display:flex;"><span>cluster_indices <span style="color:#f92672">=</span> ec<span style="color:#f92672">.</span>Extract()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create Cluster-Mask Point Cloud to visualize each cluster separately</span>
</span></span><span style="display:flex;"><span>get_color_list<span style="color:#f92672">.</span>color_list <span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>cluster_color <span style="color:#f92672">=</span> get_color_list(len(cluster_indices))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Assign a color corresponding to each segmented object in scene</span>
</span></span><span style="display:flex;"><span>color_cluster_point_list <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> j, indices <span style="color:#f92672">in</span> enumerate(cluster_indices):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i, indice <span style="color:#f92672">in</span> enumerate(indices):
</span></span><span style="display:flex;"><span>        color_cluster_point_list<span style="color:#f92672">.</span>append([extracted_inliers[indice][<span style="color:#ae81ff">0</span>],
</span></span><span style="display:flex;"><span>                                        extracted_inliers[indice][<span style="color:#ae81ff">1</span>],
</span></span><span style="display:flex;"><span>                                        extracted_inliers[indice][<span style="color:#ae81ff">2</span>],
</span></span><span style="display:flex;"><span>                                        rgb_to_float(cluster_color[j])])
</span></span></code></pre></div><p><img src="/kr/ros2_foxy/images13/Untitled23.png?height=400px" alt="Untitled23.png"></p>
<h2 id="pcl-python-ros-2-ì—°ë™">PCL python ROS 2 ì—°ë™</h2>
<blockquote>
<p>ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ë‚´ìš©ë“¤ì„ ì´ë™ì›í•´ì„œ PCLë¥¼ ROS 2ì™€ ì—°ë™í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
</blockquote>
<ul>
<li>ì˜ˆì‹œ ì‹¤í–‰</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1 - gazebo world launch</span>
</span></span><span style="display:flex;"><span>ros2 launch lidar_world lidar_world<span style="color:#f92672">.</span>launch<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2 - python node run</span>
</span></span><span style="display:flex;"><span>ros2 run py_pcl_tutorial pcl_cluster_pub
</span></span><span style="display:flex;"><span>[INFO] [<span style="color:#ae81ff">1682602819.908146533</span>] [pcl_cluster_node]: PCL Cluster Node has been started
</span></span></code></pre></div><p><img src="/kr/ros2_foxy/images13/Untitled24.png?height=400px" alt="Untitled24.png"></p>

<div class="notices note" ><p>rviz2ë¥¼ í†µí•´ /cluster topicì„ subscribe í•˜ë©´, ì‚¬ì§„ê³¼ ê°™ì´ ë¬¼ì²´ë³„ë¡œ ë‹¤ë¥¸ ìƒ‰ìƒì´ ì ìš©ëœ ìƒˆë¡œìš´ pointcloud topicì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</div>

<blockquote>
<p>ì½”ë“œë¥¼ ë¶„ì„í•˜ê¸° ì „, ì „ì²´ ì‹œìŠ¤í…œì„ ìš”ì•½í•´ë³´ì•˜ìŠµë‹ˆë‹¤.</p>
</blockquote>
<ol>
<li>ROS 2ì˜ PointCloud2 msgë¥¼ PCL íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</li>
<li>PCL dataì™€ ì¼ì „ ì˜ˆì‹œ ì½”ë“œë¥¼ í†µí•´ clusteringì„ êµ¬í˜„í•©ë‹ˆë‹¤.</li>
<li>ë¶„ë¦¬í•œ clusterë“¤ì— ê°œë³„ ìƒ‰ìƒì„ ë¶€ì—¬í•˜ê³ , ë‹¤ì‹œ ROS 2 PointCloud2 íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</li>
<li>topic publish!</li>
</ol>
<ul>
<li>ROS 2 â‡’ PCL / PCL â‡’ ROS 2 ì‚¬ì´ì˜ ë³€í™˜ì€ pcl_helperë¼ëŠ” ë³„ë„ ì½”ë“œë¥¼ êµ¬í˜„í•´ ë‘ì—ˆìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">ros2_to_pcl</span>(ros_cloud):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34; Converts a ROS PointCloud2 message to a pcl PointXYZRGB
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        Args:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            ros_cloud (PointCloud2): ROS PointCloud2 message
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        Returns:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            pcl.PointCloud_PointXYZRGB: PCL XYZRGB point cloud
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">pcl_to_ros2</span>(pcl_array, now<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34; Converts a pcl PointXYZRGB to a ROS PointCloud2 message
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        Args:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            pcl_array (PointCloud_PointXYZRGB): A PCL XYZRGB point cloud
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            now (Time): A ROS 2 time object like self.get_clock().now()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        Returns:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            PointCloud2: A ROS point cloud
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span></code></pre></div>
<div class="notices note" ><p>ì£¼ì˜í•´ì•¼ í•  ì ìœ¼ë¡œ, PCL â‡’ ROS 2 ë³€í™˜ ì‹œì—ëŠ” ì‹œê°„ì— ëŒ€í•œ ë°ì´í„°ê°€ ì¶”ê°€ë˜ë‹ˆ Node ë‚´ë¶€ì˜ clockì—ì„œ now ê°ì²´ë¥¼ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤.</p>
</div>

<ul>
<li>PCLClusterNodeì˜ ìƒì„±ìì—ì„œ subscriberì™€ publisherë¥¼ í•˜ë‚˜ì”© ìƒì„±í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PCLClusterNode</span>(Node):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        super()<span style="color:#f92672">.</span>__init__(<span style="color:#e6db74">&#39;pcl_cluster_node&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>pc_subscription <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>create_subscription(
</span></span><span style="display:flex;"><span>            PointCloud2, <span style="color:#e6db74">&#39;pointcloud&#39;</span>,
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>pcl_callback, <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>cluster_publisher <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>create_publisher(
</span></span><span style="display:flex;"><span>            PointCloud2, <span style="color:#e6db74">&#39;cluster&#39;</span>, <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        )
</span></span></code></pre></div><ul>
<li>subscription callbackì—ì„œ ëŒ€ë¶€ë¶„ì˜ ë¡œì§ì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">pcl_callback</span>(self, pcl_msg):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># TODO: Convert ROS msg to PCL data</span>
</span></span><span style="display:flex;"><span>        pcl_data <span style="color:#f92672">=</span> ros2_to_pcl(pcl_msg)
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#Create new cloud containing all clusters, each with unique color</span>
</span></span><span style="display:flex;"><span>        cluster_cloud <span style="color:#f92672">=</span> pcl<span style="color:#f92672">.</span>PointCloud_PointXYZRGB()
</span></span><span style="display:flex;"><span>        cluster_cloud<span style="color:#f92672">.</span>from_list(color_cluster_point_list)
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span></code></pre></div><ul>
<li>callbackì˜ ë§ˆì§€ë§‰ì— pcl_to_ros2ë¥¼ í†µí•´ ì „ì²´ clusterë¥¼ PointCloud2 íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•œ ë’¤ publishí•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#75715e"># Convert PCL data to ROS 2 messages</span>
</span></span><span style="display:flex;"><span>    cluster_cloud_msg <span style="color:#f92672">=</span> pcl_to_ros2(cluster_cloud, now<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>get_clock()<span style="color:#f92672">.</span>now())
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>cluster_publisher<span style="color:#f92672">.</span>publish(cluster_cloud_msg)
</span></span></code></pre></div>

<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/kr/ros2_foxy/lecture12/" title="Lecture12. About Gazebo - 2"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/kr/ros2_foxy/lecture14/" title="Lecture14. Useful ROS 2 Examples (Control Part)" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1684950311"></script>
    <script src="/js/perfect-scrollbar.min.js?1684950311"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1684950311"></script>
    <script src="/js/jquery.sticky.js?1684950311"></script>
    <script src="/js/featherlight.min.js?1684950311"></script>
    <script src="/js/highlight.pack.js?1684950311"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1684950311"></script>
    <script src="/js/learn.js?1684950311"></script>
    <script src="/js/hugo-learn.js?1684950311"></script>
    
        
            <script src="https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

