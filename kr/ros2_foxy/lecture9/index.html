<!DOCTYPE html>
<html lang="kr" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.104.1" />
    <meta name="description" content="COM2018 OOP Class Lecture Note">
<meta name="author" content="Soo Young Kim">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Lecture9. ROS 2 Action Programming - Documentation for Hugo Learn Theme</title>

    
    <link href="/css/nucleus.css?1684760080" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1684760080" rel="stylesheet">
    <link href="/css/hybrid.css?1684760080" rel="stylesheet">
    <link href="/css/featherlight.min.css?1684760080" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1684760080" rel="stylesheet">
    <link href="/css/auto-complete.css?1684760080" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1684760080" rel="stylesheet">
    <link href="/css/theme.css?1684760080" rel="stylesheet">
    <link href="/css/tabs.css?1684760080" rel="stylesheet">
    <link href="/css/hugo-theme.css?1684760080" rel="stylesheet">
    
    <link href="/css/theme-green.css?1684760080" rel="stylesheet">
    
    <link href="/css/foo.css?1684760080" rel="stylesheet"><link href="/css/bar.css?1684760080" rel="stylesheet">

    <script src="/js/jquery-3.3.1.min.js?1684760080"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/kr/ros2_foxy/lecture9/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <img width="1097" alt="image" src="https://user-images.githubusercontent.com/12381733/209764275-05dcbdbf-cef7-47ad-94a6-6d61febad01e.png">
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1684760080"></script>
<script type="text/javascript" src="/js/auto-complete.js?1684760080"></script>
<script type="text/javascript">
    
        var baseurl = "\/\/kr";
    
</script>
<script type="text/javascript" src="/js/search.js?1684760080"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/kr'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/kr/ros_basic_noetic/" title="ROS Basics" class="dd-item
        
        
        
        ">
      <a href="/kr/ros_basic_noetic/">
          <b>ROS Noetic. </b>ROS Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture1/" title="Lecture1 - Introduction to ROS" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture1/">
        Lecture1 - Introduction to ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture2/" title="Lecture2 - Dev Env Setup" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture2/">
        Lecture2 - Dev Env Setup
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture3/" title="Lecture3 - Core of ROS" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture3/">
        Lecture3 - Core of ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture4/" title="Lecture4 - ROS Launch, RViz" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture4/">
        Lecture4 - ROS Launch, RViz
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture5/" title="Lecture5 - First Programming, ROS Topic" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture5/">
        Lecture5 - First Programming, ROS Topic
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture6/" title="Lecture6 - ROS Service, Parameter" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture6/">
        Lecture6 - ROS Service, Parameter
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture7/" title="Lecture7 - Rqt Tools and rosbag, ROS Time" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture7/">
        Lecture7 - Rqt Tools and rosbag, ROS Time
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture8/" title="Lecture8 - Deal with Open Source Projects, Custom Interfaces" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture8/">
        Lecture8 - Deal with Open Source Projects, Custom Interfaces
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture9/" title="Lecture9 - ROS TF and Examples" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture9/">
        Lecture9 - ROS TF and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture10/" title="Lecture10 - TF2 Examples, Outro" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture10/">
        Lecture10 - TF2 Examples, Outro
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/advanced_contents_ros1/" title="ROS" class="dd-item
        
        
        
        ">
      <a href="/kr/advanced_contents_ros1/">
          <b>Advanced Contents. </b>ROS
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture1/" title="Lecture1 - ROSCPP" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture1/">
        Lecture1 - ROSCPP
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture2/" title="Lecture2 - More About ROS System" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture2/">
        Lecture2 - More About ROS System
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture3/" title="Lecture3 - SROS" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture3/">
        Lecture3 - SROS
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros2_basic_foxy/" title="ROS 2 Basics" class="dd-item
        
        
        
        ">
      <a href="/kr/ros2_basic_foxy/">
          <b>[Old]ROS 2 Foxy. </b>ROS 2 Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture1/" title="Lecture1 - Introduction to ROS 2" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture1/">
        Lecture1 - Introduction to ROS 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture2/" title="Lecture2 - ROS 2 Node, Package" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture2/">
        Lecture2 - ROS 2 Node, Package
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture3/" title="Lecture3 - ROS 2 Node Programming, ROS 2 parameter" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture3/">
        Lecture3 - ROS 2 Node Programming, ROS 2 parameter
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture4/" title="Lecture4 - ROS 2 Node C&#43;&#43; Programming" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture4/">
        Lecture4 - ROS 2 Node C&#43;&#43; Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture5/" title="Lecture5 - ROS 2 Topic and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture5/">
        Lecture5 - ROS 2 Topic and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture6/" title="Lecture6 - ROS 2 Service and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture6/">
        Lecture6 - ROS 2 Service and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture7/" title="Lecture7 - Useful ROS 2 Example, Navigation2" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture7/">
        Lecture7 - Useful ROS 2 Example, Navigation2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture8/" title="Lecture8 - ROS 2 Action and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture8/">
        Lecture8 - ROS 2 Action and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture9/" title="Lecture9 - C&#43;&#43; Programming Again, Outro" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture9/">
        Lecture9 - C&#43;&#43; Programming Again, Outro
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros2_foxy/" title="ROS 2 Basics" class="dd-item
        parent
        
        
        ">
      <a href="/kr/ros2_foxy/">
          <b>[New]ROS 2 Foxy. </b>ROS 2 Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture1/" title="Lecture1. What is ROS?" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture1/">
        Lecture1. What is ROS?
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture2/" title="Lecture2. Dev Env Setup" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture2/">
        Lecture2. Dev Env Setup
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture3/" title="Lecture3. Core of ROS" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture3/">
        Lecture3. Core of ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture4/" title="Lecture4. ROS 2 Node and Parameter Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture4/">
        Lecture4. ROS 2 Node and Parameter Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture5/" title="Lecture5. ROS 2 Communication Mechanisms" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture5/">
        Lecture5. ROS 2 Communication Mechanisms
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture6/" title="Lecture6. ROS 2 Tools" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture6/">
        Lecture6. ROS 2 Tools
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture7/" title="Lecture7. ROS 2 Topic and Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture7/">
        Lecture7. ROS 2 Topic and Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture8/" title="Lecture8. ROS 2 Service and Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture8/">
        Lecture8. ROS 2 Service and Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture9/" title="Lecture9. ROS 2 Action Programming" class="dd-item active">
        <a href="/kr/ros2_foxy/lecture9/">
        Lecture9. ROS 2 Action Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture10/" title="Lecture10. TF and ROS 2" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture10/">
        Lecture10. TF and ROS 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture11/" title="Lecture11. About Gazebo - 1" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture11/">
        Lecture11. About Gazebo - 1
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture12/" title="Lecture12. About Gazebo - 2" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture12/">
        Lecture12. About Gazebo - 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture13/" title="Lecture13. Useful ROS 2 Examples (Sensor Part)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture13/">
        Lecture13. Useful ROS 2 Examples (Sensor Part)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture14/" title="Lecture14. Useful ROS 2 Examples (Control Part)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture14/">
        Lecture14. Useful ROS 2 Examples (Control Part)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture15/" title="Lecture15. Advanced ROS 2, Package Management" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture15/">
        Lecture15. Advanced ROS 2, Package Management
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture16/" title="Lecture16. Useful ROS 2 Examples (Misc)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture16/">
        Lecture16. Useful ROS 2 Examples (Misc)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture17/" title="Lecture17. Real Hardware Examples" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture17/">
        Lecture17. Real Hardware Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture18/" title="Lecture18. Point Cloud Deep Learning Example (PointNet)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture18/">
        Lecture18. Point Cloud Deep Learning Example (PointNet)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture19/" title="Lecture19. NVIDIA Isaac Sim" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture19/">
        Lecture19. NVIDIA Isaac Sim
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture20/" title="Lecture20. NVIDIA Jetson Platform" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture20/">
        Lecture20. NVIDIA Jetson Platform
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/advanced_contents_ros2/" title="ROS 2" class="dd-item
        
        
        
        ">
      <a href="/kr/advanced_contents_ros2/">
          <b>Advanced Contents. </b>ROS 2
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture1/" title="Lecture1 - About DDS" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture1/">
        Lecture1 - About DDS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture2/" title="Lecture11 - About DDS (2)" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture2/">
        Lecture11 - About DDS (2)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture3/" title="Lecture12 - SROS2" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture3/">
        Lecture12 - SROS2
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros_and_gazebo/" title="Gazebo and ROS" class="dd-item
        
        
        
        ">
      <a href="/kr/ros_and_gazebo/">
          <b>Gazebo. </b>Gazebo and ROS
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_and_gazebo/lecture1/" title="Lecture1 - Gazebo and Robot" class="dd-item ">
        <a href="/kr/ros_and_gazebo/lecture1/">
        Lecture1 - Gazebo and Robot
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_and_gazebo/lecture2/" title="Lecture2 - Gazebo and Robot(2)" class="dd-item ">
        <a href="/kr/ros_and_gazebo/lecture2/">
        Lecture2 - Gazebo and Robot(2)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/RB2023ROS/du2023-ros1"><i class='fab fa-fw fa-github'></i> GitHub repo - ROS 1</a>
              </li>
          
              <li>
                  <a class="padding" href="https://github.com/RB2023ROS/du2023-ros2"><i class='fab fa-fw fa-github'></i> GitHub repo - ROS 2</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="kr" value="/kr/ros2_foxy/lecture9/" selected>Korean</option>
                    
                  
              
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      

      
      </ul>
    </section>
    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='' href="https://github.com/com2018-fa22/hugo-blog/tree/main/content/ros2_foxy/lecture9.kr.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text"></span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                   Lecture9. ROS 2 Action Programming
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#ros-2-action-programming">ROS 2 Action Programming</a>
      <ul>
        <li><a href="#ros-2-action-programming---python">ROS 2 Action Programming - python</a></li>
        <li><a href="#ì½”ë“œ-ë¶„ì„">ì½”ë“œ ë¶„ì„</a></li>
        <li><a href="#example-2---action-client-parking-master">example 2 - Action Client (Parking Master)</a></li>
        <li><a href="#ì½”ë“œ-ë¶„ì„-1">ì½”ë“œ ë¶„ì„</a></li>
        <li><a href="#example-3---action-server-dataset-generation">example 3 - Action Server (Dataset Generation)</a></li>
        <li><a href="#ì´-nodeë¥¼-ê°œë°œí•´ë³´ëŠ”-ê²ƒì´-ì´ë²ˆ-ì‹œê°„ì˜-ê³¼ì œì…ë‹ˆë‹¤">ğŸ’ªÂ ì´ Nodeë¥¼ ê°œë°œí•´ë³´ëŠ” ê²ƒì´ ì´ë²ˆ ì‹œê°„ì˜ ê³¼ì œì…ë‹ˆë‹¤.</a></li>
      </ul>
    </li>
    <li><a href="#ros-2-action-programming---c">ROS 2 Action Programming - C++</a>
      <ul>
        <li><a href="#example-1---action-server-parking-master-1">example 1 - Action Server (Parking Master)</a></li>
        <li><a href="#ì½”ë“œ-ë¶„ì„-2">ì½”ë“œ ë¶„ì„</a></li>
        <li><a href="#example-2---action-client-parking-master-1">example 2 - Action Client (Parking Master)</a></li>
        <li><a href="#ì½”ë“œ-ë¶„ì„-3">ì½”ë“œ ë¶„ì„</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Lecture9. ROS 2 Action Programming
            </h1>
          

        


<h2 id="ros-2-action-programming">ROS 2 Action Programming</h2>
<blockquote>
<p>ê°•ì˜ë¥¼ ì—´ì‹¬íˆ ë”°ë¼ì˜¤ë©´ì„œ ê°œë…ì„ ìŠì–´ë²„ë ¸ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ Actionì— ëŒ€í•´ì„œ ê°„ë‹¨íˆ ê°œë… ë³µìŠµì„ í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
</blockquote>
<p><img src="/kr/ros2_foxy/images9/action.gif?height=300px" alt="action.gif"></p>
<ul>
<li>image from : <a href="https://docs.ros.org/en/foxy/Tutorials/Understanding-ROS2-Actions.html">https://docs.ros.org/en/foxy/Tutorials/Understanding-ROS2-Actions.html</a></li>
</ul>
<p>ì‚¬ì§„ê³¼ ê°™ì´ Action Clientì™€ Serverê°€ ì£¼ê³ ë°›ëŠ” ë‚´ìš©ì€ í¬ê²Œ 5ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.</p>
<ol>
<li>Client â‡’ Server, Goal Request (service requestì™€ ìœ ì‚¬í•©ë‹ˆë‹¤.)</li>
<li>server â‡’ client, Goal Response</li>
<li>client â‡’ server, Result Request</li>
<li>server â‡’ client, Feedback (topicê³¼ ìœ ì‚¬í•©ë‹ˆë‹¤.)</li>
<li>server â‡’ client, Result Response</li>
</ol>

<div class="notices tip" ><p>ë§Œì•½ 4ë²ˆ ë„ì¤‘ cancelì´ ë°œìƒí•˜ë©´ Actionì€ ì¢…ë£Œë©ë‹ˆë‹¤.</p>
</div>

<blockquote>
<p>ì´ë ‡ê²Œ Actionì€ Topic, Serviceì˜ íŠ¹ì§•ì„ ëª¨ë‘ ê°–ê³  ìˆìœ¼ë©° Cancelì´ë¼ëŠ” ì¶”ê°€ ê¸°ëŠ¥ê¹Œì§€ ê°–ì¶”ê³  ìˆëŠ” ë³µì¡í•œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì´ì—ˆìŠµë‹ˆë‹¤. ì´ë²ˆ ì˜ˆì‹œì—ì„œëŠ” ActionServerì™€ ActionClient, ê·¸ë¦¬ê³  ê³¼ì œë¡œ ë³„ë„ ActionServerê¹Œì§€ ì œì‹œí•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
</blockquote>
<h3 id="ros-2-action-programming---python">ROS 2 Action Programming - python</h3>
<h4 id="example-1---action-server-parking-master">example 1 - Action Server (Parking Master)</h4>
<p><img src="/kr/ros2_foxy/images9/Untitled.png?height=400px" alt="Untitled.png"></p>
<p>image from : <a href="https://www.kihoilbo.co.kr/news/articleView.html?idxno=1006073">ê¸°í˜¸ì¼ë³´</a></p>
<blockquote>
<p>Actionì„ ì‚¬ìš©í•˜ëŠ” ì¬ë¯¸ìˆëŠ” ì˜ˆì‹œë¥¼ ì¤€ë¹„í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1</span>
</span></span><span style="display:flex;"><span>ros2 launch src_gazebo wall_world<span style="color:#f92672">.</span>launch<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2</span>
</span></span><span style="display:flex;"><span>cbp py_action_tutorial <span style="color:#f92672">&amp;&amp;</span> source install<span style="color:#f92672">/</span>local_setup<span style="color:#f92672">.</span>bash
</span></span><span style="display:flex;"><span>ros2 run py_action_tutorial parking_action_server
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 3</span>
</span></span><span style="display:flex;"><span>ros2 action send_goal <span style="color:#f92672">/</span>src_parking custom_interfaces<span style="color:#f92672">/</span>action<span style="color:#f92672">/</span>Parking <span style="color:#e6db74">&#34;start_flag: true&#34;</span> <span style="color:#f92672">--</span>feedback
</span></span></code></pre></div>
<div class="notices note" ><p>í˜„ì¬ custom interfaceë¥¼ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë¯€ë¡œ workspaceë¥¼ sourcing í•´ì•¼ í•©ë‹ˆë‹¤!</p>
</div>

<ul>
<li>ì˜ˆì‹œ ì‹¤í–‰ ì‹œ ë²½ì— ì¸ì ‘í•˜ì—¬ í°ìƒ‰ ìƒìë“¤ì´ ì£¼ì°¨ ê³µê°„ì„ ë°°ì •í•´ì¤„ ê²ƒì…ë‹ˆë‹¤</li>
</ul>
<p>â‡’ rqt_robot_steeringìœ¼ë¡œ ë¡œë´‡ì„ ì˜ ì œì–´í•˜ì—¬ ì£¼ì–´ì§„ ì£¼ì°¨ ê³µê°„ì— ì•Œë§ê²Œ ì£¼ì°¨ë¥¼ í•´ë³´ì„¸ìš”!</p>
<p><img src="/kr/ros2_foxy/images9/Untitled1.png?height=400px" alt="Untitled1.png"></p>
<ul>
<li>í„°ë¯¸ë„ ìƒì˜ Feedbackì„ í†µí•´ ë²½ê³¼ì˜ ê±°ë¦¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, ì´ ê±°ë¦¬ê°€ <strong>0.5m ì´ë‚´</strong>ê°€ ë˜ë©´ ì£¼ì°¨ê°€ ì™„ë£Œë©ë‹ˆë‹¤. ì™„ë£Œ ì‹œ ì¢Œìš° ê³µê°„ì´ ì–¼ë§ˆê°€ ê· í˜•ì´ ë§ëŠ”ì§€ì— ë”°ë¼ ë‹¤ë¥¸ Resultë¥¼ ì–»ê²Œ ë©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Feedback:
</span></span><span style="display:flex;"><span>    distance: <span style="color:#ae81ff">0.7399989366531372</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Feedback:
</span></span><span style="display:flex;"><span>    distance: <span style="color:#ae81ff">0.630066454410553</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Result:
</span></span><span style="display:flex;"><span>    message: <span style="color:#960050;background-color:#1e0010">&#39;</span>[Success<span style="color:#f92672">!</span>] Oh... Teach me how you did :<span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span></code></pre></div><p><img src="/kr/ros2_foxy/images9/src_parking.gif?height=300px" alt="src_parking.gif"></p>
<p>í”„ë¡œê·¸ë˜ë°ì„ ì‹œì‘í•˜ê¸° ì „, í•„ìš”í•œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ë“¤ì„ ì‚´í´ë´…ì‹œë‹¤.</p>
<ol>
<li>
<p>Action Server : Goalì„ ë°›ìœ¼ë©´, ì •ë©´ ë²½ê³¼ì˜ ê±°ë¦¬ë¥¼ feedbackìœ¼ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤. ìµœì¢… ResultëŠ” Stringìœ¼ë¡œ ì„±ê³µ ì—¬ë¶€ë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤.</p>
</li>
<li>
<p>LaserScan Sub : ì£¼ë³€ ë¬¼ì²´ì™€ì˜ ìŠ¤ìº”ëœ ê±°ë¦¬ë¥¼ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>â‡’ Feedback Callbackê³¼ Subscription Callback ë‘ Callback í•¨ìˆ˜ë„ êµ¬í˜„í•´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤.</p>
</li>
</ol>
<ul>
<li>ì´ë²ˆ ì˜ˆì‹œë¥¼ ìœ„í•´ custom interfaceë¥¼ ë§Œë“¤ì–´ ë³´ì•˜ìŠµë‹ˆë‹¤. (custom interfaceë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ë³µìŠµì„ í•´ë³¼ ì¢‹ì€ ê¸°íšŒì…ë‹ˆë‹¤. â‡’ 7ê°•. ROS 2 Topic and Programming)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>$ ros2 interface show custom_interfaces/action/Parking
</span></span><span style="display:flex;"><span>#goal definition
</span></span><span style="display:flex;"><span>bool start_flag
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>#result definition
</span></span><span style="display:flex;"><span>string message
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>#feedback definition
</span></span><span style="display:flex;"><span>float32 distance
</span></span></code></pre></div><h3 id="ì½”ë“œ-ë¶„ì„">ì½”ë“œ ë¶„ì„</h3>
<ul>
<li>rclpyì—ì„œ Action Serverë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ActionServerë¼ëŠ” ë³„ë„ì˜ íŒ¨í‚¤ì§€ë¥¼ import í•´ì•¼ í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> rclpy
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rclpy.node <span style="color:#f92672">import</span> Node
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rclpy.action <span style="color:#f92672">import</span> ActionServer
</span></span></code></pre></div><ul>
<li>ì½”ë“œ ë¶„ì„ ì „ ì‚´í´ë³¸ ë°”ì™€ ê°™ì´ ë‘ ì¢…ë¥˜ì˜ í•¸ë“¤ëŸ¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ParkingActionServer</span>(Node):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        super()<span style="color:#f92672">.</span>__init__(<span style="color:#e6db74">&#39;parking_action_server&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>laser_sub <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>create_subscription(
</span></span><span style="display:flex;"><span>            LaserScan, <span style="color:#e6db74">&#39;scan&#39;</span>, self<span style="color:#f92672">.</span>sub_callback, <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>action_server <span style="color:#f92672">=</span> ActionServer(
</span></span><span style="display:flex;"><span>            self, Parking, <span style="color:#e6db74">&#39;src_parking&#39;</span>,
</span></span><span style="display:flex;"><span>            goal_callback<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>goal_callback,
</span></span><span style="display:flex;"><span>            cancel_callback<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>cancel_callback,
</span></span><span style="display:flex;"><span>            execute_callback<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>execute_callback,
</span></span><span style="display:flex;"><span>        )
</span></span></code></pre></div><ul>
<li>ì´ì œ Actionì˜ callback ì§€ì˜¥ì„ ì‹œì‘í•´ë³´ë ¤ í•˜ëŠ”ë°ìš”, ë‹¤ì‹œ í•œ ë²ˆ ê°œë…ì„ ë‹¤ì¡ê³  ê°‘ì‹œë‹¤.</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>goal_callback</td>
<td>clientë¡œë¶€í„° ì²« goal request ë°œìƒ ì‹œ ì‹¤í–‰ë˜ëŠ” cb</td>
</tr>
<tr>
<td>cancel_callback</td>
<td>feedback ë„ì¤‘ cancel request ë°œìƒ ì‹œ ì‹¤í–‰ë˜ëŠ” cb</td>
</tr>
<tr>
<td>execute_callback</td>
<td>feedback ì¤‘ ì‹¤í–‰ë˜ëŠ” cb</td>
</tr>
</tbody>
</table>
<ol>
<li>goal_callbackì€ goal messageë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ê°€ì§€ë©°, <strong>ACCEPT</strong> í˜¹ì€ <strong>Reject</strong> ê°’ì„ ë¦¬í„´í•©ë‹ˆë‹¤.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> rclpy.action <span style="color:#f92672">import</span> GoalResponse
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">goal_callback</span>(self, goal_request):
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>get_logger()<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;Received goal request.&#39;</span>)
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>goal <span style="color:#f92672">=</span> goal_request
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> GoalResponse<span style="color:#f92672">.</span>ACCEPT
</span></span></code></pre></div><ol start="2">
<li><strong>cancel_callback</strong>ì€ goal_handleì´ë¼ëŠ” action handler objectë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ìŠµë‹ˆë‹¤. ì´ goal_handle ë‚´ë¶€ì—ëŠ” ì—¬ëŸ¬ APIë“¤ì´ êµ¬í˜„ë˜ì–´ ìˆì–´ ì§ì ‘ í™•ì¸í•´ë³´ê³  ë„˜ì–´ê°€ê³ ì í•©ë‹ˆë‹¤.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> rclpy.action <span style="color:#f92672">import</span> CancelResponse
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cancel_callback</span>(self, goal_handle):
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>is_sub <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>is_done <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e"># print(dir(goal_handle))</span>
</span></span><span style="display:flex;"><span>    goal_handle<span style="color:#f92672">.</span>canceled()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>get_logger()<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;Received cancel request&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> CancelResponse<span style="color:#f92672">.</span>ACCEPT
</span></span></code></pre></div><ol start="3">
<li><strong>execute_callback</strong>ì—ì„œ ì£¼ë¡œ ì‹¤ì œ ë¡œì§ì´ êµ¬í˜„ë˜ë©°, ì—…ë°ì´íŠ¸ë˜ëŠ” í™˜ê²½ì— ë”°ë¼ clientì—ê²Œ feedbackì„ ì „ë‹¬í•˜ê³ , ìµœì¢… resultê°€ ë°œë™ë˜ëŠ” ì¡°ê±´ë„ êµ¬í˜„í•©ë‹ˆë‹¤.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">execute_callback</span>(self, goal_handle):
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>    feedback_msg <span style="color:#f92672">=</span> Parking<span style="color:#f92672">.</span>Feedback()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> self<span style="color:#f92672">.</span>f_obs_distance <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0.5</span> <span style="color:#f92672">and</span> self<span style="color:#f92672">.</span>is_done <span style="color:#f92672">==</span> <span style="color:#66d9ef">False</span>:
</span></span><span style="display:flex;"><span>        goal_handle<span style="color:#f92672">.</span>publish_feedback(feedback_msg)
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result
</span></span></code></pre></div><blockquote>
<p>ì´ë²ˆ ì˜ˆì‹œì˜ ë¡œì§ì„ ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•´ë³´ê² ìŠµë‹ˆë‹¤. ë¡œë´‡ì´ ë²½ì— ì¸ì ‘í•˜ê²Œ ë˜ì–´ while loopë¥¼ ë²—ì–´ë‚˜ë©´ <strong>goal succed</strong>ë¥¼ ìˆ˜í–‰í•˜ê³ , Resultë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤. ì™„ë£Œ ì‹œ ì¢Œìš° ë¬¼ì²´ì™€ì˜ ê±°ë¦¬ê°€ ê· ì¼í•  ë•Œ ì„±ê³µìœ¼ë¡œ íŒì •ì§“ìŠµë‹ˆë‹¤.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    goal_handle<span style="color:#f92672">.</span>succeed()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> Parking<span style="color:#f92672">.</span>Result()
</span></span><span style="display:flex;"><span>    lr_diff <span style="color:#f92672">=</span> abs(self<span style="color:#f92672">.</span>r_obs_distance <span style="color:#f92672">-</span> self<span style="color:#f92672">.</span>l_obs_distance)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> lr_diff <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.15</span>:
</span></span><span style="display:flex;"><span>        result<span style="color:#f92672">.</span>message <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;[Success!] Oh... Teach me how you did :0&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        result<span style="color:#f92672">.</span>message <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;[Fail] Be careful, Poor Driver! &#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>is_done <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result
</span></span></code></pre></div><ul>
<li>ì´ë²ˆ ì˜ˆì‹œì˜ mainë¬¸ì—ì„œ íŠ¹ë³„í•œ ì ì„ ì°¾ì•„ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. <strong>MultiThreadedExecutor</strong>ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ë°ìš”. ì´ê²ƒì´ í•˜ëŠ” ì—­í• ì´ ë¬´ì—‡ì¼ì§€ ì§€ê¸ˆì€ ê°„ë‹¨í•˜ê²Œ ì‹¤ìŠµì„ í†µí•´ ì‚´í´ë´…ì‹œë‹¤.
â‡’ main ë¬¸ì˜ ì£¼ì„ì„ í† ê¸€í•˜ê³ , ë‹¤ì‹œ ì˜ˆì œë¥¼ ì‹¤í–‰ ì‹œì¼œë´…ë‹ˆë‹¤. ì–´ë– í•œ ê²°ê³¼ë¥¼ ì–»ìœ¼ì…¨ë‚˜ìš”?</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>(args<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    rclpy<span style="color:#f92672">.</span>init(args<span style="color:#f92672">=</span>args)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># parking_action_server = ParkingActionServer()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># rclpy.spin(parking_action_server)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># parking_action_server.destroy_node()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># rclpy.shutdown()ã…</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span></code></pre></div><ul>
<li>í˜„ ì˜ˆì‹œëŠ” ì—¬ëŸ¬ ì¢…ë¥˜ì˜ callbackì„ ê°–ê³  ìˆìŠµë‹ˆë‹¤. ë¬¸ì œëŠ” <strong>execute_callback</strong>ì´ ì‹¤í–‰ë˜ë©´ì„œ while loopë¡œ ì§„ì…í•˜ë©´, ìì›ì„ ì ìœ í•˜ì—¬ sub_callbackì´ ë™ì‘í•  ìˆ˜ ì—†ëŠ” êµ¬ì¡°ê°€ ë©ë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ROS 2ì—ì„œëŠ” Executorë¼ëŠ” ê°œë…ì„ ë„ì…í•©ë‹ˆë‹¤. (ìì„¸í•œ ë‚´ìš©ì€ ì´í›„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.)</li>
</ul>
<p><img src="/kr/ros2_foxy/images9/Untitled2.png?height=300px" alt="Untitled2.png"></p>
<ul>
<li>image from : <a href="https://docs.ros.org/en/foxy/Concepts/About-Executors.html">docs.ros.org</a></li>
</ul>
<blockquote>
<p>ì´í›„ ì—¬ëŸ¬ê°€ì§€ êµ¬í˜„ì„ í•˜ë‹¤ ë³´ë©´ ì§€ê¸ˆì²˜ëŸ¼ ë‹¤ì¤‘ Subscribeë¥¼ í•´ì•¼í•˜ëŠ” ê²½ìš°, í˜¹ì€ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì—¬ëŸ¬ê°œì˜ Nodeë¥¼ ì‹¤í–‰ì‹œì¼œì•¼ í•˜ëŠ” ê²½ìš°ê°€ ë°œìƒí•©ë‹ˆë‹¤. ì´ë•Œ, <strong>Node Composition</strong>ê³¼ <strong>MultiThreadedExecutor</strong>ë¥¼ ì ê·¹ ì‚¬ìš©í•´ë³´ì„¸ìš”!</p>
</blockquote>
<h3 id="example-2---action-client-parking-master">example 2 - Action Client (Parking Master)</h3>
<p>Action ìì²´ë„ ì‰½ì§€ ì•Šì€ ê°œë…ì¸ë° MultiThreadedExecutorë“± ìƒˆë¡œìš´ ê°œë…ìœ¼ë¡œ ë§ì€ í˜¼ë€ì´ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ Action ClientëŠ” ì¼ì „ Parking Exampleì˜ Clientë§Œ êµ¬í˜„í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>
<ul>
<li>ì´ì „ ì˜ˆì‹œì—ì„œëŠ” ì½˜ì†” ì°½ì„ í†µí•´ ì§ì ‘ Action Clientë¥¼ ì‹¤í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.
â‡’ ros2 action send_goal <!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ros2 action send_goal <span style="color:#f92672">/</span>src_parking custom_interfaces<span style="color:#f92672">/</span>action<span style="color:#f92672">/</span>Parking <span style="color:#e6db74">&#34;start_flag: true&#34;</span> <span style="color:#f92672">--</span>feedback
</span></span></code></pre></div><ul>
<li>Action Client ì˜ˆì‹œëŠ” ë°”ë¡œ ì´ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì½”ë“œë¡œ í˜¸ì¶œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ros2 run cpp_action_tutorial parking_status_client
</span></span></code></pre></div><h3 id="ì½”ë“œ-ë¶„ì„-1">ì½”ë“œ ë¶„ì„</h3>
<ul>
<li>parking_status_client.pyë¥¼ ì°¸ê³ í•˜ì‹œë©´ ë©ë‹ˆë‹¤. íŒŒì¼ì˜ ì²˜ìŒìœ¼ë¡œ ActionClientì™€ action data typeì„ importí•˜ê³  ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> rclpy
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rclpy.node <span style="color:#f92672">import</span> Node
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rclpy.action <span style="color:#f92672">import</span> ActionClient
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> custom_interfaces.action <span style="color:#f92672">import</span> Parking
</span></span></code></pre></div><ul>
<li>ì´ë²ˆ ì˜ˆì‹œì—ì„œë„ Callbackì´ ë§ì•„ ì •ë¦¬ë¶€í„° í•˜ê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>feedback_callback</td>
<td>Action Serverë¡œë¶€í„°ì˜ feedback cb</td>
</tr>
<tr>
<td>goal_response_callback</td>
<td>Action Serverë¡œë¶€í„°ì˜ Response cb</td>
</tr>
<tr>
<td>get_result_callback</td>
<td>Action Serverë¡œë¶€í„°ì˜ Result cb</td>
</tr>
<tr>
<td>cancel_goal</td>
<td>Action Serverë¡œ ì „ë‹¬í•˜ëŠ” Cancel cb</td>
</tr>
<tr>
<td>goal_canceled_callback</td>
<td>Action Serverë¡œë¶€í„°ì˜ Cancel cb</td>
</tr>
</tbody>
</table>
<ul>
<li>ìƒì„±ìì—ì„œëŠ” Action Client ìƒì„± ì™¸ì— í° ì‘ì—…ì€ ì—†ìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ParkingActionClient</span>(Node):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        super()<span style="color:#f92672">.</span>__init__(<span style="color:#e6db74">&#39;parking_action_client&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_action_client <span style="color:#f92672">=</span> ActionClient(self, Parking, <span style="color:#e6db74">&#39;src_parking&#39;</span>)
</span></span></code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Parking</td>
<td>Action data type</td>
</tr>
<tr>
<td>&lsquo;src_parkingâ€™</td>
<td>Action name</td>
</tr>
</tbody>
</table>
<ul>
<li>send_goal()ì€ mainì—ì„œ ì§ì ‘ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ë¡œ, feedback_callbackê³¼ goal_response_callbackì„ ë°”ì¸ë”©í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_goal</span>(self):
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>_send_goal_future <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_action_client<span style="color:#f92672">.</span>send_goal_async(goal_msg, feedback_callback<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>feedback_callback)
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>_send_goal_future<span style="color:#f92672">.</span>add_done_callback(self<span style="color:#f92672">.</span>goal_response_callback)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>(args<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>    action_client<span style="color:#f92672">.</span>send_goal()
</span></span></code></pre></div><ul>
<li>goal_response_callback ì™„ë£Œ ì‹œ, get_result_callbackì´ ì‹¤í–‰ë˜ë©°, resultë¥¼ ë°›ì•˜ë‹¤ëŠ” ê²ƒì€ actionì´ ì™„ë£Œë˜ì—ˆë‹¤ëŠ” ëœ»ì´ë¯€ë¡œ ì¢…ë£Œ ë¡œì§ì´ í¬í•¨ë©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">goal_response_callback</span>(self, future):
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>goal_handle <span style="color:#f92672">=</span> future<span style="color:#f92672">.</span>result()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> self<span style="color:#f92672">.</span>goal_handle<span style="color:#f92672">.</span>accepted:
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>get_logger()<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;Goal rejected :(&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>get_logger()<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;Goal accepted :)&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>_get_result_future <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>goal_handle<span style="color:#f92672">.</span>get_result_async()
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>_get_result_future<span style="color:#f92672">.</span>add_done_callback(self<span style="color:#f92672">.</span>get_result_callback)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_result_callback</span>(self, future):
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> future<span style="color:#f92672">.</span>result()<span style="color:#f92672">.</span>result
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>get_logger()<span style="color:#f92672">.</span>info(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Result: </span><span style="color:#e6db74">{</span>result<span style="color:#f92672">.</span>message<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    rclpy<span style="color:#f92672">.</span>shutdown()
</span></span></code></pre></div><ul>
<li>cancel ë¡œì§ì€ feedback_callbackì•ˆì— ì¡´ì¬í•©ë‹ˆë‹¤. í”¼ë“œë°±ì„ í†µí•´ ë°›ì€ ì „ë°© ë¬¼ì²´ì™€ì˜ ê±°ë¦¬ê°€ ë„ˆë¬´ ë©€ì–´ì ¸ë²„ë¦¬ë©´ ì˜¤ë¥˜ë¡œ ì¸ì§€í•˜ê³  cancelì´ ì´ë£¨ì–´ì§€ëŠ” ê²ƒì…ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">feedback_callback</span>(self, feedback_msg):
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> feedback<span style="color:#f92672">.</span>distance <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">6.0</span>:
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>cancel_goal()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cancel_goal</span>(self):
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>get_logger()<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;Canceling goal&#39;</span>)
</span></span><span style="display:flex;"><span>    future <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>goal_handle<span style="color:#f92672">.</span>cancel_goal_async()
</span></span><span style="display:flex;"><span>    future<span style="color:#f92672">.</span>add_done_callback(self<span style="color:#f92672">.</span>goal_canceled_callback)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">goal_canceled_callback</span>(self, future):
</span></span><span style="display:flex;"><span>    cancel_response <span style="color:#f92672">=</span> future<span style="color:#f92672">.</span>result()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(cancel_response<span style="color:#f92672">.</span>goals_canceling) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>get_logger()<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;Cancelling of goal complete&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>get_logger()<span style="color:#f92672">.</span>warning(<span style="color:#e6db74">&#39;Goal failed to cancel&#39;</span>)
</span></span></code></pre></div><p>â‡’ ë”°ë¼ì„œ ì˜ˆì‹œ ì‹¤í–‰ ì‹œ ì˜ë„ì ìœ¼ë¡œ ë’¤ë¡œ ê°€ë²„ë¦¬ë©´ Actionì´ ì¢…ë£Œë©ë‹ˆë‹¤.</p>
<ul>
<li>mainë¬¸ì—ì„œ send_goalì„ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ ìŠì§€ ë§ˆì„¸ìš”.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>(args<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>    rclpy<span style="color:#f92672">.</span>init(args<span style="color:#f92672">=</span>args)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    action_client <span style="color:#f92672">=</span> ParkingActionClient()
</span></span><span style="display:flex;"><span>    action_client<span style="color:#f92672">.</span>send_goal()
</span></span><span style="display:flex;"><span>    rclpy<span style="color:#f92672">.</span>spin(action_client)
</span></span></code></pre></div><h3 id="example-3---action-server-dataset-generation">example 3 - Action Server (Dataset Generation)</h3>
<blockquote>
<p>ì´ì œ Topic, Service, Actionì„ ëª¨ë‘ ë°°ì›Œë³´ì•˜ìŠµë‹ˆë‹¤. ë•Œë¬¸ì— ì´ë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ëŠ” ê³¼ì œë¥¼ ë‚´ë“œë¦¬ê³ ì í•©ë‹ˆë‹¤.</p>
</blockquote>
<ul>
<li>Dataset Generation</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Terminal1 - gazebo env</span>
</span></span><span style="display:flex;"><span>ros2 launch rgbd_world depth_world<span style="color:#f92672">.</span>launch<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal2 - Assignment Node</span>
</span></span><span style="display:flex;"><span>ros2 run py_action_tutorial dataset_generation_server
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal3 - Action Call</span>
</span></span><span style="display:flex;"><span>ros2 action send_goal <span style="color:#f92672">/</span>dataset_generation custom_interfaces<span style="color:#f92672">/</span>action<span style="color:#f92672">/</span>DataGen <span style="color:#e6db74">&#34;{x: 1, z: 1, model_name: beer}&#34;</span>
</span></span></code></pre></div><ul>
<li>ì„ íƒí•œ ë¬¼ì²´ì™€ ìœ„ì¹˜ì— ë”°ë¼ ì´ 6ë²ˆ spawn, capture, deletionì´ ë°˜ë³µë©ë‹ˆë‹¤.</li>
</ul>
<p><img src="/kr/ros2_foxy/images9/action_datasetgen.gif?height=300px" alt="action_datasetgen.gif"></p>
<p>â‡’ ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œëœ í›„ workspaceì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ì§„ datasetì´ ìƒì„±ë©ë‹ˆë‹¤.</p>
<p><img src="/kr/ros2_foxy/images9/Untitled3.png?height=300px" alt="Untitled3.png"></p>
<h3 id="ì´-nodeë¥¼-ê°œë°œí•´ë³´ëŠ”-ê²ƒì´-ì´ë²ˆ-ì‹œê°„ì˜-ê³¼ì œì…ë‹ˆë‹¤">ğŸ’ªÂ ì´ Nodeë¥¼ ê°œë°œí•´ë³´ëŠ” ê²ƒì´ ì´ë²ˆ ì‹œê°„ì˜ ê³¼ì œì…ë‹ˆë‹¤.</h3>
<ul>
<li><strong>Hint 1. í•„ìš”í•œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜</strong></li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>create_subscription</td>
<td>image topicì„ ë°›ì•„ ì €ì¥í•´ì•¼ í•©ë‹ˆë‹¤.</td>
</tr>
<tr>
<td>create_client</td>
<td>ì¼ì „ Service Client ë•Œì²˜ëŸ¼ ë¬¼ì„±ì¹˜ë¥¼ ì •ì§€ì‹œí‚¤ê³ , ì›í•˜ëŠ” ìœ„ì¹˜ì— ë¬¼ì²´ë¥¼ ë“±ì¥ì‹œí‚¤ê³ , ë˜ ì‚­ì œí•˜ëŠ” ì‘ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤.</td>
</tr>
<tr>
<td>ActionServer</td>
<td>Actionì„ í†µí•´ ì˜ ì§„í–‰ë˜ê³  ìˆëŠ”ì§€ ë¡œì§ì„ êµ¬í˜„í•˜ê³ , Serviceë“¤ë„ í•¸ë“¤ë§í•©ë‹ˆë‹¤.</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Hint 2. action data type</strong></li>
</ul>
<p>ì´ë²ˆ ì˜ˆì‹œë¥¼ ìœ„í•´ ì‚¬ìš©í•  ë°ì´í„° íƒ€ì…ì„ ë¯¸ë¦¬ ì¤€ë¹„í•´ë‘ì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, ì§ì ‘ ì—¬ëŸ¬ë¶„ë§Œì˜ interfaceë¥¼ ë§Œë“¤ì–´ë³´ê³ , ì‚¬ìš©í•´ë³´ê¸°ë¥¼ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#goal definition</span>
</span></span><span style="display:flex;"><span>string model_name
</span></span><span style="display:flex;"><span>float32 x
</span></span><span style="display:flex;"><span>float32 y
</span></span><span style="display:flex;"><span>float32 z
</span></span><span style="display:flex;"><span><span style="color:#f92672">---</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#result definition</span>
</span></span><span style="display:flex;"><span>string message
</span></span><span style="display:flex;"><span><span style="color:#f92672">---</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#feedback definition</span>
</span></span><span style="display:flex;"><span>string message
</span></span></code></pre></div><ul>
<li><strong>Hint 3. sleep</strong></li>
</ul>
<p>ì‚¬ì§„ì´ ì°íˆê¸°ê¹Œì§€ ì‹œê°„ ì—¬ìœ ë¥¼ ì£¼ê¸° ìœ„í•´ create_rate í•¨ìˆ˜ ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤. (ë‹¨ìœ„ëŠ” Hz)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>self<span style="color:#f92672">.</span>rate <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>create_rate(<span style="color:#ae81ff">0.3</span>)
</span></span><span style="display:flex;"><span>self<span style="color:#f92672">.</span>rate<span style="color:#f92672">.</span>sleep()
</span></span></code></pre></div><p>â‡’ í•´ì„¤ì€ ë‹¤ìŒ ì‹œê°„ì— ì§„í–‰í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤!!</p>
<h2 id="ros-2-action-programming---c">ROS 2 Action Programming - C++</h2>
<h3 id="example-1---action-server-parking-master-1">example 1 - Action Server (Parking Master)</h3>
<ul>
<li>ë°”ë¡œ ì˜ˆì‹œ ì‹¤í–‰ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1</span>
</span></span><span style="display:flex;"><span>ros2 launch src_gazebo wall_world<span style="color:#f92672">.</span>launch<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2</span>
</span></span><span style="display:flex;"><span>ros2 run cpp_action_tutorial parking_status_server
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 3</span>
</span></span><span style="display:flex;"><span>ros2 action send_goal <span style="color:#f92672">/</span>src_parking custom_interfaces<span style="color:#f92672">/</span>action<span style="color:#f92672">/</span>Parking <span style="color:#e6db74">&#34;start_flag: true&#34;</span> <span style="color:#f92672">--</span>feedback
</span></span></code></pre></div><h3 id="ì½”ë“œ-ë¶„ì„-2">ì½”ë“œ ë¶„ì„</h3>
<ul>
<li>í”„ë¡œê·¸ë˜ë° ì¤‘ íƒ€ì´í•‘ì„ ìµœì†Œí™”í•˜ê¸°ìœ„í•´ ServerGoalHandleì— ëŒ€í•œ í‚¤ì›Œë“œë¥¼ ì¬ì •ì˜í•˜ì˜€ìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#include &#34;rclcpp/rclcpp.hpp&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &#34;sensor_msgs/msg/laser_scan.hpp&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &#34;rclcpp_action/rclcpp_action.hpp&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &#34;custom_interfaces/action/parking.hpp&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>using LaserScan <span style="color:#f92672">=</span> sensor_msgs::msg::LaserScan;
</span></span><span style="display:flex;"><span>using Parking <span style="color:#f92672">=</span> custom_interfaces::action::Parking;
</span></span><span style="display:flex;"><span>using GoalHandleParking <span style="color:#f92672">=</span> rclcpp_action::ServerGoalHandle<span style="color:#f92672">&lt;</span>Parking<span style="color:#f92672">&gt;</span>;
</span></span></code></pre></div><ul>
<li>íŒŒì´ì¬ ë•Œì™€ ë™ì¼í•˜ê²Œ Action Serverì™€ Topic Subscriberê°€ í•„ìš”í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  ParkingActionServer() <span style="color:#f92672">:</span> Node(<span style="color:#e6db74">&#34;parking_action_server&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std<span style="color:#f92672">::</span>placeholders;
</span></span><span style="display:flex;"><span>    m_action_server <span style="color:#f92672">=</span> rclcpp_action<span style="color:#f92672">::</span>create_server<span style="color:#f92672">&lt;</span>Parking<span style="color:#f92672">&gt;</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span>, <span style="color:#e6db74">&#34;src_parking&#34;</span>,
</span></span><span style="display:flex;"><span>      std<span style="color:#f92672">::</span>bind(<span style="color:#f92672">&amp;</span>ParkingActionServer<span style="color:#f92672">::</span>handle_goal, <span style="color:#66d9ef">this</span>, _1, _2),
</span></span><span style="display:flex;"><span>      std<span style="color:#f92672">::</span>bind(<span style="color:#f92672">&amp;</span>ParkingActionServer<span style="color:#f92672">::</span>handle_cancel, <span style="color:#66d9ef">this</span>, _1),
</span></span><span style="display:flex;"><span>      std<span style="color:#f92672">::</span>bind(<span style="color:#f92672">&amp;</span>ParkingActionServer<span style="color:#f92672">::</span>handle_accepted, <span style="color:#66d9ef">this</span>, _1)
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    m_laser_sub <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>create_subscription<span style="color:#f92672">&lt;</span>LaserScan<span style="color:#f92672">&gt;</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;scan&#34;</span>, <span style="color:#ae81ff">10</span>, std<span style="color:#f92672">::</span>bind(<span style="color:#f92672">&amp;</span>ParkingActionServer<span style="color:#f92672">::</span>laser_callback, <span style="color:#66d9ef">this</span>, _1)
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    RCLCPP_INFO(get_logger(), <span style="color:#e6db74">&#34;Action Ready...&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><ul>
<li>rclcpp Action Serverì˜ callbackë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. íŒŒì´ì¬ê³¼ ë‹¬ë¦¬ acceptì— ëŒ€í•œ callbackì„ ê°–ìŠµë‹ˆë‹¤.</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>handle_goal</td>
<td>clientë¡œë¶€í„° ì²« goal request ë°œìƒ ì‹œ ì‹¤í–‰ë˜ëŠ” cb</td>
</tr>
<tr>
<td>handle_cancel</td>
<td>feedback ë„ì¤‘ cancel request ë°œìƒ ì‹œ ì‹¤í–‰ë˜ëŠ” cb</td>
</tr>
<tr>
<td>handle_accepted</td>
<td>goal accept ì‹œ ì‹¤í–‰ë˜ëŠ” cb</td>
</tr>
<tr>
<td>template argument</td>
<td>action data type</td>
</tr>
<tr>
<td>&ldquo;src_parking&rdquo;</td>
<td>action name</td>
</tr>
</tbody>
</table>
<ol>
<li><strong>handle_goal</strong>ì€ goal id, goal ìì²´ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ê°€ì§€ë©°, REJECT, ACCEPT_AND_EXECUTE, ACCEPT_AND_DEFERì„ ë¦¬í„´ìœ¼ë¡œ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>rclcpp_action<span style="color:#f92672">::</span>GoalResponse handle_goal(<span style="color:#66d9ef">const</span> rclcpp_action<span style="color:#f92672">::</span>GoalUUID <span style="color:#f92672">&amp;</span>uuid,
</span></span><span style="display:flex;"><span>            std<span style="color:#f92672">::</span>shared_ptr<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">const</span> Parking<span style="color:#f92672">::</span>Goal<span style="color:#f92672">&gt;</span> goal) {
</span></span><span style="display:flex;"><span>  RCLCPP_INFO(get_logger(), <span style="color:#e6db74">&#34;Got goal request with order %s&#34;</span>, goal<span style="color:#f92672">-&gt;</span>start_flag <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;true&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;false&#34;</span>);
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">void</span>)uuid;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> rclcpp_action<span style="color:#f92672">::</span>GoalResponse<span style="color:#f92672">::</span>ACCEPT_AND_EXECUTE;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol start="2">
<li><strong>handle_cancel</strong>ì€ action goal handler objectë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ìŠµë‹ˆë‹¤. íŒŒì´ì¬ê³¼ ë™ì¼í•˜ê²Œ ì´ goal_handle ë‚´ë¶€ì—ëŠ” ì—¬ëŸ¬ APIë“¤ì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</li>
</ol>
<p>â‡’ CancelResponseëŠ” ACCEPT, REJECT ë‘ì¢…ë¥˜ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>rclcpp_action<span style="color:#f92672">::</span>CancelResponse handle_cancel(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>shared_ptr<span style="color:#f92672">&lt;</span>GoalHandleParking<span style="color:#f92672">&gt;</span> goal_handle) {
</span></span><span style="display:flex;"><span>  RCLCPP_WARN(get_logger(), <span style="color:#e6db74">&#34;Got request to cancel goal&#34;</span>);
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">void</span>)goal_handle;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> rclcpp_action<span style="color:#f92672">::</span>CancelResponse<span style="color:#f92672">::</span>ACCEPT;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol start="3">
<li><strong>handle_accepted</strong>ì—ì„œ feedbackì„ êµ¬í˜„í•˜ëŠ” executeë¡œ ì—°ê²°ì´ ë©ë‹ˆë‹¤. ì´ ë¶€ë¶„ì—ì„œ íŒŒì´ì¬ê³¼ ì°¨ì´ë¥¼ ê°–ëŠ”ë°, ë³µìŠµì„ í•´ë³¼ ê²¸ ë¹„êµë¥¼ í•´ë³´ê² ìŠµë‹ˆë‹¤.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">handle_accepted</span>(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>shared_ptr<span style="color:#f92672">&lt;</span>GoalHandleParking<span style="color:#f92672">&gt;</span> goal_handle) {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// this needs to return quickly to avoid blocking the executor, so spin up a
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// new thread
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std<span style="color:#f92672">::</span>placeholders;
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span><span style="color:#66d9ef">thread</span>{std<span style="color:#f92672">::</span>bind(<span style="color:#f92672">&amp;</span>ParkingActionServer<span style="color:#f92672">::</span>execute, <span style="color:#66d9ef">this</span>, _1), goal_handle}.detach();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ParkingActionServer</span>(Node):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>    super()<span style="color:#f92672">.</span>__init__(<span style="color:#e6db74">&#39;parking_action_server&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>laser_sub <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>create_subscription(
</span></span><span style="display:flex;"><span>      LaserScan, <span style="color:#e6db74">&#39;scan&#39;</span>, self<span style="color:#f92672">.</span>sub_callback, <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>action_server <span style="color:#f92672">=</span> ActionServer(
</span></span><span style="display:flex;"><span>      self, Parking, <span style="color:#e6db74">&#39;src_parking&#39;</span>,
</span></span><span style="display:flex;"><span>      goal_callback<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>goal_callback,
</span></span><span style="display:flex;"><span>      cancel_callback<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>cancel_callback,
</span></span><span style="display:flex;"><span>      execute_callback<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>execute_callback,
</span></span><span style="display:flex;"><span>    )
</span></span></code></pre></div><ul>
<li>executeì˜ ë¡œì§ì€ ì‚´í´ë³¼ ë°” ìˆì–´ ê°„ë‹¨íˆ ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤. ë‹¤ë§Œ, cancel ë¡œì§ì´ ì‚½ì…ë˜ëŠ” ë¶€ë¶„ê³¼ êµ¬í˜„ì— ì§‘ì¤‘í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">while</span> (f_obs_distance <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0.5</span> <span style="color:#f92672">&amp;&amp;</span> is_done <span style="color:#f92672">==</span> false) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (goal_handle<span style="color:#f92672">-&gt;</span>is_canceling()) {
</span></span><span style="display:flex;"><span>    result<span style="color:#f92672">-&gt;</span>message <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Canceled&#34;</span>;
</span></span><span style="display:flex;"><span>    goal_handle<span style="color:#f92672">-&gt;</span>canceled(result);
</span></span><span style="display:flex;"><span>    is_done <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>    RCLCPP_WARN(get_logger(), <span style="color:#e6db74">&#34;Goal Canceled&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  feedback<span style="color:#f92672">-&gt;</span>distance <span style="color:#f92672">=</span> f_obs_distance;
</span></span><span style="display:flex;"><span>  goal_handle<span style="color:#f92672">-&gt;</span>publish_feedback(feedback);
</span></span><span style="display:flex;"><span>  RCLCPP_INFO(get_logger(), <span style="color:#e6db74">&#34;Distance from forward obstacle %f&#34;</span>, f_obs_distance);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  loop_rate.sleep();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>rclcppì—ì„œ <strong>MultiThreadedExecutor</strong>ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. add_nodeì— ì—¬ëŸ¬ nodeë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” ê²ƒì´ì§€ìš”.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>int main(int argc, char <span style="color:#f92672">*</span> argv[]){
</span></span><span style="display:flex;"><span>  rclcpp::init(argc, argv);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  rclcpp::executors::MultiThreadedExecutor executor;
</span></span><span style="display:flex;"><span>  auto server_node <span style="color:#f92672">=</span> std::make_shared<span style="color:#f92672">&lt;</span>ParkingActionServer<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  executor<span style="color:#f92672">.</span>add_node(server_node);
</span></span><span style="display:flex;"><span>  executor<span style="color:#f92672">.</span>spin();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  rclcpp::shutdown();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="example-2---action-client-parking-master-1">example 2 - Action Client (Parking Master)</h3>
<blockquote>
<p>cancelì„ í¬í•¨í•œ rclcpp Action Client ì‘ì„±ë²•ì„ ì•Œì•„ë´…ì‹œë‹¤.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ros2 run cpp_action_tutorial parking_status_client
</span></span></code></pre></div><h3 id="ì½”ë“œ-ë¶„ì„-3">ì½”ë“œ ë¶„ì„</h3>
<blockquote>
<p>Actionì€ ìì²´ê°€ ì‰½ì§€ ì•Šì€ ê°œë…ì´ì–´ ì½”ë”© ì‹œ ê°œë…ì´ ì¡í˜€ìˆì§€ ì•Šìœ¼ë©´ ë¬´ì²™ í˜ë“¤ì–´ì§‘ë‹ˆë‹¤. ì½”ë“œ ë¶„ì„ ì „, ê°œìš”ë¥¼ ë¨¼ì € ì‚´í´ë³´ê³  ë„˜ì–´ê°‘ì‹œë‹¤.</p>
</blockquote>
<ul>
<li>Action Client Logic</li>
</ul>
<ol>
<li>ìƒì„±ìì—ì„œ Action Client ìƒì„±</li>
<li>mainì—ì„œ send_goal ì‹¤í–‰</li>
<li>send_goalì—ì„œ ì—¬ëŸ¬ callbackì´ ì •ì˜ë˜ì–´ ìˆìœ¼ë©° ìƒí™©ì— ë”°ë¼ ì ì ˆí•œ callbackì´ ì‹¤í–‰ë¨
<ol>
<li>goal_response_callback</li>
<li>feedback_callback</li>
<li>result_callback</li>
</ol>
</li>
</ol>
<ul>
<li>action server ë•Œì™€ ë§ˆì°¬ê°€ì§€ë¡œ rclcpp_actionì˜ includeì™€ í¸ì˜ë¥¼ ìœ„í•´ ClientGoalHandle í‚¤ì›Œë“œë¥¼ ë‹¤ì‹œ ì •ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;rclcpp/rclcpp.hpp&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;rclcpp_action/rclcpp_action.hpp&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;custom_interfaces/action/parking.hpp&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std<span style="color:#f92672">::</span>placeholders;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> Parking <span style="color:#f92672">=</span> custom_interfaces<span style="color:#f92672">::</span>action<span style="color:#f92672">::</span>Parking;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> GoalHandleParking <span style="color:#f92672">=</span> rclcpp_action<span style="color:#f92672">::</span>ClientGoalHandle<span style="color:#f92672">&lt;</span>Parking<span style="color:#f92672">&gt;</span>;
</span></span></code></pre></div><ul>
<li>rclcpp action clientëŠ” ë‹¤ìŒê³¼ ê°™ì´ ìƒì„±í•©ë‹ˆë‹¤. (ì‹¤ì œ callbackë“¤ì€ send_goal ì‹œ Handlerì— ì˜í•´ ë°”ì¸ë”©ë©ë‹ˆë‹¤.)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ParkingActionClient</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> rclcpp<span style="color:#f92672">::</span>Node {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  rclcpp_action<span style="color:#f92672">::</span>Client<span style="color:#f92672">&lt;</span>Parking<span style="color:#f92672">&gt;::</span>SharedPtr m_action_client;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  ParkingActionClient() <span style="color:#f92672">:</span> Node(<span style="color:#e6db74">&#34;parking_action_client&#34;</span>){
</span></span><span style="display:flex;"><span>    m_action_client <span style="color:#f92672">=</span> rclcpp_action<span style="color:#f92672">::</span>create_client<span style="color:#f92672">&lt;</span>Parking<span style="color:#f92672">&gt;</span>(<span style="color:#66d9ef">this</span>, <span style="color:#e6db74">&#34;src_parking&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Parking</td>
<td>Action data type</td>
</tr>
<tr>
<td>&lsquo;src_parkingâ€™</td>
<td>Action name</td>
</tr>
</tbody>
</table>
<ul>
<li>ë‹¤ì‹œê¸ˆ ì´ë²ˆ ì˜ˆì‹œì—ì„œì˜ callbackê³¼ ì£¼ìš” í•¨ìˆ˜ë¥¼ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤.</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>feedback_callback</td>
<td>Action Serverë¡œë¶€í„°ì˜ feedback cb</td>
</tr>
<tr>
<td>goal_response_callback</td>
<td>Action Serverë¡œë¶€í„°ì˜ Response cb</td>
</tr>
<tr>
<td>result_callback</td>
<td>Action Serverë¡œë¶€í„°ì˜ Result cb</td>
</tr>
<tr>
<td>async_cancel_all_goals</td>
<td>Action Serverë¡œ Cancel call</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>goal_response_callback</strong>ì€ GoalHandler shared_pointerì˜ shared_futureë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ê°–ìŠµë‹ˆë‹¤. ë‹¤ì†Œ ë³µì¡í•œë°, GoalHandler ìì²´ê°€ ì•„ë‹Œ futureì´ê¸° ë•Œë¬¸ì— get() í•¨ìˆ˜ë¥¼ í†µí•´ ê°’ì„ ë”°ë¡œ ë°›ì•„ ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">goal_response_callback</span>(std<span style="color:#f92672">::</span>shared_future<span style="color:#f92672">&lt;</span>GoalHandleParking<span style="color:#f92672">::</span>SharedPtr<span style="color:#f92672">&gt;</span> future){
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">auto</span> goal_handle <span style="color:#f92672">=</span> future.get();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>goal_handle) {
</span></span><span style="display:flex;"><span>    RCLCPP_ERROR(<span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>get_logger(), <span style="color:#e6db74">&#34;Goal was rejected by server&#34;</span>);
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    RCLCPP_INFO(<span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>get_logger(), <span style="color:#e6db74">&#34;Goal accepted by server, waiting for result&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li><strong>feedback_callback</strong> ë‚´ë¶€ cancel ë¡œì§ì—ì„œ ì´ì „ê³¼ ìƒˆë¡œìš´ ì ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. êµ¬í˜„ì˜ í¸ì˜ë¥¼ ìœ„í•´ async_cancel_all_goalsì„ ì‚¬ ìš©í•˜ì˜€ëŠ”ë°ìš”, í˜„ì¬ ì‚¬ìš©ì¤‘ì¸ actionì´ í•˜ë‚˜ë¿ì´ë¼ ë¬¸ì œê°€ ì—†ì§€ë§Œ ë‹¤ìˆ˜ì˜ actionì´ ì¡´ì¬í•˜ëŠ” ê²½ìš° async_cancel_goal ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">feedback_callback</span>(GoalHandleParking<span style="color:#f92672">::</span>SharedPtr,
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>shared_ptr<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">const</span> Parking<span style="color:#f92672">::</span>Feedback<span style="color:#f92672">&gt;</span> feedback){
</span></span><span style="display:flex;"><span>  RCLCPP_INFO(<span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>get_logger(), <span style="color:#e6db74">&#34;Received feedback: %f&#34;</span>, feedback<span style="color:#f92672">-&gt;</span>distance);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span>(feedback<span style="color:#f92672">-&gt;</span>distance <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">6.0</span>)
</span></span><span style="display:flex;"><span>    m_action_client<span style="color:#f92672">-&gt;</span>async_cancel_all_goals();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>async_cancel_goal(goal_handler)</td>
<td>async_cancel_goalÂ (typename GoalHandle::SharedPtr goal_handle,Â CancelCallbackÂ cancel_callback=nullptr)</td>
</tr>
<tr>
<td>async_cancel_all_goals()</td>
<td>async_cancel_all_goalsÂ (CancelCallbackÂ cancel_callback=nullptr)</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>result_callback</strong>ì€ WrappedResultë¼ëŠ” 1ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ê°–ìŠµë‹ˆë‹¤. goal resultë¥¼ ë‹¤ë£¨ê¸° ìœ„í•œ ë³„ë„ì˜ ê°ì²´ì´ë©°, ResultCodeë¼ëŠ” enum typeì„ ê°–ê³  ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">result_callback</span>(<span style="color:#66d9ef">const</span> GoalHandleParking<span style="color:#f92672">::</span>WrappedResult <span style="color:#f92672">&amp;</span> result){
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">switch</span> (result.code) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> rclcpp_action<span style="color:#f92672">::</span>ResultCode<span style="color:#f92672">::</span>SUCCEEDED:
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> rclcpp_action<span style="color:#f92672">::</span>ResultCode<span style="color:#f92672">::</span>ABORTED:
</span></span><span style="display:flex;"><span>      RCLCPP_ERROR(<span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>get_logger(), <span style="color:#e6db74">&#34;Goal was aborted&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> rclcpp_action<span style="color:#f92672">::</span>ResultCode<span style="color:#f92672">::</span>CANCELED:
</span></span><span style="display:flex;"><span>      RCLCPP_ERROR(<span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>get_logger(), <span style="color:#e6db74">&#34;Goal was canceled&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      RCLCPP_ERROR(<span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>get_logger(), <span style="color:#e6db74">&#34;Unknown result code&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  RCLCPP_INFO(<span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>get_logger(), <span style="color:#e6db74">&#34;Result received: %s&#34;</span>, result.result<span style="color:#f92672">-&gt;</span>message.c_str());
</span></span><span style="display:flex;"><span>  rclcpp<span style="color:#f92672">::</span>shutdown();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><table>
<thead>
<tr>
<th>Enumerator</th>
</tr>
</thead>
<tbody>
<tr>
<td>UNKNOWNÂ </td>
</tr>
<tr>
<td>SUCCEEDEDÂ </td>
</tr>
<tr>
<td>CANCELEDÂ </td>
</tr>
<tr>
<td>ABORTEDÂ </td>
</tr>
</tbody>
</table>

<div class="notices note" ><p>ì´ë²ˆ ì˜ˆì‹œì—ì„œë„ mainë¬¸ì—ì„œ send_goalì„ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ ìŠì§€ ë§ˆì„¸ìš”.</p>
</div>



<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/kr/ros2_foxy/lecture8/" title="Lecture8. ROS 2 Service and Programming"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/kr/ros2_foxy/lecture10/" title="Lecture10. TF and ROS 2" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1684760080"></script>
    <script src="/js/perfect-scrollbar.min.js?1684760080"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1684760080"></script>
    <script src="/js/jquery.sticky.js?1684760080"></script>
    <script src="/js/featherlight.min.js?1684760080"></script>
    <script src="/js/highlight.pack.js?1684760080"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1684760080"></script>
    <script src="/js/learn.js?1684760080"></script>
    <script src="/js/hugo-learn.js?1684760080"></script>
    
        
            <script src="https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

