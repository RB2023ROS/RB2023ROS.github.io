<!DOCTYPE html>
<html lang="kr" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.104.1" />
    <meta name="description" content="COM2018 OOP Class Lecture Note">
<meta name="author" content="Soo Young Kim">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Lecture10. TF and ROS 2 - Documentation for Hugo Learn Theme</title>

    
    <link href="/css/nucleus.css?1689941542" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1689941542" rel="stylesheet">
    <link href="/css/hybrid.css?1689941542" rel="stylesheet">
    <link href="/css/featherlight.min.css?1689941542" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1689941542" rel="stylesheet">
    <link href="/css/auto-complete.css?1689941542" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1689941542" rel="stylesheet">
    <link href="/css/theme.css?1689941542" rel="stylesheet">
    <link href="/css/tabs.css?1689941542" rel="stylesheet">
    <link href="/css/hugo-theme.css?1689941542" rel="stylesheet">
    
    <link href="/css/theme-green.css?1689941542" rel="stylesheet">
    
    <link href="/css/foo.css?1689941542" rel="stylesheet"><link href="/css/bar.css?1689941542" rel="stylesheet">

    <script src="/js/jquery-3.3.1.min.js?1689941542"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/kr/ros2_foxy/lecture10/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <img width="1097" alt="image" src="https://user-images.githubusercontent.com/12381733/209764275-05dcbdbf-cef7-47ad-94a6-6d61febad01e.png">
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1689941542"></script>
<script type="text/javascript" src="/js/auto-complete.js?1689941542"></script>
<script type="text/javascript">
    
        var baseurl = "\/\/kr";
    
</script>
<script type="text/javascript" src="/js/search.js?1689941542"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/kr'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/kr/ros_basic_noetic/" title="ROS Basics" class="dd-item
        
        
        
        ">
      <a href="/kr/ros_basic_noetic/">
          <b>ROS Noetic. </b>ROS Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture1/" title="Lecture1 - Introduction to ROS" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture1/">
        Lecture1 - Introduction to ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture2/" title="Lecture2 - Dev Env Setup" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture2/">
        Lecture2 - Dev Env Setup
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture3/" title="Lecture3 - Core of ROS" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture3/">
        Lecture3 - Core of ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture4/" title="Lecture4 - ROS Launch, RViz" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture4/">
        Lecture4 - ROS Launch, RViz
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture5/" title="Lecture5 - First Programming, ROS Topic" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture5/">
        Lecture5 - First Programming, ROS Topic
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture6/" title="Lecture6 - ROS Service, Parameter" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture6/">
        Lecture6 - ROS Service, Parameter
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture7/" title="Lecture7 - Rqt Tools and rosbag, ROS Time" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture7/">
        Lecture7 - Rqt Tools and rosbag, ROS Time
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture8/" title="Lecture8 - Deal with Open Source Projects, Custom Interfaces" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture8/">
        Lecture8 - Deal with Open Source Projects, Custom Interfaces
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture9/" title="Lecture9 - ROS TF and Examples" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture9/">
        Lecture9 - ROS TF and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_basic_noetic/lecture10/" title="Lecture10 - TF2 Examples, Outro" class="dd-item ">
        <a href="/kr/ros_basic_noetic/lecture10/">
        Lecture10 - TF2 Examples, Outro
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/advanced_contents_ros1/" title="ROS" class="dd-item
        
        
        
        ">
      <a href="/kr/advanced_contents_ros1/">
          <b>Advanced Contents. </b>ROS
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture1/" title="Lecture1 - ROSCPP" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture1/">
        Lecture1 - ROSCPP
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture2/" title="Lecture2 - More About ROS System" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture2/">
        Lecture2 - More About ROS System
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros1/lecture3/" title="Lecture3 - SROS" class="dd-item ">
        <a href="/kr/advanced_contents_ros1/lecture3/">
        Lecture3 - SROS
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros2_basic_foxy/" title="ROS 2 Basics" class="dd-item
        
        
        
        ">
      <a href="/kr/ros2_basic_foxy/">
          <b>[Old]ROS 2 Foxy. </b>ROS 2 Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture1/" title="Lecture1 - Introduction to ROS 2" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture1/">
        Lecture1 - Introduction to ROS 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture2/" title="Lecture2 - ROS 2 Node, Package" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture2/">
        Lecture2 - ROS 2 Node, Package
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture3/" title="Lecture3 - ROS 2 Node Programming, ROS 2 parameter" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture3/">
        Lecture3 - ROS 2 Node Programming, ROS 2 parameter
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture4/" title="Lecture4 - ROS 2 Node C&#43;&#43; Programming" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture4/">
        Lecture4 - ROS 2 Node C&#43;&#43; Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture5/" title="Lecture5 - ROS 2 Topic and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture5/">
        Lecture5 - ROS 2 Topic and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture6/" title="Lecture6 - ROS 2 Service and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture6/">
        Lecture6 - ROS 2 Service and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture7/" title="Lecture7 - Useful ROS 2 Example, Navigation2" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture7/">
        Lecture7 - Useful ROS 2 Example, Navigation2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture8/" title="Lecture8 - ROS 2 Action and Examples" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture8/">
        Lecture8 - ROS 2 Action and Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_basic_foxy/lecture9/" title="Lecture9 - C&#43;&#43; Programming Again, Outro" class="dd-item ">
        <a href="/kr/ros2_basic_foxy/lecture9/">
        Lecture9 - C&#43;&#43; Programming Again, Outro
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros2_foxy/" title="ROS 2 Basics" class="dd-item
        parent
        
        
        ">
      <a href="/kr/ros2_foxy/">
          <b>[New]ROS 2 Foxy. </b>ROS 2 Basics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture1/" title="Lecture1. What is ROS?" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture1/">
        Lecture1. What is ROS?
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture2/" title="Lecture2. Dev Env Setup" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture2/">
        Lecture2. Dev Env Setup
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture3/" title="Lecture3. Core of ROS" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture3/">
        Lecture3. Core of ROS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture4/" title="Lecture4. ROS 2 Node and Parameter Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture4/">
        Lecture4. ROS 2 Node and Parameter Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture5/" title="Lecture5. ROS 2 Communication Mechanisms" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture5/">
        Lecture5. ROS 2 Communication Mechanisms
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture6/" title="Lecture6. ROS 2 Tools" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture6/">
        Lecture6. ROS 2 Tools
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture7/" title="Lecture7. ROS 2 Topic and Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture7/">
        Lecture7. ROS 2 Topic and Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture8/" title="Lecture8. ROS 2 Service and Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture8/">
        Lecture8. ROS 2 Service and Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture9/" title="Lecture9. ROS 2 Action Programming" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture9/">
        Lecture9. ROS 2 Action Programming
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture10/" title="Lecture10. TF and ROS 2" class="dd-item active">
        <a href="/kr/ros2_foxy/lecture10/">
        Lecture10. TF and ROS 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture11/" title="Lecture11. About Gazebo - 1" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture11/">
        Lecture11. About Gazebo - 1
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture12/" title="Lecture12. About Gazebo - 2" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture12/">
        Lecture12. About Gazebo - 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture13/" title="Lecture13. Useful ROS 2 Examples (Sensor Part)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture13/">
        Lecture13. Useful ROS 2 Examples (Sensor Part)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture14/" title="Lecture14. Useful ROS 2 Examples (Control Part)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture14/">
        Lecture14. Useful ROS 2 Examples (Control Part)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture15/" title="Lecture15. Advanced ROS 2, Package Management" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture15/">
        Lecture15. Advanced ROS 2, Package Management
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture16/" title="Lecture16. Useful ROS 2 Examples (Misc)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture16/">
        Lecture16. Useful ROS 2 Examples (Misc)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture17/" title="Lecture17. Real Hardware Examples" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture17/">
        Lecture17. Real Hardware Examples
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture18/" title="Lecture18. Point Cloud Deep Learning Example (PointNet)" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture18/">
        Lecture18. Point Cloud Deep Learning Example (PointNet)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture19/" title="Lecture19. Orbbec ROS 2 Package - Final" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture19/">
        Lecture19. Orbbec ROS 2 Package - Final
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros2_foxy/lecture20/" title="Lecture20. NVIDIA Jetson Platform" class="dd-item ">
        <a href="/kr/ros2_foxy/lecture20/">
        Lecture20. NVIDIA Jetson Platform
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/advanced_contents_ros2/" title="ROS 2" class="dd-item
        
        
        
        ">
      <a href="/kr/advanced_contents_ros2/">
          <b>Advanced Contents. </b>ROS 2
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture1/" title="Lecture1 - About DDS" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture1/">
        Lecture1 - About DDS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture2/" title="Lecture11 - About DDS (2)" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture2/">
        Lecture11 - About DDS (2)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/advanced_contents_ros2/lecture3/" title="Lecture12 - SROS2" class="dd-item ">
        <a href="/kr/advanced_contents_ros2/lecture3/">
        Lecture12 - SROS2
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/kr/ros_and_gazebo/" title="Gazebo and ROS" class="dd-item
        
        
        
        ">
      <a href="/kr/ros_and_gazebo/">
          <b>Gazebo. </b>Gazebo and ROS
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_and_gazebo/lecture1/" title="Lecture1 - Gazebo and Robot" class="dd-item ">
        <a href="/kr/ros_and_gazebo/lecture1/">
        Lecture1 - Gazebo and Robot
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/kr/ros_and_gazebo/lecture2/" title="Lecture2 - Gazebo and Robot(2)" class="dd-item ">
        <a href="/kr/ros_and_gazebo/lecture2/">
        Lecture2 - Gazebo and Robot(2)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/RB2023ROS/du2023-ros1"><i class='fab fa-fw fa-github'></i> GitHub repo - ROS 1</a>
              </li>
          
              <li>
                  <a class="padding" href="https://github.com/RB2023ROS/du2023-ros2"><i class='fab fa-fw fa-github'></i> GitHub repo - ROS 2</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="kr" value="/kr/ros2_foxy/lecture10/" selected>Korean</option>
                    
                  
              
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      

      
      </ul>
    </section>
    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='' href="https://github.com/com2018-fa22/hugo-blog/tree/main/content/ros2_foxy/lecture10.kr.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text"></span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                   Lecture10. TF and ROS 2
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#introduction-to-tf2">Introduction to tf2</a>
      <ul>
        <li><a href="#husky-again">Husky Again</a></li>
      </ul>
    </li>
    <li><a href="#tf2-tree">TF2 Tree</a>
      <ul>
        <li><a href="#static-broadcaster">static broadcaster</a></li>
        <li><a href="#static-transform-publisher">static transform publisher</a></li>
        <li><a href="#tf2-broadcaster--lisenter--add-frame">TF2 Broadcaster &amp; Lisenter &amp; Add frame</a></li>
      </ul>
    </li>
    <li><a href="#tf2-python-programming">TF2 Python Programming</a>
      <ul>
        <li><a href="#tf2-broadcaster-python">TF2 Broadcaster (Python)</a></li>
        <li><a href="#ì½”ë“œ-ë¶„ì„">ì½”ë“œ ë¶„ì„</a></li>
        <li><a href="#tf2-listener-python">TF2 Listener [Python]</a></li>
        <li><a href="#tf2-add-frame-python">TF2 Add Frame (Python)</a></li>
        <li><a href="#tf2-c-programming">TF2 C++ Programming</a></li>
        <li><a href="#ì½”ë“œ-ë¶„ì„-1">ì½”ë“œ ë¶„ì„</a></li>
        <li><a href="#tf2-listener-c">TF2 Listener (C++)</a></li>
        <li><a href="#tf2-add-frame-c">TF2 Add Frame (C++)</a></li>
      </ul>
    </li>
    <li><a href="#tf2-example">TF2 Example</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Lecture10. TF and ROS 2
            </h1>
          

        


<h2 id="introduction-to-tf2">Introduction to tf2</h2>
<blockquote>
<p>ëŒ€ë¶€ë¶„ì˜ ë¡œë³´í‹±ìŠ¤ ê³¼ì •ë“¤ì—ì„œ ê°€ì¥ ë¨¼ì € ë‹¤ë£¨ëŠ” ê²ƒì´ ë°”ë¡œ <strong>ì¢Œí‘œê³„ ë³€í™˜ - Transformation</strong>ì…ë‹ˆë‹¤. ë¡œë´‡ì€ ìˆ˜ë§ì€ jointì™€ linkë¡œ ì´ë£¨ì–´ì ¸ ìˆìœ¼ë©°, ì„¼ì„œì™€ ì›€ì§ì„ì„ ë‹¤ë£¨ê¸° ë•Œë¬¸ì— ì¢Œí‘œê³„ë¥¼ ë‹¤ë£¨ëŠ” ì¼ì´ ë§¤ìš° ë¹ˆë²ˆí•©ë‹ˆë‹¤.</p>
</blockquote>
<p>ROS 2ì—ì„œëŠ” TF2ë¼ëŠ” íŠ¹ìˆ˜í•œ í˜•íƒœë¡œ ì´ ì¢Œí‘œê³„ì™€ ì‹œê°„ì„ í•¨ê»˜ ë‹¤ë£¨ê³  ìˆìŠµë‹ˆë‹¤. ì˜ˆì‹œì™€ ì„¤ëª…ì„ í†µí•´ ROS 2ì˜ TF2ì— ëŒ€í•´ ë°°ì›Œë´…ì‹œë‹¤ ğŸ˜Š</p>
<p><img src="/kr/ros2_foxy/images10/Untitled.png?height=300px" alt="Untitled.png"></p>
<ul>
<li>image from : <a href="https://ethz.ch/content/dam/ethz/special-interest/mavt/robotics-n-intelligent-systems/rsl-dam/documents/RobotDynamics2017/RD_HS2017script.pdf">eth robot dynamics lecture notes</a></li>
</ul>
<h3 id="husky-again">Husky Again</h3>
<blockquote>
<p>ì¼ì „ husky ì˜ˆì‹œë¥¼ í†µí•´ tf2ì— ëŒ€í•œ ê°œìš”ì„ íŒŒì•…í•´ë³´ê³ ì í•©ë‹ˆë‹¤.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1 - husky gazebo</span>
</span></span><span style="display:flex;"><span>ros2 launch husky_gazebo husky_playpen<span style="color:#f92672">.</span>launch<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2 - rviz</span>
</span></span><span style="display:flex;"><span>rviz2
</span></span></code></pre></div><p><img src="/kr/ros2_foxy/images10/Untitled1.png?height=400px" alt="Untitled1.png"></p>
<p>â‡’ rvizì—ì„œ ë³´ì´ëŠ” ì„¸ê°€ì§€ ìƒ‰ìƒì˜ ë§‰ëŒ€ê°€ ë°”ë¡œ tf2 ì…ë‹ˆë‹¤. x,y,zì˜ ê° ì¶•ì„ ê°ê¸° ë‹¤ë¥¸ ìƒ‰ìœ¼ë¡œ í‘œí˜„í•˜ì˜€ìœ¼ë©°, ì—°ê´€ëœ ì¢Œí‘œê³„ë¼ë¦¬ëŠ” ë…¸ë€ ì„ ì„ í†µí•´ ì—°ê²°í•œ ëª¨ìŠµì´ ë³´ì…ë‹ˆë‹¤.</p>
<p><img src="/kr/ros2_foxy/images10/Untitled2.png?height=300px" alt="Untitled2.png"></p>
<ul>
<li>rviz2 í™”ë©´ì—ì„œ fixed frameì„ ë³€ê²½í•´ë³´ë©´, ëª¨ë“  ë°ì´í„°, ì¢Œí‘œë“¤ì˜ ì›ì ì´ ë°”ë€ŒëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<p><img src="/kr/ros2_foxy/images10/Untitled3.png?height=300px" alt="Untitled3.png"></p>
<p>â‡’ ì´ë ‡ê²Œ ì¢Œí‘œë³€í™˜ì— ë”°ë¥¸ ë°ì´í„° ì‹œê°í™”ê°€ ê°€ëŠ¥í•˜ë ¤ë©´ ëª¨ë“  ì¢Œí‘œê³„ë“¤ ì‚¬ì´ì˜ íšŒì „, í‰í–‰ ì´ë™ ë³€í™˜ ì •ë³´ë¥¼ ì•Œê³  ìˆì–´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤. ROS 2ì—ì„œ ì´ë¥¼ ì–´ë–»ê²Œ ë‹¤ë£° ìˆ˜ ìˆëŠ”ì§€ ë˜ í•˜ë‚˜ì˜ ì˜ˆì‹œë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<h2 id="tf2-tree">TF2 Tree</h2>
<ul>
<li>tf2 view frame - ì´ì „ huskyëŠ” ì‹¤í–‰ ìƒíƒœë¡œ ìœ ì§€í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Terminal1 - husky gazebo</span>
</span></span><span style="display:flex;"><span>ros2 launch husky_gazebo husky_playpen.launch.py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal2 - tf2 view frame</span>
</span></span><span style="display:flex;"><span>cd ~/ros2_ws
</span></span><span style="display:flex;"><span>ros2 run tf2_tools view_frames.py
</span></span></code></pre></div><ul>
<li>ì•½ 5ì´ˆê°„ ëŒ€ê¸° í›„, í´ë”ë¥¼ ì¡°íšŒí•´ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ tree ì‚¬ì§„ì´ ì €ì¥ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<p><img src="/kr/ros2_foxy/images10/frames.png?height=300px" alt="frames.png"></p>
<p>treeë¥¼ í™•ëŒ€í•´ì„œ ì‚´í´ë´…ì‹œë‹¤.</p>
<ul>
<li>ëª¨ë“  nodeë“¤ë¼ë¦¬ëŠ” í•˜ë‚˜ì˜ ì—°ê²° ìƒíƒœë¥¼ ê°–ìŠµë‹ˆë‹¤.</li>
<li>rviz2ì˜ fixed frameì—ì„œëŠ” ë°”ë¡œ ì´ nodeë¥¼ ì„ íƒí–ˆë˜ ê²ƒì…ë‹ˆë‹¤.</li>
<li>í•´ë‹¹ ì—°ê²°ì„ ë‹´ë‹¹í•˜ëŠ” Broadcaster ì •ë³´, í‰ê·  rate, buffer length ë“±ì˜ ì •ë³´ë¥¼ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
</ul>
<p><img src="/kr/ros2_foxy/images10/Untitled4.png?height=300px" alt="Untitled4.png"></p>

<div class="notices note" ><p>ë§Œì•½ tf treeê°€ ì˜¨ì „íˆ ì—°ê²°ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´ ì–´ë–¤ ì¼ì´ ë°œìƒí• ê¹Œìš”?</p>
</div>

<p><img src="/kr/ros2_foxy/images10/Untitled5.png?height=300px" alt="Untitled5.png"></p>
<p>â‡’ tf2ê°„ ì—°ê²°ì´ ëŠì–´ì§€ê²Œ ë˜ë©´, ëŠì–´ì§„ ì•„ë˜ ì‹œì ì— ëŒ€í•´ì„œëŠ” ê·¸ ì–´ë– í•œ ì •ë³´ë„ ì•Œ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ rviz2ì—ì„œì˜ ì‹œê°í™”ë‚˜, SLAM, ììœ¨ì£¼í–‰ ì‹œ ì´ëŠ” í° ë¬¸ì œê°€ ë©ë‹ˆë‹¤.</p>
<ul>
<li>ë”ë¶ˆì–´, tf2ê°€ ì œëŒ€ë¡œ ì—°ê²°ë˜ì–´ ìˆë”ë¼ê³  ì •í™•í•œ ì‹œê°„ê³¼ ì •í™•í•œ ì¢Œí‘œ ë³€í™˜ì„ ê°–ëŠ” ê²ƒì´ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë¼ì´ë‹¤ì˜ tfë¥¼ 180ë„ ë°˜ëŒ€ë¡œ ì„¤ì •í•´ë²„ë¦¬ë©´ í›„ë°©ì— ìˆëŠ” ì¥ì• ë¬¼ì„ ì „ë°© ì¥ì• ë¬¼ë¡œ ì˜ëª» ì¸ì‹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<p><img src="/kr/ros2_foxy/images10/Untitled6.png?height=300px" alt="Untitled6.png"></p>
<p>image from : <a href="https://answers.ros.org/question/265846/how-to-build-tf-topic-frame-tree-for-hector_slam-or-gmapping/">answers.ros.org</a></p>
<ul>
<li>ë•Œë¬¸ì— sensor topic messageë“¤ì€ ê³µí†µì ìœ¼ë¡œ tf2 ì •ë³´ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ros2 interface show sensor_msgs/msg/PointCloud2
</span></span><span style="display:flex;"><span>**std_msgs/Header header**
</span></span><span style="display:flex;"><span>uint32 height
</span></span><span style="display:flex;"><span>uint32 width
</span></span><span style="display:flex;"><span>sensor_msgs/PointField<span style="color:#f92672">[]</span> fields
</span></span><span style="display:flex;"><span>bool is_bigendian
</span></span><span style="display:flex;"><span>uint32 point_step
</span></span><span style="display:flex;"><span>uint32 row_step
</span></span><span style="display:flex;"><span>uint8<span style="color:#f92672">[]</span> data
</span></span><span style="display:flex;"><span>bool is_dense
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ ros2 interface show std_msgs/msg/Header
</span></span><span style="display:flex;"><span>uint32 seq
</span></span><span style="display:flex;"><span>time stamp
</span></span><span style="display:flex;"><span>string frame_id
</span></span></code></pre></div><p>â‡’ frame_idì™€ stampì´ ë°”ë¡œ tf2ì™€ ê´€ë ¨ëœ ë°ì´í„°ë¡œ ì´ë ‡ê²Œ ì„¼ì„œ ë°ì´í„°ë“¤ì€ ëŒ€ë¶€ë¶„ ì¢Œí‘œì™€ ì‹œê°„ì— ëŒ€í•œ ì •ë³´ë¥¼ í¬í•¨í•˜ê²Œ ë©ë‹ˆë‹¤.</p>
<p>ì´ë²ˆ ì‹œê°„ì—ëŠ” í¬ê²Œ 3ê°€ì§€ ì˜ˆì‹œë¥¼ í†µí•´ tf2ì— ëŒ€í•´ í•™ìŠµí•  ì˜ˆì •ì…ë‹ˆë‹¤.</p>
<ul>
<li>static transform â‡’ ì›€ì§ì´ì§€ ì•ŠëŠ” ì¢Œí‘œê³„</li>
<li>tf2 broadcast â‡’ tf2 ë°ì´í„°ì˜ ì†¡ì‹ </li>
<li>tf2 listen â‡’ tf2 ë°ì´í„°ì˜ ìˆ˜ì‹ </li>
</ul>

<div class="notices note" ><p>topic publishë¥¼ í•˜ëŠ”ë° ì™œ ë˜ tf2 boradcastê°€ í•„ìš”í• ê¹Œìš”?</p>
</div>

<p>â‡’ ë°”ë¡œ ìœ„ ì˜ˆì‹œì²˜ëŸ¼ topicì— ë‹´ê¸´ ì •ë³´ëŠ” ì‹¤ì œ ì¢Œí‘œë³€í™˜ì´ ì•„ë‹Œ, frame idì…ë‹ˆë‹¤. ì´ëŠ” topic dataë¥¼ ë°›ì€ subscriber node ì…ì¥ì—ì„œ ì„¼ì„œ ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ìƒí™©ì„ ìƒê°í•´ë³´ë©´ ì´í•´í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.</p>
<ol>
<li>topic sub</li>
<li>sub msgë‚´ frame id í™•ì¸</li>
<li>tf2 ë°ì´í„°ì—ì„œ í•´ë‹¹ frameì˜ ë³€í™˜ listen</li>
<li>ì´í›„ ë¡œì§ êµ¬í˜„</li>
</ol>
<p>ê·¸ëŸ¼, ì˜ˆì‹œì™€ ì½”ë“œë¥¼ í†µí•´ tf2ë¥¼ ë§ˆìŠ¤í„°í•´ë´…ì‹œë‹¤!</p>
<h3 id="static-broadcaster">static broadcaster</h3>
<h4 id="orbit-world">Orbit World</h4>
<blockquote>
<p>tf2ì˜ í•™ìŠµì„ ìœ„í•´ gazebo í™˜ê²½ì„ ë§Œë“¤ì–´ ë‘ì—ˆìŠµë‹ˆë‹¤. í•¨ê»˜ ì‹¤í–‰í•´ë´…ì‹œë‹¤.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cd <span style="color:#f92672">~/</span>ros2_ws
</span></span><span style="display:flex;"><span>cbp tf2_world <span style="color:#f92672">&amp;&amp;</span> source install<span style="color:#f92672">/</span>local_setup<span style="color:#f92672">.</span>bash
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ros2 launch tf2_world tf2_world<span style="color:#f92672">.</span>launch<span style="color:#f92672">.</span>py
</span></span></code></pre></div><blockquote>
<p>ë§ˆì¹˜ í–‰ì„±ê³¼ ìœ„ì„± ê°™ì€ í™˜ê²½ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</blockquote>
<p><img src="/kr/ros2_foxy/images10/orbit.gif?height=300px" alt="orbit.gif"></p>
<ul>
<li>í˜„ ìƒí™©ì—ì„œ tf2 treeë¥¼ ì¡°íšŒí•´ë´…ì‹œë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ros2 run tf2_tools view_frames.py
</span></span></code></pre></div><p><img src="/kr/ros2_foxy/images10/Untitled7.png?height=200px" alt="Untitled7.png"></p>

<div class="notices note" ><p>tf2 ë°ì´í„°ëŠ” ì•„ë¬´ê²ƒë„ ì—†ì§€ìš”? ì´ë²ˆ ì‹œê°„ì˜ ëª©í‘œëŠ” ìš°ë¦¬ê°€ ì§ì ‘ ì½”ë”©ê³¼ launch fileì„ í†µí•´ treeë¥¼ êµ¬ì„±í•´ ë³´ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>
</div>

<ul>
<li>launch file ì‹¤í–‰ í„°ë¯¸ë„ì„ ìì„¸íˆ ì‚´í´ë³´ë©´, ì•„ë˜ì™€ ê°™ì€ ë¬¸êµ¬ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[gzserver<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] [INFO] [<span style="color:#ae81ff">1681981785.437867364</span>] [gazebo_ros_state]: Publishing states of gazebo models at [<span style="color:#f92672">/</span>model_states]
</span></span><span style="display:flex;"><span>[gzserver<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] [INFO] [<span style="color:#ae81ff">1681981785.438120429</span>] [gazebo_ros_state]: Publishing states of gazebo links at [<span style="color:#f92672">/</span>link_states]
</span></span></code></pre></div><ul>
<li>í˜„ gazebo í™˜ê²½ì—ì„œì˜ ì¡´ì¬í•˜ëŠ” ëª¨ë“  ëª¨ë¸ì˜ stateë¥¼ /model_state topicì„ í†µí•´ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. topic monitorë¥¼ í†µí•´ ì‚´í´ë´…ì‹œë‹¤.</li>
</ul>
<p><img src="/kr/ros2_foxy/images10/Untitled8.png?height=300px" alt="Untitled8.png"></p>
<h3 id="static-transform-publisher">static transform publisher</h3>
<p><img src="/kr/ros2_foxy/images10/Untitled9.png?height=200px" alt="Untitled9.png"></p>
<ul>
<li>image from : <a href="https://theegeek.com/static-members-and-static-concept/">theegeek</a></li>
</ul>
<blockquote>
<p>ì›€ì§ì´ì§€ ì•ŠëŠ” static objectì˜ tf2 ë°ì´í„°ëŠ” static transform publisherê°€ ë‹´ë‹¹í•©ë‹ˆë‹¤. ë•ë¶„ì— ìš°ë¦¬ëŠ” êµ³ì´ ì½”ë”©ì„ í•˜ì§€ ì•Šì•„ë„ ë¯¸ë¦¬ ì¤€ë¹„ëœ nodeë¥¼ ì‹¤í–‰í•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.</p>
</blockquote>
<ul>
<li>launch fileì„ í†µí•´ static transform publisherë¥¼ ì‚¬ìš©í•´ë´…ì‹œë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    static_transform_publisher <span style="color:#f92672">=</span> Node<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>        package <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tf2_ros&#34;</span>,
</span></span><span style="display:flex;"><span>        executable <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;static_transform_publisher&#34;</span>,
</span></span><span style="display:flex;"><span>        arguments <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;0&#34;</span>, <span style="color:#e6db74">&#34;0&#34;</span>, <span style="color:#e6db74">&#34;0.5&#34;</span>, <span style="color:#e6db74">&#34;0&#34;</span>, <span style="color:#e6db74">&#34;0&#34;</span>, <span style="color:#e6db74">&#34;0&#34;</span>, <span style="color:#e6db74">&#34;world&#34;</span>, <span style="color:#e6db74">&#34;unit_sphere&#34;</span><span style="color:#f92672">]</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> LaunchDescription<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">[</span>
</span></span><span style="display:flex;"><span>            static_transform_publisher,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">)</span>
</span></span></code></pre></div><ul>
<li>argumentsì— ë“¤ì–´ê°€ëŠ” ë§¤ê°œë³€ìˆ˜ë“¤ì€ ìˆœì„œëŒ€ë¡œ (x y z roll pitch yaw parent_frame child_frame)ì´ ë©ë‹ˆë‹¤.</li>
</ul>
<p>â‡’ world frame ê¸°ì¤€ unit_sphere frameë¥¼ zì¶•ìœ¼ë¡œ 0.5ë§Œí¼ ë–¨ì–´ëœ¨ë ¤ tf2 dataê°€ ìƒì„±ë©ë‹ˆë‹¤.</p>

<div class="notices note" ><p>ë¡œë´‡ ê°œë°œìë“¤ì€ ì•”ë¬µì ìœ¼ë¡œ ëª¨ë“  ìƒí™©ì˜ ì›ì ì´ ë˜ëŠ” ì ˆëŒ€ ì¢Œí‘œê³„ë¥¼ world frameì´ë¼ê³  ì •í•©ë‹ˆë‹¤.</p>
</div>

<ul>
<li>ë‹¤ì‹œ í•œ ë²ˆ tf2 treeë¥¼ ì‚´í´ë´…ì‹œë‹¤</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ros2 run tf2_tools view_frames<span style="color:#f92672">.</span>py
</span></span></code></pre></div><p><img src="/kr/ros2_foxy/images10/Untitled10.png?height=300px" alt="Untitled10.png"></p>
<p>â‡’ world to unit_sphere tfê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!</p>
<ul>
<li>ì´ì œ rviz2 í™”ë©´ì„ í†µí•´ì„œë„ tf2ë¥¼ ì‹œê°í™” í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<p><img src="/kr/ros2_foxy/images10/Untitled11.png?height=400px" alt="Untitled11.png"></p>

<div class="notices note" ><p>ì›€ì§ì´ì§€ ì•ŠëŠ” ë¬¼ì²´ ë¿ë§Œ ì•„ë‹ˆë¼, ë¡œë´‡ ë‚´ë¶€ì—ì„œ ê³ ì •ëœ ë¶€ë¶„ì—ì„œë„ static_transform_publisherë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìì£¼ íƒˆë¶€ì°©ë˜ëŠ” ì„¼ì„œ frameì´ ëŒ€í‘œì ì¸ ì˜ˆì‹œì…ë‹ˆë‹¤.</p>
</div>

<p><img src="/kr/ros2_foxy/images10/Untitled12.png?height=300px" alt="Untitled12.png"></p>
<ul>
<li>image from : <a href="https://articulatedrobotics.xyz/ready-for-ros-6-tf/">articulatedrobotics</a></li>
</ul>
<h3 id="tf2-broadcaster--lisenter--add-frame">TF2 Broadcaster &amp; Lisenter &amp; Add frame</h3>
<blockquote>
<p>ì§€ë‚œ ê°•ì˜ì—ì„œ ê³ ì •ëœ ë¬¼ì²´ì— ëŒ€í•œ tf2 ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ë²ˆ ì‹œê°„ë¶€í„° tf2ë¥¼ ë‹¤ë£¨ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•´ ë³´ê² ìœ¼ë©°, ìµœì¢…ì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì€ ì‹œìŠ¤í…œì„ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.</p>
</blockquote>
<p><img src="/kr/ros2_foxy/images10/orbit_frame.gif?height=400px" alt="orbit_frame.gif"></p>
<h2 id="tf2-python-programming">TF2 Python Programming</h2>
<h3 id="tf2-broadcaster-python">TF2 Broadcaster (Python)</h3>
<blockquote>
<p>topicì—ì„œëŠ” publish/subscribeë¼ëŠ” ìš©ì–´ë¥¼ ì‚¬ìš©í•˜ì˜€ì§€ë§Œ tf2ì—ì„œëŠ” broadcast/listenì´ë¼ëŠ” ìš©ì–´ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. topicê³¼ tf2ëŠ” ì™„ì „ ë³„ê°œì˜ ê°œë…ì…ë‹ˆë‹¤! í˜¼ë€ë˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•˜ì„¸ìš”.</p>
</blockquote>
<ul>
<li>ìš°ì„ , ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Terminal1 - gazebo</span>
</span></span><span style="display:flex;"><span>ros2 launch tf2_world tf2_world.launch.py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal2 - tf2 broadcaster</span>
</span></span><span style="display:flex;"><span>cbp py_tf2_tutorial <span style="color:#f92672">&amp;&amp;</span> source install/local_setup.bash
</span></span><span style="display:flex;"><span>ros2 run py_tf2_tutorial tf2_broadcaster
</span></span></code></pre></div><ul>
<li>rviz2ë¥¼ í†µí•´ ì›€ì§ì´ëŠ” êµ¬ì˜ tf2ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ì´ë²ˆ ì˜ˆì œì˜ ëª©í‘œì…ë‹ˆë‹¤.</li>
</ul>
<p><img src="/kr/ros2_foxy/images10/tf2_bc.gif?height=400px" alt="tf2_bc.gif"></p>
<h3 id="ì½”ë“œ-ë¶„ì„">ì½”ë“œ ë¶„ì„</h3>
<ul>
<li>ì´ì „ ê°•ì˜ì—ì„œ gazebo ë‚´ ëª¨ë“  ë¬¼ì²´ë“¤ì˜ ì •ë³´ë¥¼ ë‹´ì€ /model_state topicì„ ì‚´í´ë³¸ ë°” ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì½”ë“œ êµ¬í˜„ì— ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì •ë³´ë¥¼ ì¡°íšŒí•´ë´…ì‹œë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ros2 interface show gazebo_msgs<span style="color:#f92672">/</span>msg<span style="color:#f92672">/</span>ModelStates
</span></span><span style="display:flex;"><span><span style="color:#75715e"># broadcast all model states in world frame</span>
</span></span><span style="display:flex;"><span>string[] name                 <span style="color:#75715e"># model names</span>
</span></span><span style="display:flex;"><span>geometry_msgs<span style="color:#f92672">/</span>Pose[] pose     <span style="color:#75715e"># desired pose in world frame</span>
</span></span><span style="display:flex;"><span>geometry_msgs<span style="color:#f92672">/</span>Twist[] twist   <span style="color:#75715e"># desired twist in world frame</span>
</span></span></code></pre></div><p>â‡’ ì´ ëª¨ì–‘ì„ ê¸°ì–µí•˜ë©´ì„œ ì½”ë“œë¡œ ì§„ì…í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<ul>
<li>ë”ë¶ˆì–´, tf2ì˜ ë°ì´í„° íƒ€ì…ì€ geometry_msgs/msg/TransformStamped ì…ë‹ˆë‹¤. â‡’ <a href="http://docs.ros.org/en/noetic/api/geometry_msgs/html/msg/TransformStamped.html">link</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ros2 interface show geometry_msgs<span style="color:#f92672">/</span>msg<span style="color:#f92672">/</span>TransformStamped
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This expresses a transform from coordinate frame header.frame_id</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># to the coordinate frame child_frame_id</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This message is mostly used by the</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tf package.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># See its documentation for more information.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Header header
</span></span><span style="display:flex;"><span>string child_frame_id <span style="color:#75715e"># the frame id of the child frame</span>
</span></span><span style="display:flex;"><span>Transform transform
</span></span></code></pre></div><ul>
<li>ì½”ë“œë¡œ ëŒì•„ì™€ import ë¶€ë¶„ì…ë‹ˆë‹¤. tf2 ë°ì´í„°ë¥¼ ë‹¤ë£¨ê¸° ìœ„í•œ íŒ¨í‚¤ì§€ì¸ tf2_ros, ModelStates ë°ì´í„° íƒ€ì…ì„ importí•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> rclpy
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rclpy.node <span style="color:#f92672">import</span> Node
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> tf2_ros <span style="color:#f92672">import</span> TransformBroadcaster
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> gazebo_msgs.msg <span style="color:#f92672">import</span> ModelStates
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> geometry_msgs.msg <span style="color:#f92672">import</span> TransformStamped
</span></span></code></pre></div><ul>
<li>ìš°ë¦¬ì˜ ëª©í‘œë¥¼ ì •ë¦¬í•´ë´…ì‹œë‹¤.</li>
</ul>
<ol>
<li>model_state topicì—ì„œ ì›€ì§ì´ëŠ” ë¬¼ì²´ì˜ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.</li>
<li>í•´ë‹¹ ë°ì´í„°ë¥¼ ì •ì œí•˜ì—¬ TF2ì˜ í˜•íƒœë¡œ ë³€í˜•í•œ ë’¤ broadcast í•©ë‹ˆë‹¤.</li>
</ol>
<p>â‡’ ë”°ë¼ì„œ topic subê³¼ tf2 broadcastê°€ í•„ìš”í•œ ìƒí™©ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OrbitBroadcaster</span>(Node):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>    super()<span style="color:#f92672">.</span>__init__(<span style="color:#e6db74">&#39;tf2_frame_broadcaster&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Initialize the transform broadcaster</span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>tf_broadcaster <span style="color:#f92672">=</span> TransformBroadcaster(self)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Subscribe to a turtle{1}{2}/pose topic and call handle_turtle_pose</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># callback function on each message</span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>m_model_state_sub <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>create_subscription(
</span></span><span style="display:flex;"><span>        ModelStates, <span style="color:#e6db74">&#34;model_states&#34;</span>, self<span style="color:#f92672">.</span>handle_turtle_pose, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    )
</span></span></code></pre></div><ul>
<li>ì½”ë“œì˜ í•µì‹¬ì€ sub callbackì— ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤. model_state msgì¤‘ ìš°ë¦¬ê°€ ì›í•˜ëŠ” animated_sphereì˜ ì •ë³´ë¥¼ íŒŒì‹±í•˜ì—¬ TransformStamped msgì— ì§‘ì–´ë„£ì€ ë’¤, broadcast í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">handle_turtle_pose</span>(self, msg):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    index <span style="color:#f92672">=</span> [i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(msg<span style="color:#f92672">.</span>name)) <span style="color:#66d9ef">if</span> msg<span style="color:#f92672">.</span>name[i] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;animated_sphere&#34;</span>][<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    t <span style="color:#f92672">=</span> TransformStamped()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Read message content and assign it to</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># corresponding tf variables</span>
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>header<span style="color:#f92672">.</span>stamp <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>get_clock()<span style="color:#f92672">.</span>now()<span style="color:#f92672">.</span>to_msg()
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>header<span style="color:#f92672">.</span>frame_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;world&#39;</span>
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>child_frame_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;animated_sphere&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>translation<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> msg<span style="color:#f92672">.</span>pose[index]<span style="color:#f92672">.</span>position<span style="color:#f92672">.</span>x
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>translation<span style="color:#f92672">.</span>y <span style="color:#f92672">=</span> msg<span style="color:#f92672">.</span>pose[index]<span style="color:#f92672">.</span>position<span style="color:#f92672">.</span>y
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>translation<span style="color:#f92672">.</span>z <span style="color:#f92672">=</span> msg<span style="color:#f92672">.</span>pose[index]<span style="color:#f92672">.</span>position<span style="color:#f92672">.</span>z
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>rotation<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> msg<span style="color:#f92672">.</span>pose[index]<span style="color:#f92672">.</span>orientation<span style="color:#f92672">.</span>x
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>rotation<span style="color:#f92672">.</span>y <span style="color:#f92672">=</span> msg<span style="color:#f92672">.</span>pose[index]<span style="color:#f92672">.</span>orientation<span style="color:#f92672">.</span>y
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>rotation<span style="color:#f92672">.</span>z <span style="color:#f92672">=</span> msg<span style="color:#f92672">.</span>pose[index]<span style="color:#f92672">.</span>orientation<span style="color:#f92672">.</span>z
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>rotation<span style="color:#f92672">.</span>w <span style="color:#f92672">=</span> msg<span style="color:#f92672">.</span>pose[index]<span style="color:#f92672">.</span>orientation<span style="color:#f92672">.</span>w
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Send the transformation</span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>tf_broadcaster<span style="color:#f92672">.</span>sendTransform(t)
</span></span></code></pre></div><ul>
<li>tf2 broadcasttë¥¼ ìœ„í•œ APIë¥¼ ì •ë¦¬í•˜ê³  ë„˜ì–´ê°‘ì‹œë‹¤. ë‹¤ì‹œ í•œ ë²ˆ ë§í•˜ì§€ë§Œ topicê³¼ í—·ê°ˆë¦¬ë©´ ì•ˆë©ë‹ˆë‹¤!</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>TransformBroadcaster()</td>
<td>broadcaster ìƒì„±</td>
</tr>
<tr>
<td>TransformStamped()</td>
<td>tf2 msg ìƒì„±</td>
</tr>
<tr>
<td>sendTransform(msg)</td>
<td>tf2 broadcast</td>
</tr>
</tbody>
</table>
<h3 id="tf2-listener-python">TF2 Listener [Python]</h3>
<ul>
<li>rqt_monitorë¥¼ í†µí•´ model_state topicì„ ì¡°íšŒí•œ ê²°ê³¼ì…ë‹ˆë‹¤. poseëŠ” ì˜ ë³´ì´ëŠ”ë°, ì†ë„ ë°ì´í„°ì¸ twistëŠ” ë¹„ì–´ìˆëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<p>â‡’ TF2 Listenerë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë¥¼ êµ¬í˜„í•´ë´…ì‹œë‹¤!</p>
<p><img src="/kr/ros2_foxy/images10/Untitled13.png?height=300px" alt="Untitled13.png"></p>
<ul>
<li>ì˜ˆì‹œ ì‹¤í–‰ â‡’ ì„ ì†ë„ì™€ ê°ì†ë„ë¥¼ ì½˜ì†”ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Terminal1 - gazebo</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ros2 launch tf2_world tf2_world<span style="color:#f92672">.</span>launch<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal2 - tf2 broadcaster</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ros2 run py_tf2_tutorial tf2_broadcast
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal3 - tf2 listener</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ros2 run py_tf2_tutorial tf2_listener
</span></span><span style="display:flex;"><span>[INFO] [<span style="color:#ae81ff">1681998128.822169076</span>] [tf2_frame_listener]: linear vel : <span style="color:#ae81ff">2.542703</span>, angular vel : <span style="color:#ae81ff">1.810120</span>
</span></span><span style="display:flex;"><span>[INFO] [<span style="color:#ae81ff">1681998128.922124745</span>] [tf2_frame_listener]: linear vel : <span style="color:#ae81ff">2.501199</span>, angular vel : <span style="color:#ae81ff">1.610775</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span></code></pre></div><ul>
<li>ì½”ë“œì˜ import ë¶€ë¶„ì…ë‹ˆë‹¤. tf2 listenì„ ìœ„í•´ TransformListenerì™€ Bufferë¥¼ importí•˜ê³  ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> math
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> geometry_msgs.msg <span style="color:#f92672">import</span> Twist
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> rclpy
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rclpy.node <span style="color:#f92672">import</span> Node
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> tf2_ros <span style="color:#f92672">import</span> TransformException
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> tf2_ros.buffer <span style="color:#f92672">import</span> Buffer
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> tf2_ros.transform_listener <span style="color:#f92672">import</span> TransformListener
</span></span></code></pre></div><ul>
<li>í˜„ì¬ ìš°ë¦¬ê°€ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ì‘ì—…ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</li>
</ul>
<ol>
<li>tf2 ë°ì´í„° listen â‡’ ì´ë¥¼ í†µí•´ ì›€ì§ì´ëŠ” ë¬¼ì²´ì˜ ì¢Œí‘œ ë³€í™”ë¥¼ ê°ì§€í•©ë‹ˆë‹¤.</li>
<li>ì†ë„ ê³„ì‚° â‡’ ìœ„ì¹˜ë¥¼ í†µí•´ ì„ ì†ë„ì™€ ê°ì†ë„ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.</li>
<li>topic publish</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TF2Listener</span>(Node):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>    super()<span style="color:#f92672">.</span>__init__(<span style="color:#e6db74">&#39;tf2_frame_listener&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>tf_buffer <span style="color:#f92672">=</span> Buffer()
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>tf_listener <span style="color:#f92672">=</span> TransformListener(self<span style="color:#f92672">.</span>tf_buffer, self)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Create turtle2 velocity publisher</span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>publisher <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>create_publisher(Twist, <span style="color:#e6db74">&#39;sphere_vel&#39;</span>, <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Call timer_cb function every 10 seconds</span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>timer <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>create_timer(<span style="color:#ae81ff">0.1</span>, self<span style="color:#f92672">.</span>timer_cb)
</span></span></code></pre></div><p>â‡’ TransformListenerì˜ ìƒì„± ì´í›„, ëª¨ë“  tf2ì˜ listenì„ ì‹œì‘í•˜ë©´ ì´ë¥¼ Bufferì— ë‹´ì•„ë‘ëŠ” ì‹ì…ë‹ˆë‹¤.</p>
<p>â‡’ ì£¼ê¸°ì ìœ¼ë¡œ listen, publishë¥¼ ìœ„í•´ timerë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<p>ë‹¤ìŒìœ¼ë¡œ, timer_cb í•¨ìˆ˜ë¥¼ ëœ¯ì–´ë´…ì‹œë‹¤.</p>
<ul>
<li>tf2 listenì„ ìœ„í•´ lookup_transformì´ë¼ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©° 3ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤.
<ol>
<li><strong>Target frame</strong></li>
<li><strong>Source frame</strong></li>
<li><strong>time</strong></li>
</ol>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    from_frame_rel <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;animated_sphere&#39;</span>
</span></span><span style="display:flex;"><span>    to_frame_rel <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;world&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>tf_buffer<span style="color:#f92672">.</span>lookup_transform(
</span></span><span style="display:flex;"><span>            from_frame_rel, to_frame_rel, rclpy<span style="color:#f92672">.</span>time<span style="color:#f92672">.</span>Time())
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> TransformException <span style="color:#66d9ef">as</span> ex:
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>get_logger()<span style="color:#f92672">.</span>info(
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Could not transform </span><span style="color:#e6db74">{</span>to_frame_rel<span style="color:#e6db74">}</span><span style="color:#e6db74"> to </span><span style="color:#e6db74">{</span>from_frame_rel<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>ex<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span></code></pre></div><ul>
<li>tf2 ë°ì´í„°ì—ì„œ ìš°ë¦¬ê°€ ì›í•˜ëŠ” ì†ë„ë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ ê°„ë‹¨í•œ ì—°ì‚°ì„ ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    msg <span style="color:#f92672">=</span> Twist()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    scale_rotation_rate <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.0</span>
</span></span><span style="display:flex;"><span>    msg<span style="color:#f92672">.</span>angular<span style="color:#f92672">.</span>z <span style="color:#f92672">=</span> scale_rotation_rate <span style="color:#f92672">*</span> math<span style="color:#f92672">.</span>atan2(
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>translation<span style="color:#f92672">.</span>y,
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>translation<span style="color:#f92672">.</span>x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    scale_forward_speed <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span>    msg<span style="color:#f92672">.</span>linear<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> scale_forward_speed <span style="color:#f92672">*</span> math<span style="color:#f92672">.</span>sqrt(
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>translation<span style="color:#f92672">.</span>x <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>translation<span style="color:#f92672">.</span>y <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>)
</span></span></code></pre></div><ul>
<li>ìµœì¢… ì™„ì„±ëœ Twist msgë¥¼ publish í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>get_logger()<span style="color:#f92672">.</span>info(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;linear_vel: </span><span style="color:#e6db74">{</span>msg<span style="color:#f92672">.</span>linear<span style="color:#f92672">.</span>x<span style="color:#e6db74">}</span><span style="color:#e6db74">, angular_vel: </span><span style="color:#e6db74">{</span>msg<span style="color:#f92672">.</span>angular<span style="color:#f92672">.</span>z<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>publisher<span style="color:#f92672">.</span>publish(msg)
</span></span></code></pre></div><p>â‡’ í˜„ì¬ ì˜ˆì‹œì´ë¯€ë¡œ ì •í™•í•œ 3ì°¨ì› ì†ë„ë¥¼ ê³„ì‚°í•˜ì§€ëŠ” ì•Šì•˜ì§€ë§Œ, gazeboì˜ model_state ë°ì´í„°ì— ê¸°ë°˜í•˜ì—¬ í™˜ê²½ì˜ ground_truthë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<h3 id="tf2-add-frame-python">TF2 Add Frame (Python)</h3>
<ul>
<li>tf2 êµ¬í˜„ì˜ ë§ˆì§€ë§‰ ì˜ˆì‹œì…ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Terminal1 - gazebo</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ros2 launch tf2_world tf2_world<span style="color:#f92672">.</span>launch<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal2 - tf2 broadcaster</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ros2 run py_tf2_tutorial tf2_broadcast
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal3 - tf2 add frame</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ros2 run py_tf2_tutorial tf2_add_frame
</span></span></code></pre></div><ul>
<li>animated_sphereì˜ ì£¼ìœ„ë¥¼ ìœ„ì„±ì²˜ëŸ¼ ê¶¤ë„ ìš´ë™í•˜ëŠ” ìƒˆë¡œìš´ frameì´ ë³´ì…ë‹ˆë‹¤.</li>
</ul>
<p><img src="/kr/ros2_foxy/images10/orbit_frame.gif?height=400px" alt="orbit_frame.gif"></p>
<p>â‡’ ì´ë²ˆ ì˜ˆì‹œëŠ” ìƒˆë¡œìš´ dynamic frameì„ ì¶”ê°€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì¼ì „ ì •ì  frameì€ ì¼ì „ launch fileì—ì„œ static_transform_publisherë¥¼ ì‚¬ìš©í•˜ì˜€ì§€ìš”? dynamics frameì€ ì½”ë“œë¡œ êµ¬í˜„í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<ul>
<li>tf2 ë°ì´í„°ë¥¼ broadcastí•´ì•¼ í•˜ëŠ” ê²ƒì€ ì¼ì „ ì˜ˆì‹œì™€ ë™ì¼í•©ë‹ˆë‹¤. ë”°ë¼ì„œ importì™€ ìƒì„±ì ë¶€ë¶„ì— ëŒ€í•œ ì„¤ëª…ì€ ìƒëµí•˜ê² ìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> rclpy
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rclpy.node <span style="color:#f92672">import</span> Node
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> tf2_ros <span style="color:#f92672">import</span> TransformBroadcaster
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> geometry_msgs.msg <span style="color:#f92672">import</span> TransformStamped
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">InverOrbitFrame</span>(Node):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>      super()<span style="color:#f92672">.</span>__init__(<span style="color:#e6db74">&#39;inverse_orbit_frame_tf2_broadcaster&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      self<span style="color:#f92672">.</span>count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>      self<span style="color:#f92672">.</span>freq_factor <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>pi <span style="color:#f92672">/</span> <span style="color:#ae81ff">20</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      self<span style="color:#f92672">.</span>tf_broadcaster <span style="color:#f92672">=</span> TransformBroadcaster(self)
</span></span><span style="display:flex;"><span>      self<span style="color:#f92672">.</span>timer <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>create_timer(<span style="color:#ae81ff">0.1</span>, self<span style="color:#f92672">.</span>broadcast_timer_callback)
</span></span></code></pre></div><ul>
<li>timerì— ì˜í•´ ë°˜ë³µ ì‹¤í–‰ë˜ëŠ” callback í•¨ìˆ˜ë¥¼ ì‚´í´ë´…ì‹œë‹¤.</li>
</ul>
<p>â‡’ animated_sphereì„ ê¸°ì¤€ìœ¼ë¡œ ì› ìš´ë™ì„ í•˜ëŠ” ìƒˆë¡œìš´ frameì„ ë§Œë“œëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤. ë”°ë¼ì„œ (cos(theta), sin(theta))ì˜ ì¢Œí‘œë¥¼ ê°–ëŠ” tf2 dataë¥¼ êµ¬ì¶•í•˜ê³  ì´ë¥¼ ì‹œê°„ì— ë”°ë¼ broadcast í•˜ì˜€ìŠµë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">broadcast_timer_callback</span>(self):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   t <span style="color:#f92672">=</span> TransformStamped()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   t<span style="color:#f92672">.</span>header<span style="color:#f92672">.</span>stamp <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>get_clock()<span style="color:#f92672">.</span>now()<span style="color:#f92672">.</span>to_msg()
</span></span><span style="display:flex;"><span>   t<span style="color:#f92672">.</span>header<span style="color:#f92672">.</span>frame_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;animated_sphere&#39;</span>
</span></span><span style="display:flex;"><span>   t<span style="color:#f92672">.</span>child_frame_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;inverse_orbit_frame&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>translation<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cos(<span style="color:#f92672">-</span>self<span style="color:#f92672">.</span>count <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>freq_factor)
</span></span><span style="display:flex;"><span>   t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>translation<span style="color:#f92672">.</span>y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sin(<span style="color:#f92672">-</span>self<span style="color:#f92672">.</span>count <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>freq_factor)
</span></span><span style="display:flex;"><span>   t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>translation<span style="color:#f92672">.</span>z <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>rotation<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>   t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>rotation<span style="color:#f92672">.</span>y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>   t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>rotation<span style="color:#f92672">.</span>z <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>   t<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>rotation<span style="color:#f92672">.</span>w <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   self<span style="color:#f92672">.</span>tf_broadcaster<span style="color:#f92672">.</span>sendTransform(t)
</span></span><span style="display:flex;"><span>   self<span style="color:#f92672">.</span>count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>count <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">20</span>:
</span></span><span style="display:flex;"><span>       self<span style="color:#f92672">.</span>count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><h3 id="tf2-c-programming">TF2 C++ Programming</h3>
<h4 id="tf2-broadcaster-c">TF2 Broadcaster (C++)</h4>
<blockquote>
<p>ì‹¤ì œ ê°œë°œì—ì„œ tf2 ë°ì´í„°ëŠ” ì‹¤ì‹œê°„ì„±ì´ ë¬´ì²™ ì¤‘ìš”í•œ ì¢Œí‘œë³€í™˜ì„ ë‹¤ë£¨ë¯€ë¡œ, c++ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ë¹„ì¤‘ì´ ë” í½ë‹ˆë‹¤. ë”°ë¼ì„œ, ìš°ì„  ëª¨ë“  ì˜ˆì‹œë¥¼ ì‚´í´ë³´ê³  ì„¼ì„œ íŒ¨í‚¤ì§€ì— ê¸°ë°˜í•˜ì—¬ ì‹¤ ì‚¬ìš© ì‚¬ë¡€ë„ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
</blockquote>
<ul>
<li>ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Terminal1 - gazebo</span>
</span></span><span style="display:flex;"><span>ros2 launch tf2_world tf2_world.launch.py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal2 - tf2 broadcaster</span>
</span></span><span style="display:flex;"><span>ros2 run cpp_tf2_tutorial tf2_broadcaster
</span></span></code></pre></div><ul>
<li>rviz2ë¥¼ í†µí•´ ì›€ì§ì´ëŠ” êµ¬ì˜ tf2ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<p><img src="/kr/ros2_foxy/images10/tf2_bc.gif?height=400px" alt="tf2_bc.gif"></p>
<h3 id="ì½”ë“œ-ë¶„ì„-1">ì½”ë“œ ë¶„ì„</h3>
<ul>
<li>ì½”ë“œë¡œ ëŒì•„ì™€ include ë¶€ë¶„ì…ë‹ˆë‹¤. tf2 ë°ì´í„°ë¥¼ ë‹¤ë£¨ê¸° ìœ„í•œ íŒ¨í‚¤ì§€ì¸ tf2_ros, ModelStates ë°ì´í„° íƒ€ì…ì„ importí•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;rclcpp/rclcpp.hpp&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;tf2/LinearMath/Quaternion.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;tf2_ros/transform_broadcaster.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;gazebo_msgs/msg/model_states.hpp&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;geometry_msgs/msg/transform_stamped.hpp&#34;</span><span style="color:#75715e">
</span></span></span></code></pre></div><ul>
<li>tf_broadcasterë¥¼ ì´ˆê¸°í™”í•˜ëŠ” ì½”ë“œ APIì—ì„œ unique_ptrì´ ì‚¬ìš©ë©ë‹ˆë‹¤. ê°œë°œìì˜ ì‹¤ìˆ˜ë¡œ tf2_broadcasterê°€ ì—¬ëŸ¬ê°œ ìƒê¸¸ ì‹œ ì´ë¥¼ ë””ë²„ê¹…í•˜ê¸° í˜ë“¤ì–´ ì‚¬ì „ì— ë°©ì§€í•œ ê²½ìš°ì…ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OrbitBroadcaster</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> rclcpp<span style="color:#f92672">::</span>Node
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  rclcpp<span style="color:#f92672">::</span>Subscription<span style="color:#f92672">&lt;</span>ModelStates<span style="color:#f92672">&gt;::</span>SharedPtr m_model_state_sub;
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>tf2_ros<span style="color:#f92672">::</span>TransformBroadcaster<span style="color:#f92672">&gt;</span> m_tf_broadcaster;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  OrbitBroadcaster() <span style="color:#f92672">:</span> Node(<span style="color:#e6db74">&#34;tf2_frame_broadcaster&#34;</span>){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    m_model_state_sub <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>create_subscription<span style="color:#f92672">&lt;</span>ModelStates<span style="color:#f92672">&gt;</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;model_states&#34;</span>, <span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>      std<span style="color:#f92672">::</span>bind(<span style="color:#f92672">&amp;</span>OrbitBroadcaster<span style="color:#f92672">::</span>model_state_sub_cb, <span style="color:#66d9ef">this</span>, std<span style="color:#f92672">::</span>placeholders<span style="color:#f92672">::</span>_1)
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Initialize the transform broadcaster
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    m_tf_broadcaster <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>      std<span style="color:#f92672">::</span>make_unique<span style="color:#f92672">&lt;</span>tf2_ros<span style="color:#f92672">::</span>TransformBroadcaster<span style="color:#f92672">&gt;</span>(<span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><ul>
<li>model_states íƒ€ì…ì€ 3ê°œì˜ std::vectorë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ìš°ë¦¬ê°€ ì›í•˜ëŠ” ê°’, animated_sphereì˜ indexë¥¼ ë¨¼ì € ì•Œì•„ë‚¸ ë’¤, pose ë°ì´í„°ë¥¼ íŒŒì‹±í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> model_state_sub_cb(<span style="color:#66d9ef">const</span> ModelStates<span style="color:#f92672">::</span>ConstSharedPtr msg)
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    geometry_msgs<span style="color:#f92672">::</span>msg<span style="color:#f92672">::</span>TransformStamped t;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>string model_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;animated_sphere&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> it <span style="color:#f92672">=</span> find(msg<span style="color:#f92672">-&gt;</span>name.begin(), msg<span style="color:#f92672">-&gt;</span>name.end(), model_name);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> index <span style="color:#f92672">=</span> it <span style="color:#f92672">-</span> msg<span style="color:#f92672">-&gt;</span>name.begin();
</span></span></code></pre></div><ul>
<li>ì´ë²ˆ ì½”ë“œì—ì„œ ë‹¤ë£¨ì§€ëŠ” ì•Šì§€ë§Œ, tf2ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì˜¤ì¼ëŸ¬ ê°ë„ ì²´ê³„ê°€ ì•„ë‹Œ ì¿¼í„°ë‹ˆì–¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì˜¤ì¼ëŸ¬ ê°ë„ â‡’ ì¿¼í„°ë‹ˆì–¸ì˜ ë³€í™˜ê³¼ ê°™ì€ APIëŠ” tf2 íŒ¨í‚¤ì§€ì— êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;tf2/LinearMath/Quaternion.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// tf2::Quaternion q;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// q.setRPY(0, 0, msg-&gt;theta);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    t.transform.rotation.x <span style="color:#f92672">=</span> msg<span style="color:#f92672">-&gt;</span>pose[index].orientation.x;
</span></span><span style="display:flex;"><span>    t.transform.rotation.y <span style="color:#f92672">=</span> msg<span style="color:#f92672">-&gt;</span>pose[index].orientation.y;
</span></span><span style="display:flex;"><span>    t.transform.rotation.z <span style="color:#f92672">=</span> msg<span style="color:#f92672">-&gt;</span>pose[index].orientation.z;
</span></span><span style="display:flex;"><span>    t.transform.rotation.w <span style="color:#f92672">=</span> msg<span style="color:#f92672">-&gt;</span>pose[index].orientation.w;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Send the transformation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    m_tf_broadcaster<span style="color:#f92672">-&gt;</span>sendTransform(t);
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><ul>
<li>cpp ì½”ë“œì¸ë§Œí¼ CMakeLists.txtë„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>find_package(tf2 REQUIRED)
</span></span><span style="display:flex;"><span>find_package(tf2_ros REQUIRED)
</span></span><span style="display:flex;"><span>find_package(gazebo_msgs REQUIRED)
</span></span><span style="display:flex;"><span>find_package(geometry_msgs REQUIRED)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>add_executable(tf2_broadcast src<span style="color:#f92672">/</span>tf2_broadcast<span style="color:#f92672">.</span>cpp)
</span></span><span style="display:flex;"><span>ament_target_dependencies(tf2_broadcast tf2 tf2_ros gazebo_msgs geometry_msgs)
</span></span></code></pre></div><ul>
<li>tf2 broadcastë¥¼ ìœ„í•œ APIë¥¼ ì •ë¦¬í•˜ê³  ë„˜ì–´ê°‘ì‹œë‹¤.</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>std::make_unique&lt;tf2_ros::TransformBroadcaster&gt;</td>
<td>broadcaster ìƒì„±</td>
</tr>
<tr>
<td>geometry_msgs::msg::TransformStamped</td>
<td>tf2 msg ìƒì„±</td>
</tr>
<tr>
<td>tf_broadcaster-&gt;sendTransform(t)</td>
<td>tf2 broadcast</td>
</tr>
</tbody>
</table>
<h3 id="tf2-listener-c">TF2 Listener (C++)</h3>
<ul>
<li>animated_sphereì˜ tf2 listenì„ í†µí•´ ì†ë„ topicì„ publishí•˜ëŠ” ì˜ˆì‹œì˜€ìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Terminal1 - gazebo</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ros2 launch tf2_world tf2_world<span style="color:#f92672">.</span>launch<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal2 - tf2 broadcaster</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ros2 run py_tf2_tutorial tf2_broadcast
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal3 - tf2 listener</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ros2 run py_tf2_tutorial tf2_listener
</span></span><span style="display:flex;"><span>[INFO] [<span style="color:#ae81ff">1681998128.822169076</span>] [tf2_frame_listener]: linear vel : <span style="color:#ae81ff">2.542703</span>, angular vel : <span style="color:#ae81ff">1.810120</span>
</span></span><span style="display:flex;"><span>[INFO] [<span style="color:#ae81ff">1681998128.922124745</span>] [tf2_frame_listener]: linear vel : <span style="color:#ae81ff">2.501199</span>, angular vel : <span style="color:#ae81ff">1.610775</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span></code></pre></div><ul>
<li>ì½”ë“œì˜ include ë¶€ë¶„ì…ë‹ˆë‹¤. tf2 listenì„ ìœ„í•´ tf2_ros/transform_listener.hë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;rclcpp/rclcpp.hpp&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;tf2/exceptions.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;tf2_ros/transform_listener.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;tf2_ros/buffer.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;geometry_msgs/msg/twist.hpp&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;geometry_msgs/msg/transform_stamped.hpp&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std<span style="color:#f92672">::</span>chrono_literals;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> Twist <span style="color:#f92672">=</span> geometry_msgs<span style="color:#f92672">::</span>msg<span style="color:#f92672">::</span>Twist;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> TransformStamped <span style="color:#f92672">=</span> geometry_msgs<span style="color:#f92672">::</span>msg<span style="color:#f92672">::</span>TransformStamped;
</span></span></code></pre></div><ul>
<li>listenerì˜ ìƒì„± ì‹œ Bufferê°€ í•„ìš”í•œ ë¶€ë¶„ë„ ë™ì¼í•˜ë©°, ëŒ€ì‹ , bufferê°€ unique_ptr íƒ€ì…ì„ ì·¨í•˜ê³  ìˆì–´ pointerê°€ ì•„ë‹Œ valueë¥¼ ì „ë‹¬í•¨ì— ìœ ì˜í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  TF2Listener()<span style="color:#f92672">:</span> Node(<span style="color:#e6db74">&#34;tf2_frame_listener&#34;</span>){
</span></span><span style="display:flex;"><span>    m_tf_buffer <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>make_unique<span style="color:#f92672">&lt;</span>tf2_ros<span style="color:#f92672">::</span>Buffer<span style="color:#f92672">&gt;</span>(<span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>get_clock());
</span></span><span style="display:flex;"><span>    m_tf_listener <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>make_shared<span style="color:#f92672">&lt;</span>tf2_ros<span style="color:#f92672">::</span>TransformListener<span style="color:#f92672">&gt;</span>(<span style="color:#f92672">*</span>m_tf_buffer);
</span></span></code></pre></div><ul>
<li>pythonê³¼ ë™ì¼í•˜ê²Œ lookupTransformì€ 3ê°€ì§€ ë§¤ê°œë³€ìˆ˜ë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤.
<ol>
<li>Target frame</li>
<li>Source frame</li>
<li>time</li>
</ol>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">timer_cb</span>(){
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Store frame names in variables that will be used to
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// compute transformations
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  TransformStamped t;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>    t <span style="color:#f92672">=</span> m_tf_buffer<span style="color:#f92672">-&gt;</span>lookupTransform(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;animated_sphere&#34;</span>, <span style="color:#e6db74">&#34;world&#34;</span>, tf2<span style="color:#f92672">::</span>TimePointZero
</span></span><span style="display:flex;"><span>    );
</span></span></code></pre></div><h3 id="tf2-add-frame-c">TF2 Add Frame (C++)</h3>
<ul>
<li>tf2 êµ¬í˜„ì˜ ë§ˆì§€ë§‰ ì˜ˆì‹œì…ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Terminal1 - gazebo</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ros2 launch tf2_world tf2_world<span style="color:#f92672">.</span>launch<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal2 - tf2 broadcaster</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ros2 run cpp_tf2_tutorial tf2_broadcast
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal3 - tf2 add frame</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ros2 run cpp_tf2_tutorial tf2_add_frame
</span></span></code></pre></div><p><img src="/kr/ros2_foxy/images10/orbit_frame.gif?height=300px" alt="orbit_frame.gif"></p>
<p>â‡’ tf2 broadcasterì™€ í° ì°¨ì´ê°€ ì—†ìœ¼ë¯€ë¡œ, êµ¬ì²´ì ì¸ ì„¤ëª…ì€ ìƒëµí•˜ê² ìŠµë‹ˆë‹¤.</p>
<h2 id="tf2-example">TF2 Example</h2>
<p>ì´ë²ˆ ì‹œê°„ì—ëŠ” ì‹¤ì œ ì„¼ì„œ ë°ì´í„° ROS 2 íŒ¨í‚¤ì§€ì—ì„œ tf2ê°€ ì‚¬ìš©ëœ ëª¨ìŠµì„ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p><img src="/kr/ros2_foxy/images10/Untitled14.png?height=300px" alt="Untitled14.png"></p>
<p>ë‘ ì„¼ì„œ íŒ¨í‚¤ì§€ë¥¼ ì°¸ê³ í•´ë³´ë ¤ í•©ë‹ˆë‹¤.</p>
<ol>
<li><a href="https://github.com/IntelRealSense/realsense-ros/tree/f18ca43483f216a02d1f1ea010ad52c9999e6c97">intel realsense ros2 package</a></li>
<li><a href="https://github.com/CLOBOT-Co-Ltd/myahrs_ros2_driver/tree/master">my ahrs imu package</a></li>
</ol>
<ul>
<li>ìš°ì„ , my ahrs ì½”ë“œì…ë‹ˆë‹¤. publish<em>tf</em>ë¼ëŠ” ë§¤ê°œë³€ìˆ˜ì— ë”°ë¼ tf2 ë°ì´í„°ì˜ broadcast ì—¬ë¶€ê°€ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ì´ë ‡ê²Œ í•´ë‘” ì´ìœ ëŠ”, ì„¼ì„œ ìì²´ë¥¼ í†µí•œ ê°œë°œ ì‹œì—ëŠ” tf2ì˜ ì‚¬ìš©ì´ í•„ìš” ì—†ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">// publish tf
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (publish_tf_) {
</span></span><span style="display:flex;"><span>  geometry_msgs<span style="color:#f92672">::</span>msg<span style="color:#f92672">::</span>TransformStamped tf;
</span></span><span style="display:flex;"><span>  tf.header.stamp <span style="color:#f92672">=</span> now;
</span></span><span style="display:flex;"><span>  tf.header.frame_id <span style="color:#f92672">=</span> parent_frame_id_;
</span></span><span style="display:flex;"><span>  tf.child_frame_id <span style="color:#f92672">=</span> frame_id_;
</span></span><span style="display:flex;"><span>  tf.transform.translation.x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>;
</span></span><span style="display:flex;"><span>  tf.transform.translation.y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>;
</span></span><span style="display:flex;"><span>  tf.transform.translation.z <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>;
</span></span><span style="display:flex;"><span>  tf.transform.rotation <span style="color:#f92672">=</span> imu_data_msg.orientation;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  broadcaster_<span style="color:#f92672">-&gt;</span>sendTransform(tf);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>â‡’ <a href="https://github.com/CLOBOT-Co-Ltd/myahrs_ros2_driver/blob/d6a48f5121984aaa5ab850960eb363134c5f3ac9/myahrs_ros2_driver/src/myahrs_ros2_driver.cpp#L199">link1</a></p>
<ul>
<li>ë‹¤ìŒìœ¼ë¡œ, realsense-ros íŒ¨í‚¤ì§€ì…ë‹ˆë‹¤. ì´ë²ˆì—ë„ ë§ˆì°¬ê°€ì§€ë¡œ, ìƒí™©ì— ë”°ë¼ statics tf / odom tfë¥¼ êµ¬ë³„í•˜ì—¬ êµ¬í˜„í•´ë‘” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> BaseRealSenseNode<span style="color:#f92672">::</span>publish_static_tf(<span style="color:#66d9ef">const</span> rclcpp<span style="color:#f92672">::</span>Time<span style="color:#f92672">&amp;</span> t,
</span></span><span style="display:flex;"><span>                                          <span style="color:#66d9ef">const</span> float3<span style="color:#f92672">&amp;</span> trans,
</span></span><span style="display:flex;"><span>                                          <span style="color:#66d9ef">const</span> tf2<span style="color:#f92672">::</span>Quaternion<span style="color:#f92672">&amp;</span> q,
</span></span><span style="display:flex;"><span>                                          <span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> from,
</span></span><span style="display:flex;"><span>                                          <span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> to)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    geometry_msgs<span style="color:#f92672">::</span>msg<span style="color:#f92672">::</span>TransformStamped msg;
</span></span><span style="display:flex;"><span>    msg.header.stamp <span style="color:#f92672">=</span> t;
</span></span><span style="display:flex;"><span>    msg.header.frame_id <span style="color:#f92672">=</span> from;
</span></span><span style="display:flex;"><span>    msg.child_frame_id <span style="color:#f92672">=</span> to;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Convert x,y,z (taken from camera extrinsics)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// from optical cooridnates to ros coordinates
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    msg.transform.translation.x <span style="color:#f92672">=</span> trans.z;
</span></span><span style="display:flex;"><span>    msg.transform.translation.y <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>trans.x;
</span></span><span style="display:flex;"><span>    msg.transform.translation.z <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>trans.y;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    msg.transform.rotation.x <span style="color:#f92672">=</span> q.getX();
</span></span><span style="display:flex;"><span>    msg.transform.rotation.y <span style="color:#f92672">=</span> q.getY();
</span></span><span style="display:flex;"><span>    msg.transform.rotation.z <span style="color:#f92672">=</span> q.getZ();
</span></span><span style="display:flex;"><span>    msg.transform.rotation.w <span style="color:#f92672">=</span> q.getW();
</span></span><span style="display:flex;"><span>    _static_tf_msgs.push_back(msg);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> BaseRealSenseNode<span style="color:#f92672">::</span>publishStaticTransforms(std<span style="color:#f92672">::</span>vector<span style="color:#f92672">&lt;</span>rs2<span style="color:#f92672">::</span>stream_profile<span style="color:#f92672">&gt;</span> profiles)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Publish static transforms
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (_publish_tf)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> <span style="color:#f92672">&amp;</span>profile : profiles)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            calcAndPublishStaticTransform(profile, _base_profile);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (_static_tf_broadcaster)
</span></span><span style="display:flex;"><span>            _static_tf_broadcaster<span style="color:#f92672">-&gt;</span>sendTransform(_static_tf_msgs);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> BaseRealSenseNode<span style="color:#f92672">::</span>pose_callback(rs2<span style="color:#f92672">::</span>frame frame)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    geometry_msgs<span style="color:#f92672">::</span>msg<span style="color:#f92672">::</span>PoseStamped pose_msg;
</span></span><span style="display:flex;"><span>    pose_msg.pose.position.x <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>pose.translation.z;
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> tf2_ros<span style="color:#f92672">::</span>TransformBroadcaster br(_node);
</span></span><span style="display:flex;"><span>    geometry_msgs<span style="color:#f92672">::</span>msg<span style="color:#f92672">::</span>TransformStamped msg;
</span></span><span style="display:flex;"><span>    msg.header.stamp <span style="color:#f92672">=</span> t;
</span></span><span style="display:flex;"><span>    msg.header.frame_id <span style="color:#f92672">=</span> DEFAULT_ODOM_FRAME_ID;
</span></span><span style="display:flex;"><span>    msg.child_frame_id <span style="color:#f92672">=</span> FRAME_ID(POSE);
</span></span><span style="display:flex;"><span>    msg.transform.translation.x <span style="color:#f92672">=</span> pose_msg.pose.position.x;
</span></span><span style="display:flex;"><span>    msg.transform.translation.y <span style="color:#f92672">=</span> pose_msg.pose.position.y;
</span></span><span style="display:flex;"><span>    msg.transform.translation.z <span style="color:#f92672">=</span> pose_msg.pose.position.z;
</span></span><span style="display:flex;"><span>    msg.transform.rotation.x <span style="color:#f92672">=</span> pose_msg.pose.orientation.x;
</span></span><span style="display:flex;"><span>    msg.transform.rotation.y <span style="color:#f92672">=</span> pose_msg.pose.orientation.y;
</span></span><span style="display:flex;"><span>    msg.transform.rotation.z <span style="color:#f92672">=</span> pose_msg.pose.orientation.z;
</span></span><span style="display:flex;"><span>    msg.transform.rotation.w <span style="color:#f92672">=</span> pose_msg.pose.orientation.w;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (_publish_odom_tf) br.sendTransform(msg);
</span></span></code></pre></div><p>â‡’ <a href="https://github.com/IntelRealSense/realsense-ros/blob/f18ca43483f216a02d1f1ea010ad52c9999e6c97/realsense2_camera/src/base_realsense_node.cpp#L994">ì°¸ê³  ë§í¬ 1</a></p>
<p>â‡’ <a href="https://github.com/IntelRealSense/realsense-ros/blob/f18ca43483f216a02d1f1ea010ad52c9999e6c97/realsense2_camera/src/base_realsense_node.cpp#L511">ì°¸ê³  ë§í¬ 2</a></p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/kr/ros2_foxy/lecture9/" title="Lecture9. ROS 2 Action Programming"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/kr/ros2_foxy/lecture11/" title="Lecture11. About Gazebo - 1" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1689941542"></script>
    <script src="/js/perfect-scrollbar.min.js?1689941542"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1689941542"></script>
    <script src="/js/jquery.sticky.js?1689941542"></script>
    <script src="/js/featherlight.min.js?1689941542"></script>
    <script src="/js/highlight.pack.js?1689941542"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1689941542"></script>
    <script src="/js/learn.js?1689941542"></script>
    <script src="/js/hugo-learn.js?1689941542"></script>
    
        
            <script src="https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

