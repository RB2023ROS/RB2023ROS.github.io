[
{
	"uri": "/kr/ros_basic_noetic/",
	"title": "ROS Basics",
	"tags": [],
	"description": "",
	"content": "\nLecture1. Lecture1 - Introduction to ROS Lecture2. Dev Env Setup Lecture3. Core of ROS Lecture4. ROS Launch, RViz Lecture5. First Programming, ROS Topic Lecture6. ROS Service, Parameter Lecture7. Rqt Tools and rosbag, ROS Time Lecture8. Deal with Open Source Projects, Custom Interfaces Lecture9. ROS TF and Examples Lecture10. TF2 Examples, Outro "
},
{
	"uri": "/kr/advanced_contents_ros1/",
	"title": "ROS",
	"tags": [],
	"description": "",
	"content": "\nLecture1 - ROSCPP Lecture2 - More About ROS System Lecture2 - SROS "
},
{
	"uri": "/kr/ros2_basic_foxy/",
	"title": "ROS 2 Basics",
	"tags": [],
	"description": "",
	"content": "\nLecture1. Lecture1 - Introduction to ROS 2 Lecture2. ROS 2 Node, Package Lecture3. ROS 2 Node Programming, ROS 2 Parameter Lecture4. ROS 2 Node C++ Programming Lecture5. ROS 2 Topic and Examples Lecture6. ROS 2 Service and Examples Lecture7. Useful ROS 2 Examples, Nav2 Lecture8. ROS 2 Action and Examples Lecture9. C++ Programming Again, Outro "
},
{
	"uri": "/kr/ros2_foxy/",
	"title": "ROS 2 Basics",
	"tags": [],
	"description": "",
	"content": "\nLecture1. What is ROS? Lecture2. Dev Env Setup Lecture3. Core of ROS Lecture4. ROS 2 Node and Parameter Programming Lecture5. ROS 2 Communication Mechanisms Lecture6. ROS 2 Tools Lecture7. ROS 2 Topic and Programming Lecture8. ROS 2 Service and Programming Lecture9. ROS 2 Action Programming Lecture10. TF2 and ROS 2 Lecture11. About Gazebo - 1 Lecture12. About Gazebo - 2 Lecture13. Useful ROS 2 Examples (Sensor Part) Lecture14. Useful ROS 2 Examples (Control Part) Lecture15. Advanced ROS 2, Package Management Lecture16. Useful ROS 2 Examples (Misc) Lecture17. Real Hardware Examples Lecture18. Point Cloud Deep Learning Example (PointNet) Lecture19. NVIDIA Isaac Sim Lecture20. NVIDIA Jetson Platform "
},
{
	"uri": "/kr/advanced_contents_ros2/",
	"title": "ROS 2",
	"tags": [],
	"description": "",
	"content": "\nLecture1 - About DDS Lecture2 - About DDS (2) Lecture2 - SROS2 "
},
{
	"uri": "/kr/ros_and_gazebo/",
	"title": "Gazebo and ROS",
	"tags": [],
	"description": "",
	"content": "\nLecture1 - Gazebo and ROS Lecture2 - Gazebo and ROS (2) "
},
{
	"uri": "/kr/",
	"title": "2023 Road Balance ROS Lecture Note",
	"tags": [],
	"description": "",
	"content": "2023 ROAD BALANCE ROS LECTURE NOTE ë³¸ ì‚¬ì´íŠ¸ëŠ” 2023ë…„ Road Balanceì˜ ROS/ROS 2 ê°•ì˜ì— ì‚¬ìš©ë˜ëŠ” ê°•ì˜ ë…¸íŠ¸ì…ë‹ˆë‹¤.\nROS Noetic Lecture Lecture1. Lecture1 - Introduction to ROS Lecture2. Dev Env Setup Lecture3. Core of ROS Lecture4. ROS Launch, RViz Lecture5. First Programming, ROS Topic Lecture6. ROS Service, Parameter Lecture7. Rqt Tools and rosbag, ROS Time Lecture8. Deal with Open Source Projects, Custom Interfaces Lecture9. ROS TF and Examples Lecture10. TF2 Examples, Outro Lecture11 - ROSCPP Lecture12 - More About ROS System Lecture13 - SROS [New Version] ROS 2 Foxy Lecture [Old Version] ROS 2 Foxy Lecture Lecture1. Lecture1 - Introduction to ROS 2 Lecture2. ROS 2 Node, Package Lecture3. ROS 2 Node Programming, ROS 2 Parameter Lecture4. ROS 2 Node C++ Programming Lecture5. ROS 2 Topic and Examples Lecture6. ROS 2 Service and Examples Lecture7. Useful ROS 2 Examples, Nav2 Lecture8. ROS 2 Action and Examples Lecture9. C++ Programming Again, Outro Lecture10 - About DDS Lecture11 - About DDS (2) Lecture12 - SROS2 Lecture13 - Gazebo and Robot(1) Lecture14 - Gazebo and Robot(2) Advanced Contents ROS Lecture1 - ROSCPP Lecture2 - More About ROS System Lecture2 - SROS ROS 2 Lecture1 - About DDS Lecture2 - About DDS (2) Lecture2 - SROS2 ROS and Simulations Gazebo Lecture1 - Gazebo and ROS Lecture2 - Gazebo and ROS (2) Issac Sim Ongoing \u0026hellip; "
},
{
	"uri": "/kr/ros2_foxy/lecture1/",
	"title": "Lecture1. What is ROS?",
	"tags": [],
	"description": "",
	"content": "What is ROS? ê°•ì˜ë¥¼ ì œì‘í•˜ê³  ìˆëŠ” í˜„ ì‹œì , ì„¸ìƒì€ chatgptë¡œ ì¸í•´ í° ê²©ë³€ì„ ë§ì´í•˜ê³  ìˆëŠ”ë°ìš”, chatgptì—ê²Œ ROSê°€ ë¬´ì—‡ì¸ì§€ í•œ ë²ˆ ë¬¼ì–´ë³´ì•˜ìŠµë‹ˆë‹¤. ğŸ˜Š\nğŸ’¡ ì•ìœ¼ë¡œ í”„ë¡œê·¸ë˜ë°ê³¼ ì‹¤ìŠµ ì‹œ chatgptë¥¼ ì ê·¹ í™œìš©í•˜ì—¬ ê°•ì˜ë¥¼ ì´ì–´ë‚˜ê°€ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ğŸ˜‰\nchatgptê°€ ì˜ ì •ë¦¬í•´ì£¼ì—ˆì§€ë§Œ, ì œê°€ ì¡°ê¸ˆ ë” ì„¤ëª…ì„ ì´ì–´ë‚˜ê°€ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ROSë€, ë¡œë´‡ ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œì— ì‚¬ìš©ë˜ëŠ” ì¼ì¢…ì˜ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. í”„ë ˆì„ì›Œí¬ë¼ëŠ” ë§ì€, ROS ë‚˜ë¦„ëŒ€ë¡œì˜ ì‹¤í–‰ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê°–ê³  ìˆë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤. ì‚¬ìš©ìì¸ ìš°ë¦¬ë“¤ì€, ì´ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œë´‡ì„ ë‹¤ë£¨ëŠ” ìš°ë¦¬ë§Œì˜ Applicationì„ ë§Œë“¤ê²Œ ë©ë‹ˆë‹¤. image from : wikimedia\nê·¸ëŸ°ë° ì™œ OSë¼ëŠ” ì´ë¦„ì´ ë¶™ê²Œ ë˜ì—ˆì„ê¹Œìš”? ë¡œë´‡ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œ, ìˆ˜ë§ì€ í”„ë¡œê·¸ë¨ë“¤ì´ ì‹¤í–‰ë˜ë©°, ROSëŠ” ì´ë“¤ ì‚¬ì´ì˜ ìš°ì„ ìˆœìœ„ì™€, í”„ë¡œê·¸ë¨ ì‚¬ì´ì˜ ë°ì´í„° íë¦„ì„ ì±…ì„ì§‘ë‹ˆë‹¤. ì´ ì‘ì—…ì€ ìŠ¤ì¼€ì¥´ë§ì´ë¼ê³  ë¶ˆë¦¬ë©°, ì´ëŸ¬í•œ ë™ì‘ì„ ìˆ˜í–‰í•˜ëŠ” ì‹œìŠ¤í…œì„ Operating Systemì´ë¼ê³  ë¶€ë¥´ê¸° ë•Œë¬¸ì— ROSë¼ëŠ” ì´ë¦„ì„ ê°–ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.\nimage from : tutorialspoint ê·¸ëŸ¼, ë¡œë´‡ì„ ê°œë°œí•˜ê¸° ìœ„í•´ì„œ ì–´ë– í•œ í”„ë¡œê·¸ë¨ë“¤ì´ í•„ìš”í• ê¹Œìš”? =\u0026gt; ë¡œë´‡ì´ ìˆ˜í–‰í•˜ëŠ” ì„ë¬´ë“¤ì„ í¬ê²Œ 3ê°€ì§€ë¡œ ë¶„ë¥˜í•˜ë©´ ì¸ì§€, íŒë‹¨, ì œì–´ì˜ 3ê°€ì§€ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.\nì¸ì§€ë€, ì„¼ì„œë“¤ì„ í†µí•œ ë¬¼ì²´ ì¸ì§€, ìê¸° ìì‹ ì˜ ìœ„ì¹˜ì™€ ë°©í–¥ ì¸ì§€, ìƒí™© ì¸ì§€ ë“± ë¡œë´‡ì—ê²Œ ìˆì–´ í™˜ê²½ê³¼ ìƒí˜¸ì‘ìš©í•˜ëŠ” ê³¼ì •ì— í•´ë‹¹í•©ë‹ˆë‹¤. íŒë‹¨ì´ë€, ì•/ë’¤ë¡œ ì›€ì§ì¼ì§€, ë¡œë´‡ íŒ”ì„ ë»—ì„ì§€ì™€ ê°™ì´ ì¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì–»ì€ ë°ì´í„°ë¥¼ í†µí•´ ê²°ì •ì„ ë‚´ë¦¬ëŠ” ì‘ì—…ë“¤ì´ í•´ë‹¹í•  ê²ƒì…ë‹ˆë‹¤. ì œì–´ ë˜í•œ ë¹¼ë†“ì„ ìˆ˜ ì—†ëŠ” ì˜ì—­ìœ¼ë¡œ, ë¡œë´‡ì€ ì—­í•™ì´ë¼ëŠ” ë²•ì¹™ì´ ì¡´ì¬í•˜ëŠ” ì‹¤ì œ ì„¸ìƒì—ì„œ ì›€ì§ì´ê¸° ë•Œë¬¸ì—, ì´ ì‹œìŠ¤í…œì„ ë¶„ì„í•˜ì—¬ ì ì ˆí•œ ì›€ì§ì„ì„ ì·¨í•˜ë„ë¡ í•´ì•¼í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ ë¡œë´‡ ì‹œìŠ¤í…œì€ ë¬´ì²™ ë³µì¡í•˜ë©°, ì—¬ëŸ¬ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” í”„ë¡œê·¸ë¨ë“¤ ì‚¬ì´ ìˆ˜ë§ì€ ë°ì´í„°ê°€ ì˜¤ê°€ê³ , ë°ì´í„°ì˜ ì‹ ë¢°ì„±ê³¼ ì†ë„ ëª¨ë‘ ì¶©ì¶•ì‹œì¼œì•¼ í•˜ë©°, ë˜ ì‚¬ëŒê³¼ ìƒí˜¸ ì‘ìš©í•´ì•¼ í•©ë‹ˆë‹¤.\nimage from : ROS Industrial ROSëŠ” ì´ëŸ¬í•œ ì‘ì—…ì„ ì†ì‰½ê²Œ í•´ì£¼ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ë©´, ë¡œë´‡ì˜ ì„¼ì„œ, êµ¬ë™ë¶€, ì•Œê³ ë¦¬ì¦˜ì´ ëª¨ë‘ ì¤€ë¹„ë˜ì–´ ìˆëŠ” ìƒí™©ì—ì„œ, ì´ë“¤ì„ í•˜ë‚˜ì˜ ì‹œìŠ¤í…œìœ¼ë¡œ ì—®ì–´ì£¼ëŠ” ì—­í• ì„ í•˜ëŠ” ê²ƒì´ ë°”ë¡œ ROSì…ë‹ˆë‹¤.\nimage from : ros wiki ê·¸ë ‡ë‹¤ë©´, ROSì™€ ROS 2ëŠ” ì–´ë–¤ ì ì—ì„œ ë‹¤ë¥¼ê¹Œìš”? ROSì˜ ì‹œì‘ì€ ì—°êµ¬ì‹¤ì´ì—ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  PR2ë¼ëŠ” ë‹¨ì¼ ë¡œë´‡ì„ ìœ„í•´ ë§Œë“¤ì–´ì§„ ì‹œìŠ¤í…œì´ì—ˆê¸°ì— ì—°êµ¬ìš©, ê°„ë‹¨í•œ í”„ë¡œì íŠ¸ìš©ìœ¼ë¡œëŠ” ì‚¬ìš©ë  ìˆ˜ ìˆì§€ë§Œ, ìƒìš©í™”ë¥¼ ìœ„í•œ ì—¬ëŸ¬ ì¡°ê±´ë“¤ì€ ê³ ë ¤í•˜ì§€ ëª»í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤. image from : https://robots.ieee.org/robots/pr2/\në³´ì•ˆ ì•ˆì •ì„± ì‹¤ì‹œê°„ì„± ê°œë°œ ìš©ì´ì„± ê¸°ìˆ  ì§€ì› í•˜ë“œì›¨ì–´ ì—°ë™ etcâ€¦ ì—°êµ¬ìš©ìœ¼ë¡œ ì„¤ê³„ëœ ê¸°ì¡´ ROSë¥¼ í†µí•´ì„œëŠ” ì´ëŸ¬í•œ ëª¨ë“  ì¡°ê±´ì„ ì¶©ì¡±í•  ìˆ˜ ì—†ë‹¤ëŠ” ê²°ë¡ ì„ ë‚´ë ¸ê³ , Open RoboticsëŠ” ROS 2ë¥¼ ìƒˆë¡­ê²Œ ì„ ë³´ì´ê²Œ ë©ë‹ˆë‹¤.\nimage from : maker.pro ğŸ’¡ ê¸°ì¡´ ì–¸ê¸‰ë˜ì—ˆë˜ ROS 1ì˜ ëª¨ë“  ë¬¸ì œë“¤ì´ ROS 2ì—ì„œ í•´ê²°ë˜ì—ˆë‹¤ê³  í•  ìˆ˜ëŠ” ì—†ì§€ë§Œ ì ì–´ë„ í•´ê²°ì„ ê³ ë ¤í•˜ì—¬ ì„¤ê³„ë˜ì—ˆë‹¤ê³  ë§í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤.\nìƒìš©í™”ë¥¼ ê³ ë ¤í•œ ê°€ì¥ í° ë³€í™” ì¤‘ í•˜ë‚˜ëŠ” íŒ¨í‚· í†µì‹ ì— TCPROS/UPDROSê°€ ì•„ë‹Œ DDSë¥¼ ë„ì…í•˜ì˜€ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. image from : omg.org DDSëŠ” Data Distribution Serviceì˜ ì•½ìì´ë©°, ë‹¤ì–‘í•œ í”„ë¡œê·¸ë¨ì´ ë™ì‹œì— ë™ì‘í•˜ëŠ” ì‹œìŠ¤í…œì„ ìœ„í•œ ì¼ì¢…ì˜ ì•½ì†ì…ë‹ˆë‹¤. ê¸°ì¡´ì˜ ROSê°€ ì§€ì–‘í•˜ë˜ ë°©ì‹ì´ DDSì™€ ì¼ì¹˜í•˜ëŠ” ë¶€ë¶„ì´ ë§ì•˜ê³ , ì‚°ì—… í‘œì¤€ì— ë„ë¦¬ ì‚¬ìš©ë˜ê³  ìˆì—ˆê¸° ë•Œë¬¸ì— ì±„íƒí•˜ì§€ ì•Šì•˜ë‚˜ ì‹¶ìŠµë‹ˆë‹¤. (ìì„¸í•œ ë‚´ìš©ì€ ê°•ì˜ë¥¼ í†µí•´ í•¨ê»˜ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.)\nAbout this lecture ì•ì„œ ì´ì•¼ê¸°í•œ ë°”ì™€ ê°™ì´ ROSëŠ” íŠ¹ì • ì•Œê³ ë¦¬ì¦˜ì„ ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì•„ë‹Œ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.\në”°ë¼ì„œ, ì´ ì‹œìŠ¤í…œì„ ì´í•´í•˜ê³ , ìµìˆ™í•´ì§€ê³ , ì‹¤ìŠµí•˜ê³ , ì½”ë”©í•˜ê³ , ê¸°ì¡´ì˜ ì½”ë“œë¥¼ ì—°ë™í•˜ëŠ” ì‘ì—…ë“¤ì„ í†µí•´ ì—¬ëŸ¬ë¶„ë“¤ì˜ ì½”ë“œì™€ ì•Œê³ ë¦¬ì¦˜ì„ ROSë¡œ ê°ìŒ€ ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.\nROS Wrapper Google ê²€ìƒ‰ ê²°ê³¼ ì´ë²ˆ ê°•ì˜ë¥¼ ê¸°íší•˜ëŠ” ì‹œì ì—ì„œ ì„¸ìƒì— í° ë³€í™”ê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ë°”ë¡œ ChatGPTì¸ë°ìš”. C++ ì½”ë“œë¥¼ Python ì½”ë“œë¡œ ë°”ê¾¼ë‹¤ê±°ë‚˜, ë‚´ê°€ ì›í•˜ëŠ” ROS 2 ì½”ë“œë¥¼ ë§ë§Œ í•˜ë©´ ìˆœì‹ê°„ì— ì§œì£¼ëŠ” ì„¸ìƒì´ ë˜ì—ˆìŠµë‹ˆë‹¤.\nChatGPTë¥¼ í†µí•´ ìƒì„±í•œ ì½”ë“œ ì˜ˆì‹œ ë¿ë§Œ ì•„ë‹ˆë¼ ì½”ë“œ ì‘ì„± ì‹œì—ë„ Github Copilot, Code GPT ë“± ìë™ ì™„ì„± ê¸°ëŠ¥ë“¤ì´ ë“±ì¥í•˜ì—¬ ê°œë°œìë“¤ì˜ í¸ì˜ë¥¼ ë†’ì—¬ì£¼ê³  ìˆìŠµë‹ˆë‹¤.\ncopliotì„ í†µí•´ ìƒì„±í•œ rclcpp ì˜ˆì‹œ #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; // rclcpp node example int main(int argc, char *argv[]) { rclcpp::init(argc, argv); auto node = rclcpp::Node::make_shared(\u0026#34;test_node\u0026#34;); rclcpp::spin(node); rclcpp::shutdown(); return 0; } ì´ëŸ¬í•œ ì´ìœ ë¡œ ê°œë°œìë“¤ì€ ë”ì´ìƒ ì½”ë“œ APIë¥¼ ì™¸ìš°ê³ , ì˜ˆì œë¥¼ ë’¤ì ì´ê³  í•  í•„ìš”ê°€ ì—†ì–´ì¡Œë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤. ì´ëŠ” ROS 2 ê°œë°œì‹œì—ë„ ë¬¼ë¡  ì ìš©ë  ê²ƒì…ë‹ˆë‹¤.\në”°ë¼ì„œ, ì´ë²ˆ ê°•ì˜ì—ì„œëŠ” AIê°€ ì•Œë ¤ì¤„ ìˆ˜ ì—†ëŠ” ê²ƒë“¤ì„ ìœ„ì£¼ë¡œ ì§„í–‰í•˜ê³ ì í•©ë‹ˆë‹¤.\nROS 2ë¥¼ ì–´ë–»ê²Œ ì†ì‰½ê²Œ ì„¤ì¹˜í•˜ê³ , ì–´ë– í•œ ëª…ë ¹ìœ¼ë¡œ ë‹¤ë£° ìˆ˜ ìˆëŠ”ì§€, ë˜ ì–´ë– í•œ ê°œë…ì„ ê°–ê³  ìˆìœ¼ë©°, ë‚´ê°€ ì›í•˜ëŠ” ê¸°ëŠ¥ì„ ìœ„í•´ ì–´ë–¤ ì½”ë“œ êµ¬í˜„ì´ í•„ìš”í•œì§€ ì´ ê°•ì˜ì—ì„œ ëª¨ë‘ ë‹¤ë£¨ì–´ ë³´ê² ìŠµë‹ˆë‹¤. ğŸ˜‰ ê°•ì˜ë¥¼ ìˆ˜ê°•í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì„ ìˆ˜ì§€ì‹ ë³¸ ê°•ì˜ëŠ” ìµœëŒ€í•œ ë§ì€ ë¶„ë“¤ì´ ëê¹Œì§€ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, ìµœëŒ€í•œ ì‰½ê³ , í”„ë¡œê·¸ë˜ë° ì‹¤ë ¥ì´ ì¶œì¤‘í•˜ì§€ ì•Šì•„ë„ ëª¨ë‘ ì™„ê°•í•  ìˆ˜ ìˆê²Œ ì§„í–‰í•©ë‹ˆë‹¤. í”„ë¡œê·¸ë˜ë° ì§€ì‹ì€ ì•„ë˜ ì½”ë“œë¥¼ ì´í•´í•  ìˆ˜ ìˆì„ ì •ë„ë©´ ê´œì°®ìŠµë‹ˆë‹¤.\npython basic class OOPNode: def __init__(self): self.counter_ = 0 def hello_du(self, event=None): hello_du = f\u0026#34;hello du {rospy.get_time()}, counter: {self.counter_}\u0026#34; print(hello_du) self.counter_ += 1 def my_first_oop_node(): oop_node = OOPNode() if __name__ == \u0026#39;__main__\u0026#39;: try: my_first_oop_node() except Exception as e: print(e) C++ì˜ ê²½ìš° ì´ì•¼ê¸°ê°€ ì¡°ê¸ˆ ë‹¤ë¥¸ë°ìš”. C++11 ì´í›„, í†µì¹­ Modern C++ì— ëŒ€í•œ ì§€ì‹ì´ í•„ìš”í•©ë‹ˆë‹¤.\ntype deduction smart pointer lambda, bind etcâ€¦ ë”ë¶ˆì–´ ë¹Œë“œ ì‹œìŠ¤í…œì— ëŒ€í•œ ì´í•´ (make, CMake)ë„ ì–´ëŠ ì •ë„ í•„ìš”í•©ë‹ˆë‹¤.\níŒŒì´ì¬ìœ¼ë¡œ ê°œë…ì„ ìµíˆê³ , C++ ì–¸ì–´ ê³µë¶€ëŠ” ì–¸ì œë“  ì¶”ê°€ë¡œ í•˜ë©´ ë˜ë‹ˆ ê°•ì˜ì—ì„œ ì´í•´ì— ì–´ë ¤ì›€ì´ ìˆë‹¤ë©´ ì¶”ê°€ë¡œ ë¦¬ì„œì¹˜í•˜ë©´ ë˜ì‹œê² ìŠµë‹ˆë‹¤.\nê°•ì˜ ì½”ë“œì™€ ê°•ì˜ ë…¸íŠ¸ ì‚¬ìš©ë²• ê°•ì˜ ë„ì¤‘ ì‚¬ìš©ë˜ëŠ” ì½”ë“œë“¤ì€ Github Repositoryë¥¼ í†µí•´ ë°°í¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\nhttps://github.com/RB2023ROS/du2023-ros2 ê°•ì˜ ë…¸íŠ¸ì˜ ì£¼ì†ŒëŠ” https://rb2023ros.github.io/kr/ ì…ë‹ˆë‹¤. ì½”ë“œì™€ ëª…ë ¹ì–´ ë“± í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ëª¨ë‘ ë‹´ê³  ìˆìœ¼ë¯€ë¡œ ë³µì‚¬/ë¶™ì—¬ë„£ê¸°ë¥¼ í™œìš©í•˜ì—¬ ê°•ì˜ ì²­ì·¨ ì‹œê°„ì„ ì ˆì•½í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.\ní•´ë‹¹ ë…¸íŠ¸ëŠ” hugoë¥¼ ì‚¬ìš©í•˜ì—¬ ì œì‘ëœ ì›¹ í˜ì´ì§€ì„ì„ ë°í™ë‹ˆë‹¤.\n"
},
{
	"uri": "/kr/ros2_foxy/lecture2/",
	"title": "Lecture2. Dev Env Setup",
	"tags": [],
	"description": "",
	"content": "\nDevelpoment Environment Setup í”„ë¡œì íŠ¸ ê¸°ë°˜ì˜ ê°•ì˜ì¸ ë§Œí¼, ê°œë°œ í™˜ê²½ì´ êµ¬ì¶•ë˜ì§€ ì•Šìœ¼ë©´ ì•ìœ¼ë¡œì˜ ì‹¤ìŠµì„ ì§„í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\në”°ë¼ì„œ ì´ë²ˆ íŒŒíŠ¸ì— ë§ì€ ì‹œê°„ì„ ë°°ì •í•˜ì˜€ê³ , í˜ë“¤ ìˆ˜ ìˆì§€ë§Œ ëê¹Œì§€ ë”°ë¼ì™€ì£¼ì‹œë©´ ê°ì‚¬í•©ë‹ˆë‹¤.\nì¤€ë¹„í•œ í™˜ê²½ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nUbuntu Linux \u0026amp; ROS 2 Setup Windows 11 \u0026amp; WSL 2 Setup Windows 10 \u0026amp; WSL 2 Setup 1,2,3 ìˆœì„œë¡œ ì¶”ì²œí•˜ëŠ” ì„¤ì •ì…ë‹ˆë‹¤. ê°•ì˜ ì»¨í…ì¸ ë¥¼ ë”°ë¼ì˜¤ë©´ì„œ ì„ í˜¸í•˜ëŠ” ì„¤ì •ì— ë§ì¶”ì–´ ì‘ì—…í•˜ì‹œë‹¤ê°€ ë„ì €íˆ í•´ê²°í•  ìˆ˜ ì—†ëŠ” ë¬¸ì œê°€ ë°œìƒí•œ ê²½ìš° github issueë¥¼ ë°œí–‰í•˜ì‹œê±°ë‚˜ í˜„ì¥ ê°•ì˜ì˜ ê²½ìš° ì €ë¥¼ ë¶ˆëŸ¬ ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.\nUbuntu Linux \u0026amp; ROS 2 Setup í•´ë‹¹ ë©”ë‰´ì–¼ì€ ìš°ë¶„íˆ¬ ë¦¬ëˆ…ìŠ¤ 20.04ë²„ì „ì„ ì‚¬ìš©í•˜ëŠ” PCë¥¼ ìœ„í•œ ROS 2 ì„¤ì¹˜ íŠœí† ë¦¬ì–¼ì…ë‹ˆë‹¤. ê¸°ì¡´ Windowsë¥¼ ì‚¬ìš©í•˜ê³  ìˆì—ˆë‹¤ë©´ ë“€ì–¼ ë¶€íŒ…ì´ë¼ëŠ” ê²ƒì„ í†µí•´ Ubuntu + Windowsë¥¼ ëª¨ë‘ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. ë“€ì–¼ ë¶€íŒ…ì— ë°©ë²•ì— ëŒ€í•´ì„  ì˜ ì„¤ëª…í•œ ì˜ìƒë“¤ì´ ë§ìœ¼ë¯€ë¡œ ë§í¬ë¡œ ëŒ€ì²´í•˜ê² ìŠµë‹ˆë‹¤.\n=\u0026gt; https://www.itechguides.com/dual-boot-ubuntu-windows-10/\nDual Booting ê´€ë ¨ ìë£Œ ë§í¬\nHow to Dual Boot Ubuntu 20.04 LTS and Windows 10 How to Dual Boot Ubuntu and Windows 11 ROS 2ë¥¼ ì„¤ì¹˜í•˜ê¸° ì „, ìœ ìš©í•œ ìœ í‹¸ë¦¬í‹° í”„ë¡œê·¸ë¨ë“¤ì„ ëª‡ê°€ì§€ ì†Œê°œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.\nternimator ì„¤ì¹˜ - ë‹¤ì¤‘ í„°ë¯¸ë„ì„ ì§€ì›í•˜ëŠ” í›Œë¥­í•œ í„°ë¯¸ë„ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. sudo apt update sudo apt install terminator -y terminator í™”ë©´ ë¶„í•  ì˜ˆì‹œ\nctrl + shift + e : ê°€ë¡œ ë¶„í•  ctrl + shift + o : ì„¸ë¡œ ë¶„í•  ctrl + shift + w : ì°½ ë‹«ê¸° alt + í™”ì‚´í‘œ : ì°½ ê°„ ì´ë™ peek - gif ì œì‘ ì‹œ ìœ ìš©í•œ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. ì €ëŠ” Gazeboì™€ ê°™ì€ ì‹œë®¬ë ˆì´ì…˜ ìƒí™©ì˜ ë””ë²„ê¹… ì‹œ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. sudo add-apt-repository ppa:peek-developers/stable sudo apt-get update sudo apt install peek ë‹¤ìŒìœ¼ë¡œ, ì œê°€ ë¯¸ë¦¬ ì¤€ë¹„í•´ë‘” ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ ROS / ROS 2ì˜ í•œì¤„ ì„¤ì¹˜ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤. ì„¤ì¹˜ ì—¬ë¶€ë¥¼ ë¬»ëŠ” ì§ˆë¬¸ì—ëŠ” yë¥¼ ì…ë ¥í•˜ì‹œë©´ ë˜ë©°, OpenVINOë¥¼ ì„¤ì¹˜í•˜ëŠ” ì§ˆë¬¸ì—ì„œëŠ” në¥¼ ì…ë ¥í•˜ì‹œë©´ ë©ë‹ˆë‹¤. cd ~/ sh -c \u0026#34;$(curl -fsSL https://raw.githubusercontent.com/kimsooyoung/ros_menu/main/scripts/setup.sh)\u0026#34; â€¦ Do you want to install ROS automatically? (y/N): y ì„¤ì¹˜ í›„, ì—¬ëŸ¬ë¶„ë“¤ì˜ PCëŠ” ì•„ë˜ì™€ ê°™ì´ ì‹¤í–‰ ì „, ROS ì‚¬ìš© ì—¬ë¶€ë¥¼ ì„ íƒí•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ********* RoadBalance Startup Menu for ROS *********** * Usage: Please select the following options to load * * ROS environment automatically. * ****************************************************** 0) Do nothing 1) ROS 1 noetic 2) ROS 2 foxy 3) ROS 2 galactic 4) ROS2/ROS1_bridge h) Help Please choose an option: 2 ------------------------------------------------------ * ROS_DOMAIN_ID = 30 ------------------------------------------------------ ... í•´ë‹¹ setupì€ ADLINKì˜ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ì°¸ê³ í•˜ì˜€ìŒì„ ë°í™ë‹ˆë‹¤. ADLINKëŠ” DDS Vendor ì¤‘ í•˜ë‚˜ë¡œ ROS 2 ë³´ê¸‰ì—ë„ í˜ì“°ê³  ìˆë‹µë‹ˆë‹¤. ğŸ˜ƒ\nGazeboì™€ Rviz2ì˜ ì„¤ì¹˜ ì—¬ë¶€ë¥¼ í•¨ê»˜ í™•ì¸í•´ ë´…ì‹œë‹¤. # 1. gazebo install check gazebo # 2. rviz2 install check rviz2 ê·¸ë¦¼ì™€ ê°™ì´ Gazeboì˜ í™”ë©´ì´ ì–´ë‘¡ê±°ë‚˜, ê·¸ë¦¼ìê°€ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤ë©´ í˜¸í™˜ë˜ëŠ” ê·¸ë˜í”½ ë“œë¼ì´ë²„ë¥¼ ì„¤ì¹˜í•´ì•¼ í•˜ëŠ” ìƒí™©ì…ë‹ˆë‹¤. ë‹¹ì¥ í¬ê²Œ ë¶ˆí¸í•˜ì§€ ì•Šë‹¤ë©´ ìƒê´€ì€ ì—†ìŠµë‹ˆë‹¤.\ní˜¹ì‹œë‚˜ Gazeboê°€ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ë‹¤ë©´, ì•„ë˜ì˜ ì»¤ë©˜ë“œ ë¼ì¸ì„ í†µí•´ ì„¤ì¹˜í•´ì¤ë‹ˆë‹¤. sudo sh -c \u0026#39;echo \u0026#34;deb http://packages.osrfoundation.org/gazebo/ubuntu-stable `lsb_release -cs` main\u0026#34; /etc/apt/sources.list.d/gazebo-stable.list\u0026#39; wget https://packages.osrfoundation.org/gazebo.key -O - | sudo apt-key add - sudo apt update sudo apt install gazebo11 libgazebo11-dev -y sudo apt install ros-foxy-gazebo-ros-pkgs -y sudo apt install ros-noetic-gazebo-ros-pkgs -y Windows 11 \u0026amp; WSL 2 Setup í•´ë‹¹ ë©”ë‰´ì–¼ì€ Windows11ì„ ì‚¬ìš©í•˜ëŠ” PCë¥¼ ìœ„í•œ ROS 2 ì„¤ì¹˜ íŠœí† ë¦¬ì–¼ì…ë‹ˆë‹¤.\nì„¤ì¹˜ ì „, â€œWindows Key â‡’ ì—…ë°ì´íŠ¸â€ë¥¼ í†µí•´ ìµœì‹  ì—…ë°ì´íŠ¸ë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤. (ìƒí™©ì— ë”°ë¼ ì¬ë¶€íŒ…ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.) ë”ë¶ˆì–´, Ctrl + Alt + Delete â‡’ ì‘ì—…ê´€ë¦¬ì â‡’ ì™¼ìª½ ì„±ëŠ¥ íƒ­ì„ í†µí•´ ê°€ìƒí™” ê¸°ëŠ¥ì´ Enable ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ì´ ì‹œì ì—ì„œ ë¬¸ì œê°€ ìˆë‹¤ë©´, ë§í¬ë¥¼ í†µí•´ ë¬¸ì œë¥¼ í•´ê²°í•´ë´…ì‹œë‹¤.\nâ‡’ https://www.manualfactory.net/15704\në‹¤ìŒìœ¼ë¡œ, í„°ë¯¸ë„ í”„ë¡œê·¸ë¨ì„ ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ëŠ” â€œWindows Key + Xâ€ â‡’ í„°ë¯¸ë„(ê´€ë¦¬ì)ë¥¼ í†µí•´ ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤. ê´€ë¦¬ì ê¶Œí•œ Powershellì—ì„œ ì•„ë˜ì™€ ê°™ì€ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì…ë ¥í•©ë‹ˆë‹¤. ì‚¬ì§„ê³¼ ê°™ì´ ê°€ìƒ ë¨¸ì‹  í”Œë ›í¼ / WSL / Ubuntuê°€ ëª¨ë‘ í•œë²ˆì— ì„¤ì¹˜ë©ë‹ˆë‹¤. - ì—¬ê¸°ì—ì„œ ì„¤ì¹˜ë˜ëŠ” UbuntuëŠ” 22.04ë²„ì „ì…ë‹ˆë‹¤. wsl --install ë‹¤ìŒìœ¼ë¡œ ë™ì¼ í„°ë¯¸ë„ì—ì„œ ì•„ë˜ì˜ ë‘ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì…ë ¥í•©ë‹ˆë‹¤. # 1. WSL Enable dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart # 2. VirtualMachinePlatform Enable dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart ì•„ë˜ì™€ ê°™ì´ ëª¨ë“  ì‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì–´ì•¼ í•©ë‹ˆë‹¤!\n\u0026gt; dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart ë°°í¬ ì´ë¯¸ì§€ ì„œë¹„ìŠ¤ ë° ê´€ë¦¬ ë„êµ¬ ë²„ì „: 10.0.19041.844 ì´ë¯¸ì§€ ë²„ì „: 10.0.19043.1348 ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •í•˜ëŠ” ì¤‘ [==========================100.0%==========================] ì‘ì—…ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. \u0026gt; dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart ë°°í¬ ì´ë¯¸ì§€ ì„œë¹„ìŠ¤ ë° ê´€ë¦¬ ë„êµ¬ ë²„ì „: 10.0.19041.844 ì´ë¯¸ì§€ ë²„ì „: 10.0.19043.1348 ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •í•˜ëŠ” ì¤‘ [==========================100.0%==========================] ì‘ì—…ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. WSL 2 ì„¤ì •ì´ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸ì„ í•´ë³¼ê¹Œìš”? PS C:\\Users\\tge13\u0026gt; wsl -l -v NAME STATE VERSION * Ubuntu Stopped 2 ì„¤ì¹˜ëœ UbuntuëŠ” 22.04 ë²„ì „ìœ¼ë¡œ, ê°•ì˜ì—ì„œ ì‚¬ìš©ë˜ëŠ” 20.04ë²„ì „ì€ MS Storeì—ì„œ ë‹¤ì‹œ ë‹¤ìš´ë¡œë“œë°›ì•„ì•¼ í•©ë‹ˆë‹¤. ì„¤ì¹˜ ì´í›„, â€œì—´ê¸°â€ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì´ˆê¸° ì‹¤í–‰ì„ í•˜ë©´ ì•„ë˜ê³¼ ê°™ì€ í„°ë¯¸ë„ì„ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, username, passwordë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. - passwordëŠ” ë³´ì´ì§€ ì•ŠìŒì— ìœ ì˜í•©ë‹ˆë‹¤. ë‹¤ìŒìœ¼ë¡œ, ì œê°€ ë¯¸ë¦¬ ì¤€ë¹„í•´ë‘” ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ ROS / ROS 2ì˜ í•œì¤„ ì„¤ì¹˜ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤. ì„¤ì¹˜ ì—¬ë¶€ë¥¼ ë¬»ëŠ” ì§ˆë¬¸ì—ëŠ” yë¥¼ ì…ë ¥í•˜ì‹œë©´ ë˜ë©°, OpenVINOë¥¼ ì„¤ì¹˜í•˜ëŠ” ì§ˆë¬¸ì—ì„œëŠ” në¥¼ ì…ë ¥í•˜ì‹œë©´ ë©ë‹ˆë‹¤. cd ~/ sh -c \u0026#34;$(curl -fsSL https://raw.githubusercontent.com/kimsooyoung/ros_menu/main/scripts/setup.sh)\u0026#34; â€¦ Do you want to install ROS automatically? (y/N): y ì„¤ì¹˜ í›„, ì—¬ëŸ¬ë¶„ë“¤ì˜ PCëŠ” ì•„ë˜ì™€ ê°™ì´ ì‹¤í–‰ ì „, ROS ì‚¬ìš© ì—¬ë¶€ë¥¼ ì„ íƒí•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ********* RoadBalance Startup Menu for ROS *********** * Usage: Please select the following options to load * * ROS environment automatically. * ****************************************************** 0) Do nothing 1) ROS 1 noetic 2) ROS 2 foxy 3) ROS 2 galactic 4) ROS2/ROS1_bridge h) Help Please choose an option: 2 ------------------------------------------------------ * ROS_DOMAIN_ID = 30 ------------------------------------------------------ ... GUI ì¸í„°í˜ì´ìŠ¤ ì„¤ì • Gazebo, Rviz2, Rqtì™€ ê°™ì€ ì‹œê°í™” í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ Windowsìš© X Serverì¸ VcXsrvë¥¼ ì‚¬ìš©í•˜ê³ ì í•©ë‹ˆë‹¤.\në§í¬ë¥¼ í†µí•´ VcXsrvë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤. â‡’ https://sourceforge.net/projects/vcxsrv/ ì„¤ì¹˜ ì´í›„, â€œWindows Keyâ€ â‡’ XLaunchë¥¼ ê²€ìƒ‰í•˜ì—¬ ì‹¤í–‰í•˜ê³ , ì‚¬ì§„ê³¼ ê°™ì€ ì„¤ì •ì„ ì§„í–‰í•©ë‹ˆë‹¤. ì²«ë²ˆì§¸ í˜ì´ì§€ í•˜ë‹¨ Display Numberë¥¼ -1ì—ì„œ 0ìœ¼ë¡œ ë³€ê²½ ë‘ë²ˆì§¸ í˜ì´ì§€ í†µê³¼ ì„¸ë²ˆì§¸ í˜ì´ì§€ Native opengl ì²´í¬í•´ì œ í›„ Disable access control ì²´í¬ ë„¤ë²ˆì§¸ í˜ì´ì§€ í†µê³¼ ì•ìœ¼ë¡œ ì¬ë¶€íŒ… ì‹œë§ˆë‹¤ ì´ ì„¤ì •ì„ ë°˜ë³µí•´ì¤˜ì•¼ í•˜ë©°, ì¢…ì¢… Gazeboì˜ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¡œ ì¸í•´ í™”ë©´ì´ ì¢…ë£Œë˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìˆëŠ”ë°, ì´ëŸ° ê²½ìš° XLaunchë¥¼ ê°•ì œ ì¢…ë£Œí•´ì£¼ë©´ ë©ë‹ˆë‹¤.\nì„¤ì •ì´ ì˜ ë˜ì—ˆëŠ”ì§€ Gazeboë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. í„°ë¯¸ë„ ìƒì˜ ì•„ë˜ì˜ 4ì¤„ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì…ë ¥í•©ë‹ˆë‹¤. export GAZEBO_IP=127.0.0.1 export DISPLAY=$(cat /etc/resolv.conf | grep nameserver | awk \u0026#39;{print $2}\u0026#39;):0 export LIBGL_ALWAYS_INDIRECT=0 # ì„¤ì • ì™„ë£Œ í›„ Gazebo ì‹¤í–‰ gazebo ë§ˆì§€ë§‰ìœ¼ë¡œ, ì•ì„  ì„¤ì • ì»¤ë©˜ë“œ ë¼ì¸ì„ ë§¤ë²ˆ ìˆ˜ê³ ìŠ¤ëŸ½ê²Œ ì…ë ¥í•˜ì§€ ì•Šë„ë¡ bashrc ì„¤ì • íŒŒì¼ì„ ìˆ˜ì •í•©ë‹ˆë‹¤. echo \u0026#39;export GAZEBO_IP=127.0.0.1\u0026#39; \u0026gt;\u0026gt; ~/.bashrc echo \u0026#34;export DISPLAY=$(cat /etc/resolv.conf | grep nameserver | awk \u0026#39;{print $2}\u0026#39;):0 \u0026#34; \u0026gt;\u0026gt; ~/.bashrc echo \u0026#39;export LIBGL_ALWAYS_INDIRECT=0\u0026#39; \u0026gt;\u0026gt; ~/.bashrc ì˜¤ë¥˜ FAQ Ubuntu ì‹¤í–‰ ì‹œ 0x80370114 ì—ëŸ¬ Installing, this may take a few minutes... WslRegisterDistribution failed with error: 0x80370114 Error: 0x80370114 ??? ??? ???? ?? ?? ??? ??? ??? ? ????. Press any key to continue... â‡’ ê´€ë¦¬ì ê¶Œí•œ Powershellì—ì„œ ì•„ë˜ì˜ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”\ndism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart Windows 10 \u0026amp; WSL 2 Setup í•´ë‹¹ ë©”ë‰´ì–¼ì€ Windows 10ì„ ì‚¬ìš©í•˜ëŠ” PCë¥¼ ìœ„í•œ ROS 2 ì„¤ì¹˜ íŠœí† ë¦¬ì–¼ì…ë‹ˆë‹¤.\nì„¤ì¹˜ ì „, â€œWindows Key â‡’ ì—…ë°ì´íŠ¸â€ë¥¼ í†µí•´ ìµœì‹  ì—…ë°ì´íŠ¸ë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤. (ìƒí™©ì— ë”°ë¼ ì¬ë¶€íŒ…ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.) powershellì„ ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰í•œ ë’¤, ì„¤ì¹˜ ë˜ì–´ìˆëŠ” WSL 2ë¥¼ í™œì„±í™”ì‹œí‚µë‹ˆë‹¤. ì´ëŠ” â€œWindows Key + Xâ€ â‡’ í„°ë¯¸ë„(ê´€ë¦¬ì)ë¥¼ í†µí•´ ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤. ê´€ë¦¬ì ê¶Œí•œ Powershellì—ì„œ ì•„ë˜ì™€ ê°™ì€ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì…ë ¥í•©ë‹ˆë‹¤. # 1. WSL Enable dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart # 2. VirtualMachinePlatform Enable dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart ì•„ë˜ì™€ ê°™ì´ ëª¨ë“  ì‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì–´ì•¼ í•©ë‹ˆë‹¤!\n\u0026gt; dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart ë°°í¬ ì´ë¯¸ì§€ ì„œë¹„ìŠ¤ ë° ê´€ë¦¬ ë„êµ¬ ë²„ì „: 10.0.19041.844 ì´ë¯¸ì§€ ë²„ì „: 10.0.19043.1348 ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •í•˜ëŠ” ì¤‘ [==========================100.0%==========================] ì‘ì—…ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. \u0026gt; dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart ë°°í¬ ì´ë¯¸ì§€ ì„œë¹„ìŠ¤ ë° ê´€ë¦¬ ë„êµ¬ ë²„ì „: 10.0.19041.844 ì´ë¯¸ì§€ ë²„ì „: 10.0.19043.1348 ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •í•˜ëŠ” ì¤‘ [==========================100.0%==========================] ì‘ì—…ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. â€œWindows Keyâ€ â‡’ MS Storeë¡œ ì´ë™í•˜ì—¬ windows terminalì„ ì„¤ì¹˜í•©ë‹ˆë‹¤. windows terminal í™”ë©´ ë¶„í•  ì˜ˆì‹œ\nalt + shift + - : ê°€ë¡œ ë¶„í•  alt + shift + + : ì„¸ë¡œ ë¶„í•  ctrl + shift + w : ì°½ ë‹«ê¸° alt + í™”ì‚´í‘œ : ì°½ ê°„ ì´ë™ ë‹¤ìŒ ë§í¬ë¥¼ í†µí•´ WSL ì—…ë°ì´íŠ¸ í”„ë¡œê·¸ë¨ì„ ë‹¤ìš´ë°›ê³  WSL 2 Linux ì»¤ë„ ì—…ë°ì´íŠ¸ë¥¼ ì„¤ì¹˜/ì§„í–‰ í›„ ì¬ë¶€íŒ…í•©ë‹ˆë‹¤.\nì»¤ë„ ì—…ë°ì´íŠ¸ë¥¼ ë§ˆì¹œ ë‹¤ìŒ, powershellì— ì•„ë˜ ì»¤ë§¨ë“œ ë¼ì¸ì„ ì…ë ¥í•˜ì—¬ WSL 2ë¥¼ ê¸°ë³¸ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤. \u0026gt; wsl --set-default-version 2 WSL 2ì™€ì˜ ì£¼ìš” ì°¨ì´ì ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ https://aka.ms/wsl2ë¥¼ ì°¸ì¡°í•˜ì„¸ìš” ì‘ì—…ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ ì§„í–‰í•œ ì‘ì—…ë“¤ì´ ì œëŒ€ë¡œ ì„¤ì • ë˜ì–´ìˆëŠ”ì§€ í™•ì¸í•´ë´…ì‹œë‹¤. \u0026gt; wsl -l -v NAME STATE VERSION * Ubuntu-20.04 Running 2 MS Store ì§„ì… í›„, Ubuntu 20.04 ë²„ì „ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤. ì„¤ì¹˜ ì´í›„, ì—´ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ ì´ˆê¸° ì‹¤í–‰ì„ í•˜ê³  username, passwordë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ì„¤ì¹˜ ì´í›„ì—ëŠ” windows terminalì—ì„œ Ubuntu Terminalì„ ì„ íƒí•˜ì—¬ ì‹¤í–‰ ë° ì§„ì…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì„¤ì • íƒ­ì„ í†µí•´ Ubuntu 20.04ë¥¼ ê¸°ë³¸ í„°ë¯¸ë„ë¡œ ì„¤ì • í›„ ì €ì¥í•©ì‹œë‹¤. ROS / ROS 2ë¥¼ í•œì¤„ ì„¤ì¹˜í•©ë‹ˆë‹¤. $ cd ~/ $ sh -c \u0026#34;$(curl -fsSL https://raw.githubusercontent.com/kimsooyoung/ros_menu/main/scripts/setup.sh)\u0026#34; Installing Neuron Startup Menu... Cloning into \u0026#39;/home/kimsooyoung/ros_menu\u0026#39;... remote: Enumerating objects: 583, done. remote: Counting objects: 100% (290/290), done. remote: Compressing objects: 100% (193/193), done. remote: Total 583 (delta 179), reused 173 (delta 93), pack-reused 293 Receiving objects: 100% (583/583), 154.50 KiB | 3.22 MiB/s, done. Resolving deltas: 100% (340/340), done. Do you want to install ROS automatically? (y/N): y ì„¤ì¹˜ê°€ ì™„ë£Œë˜ì—ˆë‹¤ë©´, ì•ìœ¼ë¡œ í„°ë¯¸ë„ì„ ìƒˆë¡œ ë“±ì¥ì‹œí‚¬ ë•Œë§ˆë‹¤ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•  ROS ë²„ì „ì„ ë¬»ê²Œ ë©ë‹ˆë‹¤. GUI ì¸í„°í˜ì´ìŠ¤ ì„¤ì • Gazebo, Rviz2, Rqtì™€ ê°™ì€ ì‹œê°í™” í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ Windowsìš© X Serverì¸ VcXsrvë¥¼ ì‚¬ìš©í•˜ê³ ì í•©ë‹ˆë‹¤.\në§í¬ë¥¼ í†µí•´ VcXsrvë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤. â‡’ https://sourceforge.net/projects/vcxsrv/ ì„¤ì¹˜ ì´í›„, â€œWindows Keyâ€ â‡’ XLaunchë¥¼ ê²€ìƒ‰í•˜ì—¬ ì‹¤í–‰í•˜ê³ , ì‚¬ì§„ê³¼ ê°™ì€ ì„¤ì •ì„ ì§„í–‰í•©ë‹ˆë‹¤. ì²«ë²ˆì§¸ í˜ì´ì§€ í•˜ë‹¨ Display Numberë¥¼ -1ì—ì„œ 0ìœ¼ë¡œ ë³€ê²½ ë‘ë²ˆì§¸ í˜ì´ì§€ í†µê³¼ ì„¸ë²ˆì§¸ í˜ì´ì§€ Native opengl ì²´í¬í•´ì œ í›„ Disable access control ì²´í¬ ë„¤ë²ˆì§¸ í˜ì´ì§€ í†µê³¼ ì•ìœ¼ë¡œ ì¬ë¶€íŒ… ì‹œë§ˆë‹¤ ì´ ì„¤ì •ì„ ë°˜ë³µí•´ì¤˜ì•¼ í•˜ë©°, ì¢…ì¢… Gazeboì˜ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¡œ ì¸í•´ í™”ë©´ì´ ì¢…ë£Œë˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìˆëŠ”ë°, ì´ëŸ° ê²½ìš° XLaunchë¥¼ ê°•ì œ ì¢…ë£Œí•´ì£¼ë©´ ë©ë‹ˆë‹¤.\nì„¤ì •ì´ ì˜ ë˜ì—ˆëŠ”ì§€ Gazeboë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. í„°ë¯¸ë„ ìƒì˜ ì•„ë˜ì˜ 4ì¤„ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì…ë ¥í•©ë‹ˆë‹¤. export GAZEBO_IP=127.0.0.1 export DISPLAY=$(cat /etc/resolv.conf | grep nameserver | awk \u0026#39;{print $2}\u0026#39;):0 export LIBGL_ALWAYS_INDIRECT=0 # ì„¤ì • ì™„ë£Œ í›„ Gazebo ì‹¤í–‰ gazebo ë§ˆì§€ë§‰ìœ¼ë¡œ, ì•ì„  ì„¤ì • ì»¤ë©˜ë“œ ë¼ì¸ì„ ë§¤ë²ˆ ìˆ˜ê³ ìŠ¤ëŸ½ê²Œ ì…ë ¥í•˜ì§€ ì•Šë„ë¡ bashrc ì„¤ì • íŒŒì¼ì„ ìˆ˜ì •í•©ë‹ˆë‹¤. echo \u0026#39;export GAZEBO_IP=127.0.0.1\u0026#39; \u0026gt;\u0026gt; ~/.bashrc echo \u0026#34;export DISPLAY=$(cat /etc/resolv.conf | grep nameserver | awk \u0026#39;{print $2}\u0026#39;):0 \u0026#34; \u0026gt;\u0026gt; ~/.bashrc echo \u0026#39;export LIBGL_ALWAYS_INDIRECT=0\u0026#39; \u0026gt;\u0026gt; ~/.bashrc ì˜¤ë¥˜ FAQ wsl --set-default-version 2 ì—ì„œ ì‘ì—… ì™„ë£Œ ë©”ì„¸ì§€ê°€ ë“±ì¥í•˜ì§€ ì•ŠëŠ” ê²½ìš° â‡’ Linuxìš© Windows í•˜ìœ„ ì‹œìŠ¤í…œ ì„¤ì • ì—¬ë¶€ë¥¼ í™•ì¸í•´ë³´ì‹  ë’¤, ì œì¼ ì²˜ìŒ ëª…ë ¹ì–´ë¶€í„° ì œê°€ ë³´ì—¬ë“œë¦° ì˜ˆì‹œì™€ ë™ì¼í•œ ê²°ê³¼ë¥¼ ì–»ì—ˆëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”\nUbuntu ì„¤ì¹˜ í›„ â€˜The WSL Optional Component is not Enabled. Please Enable it and Try againâ€™ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ê²½ìš° â‡’ ê´€ë¦¬ì ê¶Œí•œ Powershellì—ì„œ ì•„ë˜ì˜ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì…ë ¥í•©ë‹ˆë‹¤.\n\u0026gt; Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux Ubuntu ì„¤ì¹˜ í›„ 0x80370102 ì—ëŸ¬ê°€ ë°œìƒí•œ ê²½ìš° ë¶€íŒ… BIOSì—ì„œ ê°€ìƒí™” ê¸°ëŠ¥ì„ í™œì„±í™”í•´ì¤ë‹ˆë‹¤.\nUbuntu ì„¤ì¹˜ í›„ 0xc03a001a ì—ëŸ¬ê°€ ë°œìƒí•œ ê²½ìš° ë‹¤ìŒ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì„ ì°¸ê³ í•©ë‹ˆë‹¤.\nGazebo ì‹¤í–‰ ì‹œ symbol lookup errorê°€ ë°œìƒí•˜ëŠ” ê²½ìš° sudo apt upgrade -y libignition-math2 ì„ í†µí•´ ëˆ„ë½ëœ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.\n$ gazebo gazebo: symbol lookup error: /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9: undefined symbol: _ZN8ignition10fuel_tools12ClientConfig12SetUserAgentERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE Gazebo ìì²´ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ” ê²½ìš° PC ì¬ì‹œì‘ í›„ ë°±ì‹  í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œì‹œí‚µë‹ˆë‹¤. ì œì–´íŒ â‡’ ì‹œìŠ¤í…œ ë° ë³´ì•ˆ â‡’ Windows ë°©í™”ë²½ â‡’ ê³ ê¸‰ ì„¤ì • =\u0026gt; ì¸ë°”ìš´ë“œ ê·œì¹™ â‡’ VcXsrv ì‚¬ìš© í—ˆìš©ì„ ì ìš©í•©ë‹ˆë‹¤. GazeboëŠ” ì‹¤í–‰ë˜ì§€ë§Œ, Grid (ì‹¤ì„ )ì´ ë“±ì¥í•˜ì§€ ì•ŠëŠ” ê²½ìš° ì•ˆíƒ€ê¹ì§€ë§Œ ê·¸ë˜í”½ ë“œë¼ì´ë²„ ë¬¸ì œì¼ ê°€ëŠ¥ì„±ì´ í½ë‹ˆë‹¤. Window â‡’ ì—…ë°ì´íŠ¸ í™•ì¸ ì§„ì… í›„ ê°€ì¥ ìµœì‹  ë²„ì „ìœ¼ë¡œ ëª¨ë‘ ì—…ê·¸ë ˆì´ë“œë¥¼ ì‹¤í–‰í•´ì¤ë‹ˆë‹¤ ê¸°íƒ€ ê°œë°œ í™˜ê²½ ê°•ì˜ ì¤‘ ì‚¬ìš©í•  ì½”ë“œ í™˜ê²½ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nVSCode + Github Copilot ê°•ì˜ ì¤‘ ì‹¤í–‰í•œ í•œ ì¤„ ì„¤ì¹˜ì—ëŠ” ì œê°€ ê¸°ë³¸ì ìœ¼ë¡œ ì„¤ì •í•œ ì—¬ëŸ¬ ë‹¨ì¶• ì»¤ë©˜ë“œë“¤ì´ ìˆìŠµë‹ˆë‹¤. ëª‡ê°€ì§€ë§Œ ì‹¤ìŠµí•˜ê³  ë„˜ì–´ê°€ë³´ê² ìŠµë‹ˆë‹¤.\neb : edit bashrcì˜ ì•½ìë¡œ ~/.bashrc íŒŒì¼ì„ geditì„ í†µí•´ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. sb : source bashrcì˜ ì•½ìë¡œ ìˆ˜ì •ëœ ~/.bashrc íŒŒì¼ì„ ë°˜ì˜ì‹œí‚µë‹ˆë‹¤. killg : ì‹¤í–‰ì¤‘ì¸ Gazeboê´€ë ¨ ëª¨ë“  í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œì‹œí‚µë‹ˆë‹¤. "
},
{
	"uri": "/kr/ros2_foxy/lecture3/",
	"title": "Lecture3. Core of ROS",
	"tags": [],
	"description": "",
	"content": "Husky Gazebo ê°•ì˜ì— ì•ì„œ, Gazeboìƒì— ClearPathì˜ Huskyë¼ëŠ” ë¡œë´‡ì„ ë“±ì¥ì‹œì¼œë³´ê³ ì í•©ë‹ˆë‹¤.\nimage from : clearpath robotics\nì˜ˆì œ íŒ¨í‚¤ì§€ ì„¤ì¹˜ sudo apt-get update sudo apt install ros-foxy-husky-gazebo sudo apt install ros-foxy-husky-simulator sudo apt install ros-foxy-husky-viz ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰ # Terminal 1 ros2 launch husky_gazebo husky_playpen.launch.py Rviz2 + Controller ì‹¤í–‰ (Rviz2ìƒì˜ interactive markerë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œë´‡ì„ ì´ë™ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.) # Terminal 2 ros2 launch husky_viz view_robot.launch.py ë‹¤ìŒìœ¼ë¡œ, ìƒˆë¡œìš´ í„°ë¯¸ë„ì—ì„œ ì•„ë˜ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì‹¤í–‰ì‹œì¼œ ë´…ì‹œë‹¤. rqt_graph ìœ„ ê·¸ë¦¼ì€ ë°©ê¸ˆ ì „ ì‹¤í–‰í•œ ì˜ˆì œ ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë– í•œ ë™ì‘ë“¤ì´ ì´ë£¨ì–´ì§€ê³  ìˆì—ˆëŠ”ì§€ë¥¼ ë³´ì—¬ì£¼ëŠ” ê²ƒìœ¼ë¡œ, ê°•ì˜ë¥¼ ë§ˆì¹  ë•Œë©´ ì—¬ëŸ¬ë¶„ë“¤ì€ ìœ„ ê·¸ë¦¼ì´ ì–´ë– í•œ ì˜ë¯¸ë¥¼ ê°–ëŠ”ì§€ ëª¨ë‘ ì´í•´í•˜ì‹¤ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.\në‹¤ìŒìœ¼ë¡œ, í„°ë¯¸ë„ì„ ìƒˆë¡œ ì‹¤í–‰ì‹œì¼œ ì•„ë˜ì˜ ëª…ë ¹ì–´ë“¤ì„ ì‹¤í–‰ì‹œì¼œ ë´…ì‹œë‹¤.\nros2 node list $ ros2 node list /controller_manager /ekf_node /gazebo /gazebo_ros2_control /gps_plugin /husky_velocity_controller /imu_filter /imu_plugin ... ros2 topic list $ ros2 topic list /clicked_point /clock /cmd_vel /diagnostics /dynamic_joint_states /e_stop /goal_pose /gps/data /husky_velocity_controller/cmd_vel_unstamped /imu/data /imu/data_raw /imu/mag /initialpose ... ìœ„ ëª…ë ¹ì–´ë“¤ì´ ì–´ë– í•œ ì˜ë¯¸ë¥¼ ê°–ëŠ”ì§€ í•˜ë‚˜í•˜ë‚˜ì”© í•¨ê»˜ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nROS 2 Node ROS 2ëŠ” ê° í”„ë¡œì„¸ìŠ¤ë“¤ì„ Nodeë¼ëŠ” ë‹¨ìœ„ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤.\në¡œë´‡ì„ ì›€ì§ì´ëŠ” Node, ì„¼ì„œì™€ í†µì‹ í•˜ëŠ” Node, ì‹œê°í™” Node ë“± ë‹¤ì–‘í•œ Nodeë“¤ì´ ì–½í˜€ ë¡œë´‡ ì‹œìŠ¤í…œì„ êµ¬ì„±í•˜ê²Œ ë©ë‹ˆë‹¤. Nodeë“¤ ì‚¬ì´ì—ëŠ” ë°ì´í„°ì˜ ì†¡ìˆ˜ì‹ ì´ í•„ìš”í•©ë‹ˆë‹¤. ì´ë¥¼ ë‹´ë‹¹í•˜ëŠ” ROSì˜ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ë“¤ì´ ìˆìœ¼ë©° ê°ê¸° ë‹¤ë¥¸ íŠ¹ì„±ì„ ê°–ê³  ìˆìŠµë‹ˆë‹¤. (topic, service, action) ì‹¤í–‰ì¤‘ì¸ Nodeë¥¼ í™•ì¸í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ì €ëŠ” í¬ê²Œ ë‘ê°€ì§€ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ROS 2 command line interface $ ros2 node list /node1 /node2 /node3 ... rqt_graph rqt_graph # or ros2 run rqt_graph rqt_graph rqt graphë¥¼ ì‚´í´ë³´ë©´, ë™ê·¸ë€ Nodeì™€ Nodeë“¤ ì‚¬ì´ì˜ ë°ì´í„° ì†¡ìˆ˜ì‹ ì´ í™”ì‚´í‘œë¡œ í‘œí˜„ëœ ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Rviz2 markerë¥¼ í†µí•´ ì œì–´ ë°ì´í„°ê°€ ì†¡ì‹ ë˜ì–´ twist_muxë¡œ ì „ë‹¬ë˜ê³  ìˆìœ¼ë©°, ë”°ë¼ì„œ gazeboëŠ” ì´ ë°ì´í„°ë¥¼ í†µí•´ ì‹¤ì œ ë¡œë´‡ì„ ì›€ì§ì´ê²Œ ë˜ëŠ” ê²ƒì…ë‹ˆë‹¤. íŠ¹ì • Nodeì— ëŒ€í•´ì„œ ë” ìì„¸í•œ ì •ë³´ë¥¼ ì–»ê³  ì‹¶ë‹¤ë©´, info ì»¤ë§¨ë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. $ ros2 node info /ekf_node /ekf_node Subscribers: /imu/data: sensor_msgs/msg/Imu /odom: nav_msgs/msg/Odometry /parameter_events: rcl_interfaces/msg/ParameterEvent /set_pose: geometry_msgs/msg/PoseWithCovarianceStamped Publishers: /diagnostics: diagnostic_msgs/msg/DiagnosticArray /odometry/filtered: nav_msgs/msg/Odometry /parameter_events: rcl_interfaces/msg/ParameterEvent /rosout: rcl_interfaces/msg/Log /tf: tf2_msgs/msg/TFMessage Service Servers: /ekf_node/describe_parameters: rcl_interfaces/srv/DescribeParameters ... í˜„ì¬ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•˜ë©° ìˆ˜ë§ì€ í”„ë¡œê·¸ë¨ë“¤ì´ ë™ì‘ë˜ì–´ ë§¤ìš° ë³µì¡í•œ ìƒí™©ì…ë‹ˆë‹¤. ì´ì „ ì˜ˆì œë“¤ì€ ì¼ë‹¨ ì¢…ë£Œì‹œí‚¨ ë’¤, ë³´ë‹¤ ê°„ë‹¨í•œ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. # Terminal 1 ros2 run examples_rclcpp_minimal_publisher publisher_member_function # Terminal 2 ros2 run examples_rclcpp_minimal_subscriber subscriber_member_function # Terminal 3 rqt_graph rqt_graphë¥¼ ë³´ë©´ publisher â‡’ subscriber ë¡œ ë°ì´í„°ê°€ ì „ì†¡ë˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì´ê²ƒì´ ë°”ë¡œ ROS 2ê°€ ë°ì´í„°ë¥¼ ì†¡ìˆ˜ì‹ í•˜ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ êµ¬ì¡°ì…ë‹ˆë‹¤.\nì„œë¡œ ë‹¤ë¥¸ ë‘ í”„ë¡œê·¸ë¨(Node)ì„ ìƒì„±í•˜ê³  ROS 2ì—ì„œ ì‚¬ìš©í•˜ëŠ” íŠ¹ì •í•œ í˜•ì‹ì— ì´ ë‘˜ ì‚¬ì´ì— ì˜¤ê°€ì•¼ í•˜ëŠ” ë°ì´í„°ë¥¼ ì±„ì›Œë„£ìŠµë‹ˆë‹¤. ë‘ í”„ë¡œê·¸ë¨ ì‚¬ì´ í†µì‹ ì€ DDSë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. image from :Â MDS í…Œí¬ ROS 2 Workspace ìƒì„± ROS 2ì˜ PackageëŠ” ê´€ë ¨ëœ íŒŒì¼ë“¤ê³¼ ì½”ë“œë¥¼ í•œë° ëª¨ì•„ë‘” í´ë”ì´ì, ë¹Œë“œì˜ ë‹¨ìœ„ì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ëŸ¬í•œ íŒ¨í‚¤ì§€ëŠ” íŠ¹ì • Workspaceì•ˆì— ë‹´ê²¨ìˆì–´ì•¼ í•©ë‹ˆë‹¤. image from : packthub Workspace?? ë§ˆì¹˜ íŒŒì´ì¬ì˜ ê°€ìƒ í™˜ê²½ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì²˜ëŸ¼, ROS 2 ê°œë°œì„ í•˜ë‹¤ ë³´ë©´ ì§„í–‰í•˜ëŠ” í”„ë¡œì íŠ¸ì— ë”°ë¼ í•˜ë‚˜ì˜ PCì— ì—¬ëŸ¬ ROS 2 í™˜ê²½ì´ í•„ìš”í•´ì§€ëŠ” ê²½ìš°ê°€ ìƒê¹ë‹ˆë‹¤.\nê°•ì˜ìš© WS ê°œë°œìš© WS ë°°í¬ìš© Clean WS etcâ€¦ ROS 2ì—ì„œ ì‚¬ìš©ì¤‘ì¸ colcon ì‹œìŠ¤í…œì€ Workspaceë¥¼ ë‚˜ëˆ”ìœ¼ë¡œ ì´ ì‘ì—…ì„ ì†ì‰½ê²Œ í•´ì¤ë‹ˆë‹¤.\nì´ë²ˆ ê°•ì˜ìš© WSë¥¼ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤. ì´í›„ ì—¬ëŸ¬ë¶„ë“¤ë§Œì˜ WSë„ ë§Œë“¤ì–´ ì‘ì—…í•´ë³´ì„¸ìš”!\nì¼ë°˜ì ìœ¼ë¡œ ROS 2ì˜ workspaceëŠ” _wsë¼ëŠ” ì´ë¦„ì„ ê°–ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ë©°, ìš°ë¦¬ëŠ” ros2_wsë¼ëŠ” workspaceë¥¼ ë§Œë“¤ì–´ë³´ê³ ì í•©ë‹ˆë‹¤. cd ~/ # colcon workspaceëŠ” ë°˜ë“œì‹œ srcë¼ëŠ” í´ë”ê°€ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. mkdir -p ros2_ws/src cd ros2_ws colcon build image from :Â colcon.readthedocs ros2_ws â”œâ”€â”€ build â”‚Â â””â”€â”€ COLCON_IGNORE â”œâ”€â”€ install â”‚Â â”œâ”€â”€ COLCON_IGNORE â”‚Â â”œâ”€â”€ setup.bash â”œâ”€â”€ log â””â”€â”€ src ì‘ì—…ì„ ì™„ë£Œí•˜ë©´, ìœ„ì™€ ê°™ì€ í´ë” êµ¬ì¡°ê°€ ìë™ ìƒì„±ë˜ì—ˆì„ ê²ƒì…ë‹ˆë‹¤.\nbuild : ì»´íŒŒì¼ ëœ í”„ë¡œê·¸ë¨, custom interface ë“±ì´ ìœ„ì¹˜í•˜ê²Œ ë©ë‹ˆë‹¤. install : ros2 launchì™€ ros2 run ë“±ì˜ ëª…ë ¹ì–´ëŠ” í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ ì‹œ ì´ install í´ë” ë‚´ íŒŒì¼ë“¤ì„ ì¡°íšŒí•©ë‹ˆë‹¤. ì¼ì¢…ì˜ ë°”ë¡œê°€ê¸°ë“¤ì˜ ëª¨ì„ì´ë¼ê³  ìƒê°í•˜ë©´ ë©ë‹ˆë‹¤. log : colcon build ì‹œ ë°œìƒí•˜ëŠ” ë¡œë“œë“¤ì´ ìœ„ì¹˜í•˜ê²Œ ë©ë‹ˆë‹¤. src : ëª¨ë“  ì†ŒìŠ¤ ì½”ë“œë“¤ì´ ìœ„ì¹˜í•˜ê²Œ ë©ë‹ˆë‹¤. packageë¥¼ ì§€ìš°ê³  ì‹¶ì€ ê²½ìš°ì—ëŠ” srcì—ì„œ ì½”ë“œ ì›ë³¸ì„ ì§€ìš´ ë’¤, buildì™€ install í´ë”ì—ì„œ í•´ë‹¹ packageì— í•´ë‹¹í•˜ëŠ” ë‚´ìš©ë“¤ë„ ì‚­ì œí•´ì•¼ í•©ë‹ˆë‹¤!\nPackage ìƒì„± ì‹¤ìŠµ ROS 2ì—ì„œëŠ” colconì„ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ packageë¥¼ ìƒì„±í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ, ROS 2ì—ì„œëŠ” ì‚¬ìš©í•˜ëŠ” í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì— ë”°ë¼ ë‹¤ë¥¸ build typeì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ìì£¼ ì‚¬ìš©ë˜ëŠ” ë‘ ì–¸ì–´(python/c++)ì— ëŒ€í•´ì„œ íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•´ë³´ê² ìŠµë‹ˆë‹¤.\nROS 2 Python Package\níŒŒì´ì¬ íŒ¨í‚¤ì§€ì˜ ìƒì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. $ ros2 pkg create --build-type ament_python \u0026lt;package_name\u0026gt; # example $ ros2 pkg create --build-type ament_python my_first_pkg going to create a new package package name: my_first_pkg destination directory: /home/kimsooyoung/ros2_ws/src package format: 3 version: 0.0.0 ... ë‹¤ìŒê³¼ ê°™ì€ í´ë” êµ¬ì¡°ê°€ ìë™ ìƒì„±ë©ë‹ˆë‹¤. my_first_pkg/ â”œâ”€â”€ my_first_pkg â”‚Â â””â”€â”€ __init__.py â”œâ”€â”€ package.xml â”œâ”€â”€ resource â”‚Â â””â”€â”€ my_first_pkg â”œâ”€â”€ setup.cfg â”œâ”€â”€ setup.py â””â”€â”€ test â”œâ”€â”€ test_copyright.py â”œâ”€â”€ test_flake8.py â””â”€â”€ test_pep257.py ìƒˆë¡­ê²Œ ìƒì„±ëœ íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œí•´ë´…ì‹œë‹¤. (ì—¬ê¸°ì„œì˜ ë¹Œë“œëŠ” ì»´íŒŒì¼ì„ ê±°ì¹˜ëŠ” ë¹Œë“œê°€ ì•„ë‹ˆë¼ colcon ì‹œìŠ¤í…œì—ì„œì˜ ë¹Œë“œë¥¼ ëœ»í•©ë‹ˆë‹¤.) $ cd ~/ros2_ws $ colcon build --packages-select my_first_pkg Starting \u0026gt;\u0026gt;\u0026gt; my_first_pkg Finished \u0026lt;\u0026lt;\u0026lt; my_first_pkg [1.56s] Summary: 1 package finished [1.96s] ë¹Œë“œ ê²°ê³¼ë¡œ, workspace ë‚´ë¶€ buildì™€ install í´ë” ë‚´ë¶€ì— í•´ë‹¹ íŒ¨í‚¤ì§€ ì´ë¦„ì„ ê°–ëŠ” í´ë”ê°€ ìƒì„±ë©ë‹ˆë‹¤. $ cd ~/ros2_ws/build $ ls **COLCON_IGNORE my_first_pkg/ $ cd ~/ros2_ws/install $ ls **COLCON_IGNORE my_first_pkg/ ... ROS 2 Cpp Package ëŒ€ë¶€ë¶„ì˜ ì˜¤í”ˆì†ŒìŠ¤ íŒ¨í‚¤ì§€ë“¤ì€ C++ë¡œ ê°œë°œë˜ì–´ ìˆëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, ì‹¤ì œ ì‘ì—… ì‹œ íŒŒì´ì¬ì„ ìœ„ì£¼ë¡œ ì‚¬ìš©í•˜ë”ë¼ë„ ì ì–´ë„ C++ íŒ¨í‚¤ì§€ì˜ êµ¬ì¡°ëŠ” íŒŒì•…í•˜ê³  ìˆì–´ì•¼ ì˜¤ë¥˜ ìƒí™©ì— ëŒ€ì²˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nC++ íŒ¨í‚¤ì§€ì˜ ìƒì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. $ ros2 pkg create --build-type ament_cmake \u0026lt;package_name\u0026gt; # example $ ros2 pkg create --build-type ament_cmake my_first_cpp_pkg going to create a new package package name: my_first_cpp_pkg destination directory: /home/kimsooyoung/ros2_ws/src package format: 3 version: 0.0.0 ... C++ íŒ¨í‚¤ì§€ëŠ” ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¥¼ ê°–ìŠµë‹ˆë‹¤. íŒŒì´ì¬ê³¼ ë‹¬ë¦¬, C++ëŠ” ì»´íŒŒì¼ ì–¸ì–´ì´ê¸° ë•Œë¬¸ì— makeë¥¼ ìœ„í•œ CMakeLists.txt íŒŒì¼ì´ ì¶”ê°€ë˜ì–´ ìˆìŠµë‹ˆë‹¤. my_first_cpp_pkg â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ include â”‚Â â””â”€â”€ my_first_cpp_pkg â”œâ”€â”€ package.xml â””â”€â”€ src ì¼ë°˜ì ìœ¼ë¡œ C++ ê°œë°œì„ í•˜ë‹¤ë³´ë©´ headerì™€ sourceì˜ ë¶„ë¦¬ë¥¼ ì‹œí‚¤ê³¤ í•©ë‹ˆë‹¤. ë¹„ìŠ·í•˜ê²Œ, ROS 2ì—ì„œë„ ë³´í†µ include í´ë” ì•ˆì— í—¤ë” íŒŒì¼ì„ ìœ„ì¹˜ì‹œí‚¤ê³ , src í´ë” ì•ˆì— ì†ŒìŠ¤ ì½”ë“œë¥¼ ìœ„ì¹˜ì‹œí‚µë‹ˆë‹¤.\në¹Œë“œì™€ ì‹¤í–‰ì€ íŒŒì´ì¬ê³¼ ë™ì¼í•œ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. $ colcon build --packages-select my_first_cpp_pkg Starting \u0026gt;\u0026gt;\u0026gt; my_first_cpp_pkg Finished \u0026lt;\u0026lt;\u0026lt; my_first_cpp_pkg [1.56s] Summary: 1 package finished [1.96s] ì´ ì‹œì ì—ì„œ, colconì„ ì‚¬ìš©í•˜ì—¬ packageë¥¼ ë¹Œë“œí•˜ëŠ” ë°©ë²•ë“¤ì„ ì •ë¦¬í•˜ì—¬ ì†Œê°œí•©ë‹ˆë‹¤.\ncolcon build : src í´ë” ë‚´ë¶€ì— ì¡´ì¬í•˜ëŠ” ëª¨ë“  packageë“¤ì„ ë¹Œë“œí•©ë‹ˆë‹¤. colcon build \u0026ndash;packages-up-to : í•´ë‹¹ packageì˜ ì¢…ì†ì„±ì´ ì¡´ì¬í•  ì‹œ, ì´ë“¤ì„ ë¨¼ì € ë¹Œë“œí•˜ê³  pkg-nameì„ ë¹Œë“œí•©ë‹ˆë‹¤. colcon build \u0026ndash;packages-select : í•´ë‹¹ packageë§Œì„ ë¹Œë“œí•©ë‹ˆë‹¤. ìƒˆë¡œìš´ Packageë¥¼ ë¹Œë“œí–ˆë‹¤ë©´, ë³€ê²½ ë‚´ìš©ì„ ê°±ì‹  (source) í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ ì‘ì—…ì—ëŠ” í¬ê²Œ ë‘ê°€ì§€ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.\nsource install/setup.bash â‡’ workspaceë¥¼ sourceí•˜ê³  ROS 2ì‹œìŠ¤í…œ ì „ì²´ë¥¼ ê°±ì‹ í•©ë‹ˆë‹¤. source install/local_setup.bash â‡’ workspaceë§Œì„ sourcesí•©ë‹ˆë‹¤. (ì—¬ëŸ¬ ROS 2 workspaceê°€ ìˆëŠ” ê²½ìš° local_setup.bashë¥¼ ì‚¬ìš©í•©ì‹œë‹¤.) ì°¸ê³ ë¡œ, setup.bashì—ëŠ” ê²°êµ­ local_setup.bashê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\n# source chained prefixes # setting COLCON_CURRENT_PREFIX avoids determining the prefix in the sourced script COLCON_CURRENT_PREFIX=\u0026#34;/opt/ros/foxy\u0026#34; _colcon_prefix_chain_bash_source_script \u0026#34;$COLCON_CURRENT_PREFIX/local_setup.bash\u0026#34; # source this prefix # setting COLCON_CURRENT_PREFIX avoids determining the prefix in the sourced script COLCON_CURRENT_PREFIX=\u0026#34;$(builtin cd \u0026#34;`dirname \u0026#34;${BASH_SOURCE[0]}\u0026#34;`\u0026#34; \u0026gt; /dev/null \u0026amp;\u0026amp; pwd)\u0026#34; _colcon_prefix_chain_bash_source_script \u0026#34;$COLCON_CURRENT_PREFIX/local_setup.bash\u0026#34; unset COLCON_CURRENT_PREFIX unset _colcon_prefix_chain_bash_source_script aptë¥¼ í†µí•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜í•˜ê¸° ë„ë¦¬ ì‚¬ìš©ë˜ê³  ê²€ì¦ëœ íŒ¨í‚¤ì§€ë“¤ì€ ì†ŒìŠ¤ ì½”ë“œ ë¹Œë“œ ì—†ì´ apt ëª…ë ¹ì–´ í•˜ë‚˜ë§Œìœ¼ë¡œ ë¹Œë“œëœ í˜•íƒœë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ, ê°™ì€ ROS 2ì¼ì§€ë¼ë„ ë²„ì „ì— ë”°ë¼ ì¬ì„¤ì¹˜ë¥¼ í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.\n$ sudo apt install ros-\u0026lt;DISTRO\u0026gt;-\u0026lt;pkg-name\u0026gt; $ sudo apt install ros-foxy-turtlesim ì¼ì „, ìš°ë¦¬ê°€ ì‚¬ìš©í–ˆë˜ huskyê´€ë ¨ íŒ¨í‚¤ì§€ë“¤ì€ ëª¨ë‘ apt install ì„ í†µí•´ ì„¤ì¹˜ê°€ ê°€ëŠ¥í•˜ì˜€ê¸°ì— ì½”ë“œì— ëŒ€í•œ ê³ ë ¤ ì—†ì´ ë°”ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë˜ ê²ƒì…ë‹ˆë‹¤.\nROS 2ì—ì„œëŠ” huskyë¥¼ ë¹„ë¡¯í•œ ë‹¤ì–‘í•œ ë¡œë³´í‹±ìŠ¤ íŒ¨í‚¤ì§€ë“¤ì„ ì œê³µí•˜ë©°, ê°œë°œ ì´ˆê¸°ì—ëŠ” ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹ ë¥´ê²Œ ê²€ì¦ì„ í•˜ê³ , ì´í›„ ì§ì ‘ Customizingí•´ì•¼ í•˜ëŠ” ë¶€ë¶„ì€ ë³„ë„ ì†ŒìŠ¤ì½”ë“œ ë¹Œë“œë¥¼ í†µí•´ ì—…ê·¸ë ˆì´ë“œë¥¼ í•˜ê³¤ í•©ë‹ˆë‹¤.\nROS 2 Launch 3ì¢…ë¥˜ì˜ ROS 2 í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•œë‹¤ê³  í•´ë´…ì‹œë‹¤.\nA í”„ë¡œê·¸ë¨ ì‹¤í–‰ í„°ë¯¸ë„ B í”„ë¡œê·¸ë¨ ì‹¤í–‰ í„°ë¯¸ë„ C í”„ë¡œê·¸ë¨ ì‹¤í–‰ í„°ë¯¸ë„ í„°ë¯¸ë„ 3ê°œ ì •ë„ì•¼ ì‹¤í–‰í•˜ë©´ ê·¸ë§Œì¼ ìˆ˜ ìˆì§€ë§Œ, ì´ í”„ë¡œê·¸ë¨ì˜ ê°œìˆ˜ê°€ 10ê°œ, 20ê°œë¡œ ëŠ˜ì–´ë‚œë‹¤ê³  ìƒê°í•´ ë´…ì‹œë‹¤. ğŸ˜‚\nì‹¤í–‰í•´ì•¼ í•˜ëŠ” í”„ë¡œê·¸ë¨ë“¤ì„ ëª¨ë‘ í•˜ë‚˜ì˜ íŒŒì¼ë¡œ ì •ë¦¬í•œ ë‹¤ìŒ, í•´ë‹¹ íŒŒì¼ë§Œ ì‹¤í–‰ì‹œí‚¤ë©´ ì–´ë–¨ê¹Œìš”? ì´ê²ƒì´ ë°”ë¡œ launchì˜ ê°œë…ì…ë‹ˆë‹¤.\nROS 2ì˜ launchíŒŒì¼ì€ pythonê³¼ xmlì„ í†µí•´ êµ¬ì„±í•  ìˆ˜ ìˆëŠ”ë°ìš”, ì €ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ Python ë¬¸ë²•ì„ ì„ í˜¸í•©ë‹ˆë‹¤. ì›ë˜ ì‚¬ìš©í•˜ëŠ” ì–¸ì–´ì´ê¸°ë„ í•˜ê³ , ë§ì€ ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸ë“¤ì´ Python launchë¥¼ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.\nì¼ì „ ì‹¤í–‰í–ˆë˜ husky ì˜ˆì œ ë¶„ì„ì„ í†µí•´ launch êµ¬ì¡°ì— ëŒ€í•´ ì§šê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤. ros2ì˜ launch ëª…ë ¹ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. $ ros2 launch \u0026lt;package-name\u0026gt; \u0026lt;launch-file-name\u0026gt; $ ros2 launch husky_gazebo husky_playpen.launch.py í•´ë‹¹ launch íŒŒì¼ì„ ì—´ì–´ë³´ë©´, ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.(ë§í¬) ì°¸ê³ ë¡œ, python íŒŒì¼ì˜ ê²½ìš° .launch.pyë¡œ ì´ë¦„ì§“ëŠ” ê²ƒì´ ì•”ë¬µì ì¸ ê·œì¹™ì…ë‹ˆë‹¤. from launch import LaunchDescription from launch.actions import IncludeLaunchDescription from launch.launch_description_sources import PythonLaunchDescriptionSource from launch.substitutions import PathJoinSubstitution from launch_ros.substitutions import FindPackageShare def generate_launch_description(): world_file = PathJoinSubstitution( [FindPackageShare(\u0026#34;husky_gazebo\u0026#34;), \u0026#34;worlds\u0026#34;, \u0026#34;clearpath_playpen.world\u0026#34;], ) gazebo_launch = PathJoinSubstitution( [FindPackageShare(\u0026#34;husky_gazebo\u0026#34;), \u0026#34;launch\u0026#34;, \u0026#34;gazebo.launch.py\u0026#34;], ) gazebo_sim = IncludeLaunchDescription( PythonLaunchDescriptionSource([gazebo_launch]), launch_arguments={\u0026#39;world_path\u0026#39;: world_file}.items(), ) ld = LaunchDescription() ld.add_action(gazebo_sim) return ld í•­ìƒ launch fileì˜ ë¶„ì„ì€ ê°€ì¥ í•˜ë‹¨ë¶€í„° ì‹œì‘í•©ë‹ˆë‹¤. ld = LaunchDescription() ld.add_action(gazebo_sim) return ld LaunchDescriptionì•ˆì— ì‹¤í–‰ì„ ì›í•˜ëŠ” í”„ë¡œê·¸ë¨ë“¤ì„ ì „ë‹¬í•˜ê³ , launch ëª…ë ¹ ì‹œ ì´ë“¤ì„ ì‹¤ì œ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ launch fileì„ ì‘ì„±í•˜ëŠ” ì´ìœ ì…ë‹ˆë‹¤.\nìƒë‹¨ ì˜µì…˜ì„ í•˜ë‚˜ì”© ì‚´í”¼ê² ìŠµë‹ˆë‹¤. launch fileì—ì„œ íŠ¹ì • í´ë”, íŒŒì¼ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ packageì— ê¸°ë°˜í•˜ì—¬ ê²½ë¡œë¥¼ íƒìƒ‰í•©ë‹ˆë‹¤. world_file = PathJoinSubstitution( [FindPackageShare(\u0026#34;husky_gazebo\u0026#34;), \u0026#34;worlds\u0026#34;, \u0026#34;clearpath_playpen.world\u0026#34;], ) gazebo_launch = PathJoinSubstitution( [FindPackageShare(\u0026#34;husky_gazebo\u0026#34;), \u0026#34;launch\u0026#34;, \u0026#34;gazebo.launch.py\u0026#34;], ) worldë€ gazeboìƒì˜ í™˜ê²½ì„ ë‚˜íƒ€ë‚´ëŠ” íŒŒì¼ë¡œ ì•„ë˜ì™€ ê°™ì€ í…ìŠ¤íŠ¸ í˜•ì‹ì„ ê°–ìŠµë‹ˆë‹¤. (ì´í›„ Gazebo ì‹œê°„ì— ì‚´í´ë³´ê³ ì í•©ë‹ˆë‹¤.) \u0026lt;sdf version=\u0026#39;1.4\u0026#39;\u0026gt; \u0026lt;world name=\u0026#39;default\u0026#39;\u0026gt; \u0026lt;light name=\u0026#39;sun\u0026#39; type=\u0026#39;directional\u0026#39;\u0026gt; \u0026lt;cast_shadows\u0026gt;1\u0026lt;/cast_shadows\u0026gt; \u0026lt;pose\u0026gt;0 0 10 0 -0 0\u0026lt;/pose\u0026gt; \u0026lt;diffuse\u0026gt;0.8 0.8 0.8 1\u0026lt;/diffuse\u0026gt; \u0026lt;specular\u0026gt;0.2 0.2 0.2 1\u0026lt;/specular\u0026gt; \u0026lt;attenuation\u0026gt; \u0026lt;range\u0026gt;1000\u0026lt;/range\u0026gt; \u0026lt;constant\u0026gt;0.9\u0026lt;/constant\u0026gt; \u0026lt;linear\u0026gt;0.01\u0026lt;/linear\u0026gt; \u0026lt;quadratic\u0026gt;0.001\u0026lt;/quadratic\u0026gt; \u0026lt;/attenuation\u0026gt; \u0026lt;direction\u0026gt;-0.5 0.1 -0.9\u0026lt;/direction\u0026gt; \u0026lt;/light\u0026gt; \u0026lt;model name=\u0026#39;ground_plane\u0026#39;\u0026gt; ... í˜„ì¬ husky_playpenëŠ” ë‹¤ë¥¸ launch íŒŒì¼ì„ ë˜ë‹¤ì‹œ includeí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ ì‹¤í–‰ì‹œì¼œì•¼ í•  í”„ë¡œê·¸ë¨ë“¤ì´ ë§ì„ ë•Œ, launch file ìì²´ë¥¼ ê³„ì¸µ êµ¬ì¡°ë¡œ ì‹¤í–‰ì‹œí‚¤ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤. gazebo_launch = PathJoinSubstitution( [FindPackageShare(\u0026#34;husky_gazebo\u0026#34;), \u0026#34;launch\u0026#34;, \u0026#34;gazebo.launch.py\u0026#34;], ) gazebo_sim = IncludeLaunchDescription( PythonLaunchDescriptionSource([gazebo_launch]), launch_arguments={\u0026#39;world_path\u0026#39;: world_file}.items(), ) í•˜ìœ„ launch fileì¸ gazebo.launch.py ë‚´ë¶€ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ë³µì¡í•œ í˜•íƒœë¥¼ ê°–ê³  ìˆì–´ í˜„ì¬ ëª¨ë“  ë‚´ìš©ì„ ì„¤ëª…í•  ìˆ˜ëŠ” ì—†ì§€ë§Œ, launch íŒŒì¼ì€ ë°›ë“œì‹œ LaunchDescriptionì„ í¬í•¨í•˜ê³ , LaunchDescriptionìœ¼ë¡œ ì „ë‹¬ë˜ëŠ” í”„ë¡œê·¸ë¨ë“¤ì´ ì‹¤í–‰ë˜ëŠ” ì£¼ì²´ì„ì„ ë‹¤ì‹œ í•œ ë²ˆ ê°•ì¡°ë“œë¦½ë‹ˆë‹¤! ld = LaunchDescription(ARGUMENTS) ld.add_action(gz_resource_path) ld.add_action(node_robot_state_publisher) ld.add_action(spawn_joint_state_broadcaster) ld.add_action(diffdrive_controller_spawn_callback) ld.add_action(gzserver) ld.add_action(gzclient) ld.add_action(spawn_robot) ld.add_action(launch_husky_control) ld.add_action(launch_husky_teleop_base) return ld [ê°„ëµë²„ì „] Launch file ì‘ì„±ë²• ROS 2ëŠ” ì›Œë‚™ ë°©ëŒ€í•œ ì˜¤í”„ ì†ŒìŠ¤ íŒ¨í‚¤ì§€ë“¤ì„ ê°–ê³  ìˆì–´ ì•½ê°„ì˜ ê³¼ì¥ì„ ë³´íƒœë©´ ì½”ë“œ í•œ ì¤„ ì—†ì´ ë¡œë´‡ì„ ì œì‘í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\ní•˜ì§€ë§Œ, ì–´ë– í•œ í”„ë¡œê·¸ë¨ë“¤ì„ ì‹¤í–‰í•˜ê³ , ì‹¤í–‰ ì‹œ ì˜µì…˜ì€ ì–´ë–»ê²Œ í• ë‹¹í•´ì•¼ í•˜ëŠ”ì§€ëŠ” ì•Œê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì´ìœ ì—ì„œ, í”„ë¡œê·¸ë˜ë° í•™ìŠµë³´ë‹¤ ì•ì„œ ROS 2ì˜ launch file ì‘ì„±ë²•ì„ ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•˜ê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.\në°©ê¸ˆ ì „ ìƒì„±í•œ my_first_pkg íŒ¨í‚¤ì§€ ë‚´ë¶€ì— launch í´ë”ë¥¼ ìƒì„±í•˜ê³ , ì•„ë˜ ì½”ë“œë¥¼ ë³µì‚¬ \u0026amp; ë¶™ì—¬ë„£ê¸° í•©ë‹ˆë‹¤. (my_first_pkgì…ë‹ˆë‹¤! my_first_cpp_pkgê°€ ì•„ë‹™ë‹ˆë‹¤.) # my_first_launch.launch.py from launch import LaunchDescription from launch_ros.actions import Node def generate_launch_description(): turtlesim_node = Node( package=\u0026#34;turtlesim\u0026#34;, executable=\u0026#34;turtlesim_node\u0026#34;, name=\u0026#34;turtlesim_node\u0026#34;, ) return LaunchDescription([ turtlesim_node, ]) Keyword Description Node Node í•˜ë‚˜ë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆëŠ” ì˜µì…˜ì…ë‹ˆë‹¤. package ì‹¤í–‰ì‹œí‚¬ Nodeê°€ í¬í•¨ëœ packageë¥¼ ì„ íƒí•´ì¤ë‹ˆë‹¤. executable c++ Nodeì˜ ê²½ìš°, colcon buildë¥¼ í•˜ë©´ ì‹¤í–‰ ê°€ëŠ¥í•œ í”„ë¡œê·¸ë¨ì´ ìƒì„±ë©ë‹ˆë‹¤. pythonì˜ ê²½ìš°ë„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰ ì‹œí‚¤ê²Œ ë˜ë©°, ì´ëŠ” ì¶”í›„ ì½”ë”© ì‹¤ìŠµì„ ê±°ì¹˜ë©´ ì™„ë²½íˆ ì´í•´í•˜ì‹¤ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤. parameters ì‹¤í–‰ì‹œí‚¬ Nodeì˜ ì¶”ê°€ ë§¤ê°œë³€ìˆ˜ê°€ ìˆë‹¤ë©´ ì´ ë¶€ë¶„ì— ì¶”ê°€ë©ë‹ˆë‹¤. ì, ìƒˆë¡œìš´ launch íŒŒì¼ì„ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.\n$ ros2 launch my_first_pkg my_first_launch.launch.py file \u0026#39;my_first_launch.launch.py\u0026#39; was not found in the share directory of package... â‡’ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì˜€ìŠµë‹ˆë‹¤! ì´ëŠ” install í´ë” ë‚´ë¶€ì— symbolic linkê°€ ìƒì„±ë˜ì§€ ì•Šì•„ ë°œìƒí•œ ì˜¤ë¥˜ì…ë‹ˆë‹¤.\ncolcon build ì‹œ colconì€ install/\u0026lt;package_name\u0026gt;/share í´ë” ë‚´ë¶€ì— íŒŒì¼ë“¤ì˜ symbolic linkë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ë”ë¶ˆì–´ ì–´ë– í•œ íŒŒì¼ë“¤ì— ëŒ€í•´ linkë¥¼ ë§Œë“¤ ê²ƒì¸ì§€ ì „ë‹¬í•´ì£¼ì–´ì•¼ í•˜ë©°, ì´ëŠ” setup.pyì—ì„œ ì„¤ì • ê°€ëŠ¥í•©ë‹ˆë‹¤.\nsetup.py ìˆ˜ì • import os from glob import glob from setuptools import setup package_name = \u0026#39;my_first_pkg\u0026#39; setup( name=package_name, version=\u0026#39;0.0.0\u0026#39;, packages=[package_name], data_files=[ (\u0026#39;share/ament_index/resource_index/packages\u0026#39;, [\u0026#39;resource/\u0026#39; + package_name]), (\u0026#39;share/\u0026#39; + package_name, [\u0026#39;package.xml\u0026#39;]), (os.path.join(\u0026#39;share\u0026#39;, package_name, \u0026#39;launch\u0026#39;), glob(\u0026#39;launch/*.launch.py\u0026#39;)), ], ... ë‹¤ìŒìœ¼ë¡œ ì•„ë˜ì˜ ì»¤ë©˜ë“œ ë¼ì¸ì„ ìˆœì„œëŒ€ë¡œ ì…ë ¥í•´ ì£¼ì„¸ìš”! # í´ë” ì´ë™ cd ~/ros2_ws # colcon build colcon build --packages-select my_first_pkg # ë³€ê²½ ì ìš© source install/setup.bash # ì‹¤í–‰! ros2 launch my_first_pkg my_first_launch.launch.py ì´ë ‡ê²Œ launch fileì„ ì§ì ‘ ìƒì„±í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. ì£¼ëª©í•  ì ì€, ì œê°€ ë³´ì—¬ë“œë¦° ê²ƒì´ í•˜ë‚˜ì˜ ì˜ˆì‹œì¼ ë¿ì´ë©°, launch fileì€ ì—¬ëŸ¬ í˜•ì‹ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.\n# my_first_pkg return LaunchDescription([ turtlesim_node, ]) # husky_gazebo ld = LaunchDescription(ARGUMENTS) ld.add_action(gz_resource_path) ld.add_action(node_robot_state_publisher) ld.add_action(spawn_joint_state_broadcaster) ld.add_action(diffdrive_controller_spawn_callback) ld.add_action(gzserver) ld.add_action(gzclient) ld.add_action(spawn_robot) ld.add_action(launch_husky_control) ld.add_action(launch_husky_teleop_base) return ld ROS 2 ìì²´ê°€ ì˜¤í”ˆì†ŒìŠ¤ì— ê¸°ë°˜í•˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©ìë“¤ë§ˆë‹¤ ê°ê¸° ë‹¤ë¥¸ ë°©ì‹ì´ ìˆìŠµë‹ˆë‹¤. ëª¨ë“  ë°©ì‹ì„ ë‹¤ ì„¤ëª…í•  ìˆ˜ëŠ” ì—†ìœ¼ë‚˜ ê°€ì¥ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ê²ƒë“¤ì€ ëŒ€ë¶€ë¶„ ê°™ì´ ë‹¤ë£¨ì–´ë³´ê² ìŠµë‹ˆë‹¤!\n"
},
{
	"uri": "/kr/ros2_foxy/lecture4/",
	"title": "Lecture4. ROS 2 Node and Parameter Programming",
	"tags": [],
	"description": "",
	"content": "ì§€ë‚œ ì‹œê°„ ì‚´í´ë³¸ ë°”ì™€ ê°™ì´ ROS 2ì—ì„œ í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë˜ëŠ” ë‹¨ìœ„ëŠ” Nodeë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ê´€ë¦¬ë©ë‹ˆë‹¤.\nì—¬ëŸ¬ë¶„ë“¤ê»˜ì„œ ì›í•˜ëŠ” ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ëŠ” Nodeë¥¼ ìƒì„±í•˜ê³ , ì´ë¥¼ ë‹´ì€ íŒ¨í‚¤ì§€ë¥¼ ì‘ì„±í•˜ê³ , ê´€ë ¨ëœ íŒ¨í‚¤ì§€ë“¤ì„ ë¬¶ì–´ ë©”íƒ€íŒ¨í‚¤ì§€ë¥¼ êµ¬ì„±í•˜ëŠ” ì‹ìœ¼ë¡œ ROS 2 ê°œë°œì´ ì§„í–‰ë©ë‹ˆë‹¤.\nì˜¤ëŠ˜ì€ ê·¸ ì‹œì‘ì´ ë˜ëŠ” Nodeì˜ ê¸°ì´ˆ í”„ë¡œê·¸ë˜ë°ì„ ì‹¤ìŠµí•´ë³´ê² ìŠµë‹ˆë‹¤.\nì²« ì½”ë”© ê°•ì˜ì˜ ì‹œì‘ì´ë¯€ë¡œ, ì œê°€ ì‚¬ìš©í•˜ëŠ” í™˜ê²½ê³¼ ì…‹ì—…ë„ ê³µìœ ë“œë¦´ ì˜ˆì •ì…ë‹ˆë‹¤.\nPython ê°œë°œ : VSCodeì™€ Copilot C++ ê°œë°œ : Clionê³¼ Copilot ROS 2 í”„ë¡œê·¸ë˜ë°ì˜ ê²½ìš° ì¼ë°˜ì ì¸ í”„ë¡œê·¸ë˜ë°ê³¼ ë”ë¶ˆì–´ tf, í†µì‹  ë©”ì»¤ë‹ˆì¦˜, ë©€í‹° í”„ë¡œì„¸ì‹± ë“± ì‹¤ì œ ë™ì‘ì‹œì¼œë³´ì§€ ì•Šìœ¼ë©´ ì•Œ ìˆ˜ ì—†ëŠ” ê¸°ëŠ¥ë“¤ì˜ êµ¬í˜„ì´ ì¦ìŠµë‹ˆë‹¤. ì¦ì€ í™•ì¸ê³¼ Command and Conquer ë°©ì‹ìœ¼ë¡œ ì ‘ê·¼í•´ë³´ê² ìŠµë‹ˆë‹¤. ğŸ˜Š\nROS 2 Node Programming - Python ì œê°€ ë¯¸ë¦¬ ì¤€ë¹„í•´ ë‘” íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œí•´ë´…ì‹œë‹¤. cd ~/ros2_ws/src git clone https://github.com/RB2023ROS/du2023-ros2.git # ë¹Œë“œëŠ” í•­ìƒ WSì˜ ìµœìƒë‹¨ ë””ë ‰í† ë¦¬ì—ì„œ ì§„í–‰í•©ë‹ˆë‹¤!!! cd ~/ros2_ws cbp py_node_tutorial # or colcon build --packages-select py_node_tutorial # ë¹Œë“œ í›„ í•­ìƒ ì†Œì‹±!!! cd ~/ros2_ws rosfoxy # or source install/local_setup.bash example 1 - Hello ROS 2 ì•ì„œ ë¹Œë“œëœ ì˜ˆì‹œë¥¼ ì‹¤í–‰ì‹œì¼œë³´ê² ìŠµë‹ˆë‹¤. $ ros2 run py_node_tutorial example_node_1 [INFO] [1680692820.096342214] [example_node_1]: ==== Hello ROS 2 ==== ëª¨ë“  ì˜ˆì œ ì½”ë“œëŠ” Github ë§í¬ì—ì„œë„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì½”ë“œ ë¶„ì„ rclì€ ROS Client Librariesì˜ ì•½ìë¡œ ROS 2ì—ì„œëŠ” rclc, rclcpp, rclpy, rcljsì™€ ê°™ì€ ë‹¤ì–‘í•œ ì–¸ì–´ë¥¼ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤. íŒŒì´ì¬ì—ì„œ ROS 2 ê°œë°œì„ í•˜ê¸° ìœ„í•´ì„œëŠ” í•„ìˆ˜ì ìœ¼ë¡œ rclpyì˜ importê°€ í•„ìš”í•˜ë©° Nodeì˜ ì‚¬ìš©ì„ ìœ„í•´ì„œ Node classë¥¼ import í•´ì•¼ í•©ë‹ˆë‹¤.\n# !/usr/bin/env python3 import rclpy from rclpy.node import Node rclpy ì½”ë”© ê·œì¹™ ROS 2ì—ì„œ íŒŒì´ì¬ íŒŒì¼ì„ ì¡°íšŒí•˜ê³  ì‹¤í–‰í•˜ëŠ” ì¼ë ¨ì˜ ì •í•´ì§„ ê³¼ì •ì´ ìˆì–´ ì•„ë˜ì™€ ê°™ì´ main()ë¶€ë¶„ì„ í•­ìƒ ë”°ë¡œ ë¶„ë¦¬í•˜ì—¬ ì‘ì„±í•˜ë„ë¡ í•©ë‹ˆë‹¤.\nif __name__ == \u0026#39;__main__\u0026#39;: \u0026#34;\u0026#34;\u0026#34;main function\u0026#34;\u0026#34;\u0026#34; main() Node ìƒì„± def main(args=None): \u0026#34;\u0026#34;\u0026#34;Do enter into this main function first.\u0026#34;\u0026#34;\u0026#34; rclpy.init(args=args) node = Node(\u0026#39;node_name\u0026#39;) node.get_logger().info(\u0026#39;\\n==== Hello ROS 2 ====\u0026#39;) node.destroy_node() rclpy.shutdown() ì‹¤ì œ ë™ì‘ì„ ìˆ˜í–‰í•˜ëŠ” main í•¨ìˆ˜ë¥¼ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê³¼ì •ì„ ê±°ì¹˜ê³  ìˆìŠµë‹ˆë‹¤.\nFunction Description rclpy.init initialization, ì¦‰ ì´ˆê¸°í™”ë¥¼ í•˜ê³  ìˆìŠµë‹ˆë‹¤. node = Node(\u0026rsquo;node_name') Nodeë¥¼ ìƒì„±í•˜ëŠ” ë¶€ë¶„ìœ¼ë¡œ ì•ì„œ importí•œ Node classë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë§¤ê°œë³€ìˆ˜ë¡œ nodeì˜ ì´ë¦„ì´ ë“¤ì–´ê°‘ë‹ˆë‹¤. node.destroy_node() Nodeë¥¼ ìƒì„±í•˜ê³  ì›í•˜ëŠ” ì‘ì—…ì„ ëª¨ë‘ ìˆ˜í–‰í–ˆë‹¤ë©´, ì´ì œ ì‚¬ìš©í–ˆë˜ Nodeë¥¼ ì œê±°í•´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤. (ê·¸ë˜ì•¼ ë¶ˆí•„ìš”í•œ ìì›ì˜ ë‚­ë¹„ë¥¼ ì¤„ì¼ ìˆ˜ ìˆê² ì§€ìš”.) rclpy.shutdown() ì´ë²ˆ ì˜ˆì‹œ ì²« ë¶€ë¶„, rclpy.init()ì„ í†µí•˜ì—¬ ì´ˆê¸°í™”ë¥¼ í•´ì£¼ì—ˆìŠµë‹ˆë‹¤. ì´ì œ rclpyë¥¼ í†µí•œ ì‘ì—…ì´ ëª¨ë‘ ëë‚¬ìœ¼ë¯€ë¡œ ì•ˆì „í•˜ê²Œ ì¢…ë£Œì‹œì¼œì¤ë‹ˆë‹¤. â‡’ ìœ„ ê³¼ì •ì´ Pythonì—ì„œ rclpyë¥¼ í†µí•´ Nodeë¥¼ ë‹¤ë£¨ëŠ” ê¸°ë³¸ ì ˆì°¨ì…ë‹ˆë‹¤. (get_logger ë¶€ë¶„ì€ ì´í›„ì— ê³„ì†í•´ì„œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.)\nsetup.py ìˆ˜ì • íŒŒì´ì¬ íŒŒì¼ì„ ros2 run ìœ¼ë¡œ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œ íŒ¨í‚¤ì§€ ë‚´ setup.py íŒŒì¼ì— entry_pointsë¥¼ ì¶”ê°€í•´ ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. entry_points={ \u0026#39;console_scripts\u0026#39;: [ \u0026#39;example_node_1 = py_node_tutorial.node_example_1:main\u0026#39;, \u0026#39;example_node_2 = py_node_tutorial.node_example_2:main\u0026#39;, \u0026#39;example_node_3 = py_node_tutorial.node_example_3:main\u0026#39;, \u0026#39;example_node_4 = py_node_tutorial.node_example_4:main\u0026#39;, \u0026#39;example_node_5 = py_node_tutorial.node_example_5:main\u0026#39;, ], }, ì‘ì„±í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. â‡’ ì‹¤í–‰ ì‹œ ì‚¬ìš©ë  ì´ë¦„ = \u0026lt;íŒ¨í‚¤ì§€ ì´ë¦„\u0026gt;.\u0026lt;íŒŒì¼ ì´ë¦„\u0026gt;.main ì‹¤í–‰ ì‹œ ì´ë¦„ íŒ¨í‚¤ì§€ ì´ë¦„ íŒŒì¼ ì´ë¦„ example_node_1 py_node_tutorial node_example_1 ì§„ì… ì§€ì (entry_points)ë¥¼ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ íŒŒì´ì¬ íŒŒì¼ì´ ìˆì–´ë„ ros2 run ê³¼ ê°™ì€ ì»¤ë©˜ë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ê²Œ ë©ë‹ˆë‹¤.\n[ê³¼ì œ] ë‚˜ë§Œì˜ Nodeë¥¼ êµ¬í˜„í•˜ëŠ” íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìƒì„±í•˜ì—¬ ros2 runìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•´ë³´ì„¸ìš”!\nexample 2 - timer ê³„ì†í•´ì„œ Timer ì˜ˆì‹œì…ë‹ˆë‹¤. ë¡œë´‡ì€ ì¼ë°˜ì ìœ¼ë¡œ ì‹¤í–‰ëœ ì´í›„ ê³„ì†í•´ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•´ì•¼ í•˜ê¸°ì— ì£¼ê¸°ì ìœ¼ë¡œ ë¬´ì–¸ê°€ë¥¼ ì‹¤í–‰í•˜ëŠ” ì¼ì´ ì¦ìŠµë‹ˆë‹¤. ì´ë¥¼ êµ¬í˜„í•˜ëŠ” Timerë¥¼ ì‚´í´ë´…ì‹œë‹¤. $ ros2 run py_node_tutorial example_node_2 ==== Hello ROS 2 : 1==== ==== Hello ROS 2 : 2==== ==== Hello ROS 2 : 3==== ==== Hello ROS 2 : 4==== ==== Hello ROS 2 : 5==== mainë¬¸ì— ì¶”ê°€ëœ create_timerì™€ timer_callback í•¨ìˆ˜ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. def timer_callback(): \u0026#34;\u0026#34;\u0026#34;Timer will run this function periodically.\u0026#34;\u0026#34;\u0026#34; global count count += 1 print(f\u0026#39;==== Hello ROS 2 : {count}====\u0026#39;) def main(args=None): \u0026#34;\u0026#34;\u0026#34;Do enter into this main function first.\u0026#34;\u0026#34;\u0026#34; rclpy.init(args=args) node = Node(\u0026#39;node_name\u0026#39;) node.create_timer(0.2, timer_callback) rclpy.spin(node) node.destroy_node() rclpy.shutdown() timer ìƒì„± ì‹œ create_timerë¼ëŠ” í•¨ìˆ˜ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤.\nCode Description timer_period_sec ì‹¤í–‰ ì£¼ê¸° (ì´ˆ) callback í•´ë‹¹ ì£¼ê¸°ë§ˆë‹¤ ì‹¤í–‰ë  í•¨ìˆ˜ ë™ê¸°/ë¹„ë™ê¸°ì˜ ì¸¡ë©´ì—ì„œ timerì™€ Nodeì˜ ë¶„ì„ì€ ì´í›„ ê°•ì˜ì—ì„œ ì´ì–´ì§‘ë‹ˆë‹¤. ì§€ê¸ˆì€ ê¸°ë³¸ì ì¸ ì½”ë”©ì—ë§Œ ì§‘ì¤‘í•˜ê² ìŠµë‹ˆë‹¤!\nexample 3 - spin_once, spin Nodeì˜ ìƒíƒœë¥¼ ì‚´í”¼ë©´ì„œ ë°˜ë³µ ì‹¤í–‰ì‹œí‚¤ëŠ” spin í•¨ìˆ˜ì— ëŒ€í•´ ì¢€ ë” ìì„¸í•˜ê²Œ ì‚´í´ë´…ë‹ˆë‹¤. $ ros2 run py_node_tutorial example_node_3 ==== Hello ROS 2 : 1==== ==== Hello ROS 2 : 2==== ==== Hello ROS 2 : 3==== ... NodeëŠ” ìƒíƒœë¥¼ ì§€ì† ìœ ì§€í•˜ë©´ì„œ ë³€ê²½ëœ ë‚´ìš©ì— ë”°ë¼ ì§€ì •ëœ ë™ì‘ì„ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” ë¡œë´‡ í”„ë¡œê·¸ë¨ì—ì„œ ë§¤ìš° ë³´í¸ì ì¸ ì‘ì—…ìœ¼ë¡œ, ROS 2ì—ì„œëŠ” **spin()**ì´ë¼ëŠ” ì´ë¦„ì˜ í•¨ìˆ˜ë¡œ ê¸°ëŠ¥ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. def main(args=None): \u0026#34;\u0026#34;\u0026#34;Do enter into this main function first.\u0026#34;\u0026#34;\u0026#34; rclpy.init(args=args) node = Node(\u0026#39;node_name\u0026#39;) node.create_timer(0.2, timer_callback) # 1. spin_once() will run node only once. # timeout_sec: Seconds to wait. # Block forever if ``None`` or negative. Don\u0026#39;t wait if 0. rclpy.spin_once(node, timeout_sec=10) # # 2. spin() will run node until Ctrl+C. rclpy.spin(node) # # 3. spin_once() with while loop will run node periodically. while True: rclpy.spin_once(node, timeout_sec=10) node.destroy_node() rclpy.shutdown() spinì„ ë¹„ë¡¯í•˜ì—¬ spin_once, spin_until_future_completeì™€ ê°™ì´ í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ì„ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ë‹¤ì–‘í•œ ì¶”ê°€ í•¨ìˆ˜ë“¤ì´ ì¡´ì¬í•˜ë©°, ì˜ˆì‹œì—ì„œëŠ” 3ê°€ì§€ ìì£¼ ì‚¬ìš©ë˜ëŠ” íŒ¨í„´ì„ ì œì‹œí•˜ê³  ìˆìŠµë‹ˆë‹¤.\nCode Description spin_once() Nodeë¥¼ ë‹¨ í•œë²ˆë§Œ ì‹¤í–‰ spin() Ctrl+C ì…ë ¥ ì „ê¹Œì§€ ê³„ì†í•´ì„œ ì‹¤í–‰ while + spin_once() spinê³¼ ë”ë¶ˆì–´ ë‹¤ë¥¸ ë¬´ì–¸ê°€ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” íŒ¨í„´ example 4 - OOP Node ì˜ˆì œ ì‹¤í–‰ì˜ ê²°ê³¼ëŠ” ì´ì „ê³¼ ê°™ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ êµ¬í˜„ì—ì„œ OOPë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ì°¨ì´ë¥¼ ê°–ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤. $ ros2 run py_node_tutorial example_node_4 [INFO] [1657348011.971419700] [composition_example_node]: ==== Hello ROS 2 : 1==== [INFO] [1657348012.163466100] [composition_example_node]: ==== Hello ROS 2 : 2==== [INFO] [1657348012.363590700] [composition_example_node]: ==== Hello ROS 2 : 3==== classë¥¼ ì‚¬ìš©í•˜ì—¬ Nodeë¥¼ êµ¬í˜„í•œ ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. class NodeClass(Node): \u0026#34;\u0026#34;\u0026#34;Second Node Class. Just print log periodically. \u0026#34;\u0026#34;\u0026#34; def __init__(self): \u0026#34;\u0026#34;\u0026#34;Node Initialization. You must type name of the node in inheritanced initializer. \u0026#34;\u0026#34;\u0026#34; super().__init__(\u0026#39;composition_example_node\u0026#39;) self.create_timer(0.2, self.timer_callback) self._count = 1 def timer_callback(self): \u0026#34;\u0026#34;\u0026#34;Timer will run this function periodically.\u0026#34;\u0026#34;\u0026#34; self.get_logger().info(f\u0026#39;==== Hello ROS 2 : {self._count}====\u0026#39;) self._count += 1 ROS 1ê³¼ ë‹¬ë¦¬, ROS 2ì˜ OOP êµ¬í˜„ì€ Nodeë¥¼ ìƒì†ë°›ìŠµë‹ˆë‹¤. (ë•Œë¬¸ì— ìƒì„± ì‹œ, Nodeì´ë¦„ì„ super().__init__()ì•ˆì— ë„£ì–´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.) ì´ë ‡ê²Œ ê°ì²´ì§€í–¥ì„ ì‚¬ìš©í•˜ë©´ Nodeì˜ ê¸°ëŠ¥ë“¤ì„ ì ê·¹ í™œìš©í•˜ì—¬ ë”ìš± ì‰½ê³  ê°•ë ¥í•œ ROS 2 ê°œë°œì´ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.\nrclpy logger super().__init__(\u0026#39;node_name\u0026#39;) ... node.get_logger().info(\u0026#39;\\n==== Hello ROS 2 ====\u0026#39;) ROS 1ì˜ rospy.loginfo()ì™€ ê°™ì´ rclpyì—ì„œë„ get_logger()ë¼ëŠ” logging APIë¥¼ ì œê³µí•©ë‹ˆë‹¤. ë‹¤ë§Œ, rclpyì˜ loggerëŠ” Nodeì— ì¢…ì†ë˜ëŠ” ê°œë…ì…ë‹ˆë‹¤. (ROS 2ì—ì„œëŠ” ì—¬ëŸ¬ Nodeê°€ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ ì•ˆì—ì„œ ì‹¤í–‰ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.)\nget_logger()ë¥¼ ì‚¬ìš©í•˜ë©´ ì¼ë°˜ì ì¸ print ì½˜ì†” ì¶œë ¥ê³¼ëŠ” ë‹¬ë¦¬, ì‹¤í–‰ì¤‘ì¸ Nodeì´ë¦„, ì‹œê°„, ìœ„í—˜ì„± ë“±ì„ ë””ë²„ê¹…í•  ìˆ˜ ìˆì–´ ì´í›„ ë³µì¡í•œ ì‹œìŠ¤í…œì—ì„œ í° ë„ì›€ì´ ë©ë‹ˆë‹¤.\nexample 5 - Logger Level ê¸°ë³¸ node í”„ë¡œê·¸ë˜ë°ì˜ ë§ˆì§€ë§‰ ì˜ˆì‹œì…ë‹ˆë‹¤. $ ros2 run py_node_tutorial example_node_5 [INFO] [1657348108.163389800] [node_name]: ==== Hello ROS 2 : 1==== [WARN] [1657348108.163810900] [node_name]: ==== Hello ROS 2 : 1==== [ERROR] [1657348108.164126200] [node_name]: ==== Hello ROS 2 : 1==== [FATAL] [1657348108.164514300] [node_name]: ==== Hello ROS 2 : 1==== ... ROS 2ì—ì„œëŠ” ìœ„í—˜ë„ì— ë”°ë¼ì„œ ë‹¤ë¥¸ logger levelì„ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. infoë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì•„ë˜ë¡œ ê°ˆìˆ˜ë¡ ë†’ì€ ë ˆë²¨ì˜ logì´ë©°, ì œì¼ ì‹¬ê°í•œ errorì™€ fatalì˜ ê²½ìš°, ì½˜ì†” ì¶œë ¥ì‹œì—ë„ ë¹¨ê°„ ê¸€ì”¨ë¡œ ë³´ì´ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\ndebugì˜ ê²½ìš° ì‹¤ì œ ì½˜ì†” ì¶œë ¥ìœ¼ë¡œëŠ” ë‚˜íƒ€ë‚˜ì§€ ì•Šìœ¼ë©°, íš¨ê³¼ì ì¸ Trackingì„ ìœ„í•´ ì´í›„ í•™ìŠµí•  rqt console ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤. ROS 2 Parameter Programming - Python ëª¨í„°ì˜ ê²Œì¸ê°’, ì¹´ë©”ë¼ì˜ Focal Lenght, Intrinsic, Extrinsic Parameter, Point Cloudì˜ resolutionê³¼ min/max range ë“± ë¡œë´‡ í”„ë¡œê·¸ë˜ë° ì‹œ ìˆ˜ë§ì€ ë§¤ê°œë³€ìˆ˜ë“¤ì´ ì‚¬ìš©ë©ë‹ˆë‹¤.\nROS 2ì—ì„œëŠ” ê°ì¢… ë§¤ê°œë³€ìˆ˜ë¥¼ ë‹¤ë£° ìˆ˜ ìˆëŠ” ë³„ë„ì˜ Parameter Serverë¥¼ ì œê³µí•˜ë©°, Nodeë“¤ì€ ëª¨ë‘ ê°œë³„ Parameter Serverë¥¼ ê°–ê³  ìˆìŠµë‹ˆë‹¤.\nì˜ˆì œ Package ë¹Œë“œì™€ ì‹¤í–‰ $ colcon build --packages-select py_param_tutorial $ source install/local_setup.bash $ ros2 run py_param_tutorial param_example [INFO] [1672390971.030532687] [param_ex_node]: string_param: world int_param: 119 float_param: 3.1415 arr_param: [1, 2, 3] nested_param.string_param: Wee Woo â‡’ param_ex_nodeì—ì„œ 5ì¢…ë¥˜ì˜ ë§¤ê°œë³€ìˆ˜ê°€ ì„ ì–¸ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ë“¤ì„ í™•ì¸í•˜ëŠ” ì»¤ë©˜ë“œ ë¼ì¸ì„ ë°°ì›Œë´…ì‹œë‹¤.\nros2 param list $ ros2 param list /param_ex_node: arr_param float_param int_param nested_param.string_param string_param use_sim_time â‡’ param_ex_nodeì˜ Parameter ServerëŠ” í˜„ì¬ 6ê°œì˜ ê°’ì„ ê°–ê³  ìˆìŠµë‹ˆë‹¤.\nê°œë³„ Parameterë“¤ì˜ ê°’ì„ ë‹¤ë£¨ê³  ì‹¶ì€ ê²½ìš° ros2 param get/set ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. $ ros2 param get /param_ex_node arr_param Integer values are: array(\u0026#39;q\u0026#39;, [1, 2, 3]) $ ros2 param set /param_ex_node arr_param \u0026#39;[1,2,3,4]\u0026#39; Set parameter successful $ ros2 param get /param_ex_node arr_param Integer values are: array(\u0026#39;q\u0026#39;, [1, 2, 3, 4]) â‡’ node ì´ë¦„ê³¼ ë§¤ê°œë³€ìˆ˜ ì´ë¦„ì„ ëª¨ë‘ í•„ìš”ë¡œ í•¨ì— ì£¼ì˜í•©ë‹ˆë‹¤.\nì½”ë“œ ë¶„ì„ parameterì˜ ìƒì„±ì€ node ë‚´ì—ì„œ ì´ë£¨ì–´ì§€ë©°, declare_parameterë¥¼ í†µí•´ ìƒì„±í•©ë‹ˆë‹¤. (í•¨ìˆ˜ì˜ ë‘ë²ˆì§¸ ì¸ìëŠ” ê¸°ë³¸ê°’ì…ë‹ˆë‹¤.) class ParamExNode(rclpy.node.Node): def __init__(self): super().__init__(\u0026#39;param_ex_node\u0026#39;) self.declare_parameter(\u0026#39;string_param\u0026#39;, \u0026#39;world\u0026#39;) self.declare_parameter(\u0026#39;int_param\u0026#39;, 119) self.declare_parameter(\u0026#39;float_param\u0026#39;, 3.1415) self.declare_parameter(\u0026#39;arr_param\u0026#39;, [1,2,3]) self.declare_parameter(\u0026#39;nested_param.string_param\u0026#39;, \u0026#39;Wee Woo\u0026#39;) â‡’ nested_paramê³¼ ê°™ì´ parameterëŠ” ê³„ì¸µ êµ¬ì¡°ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìœ¼ë©° ì˜¨ì ì„ í†µí•´ êµ¬ë¶„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. â‡’ í˜„ì¬ string_paramì´ë¼ëŠ” ì´ë¦„ì„ ê°€ì§„ parameterê°€ ë‘ ì¢…ë¥˜ ì¡´ì¬í•˜ì§€ë§Œ ì„œë¡œ ì†Œì†ëœ ê³„ì¸µì´ ë‹¬ë¼ ê³µì¡´í•  ìˆ˜ ìˆëŠ” ê²ƒì…ë‹ˆë‹¤.\nì„ ì–¸ëœ ë§¤ê°œë³€ìˆ˜ì˜ ê°’ì€ get_parameterë¥¼ í†µí•´ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. get_parameter ìì²´ëŠ” Objectì´ê³ , value ì†ì„±ì´ ì‹¤ì œ ê°’ì„ ê°–ê³  ìˆìŒì— ì£¼ì˜í•©ë‹ˆë‹¤. string_param = self.get_parameter(\u0026#39;string_param\u0026#39;) int_param = self.get_parameter(\u0026#39;int_param\u0026#39;) float_param = self.get_parameter(\u0026#39;float_param\u0026#39;) arr_param = self.get_parameter(\u0026#39;arr_param\u0026#39;) nested_param = self.get_parameter(\u0026#39;nested_param.string_param\u0026#39;) self.get_logger().info(f\u0026#34;\\nstring_param: {string_param.value} \\ \\nint_param: {int_param.value} \\ \\nfloat_param: {float_param.value} \\ \\narr_param: {arr_param.value} \\ \\nnested_param.string_param: {nested_param.value}\u0026#34; ) parameterëŠ” launch fileì—ì„œë„ ì„¤ì •í•  ìˆ˜ ìˆëŠ”ë°ìš”. ì˜ˆì‹œë¥¼ ìš°ì„  ì‹¤í–‰í•´ë´…ì‹œë‹¤. - ë³€ê²½ëœ Parameterê°’ë„ í™•ì¸í•´ë´…ì‹œë‹¤. $ ros2 launch py_param_tutorial launch_with_param.launch.py ... [param_example-1] [INFO] [1672387864.135213913] [param_example]: [param_example-1] string_param: Hello [param_example-1] int_param: 112 [param_example-1] float_param: 3.1415 [param_example-1] arr_param: [1, 2, 3] $ ros2 launch py_param_tutorial launch_with_yaml.launch.py ... [param_example-1] [INFO] [1680857428.211772092] [param_example]: [param_example-1] string_param: Yaml Yaml [param_example-1] int_param: 5 [param_example-1] float_param: 3.14 [param_example-1] arr_param: [\u0026#39;I\u0026#39;, \u0026#39;love\u0026#39;, \u0026#39;ROS 2\u0026#39;] [param_example-1] nested_param.string_param: Ooh Wee Nodeë¥¼ ì‹¤í–‰í•˜ëŠ” launch fileì„ ê¸°ì–µí•˜ì‹œì§€ìš”? Nodeì˜ parameters ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´ ì½”ë“œë¥¼ ì§ì ‘ ë°”ê¾¸ì§€ ì•Šê³  parameterì˜ ë³€ê²½ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. def generate_launch_description(): param_ex_node = Node( package=\u0026#39;py_param_tutorial\u0026#39;, executable=\u0026#39;param_example\u0026#39;, name=\u0026#39;param_example\u0026#39;, output=\u0026#39;screen\u0026#39;, parameters=[ {\u0026#39;string_param\u0026#39;: \u0026#39;Hello\u0026#39;}, {\u0026#39;int_param\u0026#39;: 112}, ], ) parameterê°€ ë§¤ìš° ë§ì€ ê²½ìš°ì—ëŠ” yaml í˜•ì‹ì˜ íŒŒì¼ì„ ì‚¬ìš©í•´ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ”ë°ìš”, yaml íŒŒì¼ì„ ì‚¬ìš©í•˜ëŠ” launch íŒŒì¼ì˜ ì¼ë¶€ë¥¼ í•¨ê»˜ ì‚´í´ë´…ì‹œë‹¤. def generate_launch_description(): config = os.path.join( get_package_share_directory(\u0026#39;py_param_tutorial\u0026#39;), \u0026#39;config\u0026#39;, \u0026#39;params.yaml\u0026#39; ) param_ex_node = Node( package = \u0026#39;py_param_tutorial\u0026#39;, executable = \u0026#39;param_example\u0026#39;, name = \u0026#39;param_example\u0026#39;, output=\u0026#39;screen\u0026#39;, parameters = [config] ) return LaunchDescription([ param_ex_node ]) ì¶”ê°€ ì„¤ëª… - os.path.join, get_package_share_directoryë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ !\nyaml íŒŒì¼ì€ config/params.yamlì— ìœ„ì¹˜í•˜ê³  ìˆìŠµë‹ˆë‹¤. parameter ê´€ë¦¬ ìš©ë„ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ yaml íŒŒì¼ì€ ì¼ì •í•œ ê·œì¹™ì„ ê°–ì¶°ì•¼ í•©ë‹ˆë‹¤. \u0026lt;node-name\u0026gt;: ros__parameters: \u0026lt;param-name\u0026gt;: \u0026lt;param-value\u0026gt; ... \u0026lt;nested-layer-name\u0026gt;: \u0026lt;param-name\u0026gt;: \u0026lt;param-value\u0026gt; param_example: ros__parameters: string_param: \u0026#34;Yaml Yaml\u0026#34; int_param: 5 float_param: 3.14 arr_param: [\u0026#39;I\u0026#39;, \u0026#39;love\u0026#39;, \u0026#39;ROS 2\u0026#39;] nested_param: string_param: \u0026#34;Ooh Wee\u0026#34; ì´ë ‡ê²Œ ìƒˆë¡œìš´ í´ë”ì™€ íŒŒì¼ì„ ì¶”ê°€í•œ ê²½ìš°, python íŒ¨í‚¤ì§€ì˜ setup.pyë¥¼ ìˆ˜ì •í•´ì£¼ì–´ì•¼ í•˜ë©° íŒ¨í‚¤ì§€ ë¹Œë“œë„ ìƒˆë¡œ í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. import os from glob import glob from setuptools import setup package_name = \u0026#39;py_param_tutorial\u0026#39; setup( name=package_name, version=\u0026#39;0.0.0\u0026#39;, packages=[package_name], data_files=[ (\u0026#39;share/ament_index/resource_index/packages\u0026#39;, [\u0026#39;resource/\u0026#39; + package_name]), (\u0026#39;share/\u0026#39; + package_name, [\u0026#39;package.xml\u0026#39;]), (os.path.join(\u0026#39;share\u0026#39;, package_name, \u0026#39;config\u0026#39;), glob(\u0026#39;config/*.yaml\u0026#39;)), (os.path.join(\u0026#39;share\u0026#39;, package_name, \u0026#39;launch\u0026#39;), glob(\u0026#39;launch/*.launch.py\u0026#39;)), ], launch fileì— ì¶”ê°€ëœ ë‚´ìš©ì„ ë‹¤ì‹œ ì‚´í´ë³´ë©´, ë°©ê¸ˆ ì „ì˜ yaml íŒŒì¼ì„ ë¶ˆëŸ¬ì™€ì„œ nodeì˜ ì‹¤í–‰ optionì— ì „ë‹¬í•˜ê³  ìˆìŠµë‹ˆë‹¤. Namespace Parameter ì•„ì§ ì´ë¥¸ ê°ì´ ìˆì§€ë§Œ, ë‹¤ìˆ˜ì˜ ë¡œë´‡ì„ ë‹¤ë£¨ëŠ” ê²½ìš°ë¥¼ ìƒê°í•´ë´…ì‹œë‹¤. ì¢…ë¥˜ëŠ” ê°™ì§€ë§Œ ë³„ë„ì˜ Parameterê°€ í•„ìš”í•  ê²ƒì…ë‹ˆë‹¤.\nâ‡’ ì´ëŸ¬í•œ ê²½ìš°ë¥¼ ëŒ€ë¹„í•´ì„œ ROS 2ì—ì„œëŠ” namespaceë¼ëŠ” ê¸°ëŠ¥ì„ ì§€ì›í•©ë‹ˆë‹¤. topicê³¼ node ì•ì— ë³„ë„ì˜ ì ‘ë¯¸ì‚¬ë¥¼ ì¶”ê°€í•˜ì—¬ ì„œë¡œ ë‹¤ë¥¸ ê°ì²´ì„ì„ êµ¬ë³„í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.\nì´ë¥¼ ì§€ê¸ˆ ì–¸ê¸‰í•˜ëŠ” ì´ìœ ëŠ”, Parameterì˜ namespaceë¥¼ ì§€ì •í•˜ëŠ” ì¼ì´ ë§¤ìš° ë¹ˆë²ˆí•˜ê³  ê·¸ ì‚¬ìš© ë°©ì‹ì´ nodeë‚˜ topicê³¼ëŠ” ì¡°ê¸ˆ ë‹¤ë¥´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.\nnamespaceë¥¼ ì§€ì •í•˜ëŠ” ê°€ì¥ ì¼ë°˜ì ì¸ ë°©ë²•ì€ launch íŒŒì¼ì—ì„œ ì˜µì…˜ì„ ì§€ì •í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. param_ex_node = Node( package = \u0026#39;py_param_tutorial\u0026#39;, # namespace ì§€ì •! namespace = \u0026#39;robot1\u0026#39;, executable = \u0026#39;param_example\u0026#39;, name = \u0026#39;param_example\u0026#39;, output=\u0026#39;screen\u0026#39;, parameters = [config] ) ì˜ˆì‹œë¥¼ ë‹¤ì‹œ ì‹¤í–‰ì‹œí‚¨ ë‹¤ìŒ ì–´ë–¤ ê²°ê³¼ë¥¼ ì–»ê²Œ ë˜ëŠ”ì§€ ì‚´í´ë´…ì‹œë‹¤. $ ros2 launch py_param_tutorial launch_with_yaml.launch.py ... [param_example-1] [INFO] [1680861992.330212575] [robot1.param_example]: [param_example-1] string_param: world [param_example-1] int_param: 119 [param_example-1] float_param: 3.1415 [param_example-1] arr_param: [1, 2, 3] [param_example-1] nested_param.string_param: Wee Woo â‡’ yaml íŒŒì¼ì´ ë°˜ì˜ë˜ì§€ ì•Šì€ ê²°ê³¼ë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤!\nyaml íŒŒì¼ì—ë„ namespaceë¥¼ ë°˜ì˜í•´ì£¼ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì´ë©° ì˜ˆë¥¼ ë“¤ì–´ robot1ì´ë¼ëŠ” namespaceë¥¼ ë°˜ì˜í•˜ê³  ì‹¶ë‹¤ë©´ yaml íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì´ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤. robot1/param_example: ros__parameters: string_param: \u0026#34;Yaml Yaml\u0026#34; int_param: 5 float_param: 3.14 arr_param: [\u0026#39;I\u0026#39;, \u0026#39;love\u0026#39;, \u0026#39;ROS 2\u0026#39;] nested_param: string_param: \u0026#34;Ooh Wee\u0026#34; í•˜ì§€ë§Œ namespaceë¥¼ ë°”ê¿€ ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ yamlíŒŒì¼ì„ ë§Œë“¤ ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤. ì´ë¥¼ ëŒ€ë¹„í•˜ì—¬ ROS 2ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ yaml ë¬¸ë²•ì„ í—ˆìš©í•©ë‹ˆë‹¤. /**: ros__parameters: string_param: \u0026#34;Namespaced Param\u0026#34; int_param: 10 float_param: 2.718 arr_param: [\u0026#39;I\u0026#39;, \u0026#39;absolutely\u0026#39;, \u0026#39;love\u0026#39;, \u0026#39;ROS 2\u0026#39;] nested_param: string_param: \u0026#34;Yeah Hee\u0026#34; ìƒˆë¡­ê²Œ ì‘ì„±í•œ yaml íŒŒì¼ì„ ë°˜ì˜í•œ ìƒˆë¡œìš´ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. $ ros2 launch py_param_tutorial launch_with_namespace.launch.py ... [param_example-1] [INFO] [1680862245.965886805] [robot1.param_example]: [param_example-1] string_param: Namespaced Param [param_example-1] int_param: 10 [param_example-1] float_param: 2.718 [param_example-1] arr_param: [\u0026#39;I\u0026#39;, \u0026#39;absolutely\u0026#39;, \u0026#39;love\u0026#39;, \u0026#39;ROS 2\u0026#39;] [param_example-1] nested_param.string_param: Yeah Hee ë‹¤ìˆ˜ì˜ ì„¼ì„œë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜, ë‹¤ìˆ˜ì˜ ë¡œë´‡ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ì§€ê¸ˆ í•™ìŠµí•œ namespaceë¥¼ ê¼­ ê¸°ì–µí•´ì£¼ì„¸ìš”!!\nROS 2 Node Programming - C++ ì•ì„  Node í”„ë¡œê·¸ë˜ë° ì˜ˆì‹œë“¤ì„ C++ì—ì„œ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ë°°ì›Œë´…ì‹œë‹¤. ì œê°€ ë¯¸ë¦¬ ì¤€ë¹„í•´ ë‘” íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œí•˜ë©° ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤. # ë¹Œë“œëŠ” í•­ìƒ WSì˜ ìµœìƒë‹¨ ë””ë ‰í† ë¦¬ì—ì„œ ì§„í–‰í•©ë‹ˆë‹¤!!! cd ~/ros2_ws cbp cpp_node_tutorial # or colcon build --packages-select cpp_node_tutorial # ë¹Œë“œ í›„ í•­ìƒ ì†Œì‹±!!! cd ~/ros2_ws rosfoxy # or source install/local_setup.bash example 1 - Hello ROS 2 íŒŒì´ì¬ ë•Œì™€ ë§ˆì°¬ê°€ì§€ë¡œ, ì•ì„œ ë¹Œë“œëœ ì˜ˆì‹œë¥¼ ì‹¤í–‰ì‹œì¼œë³´ê² ìŠµë‹ˆë‹¤. $ ros2 run cpp_node_tutorial example_node_1 [INFO] [1680692820.096342214] [example_node_1]: ==== Hello ROS 2 ==== ROS 2 C++ ì½”ë“œ ë¹Œë“œì™€ ì‹¤í–‰ ROS 2ì—ì„œëŠ” C++ ì½”ë“œì˜ ë¹Œë“œë¥¼ ìœ„í•´ CMakeë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì½”ë“œ ë¶„ì„ ì´ì „ì— ìƒˆë¡œìš´ ì½”ë“œë¥¼ ìƒì„±í•˜ê³ , ë¹Œë“œí•˜ëŠ” ê³¼ì •ì„ ê°„ë‹¨íˆ ì„¤ëª…í•´ë³´ê³ ì í•©ë‹ˆë‹¤.\nìƒˆë¡œìš´ ì½”ë“œ ìƒì„± -C++ ì½”ë“œëŠ” íŒ¨í‚¤ì§€ ë‚´ src í´ë”ì— ìƒì„±í•˜ëŠ” ê²ƒì´ ê´€ë¡€ì…ë‹ˆë‹¤. ë‹¨, ì‘ì—… ì „ í•´ë‹¹ íŒ¨í‚¤ì§€ê°€ C++ìš©ìœ¼ë¡œ ë§Œë“¤ì–´ì ¸ ìˆëŠ”ì§€ ê¼­ í™•ì¸í•˜ì…”ì•¼ í•©ë‹ˆë‹¤. (ament_cmakeë¥¼ ì‚¬ìš©í–ˆë˜ ì ì„ ë³µê¸°í•´ë´…ì‹œë‹¤.)\nì½”ë“œ ì‘ì„±- ìš°ì„ , íŒ¨í‚¤ì§€ ë‚´ ì¡´ì¬í•˜ëŠ” ì˜ˆì‹œ í˜¹ì€ copilotì„ ì‚¬ìš©í•˜ì—¬ ê°€ì¥ ê°„ë‹¨í•œ node codeë¥¼ ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤.\nCMakeLists.txt ìˆ˜ì •\nfind_package(rclcpp REQUIRED) add_executable(test_node src/test.cpp) ament_target_dependencies(test_node rclcpp) install( TARGETS test_node DESTINATION lib/${PROJECT_NAME} ) Function Description find_package í•„ìš”í•œ ì¢…ì†ì„±ë“¤ì„ ì¶”ê°€í•©ë‹ˆë‹¤. ROS 2 ì¢…ì†ì„± ë¿ë§Œ ì•„ë‹ˆë¼, 3rd party ì¢…ì†ì„±ë„ ì—¬ê¸°ì—ì„œ ì¶”ê°€ë©ë‹ˆë‹¤. add_executable Build í›„ ì‹¤í–‰ íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤. (ì¼ë°˜ì ì¸ CMake ê³¼ì •ê³¼ ë™ì¼í•©ë‹ˆë‹¤.) ament_target_dependencies CMakeì˜ target_link_libariesì™€ ë™ì¼í•œ ì—­í• ì„ í•˜ì§€ë§Œ, ROS 2ì—ì„œ ì‚¬ìš©ì„ ìœ„í•´ í¸ì˜ì„±ì´ ì¶”ê°€ëœ Functionì…ë‹ˆë‹¤. install ë¹Œë“œ ê²°ê³¼ë¬¼ì„ íŠ¹ì • ë””ë ‰í† ë¦¬ì— ìœ„ì¹˜ì‹œí‚µë‹ˆë‹¤. ëª¨ë“  CMake functionë“¤ì€ ament_package() ìƒë‹¨ì— ìœ„ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤!\në‹¤ìŒìœ¼ë¡œ, ìƒˆë¡œìš´ ì½”ë“œì˜ ë¹Œë“œ ì‘ì—…ì„ í•¨ê»˜ í•´ë´…ì‹œë‹¤. # ë¹Œë“œëŠ” í•­ìƒ WSì˜ ìµœìƒë‹¨ ë””ë ‰í† ë¦¬ì—ì„œ ì§„í–‰í•©ë‹ˆë‹¤!!! cd ~/ros2_ws cbp cpp_node_tutorial # or colcon build --packages-select cpp_node_tutorial # ë¹Œë“œ í›„ í•­ìƒ ì†Œì‹±!!! cd ~/ros2_ws rosfoxy # or source install/local_setup.bash # ìƒˆë¡­ê²Œ ë¹Œë“œí•œ ì˜ˆì‹œ ì‹¤í–‰ $ ros2 run cpp_node_tutorial test_node [INFO] [1681299676.469101345] [example_node_1]: ==== Hello ROS 2 ==== ì½”ë“œ ë¶„ì„ python ì½”ë“œ ì‘ì„± ì‹œ rclpyë¥¼ import í–ˆë˜ ê²ƒì²˜ëŸ¼, cpp ì½”ë”© ì‹œ rclcppì„ import í•´ì•¼ í•©ë‹ˆë‹¤. (í•´ë‹¹ headerì•ˆì—ëŠ” memory, vector, string ë“± ë²”ìš©ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì›¬ë§Œí•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.) #include \u0026lt;rclcpp/rclcpp.hpp\u0026gt; Node ìƒì„± int main(int argc, char **argv) { // Initialize ROS 2 rclcpp::init(argc, argv); // Create a node auto node = rclcpp::Node::make_shared(\u0026#34;example_node_1\u0026#34;); // Log a message RCLCPP_INFO(node-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 ====\u0026#34;); // Shutdown ROS 2 rclcpp::shutdown(); return 0; } python ì½”ë“œ ë¶„ì„ ì‹œ ëŒ€ë¶€ë¶„ì˜ í•¨ìˆ˜ë¥¼ ì‚´í´ë³´ì•˜ìœ¼ë¯€ë¡œ ê°„ë‹¨í•˜ê²Œ ì§šê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤. Function Description rclcpp::init(argc, argv) initialization, ì¦‰ ì´ˆê¸°í™”ë¥¼ í•˜ê³  ìˆìŠµë‹ˆë‹¤. rclcpp::Node::make_shared() Nodeë¥¼ ìƒì„±í•˜ëŠ” ë¶€ë¶„ìœ¼ë¡œ ì•ì„œ importí•œ Node classë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë§¤ê°œë³€ìˆ˜ë¡œ nodeì˜ ì´ë¦„ì´ ë“¤ì–´ê°‘ë‹ˆë‹¤. rclcpp::shutdown() ì´ë²ˆ ì˜ˆì‹œ ì²« ë¶€ë¶„, rclpy.init()ì„ í†µí•˜ì—¬ ì´ˆê¸°í™”ë¥¼ í•´ì£¼ì—ˆìŠµë‹ˆë‹¤. ì´ì œ rclpyë¥¼ í†µí•œ ì‘ì—…ì´ ëª¨ë‘ ëë‚¬ìœ¼ë¯€ë¡œ ì•ˆì „í•˜ê²Œ ì¢…ë£Œì‹œì¼œì¤ë‹ˆë‹¤. ìŠ¤ë§ˆíŠ¸ í¬ì¸í„°ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— destroy_nodeë¼ëŠ” ê²ƒì€ ë³„ë„ë¡œ í˜¸ì¶œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. example 2 - timer ê³„ì†í•´ì„œ Timer ì˜ˆì‹œì…ë‹ˆë‹¤. #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; using namespace std::chrono_literals; static int count = 0; void timer_callback(){ std::cout \u0026lt;\u0026lt; \u0026#34;==== Hello ROS 2 : \u0026#34; \u0026lt;\u0026lt; count \u0026lt;\u0026lt; \u0026#34; ====\u0026#34; \u0026lt;\u0026lt; std::endl; count++; } int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = rclcpp::Node::make_shared(\u0026#34;example_node_2\u0026#34;); auto timer = node-\u0026gt;create_wall_timer(200ms, timer_callback); rclcpp::spin(node); rclcpp::shutdown(); return 0; } Code Description create_wall_timer Timer ìƒì„±, ì‹¤í–‰ ì£¼ê¸°ì™€ callbackì„ ë§¤ê°œë³€ìˆ˜ë¡œ ê°–ìŠµë‹ˆë‹¤. timer_callback íŠ¹ì • í•´ë‹¹ ì£¼ê¸°ë§ˆë‹¤ ì‹¤í–‰ë  í•¨ìˆ˜ Timer, Nodeì™€ ê°™ì€ ì¸í„°í˜ì´ìŠ¤ë“¤ì€ ëª¨ë‘ ìŠ¤ë§ˆíŠ¸ í¬ì¸í„°ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ í•¨ìˆ˜ì˜ ì¸ìë¡œ ì „ë‹¬í•˜ê±°ë‚˜, ë‚´ë¶€ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ì‹œ í¬ì¸í„°ë¼ëŠ” ì ì„ ê¸°ì–µí•˜ì‹œì–´ ì½”ë”©í•˜ì…”ì•¼ í•©ë‹ˆë‹¤. auto node =\u0026gt; std::shared_ptr\u0026lt;rclcpp::Node\u0026gt; auto timer =\u0026gt; std::shared_ptr\u0026lt;rclcpp::Timer\u0026gt; example 3 - OOP Node OOPë¥¼ ì‚¬ìš©í•œ Timer Node êµ¬í˜„ì…ë‹ˆë‹¤. #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; class NodeClass: public rclcpp::Node { public: NodeClass(): Node(\u0026#34;example_node_4\u0026#34;) {} }; int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;NodeClass\u0026gt;(); RCLCPP_INFO(node-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 ====\u0026#34;); rclcpp::shutdown(); return 0; } ëª¨ë“  rclcpp Nodeë“¤ì€ ë°˜ë“œì‹œ rclcpp::Nodeë¥¼ public ìƒì†ë°›ì•„ì•¼ í•©ë‹ˆë‹¤. class NodeClass: public rclcpp::Node { public: NodeClass(): Node(\u0026#34;example_node_4\u0026#34;) {} }; ìƒì†ì„ ë°›ì€ ë§Œí¼ êµ¬í˜„ ì‹œ ì£¼ì˜í•´ì•¼ í•˜ëŠ” ë¶€ë¶„ë“¤ì´ ìˆìœ¼ë©°, ìƒì„±ìëŠ” ë°˜ë“œì‹œ Access Modifier publicì„ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤.\nrclcpp logger RCLCPP_INFO(node-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 ====\u0026#34;); pythonì˜ get_logger()ì™€ ë™ì¼í•˜ì§€ë§Œ, RCLCPP_INFOë¡œ wrappingì´ ë˜ì–´ìˆë‹¤ëŠ” ì°¨ì´ì ì„ ê¸°ì–µí•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.\nOOP êµ¬í˜„ ì‹œ ìƒˆë¡œìš´ Node ìƒì„±ì„ ìœ„í•´ templateì„ ì‚¬ìš©í•©ë‹ˆë‹¤. auto node = std::make_shared\u0026lt;NodeClass\u0026gt;(); example 4 - spin_once, spin Nodeì˜ ìƒíƒœë¥¼ ì‚´í”¼ë©´ì„œ ë°˜ë³µ ì‹¤í–‰ì‹œí‚¤ëŠ” spin í•¨ìˆ˜ê°€ ì¶”ê°€ë˜ë©° OOP êµ¬í˜„ì´ ë³´ì…ë‹ˆë‹¤. class NodeClass: public rclcpp::Node { private: size_t count; rclcpp::TimerBase::SharedPtr timer; void timer_callback() { RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); count++; } public: NodeClass() : Node(\u0026#34;example_node_5\u0026#34;) { timer = this-\u0026gt;create_wall_timer( std::chrono::milliseconds(200), // timer_callback, std::bind(\u0026amp;NodeClass::timer_callback, this) ); } }; int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;NodeClass\u0026gt;(); rclcpp::spin(node); rclcpp::shutdown(); return 0; } rclpyì™€ ë§ˆì°¬ê°€ì§€ë¡œ, rclcppì—ì„œë„ spin, spin_some, spin_until_future_completeë“± ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ”ë°ìš”. spinì„ ì´í•´í•˜ê¸° ìœ„í•´ì„œ ë§ì€ ë°°ê²½ì§€ì‹ì´ í•„ìš”í•˜ë‹ˆ êµ¬ì²´ì ì¸ ë‚´ìš©ì€ ì´í›„ì— ì‚´í´ë³´ê³  ì§€ê¸ˆì€ ê¸°ëŠ¥ êµ¬í˜„ì— ì§‘ì¤‘í•˜ê² ìŠµë‹ˆë‹¤. rclcpp::spin(node); Timerë¥¼ ë¹„ë¡¯í•œ ì¸í„°í˜ì´ìŠ¤ë“¤ì€ ëª¨ë‘ shared_ptr íƒ€ì…ì„ ê°–ìŠµë‹ˆë‹¤. SharedPtrì€ ROS 2 ë‹¨ì—ì„œ í¸ì˜ë¥¼ ìœ„í•´ wrappingí•œ ê²ƒì…ë‹ˆë‹¤. - ì°¸ê³  ë§í¬ rclcpp::TimerBase::SharedPtr timer; example 5 - Logger Level ê¸°ë³¸ node í”„ë¡œê·¸ë˜ë°ì˜ ë§ˆì§€ë§‰ ì˜ˆì‹œì˜€ìŠµë‹ˆë‹¤. ì‹¤í–‰ í›„ ê°„ë‹¨í•˜ê²Œ ì‚´í´ë³´ê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤. class NodeClass: public rclcpp::Node { private: size_t count; rclcpp::TimerBase::SharedPtr timer; void timer_callback() { RCLCPP_DEBUG(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); RCLCPP_WARN(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); RCLCPP_FATAL(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); count++; } public: NodeClass() : Node(\u0026#34;example_node_5\u0026#34;) { timer = this-\u0026gt;create_wall_timer( std::chrono::milliseconds(200), std::bind(\u0026amp;NodeClass::timer_callback, this) ); } }; int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;NodeClass\u0026gt;(); rclcpp::spin(node); rclcpp::shutdown(); return 0; } ì½”ë“œ ì¤‘ logger levelì„ ì§€ì •í•˜ëŠ” ë¶€ë¶„ì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. RCLCPP_DEBUG(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); RCLCPP_WARN(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); RCLCPP_FATAL(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); ROS 2 Parameter Programming - C++ ì˜ˆì œ Package ë¹Œë“œì™€ ì‹¤í–‰ $ colcon build --packages-select cpp_param_tutorial $ source install/local_setup.bash $ ros2 run cpp_param_tutorial cpp_param_example [INFO] [1681300487.037502527] [param_ex_node]: str: world int: 119 double: 3.141500 arr: [1, 2, 3] nested: Wee Woo ì½”ë“œ ë¶„ì„ rclcpp ì½”ë“œì—ì„œ parameterì˜ ìƒì„±ê³¼ ì‚¬ìš©ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. Code Description declare_parameter(name, default_value) parameterì˜ ìƒì„± get_parameter() parameter objectë¥¼ ë°›ì•„ì˜µë‹ˆë‹¤. as_() get_parameter ê²°ê³¼ëŠ” objectë¡œ ì‹¤ì œ ê°’ì„ íŒŒì‹±í•˜ê¸° ìœ„í•´ì„œ í•„ìš”í•©ë‹ˆë‹¤. ì½”ë“œë¥¼ í†µí•´ì„œë„ í™•ì¸ì´ ê°€ëŠ¥í•˜ë©°, ìµœì†Œ 3 ì¤„ì˜ ë¼ì¸ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— get_parameterì™€ as_typeì„ í•œë²ˆì— ì‚¬ìš©í•˜ê¸°ë„ í•©ë‹ˆë‹¤. class ParamExNode : public rclcpp::Node { public: ParamExNode() : Node(\u0026#34;param_ex_node\u0026#34;) { this-\u0026gt;declare_parameter(\u0026#34;string_param\u0026#34;, \u0026#34;world\u0026#34;); ... rclcpp::Parameter str_param = this-\u0026gt;get_parameter(\u0026#34;string_param\u0026#34;); ... std::string my_str = str_param.as_string(); ê°„ì†Œí™” ë²„ì „ this-\u0026gt;declare_parameter(\u0026#34;string_param\u0026#34;, \u0026#34;world\u0026#34;); auto my_str = this-\u0026gt;get_parameter(\u0026#34;string_param\u0026#34;).as_string(); cppë¡œ êµ¬í˜„ëœ nodeì˜ parameterë„ ros2 launchì™€ yaml íŒŒì¼ì„ í†µí•´ ì†ì‰½ê²Œ ìˆ˜ì •ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. $ ros2 launch cpp_param_tutorial launch_with_yaml.launch.py ... [cpp_param_example-1] [INFO] [1681301614.005450889] [param_example]: [cpp_param_example-1] str: Yaml Yaml [cpp_param_example-1] int: 5 [cpp_param_example-1] double: 3.141500 [cpp_param_example-1] arr: [1, 2, 3] [cpp_param_example-1] nested: Ooh Wee "
},
{
	"uri": "/kr/ros2_foxy/lecture5/",
	"title": "Lecture5. ROS 2 Communication Mechanisms",
	"tags": [],
	"description": "",
	"content": " ì´ë²ˆ ì‹œê°„ì—ëŠ” ROS 2ì˜ í•µì‹¬ì¸ 3ê°€ì§€ í†µì‹  ë©”ì»¤ë‹ˆì¦˜(Topic,Service, Action)ì— ëŒ€í•´ì„œ ê°œë…ì„ ë‹¤ì¡ê³  ë„˜ì–´ê°€ê³ ì í•©ë‹ˆë‹¤. í”„ë¡œê·¸ë˜ë°ì€ ì—†ì§€ë§Œ, ê°ê°ì˜ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ë“¤ì— ëŒ€í•´ ë°˜ë“œì‹œ ìˆ™ì§€í•˜ê³  ë„˜ì–´ê°€ì‹œê¸° ë°”ëë‹ˆë‹¤!\nROS 2 Topic 3ê°•ì˜ husky ì˜ˆì‹œ ì‹¤í–‰ í›„ ì‚´í´ë³´ì•˜ë˜ rqt_graph ì´ë¯¸ì§€ì…ë‹ˆë‹¤. â‡’ ìœ„ ê·¸ë¦¼ì—ì„œ ë™ê·¸ë¼ë¯¸ëŠ” Nodeë¥¼ ëœ»í•˜ê³ , í™”ì‚´í‘œëŠ” topicì„ ëœ»í•˜ëŠ”ë°ìš”, ì²«ë²ˆì§¸ë¡œ ì´ Topicì´ë¼ëŠ” ê²ƒì´ ë¬´ì—‡ì¸ì§€ ë°°ì›Œë³´ê³ ì í•©ë‹ˆë‹¤.\nTopicì€ Nodeë“¤ ì‚¬ì´ì— ë°ì´í„°(Message)ê°€ ì˜¤ê°€ëŠ” ê¸¸(Bus)ì˜ ì´ë¦„ì´ë©°, ì ì ˆí•œ ì´ë¦„ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì†¡ìˆ˜ì‹ í•˜ì§€ ì•Šìœ¼ë©´ ì›í•˜ëŠ” ë™ì‘ì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ROS 2ì—ì„œ ì‚¬ìš©í•˜ëŠ” DDSëŠ” ëª©ì ì§€ë¥¼ ì •í•´ë‘ê³  í†µì‹ í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í†µì‹  ë§¤ê°œì²´ì˜ IDë¥¼ í†µí•´ ì†¡ìˆ˜ì‹ í•˜ê¸° ë•Œë¬¸ì— ê¸°ì¡´ ì›¹ ê¸°ë°˜ í†µì‹ ê³¼ëŠ” ë‹¤ë¥¸ ê°œë…ì„ì„ ìƒê¸°ë“œë¦½ë‹ˆë‹¤. image from : docs.ros.org\nTopicì€ N:N í†µì‹ ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. (ì—¬ëŸ¬ Nodeë“¤ë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìˆê³ , ì „ì†¡ ì‹œì—ë„ ì—¬ëŸ¬ Nodeë“¤ì—ê²Œ ì „ì†¡ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ëŒ€ë¶€ë¶„ 1:N í˜¹ì€ 1:1, N:1ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.) image from : docs.ros.org\ntopicì„ í†µí•´ ë°ì´í„°ê°€ ì „ë‹¬ë˜ëŠ” ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” ì£¼ì²´ì¸ publisherëŠ” ë°ì´í„°ë¥¼ ë°›ëŠ” ì£¼ì²´, subscriberë¥¼ ì§€ì •í•œ ë’¤, topicì„ í†µí•´ ì›í•˜ëŠ” ì •ë³´ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤. ì´ê²ƒì„ topic publishë¼ê³  ë¶€ë¥´ì§€ìš”. ë°˜ëŒ€ë¡œ, ë°ì´í„°ë¥¼ ë°›ëŠ” ì£¼ì²´ì¸ subscriber ì…ì¥ì—ì„  topicì„ í†µí•´ ë°ì´í„°ë¥¼ ë°›ê²Œ ë˜ë©° ì´ê²ƒì€ topic subscribeë¼ê³  ë¶ˆë¦½ë‹ˆë‹¤. ROS 2 Topic msg ë¡œë´‡ í”„ë¡œê·¸ë˜ë° ì‹œ ì„¼ì„œ, ì œì–´ ë°ì´í„°ë¥¼ ë¹„ë¡¯í•˜ì—¬ ë‹¤ì–‘í•œ ìœ í˜•ì˜ ë°ì´í„°ë“¤ì´ Topicì„ í†µí•´ ì˜¤ê³  ê°‘ë‹ˆë‹¤. ROSì—ì„œëŠ” ì´ëŸ¬í•œ ë°ì´í„° í˜•ì‹ì„ msg(Message)ë¼ëŠ” í˜•íƒœë¡œ ì œê³µí•˜ë©°, ì›í•˜ëŠ” ë°ì´í„°ì— ì í•©í•œ topic msgë¥¼ ì‚¬ìš©í•˜ë©´ ë”ìš± íš¨ìœ¨ì ì¸ ë¡œë´‡ í”„ë¡œê·¸ë˜ë°ì´ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤. image from : ethz.ch\nROS 1ê³¼ ROS 2ëŠ”, msgë¥¼ êµ¬ë¶„í•˜ëŠ” í•„ë“œì—ì„œ ì°¨ì´ë¥¼ ë³´ì…ë‹ˆë‹¤. ROS 1 geometry_msgs/Twist ROS 2 geometry_msgs/msg/Twist ì„¸ë¶€ í•„ë“œ ì •ë³´ë¥¼ ìœ„í•´ êµ¬ê¸€ë§ì„ í•˜ë©´ ROS 1 ê²°ê³¼ê°€ ë‚˜ì˜¬ ë•Œê°€ ìˆëŠ”ë° í•´ë‹¹í•˜ëŠ” í•„ë“œë¥¼ ì¤‘ê°„ì— ì¶”ê°€í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤. ì¶œì²˜ : http://docs.ros.org/ ROS 2 Topic CLI ROSì—ì„œëŠ” topicì— ëŒ€í•œ ì •ë³´, íŒŒì‹±, ì†¡ìˆ˜ì‹ ê³¼ ê°™ì€ ì—¬ëŸ¬ ì¸í„°í˜ì´ì‹±ì´ ê°€ëŠ¥í•˜ë„ë¡ CLIë¥¼ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. topicê³¼ msgì— ëŒ€í•œ CLIë“¤ì„ ì‚´í´ë´…ì‹œë‹¤!\nì´ë²ˆ ì˜ˆì‹œë¥¼ ìœ„í•´ 2ê°œì˜ í„°ë¯¸ë„ì„ ì‹¤í–‰í•˜ê³  ì•„ë˜ì™€ ê°™ì€ ëª…ë ¹ì–´ë¥¼ ê°ê° ì…ë ¥í•©ë‹ˆë‹¤. (ê·¸ë¦¬ê³  ì„¸ë²ˆì§¸ í„°ë¯¸ë„ì—ì„œ ì´ì–´ì§€ëŠ” í•™ìŠµì„ ì§„í–‰í•˜ì‹œë©´ ë©ë‹ˆë‹¤.) # Terminal 1 $ ros2 topic pub /chatter std_msgs/String \u0026#34;data: Hello ROS Developers\u0026#34; # Terminal 2 $ ros2 topic echo /chatter ros2 topic list â‡’ ì‚¬ìš©ì¤‘ì¸ topic list ì¡°íšŒ $ ros2 topic list /topic_a /topic_b ... /clock /parameter_events /performance_metrics /rosout ros2 topic info â‡’ íŠ¹ì • topicì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ ì¡°íšŒ $ ros2 topic info /chatter Type: std_msgs/msg/String Publisher count: 1 Subscription count: 1 â‡’ verbose optionì„ í†µí•´ ë”ìš± ìì„¸í•œ ë‚´ìš©ì„ ì•Œ ìˆ˜ ìˆì§€ë§Œ ì§€ê¸ˆì€ ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.\n$ ros2 topic info /chatter --verbose Type: std_msgs/msg/String Publisher count: 1 Node name: _ros2cli_84037 Node namespace: / Topic type: std_msgs/msg/String Endpoint type: PUBLISHER GID: 30.06.10.01.46.68.e4.44.22.bd.f2.21.00.00.08.03.00.00.00.00.00.00.00.00 QoS profile: Reliability: RMW_QOS_POLICY_RELIABILITY_RELIABLE Durability: RMW_QOS_POLICY_DURABILITY_VOLATILE Lifespan: 9223372036854775807 nanoseconds Deadline: 9223372036854775807 nanoseconds Liveliness: RMW_QOS_POLICY_LIVELINESS_AUTOMATIC Liveliness lease duration: 9223372036854775807 nanoseconds Subscription count: 1 Node name: _ros2cli_84065 Node namespace: / Topic type: std_msgs/msg/String Endpoint type: SUBSCRIPTION GID: 48.95.10.01.ea.a0.fa.d5.31.c6.85.40.00.00.08.04.00.00.00.00.00.00.00.00 QoS profile: Reliability: RMW_QOS_POLICY_RELIABILITY_BEST_EFFORT Durability: RMW_QOS_POLICY_DURABILITY_VOLATILE Lifespan: 9223372036854775807 nanoseconds Deadline: 9223372036854775807 nanoseconds Liveliness: RMW_QOS_POLICY_LIVELINESS_AUTOMATIC Liveliness lease duration: 9223372036854775807 nanoseconds ros2 topic type â‡’ í•´ë‹¹ topicì´ ì‚¬ìš©ì¤‘ì¸ msg ì¡°íšŒ $ ros2 topic type /chatter std_msgs/msg/String ros2 interface show â‡’ íŠ¹ì • msg ì •ë³´ ì¡°íšŒ $ ros2 interface show std_msgs/msg/String # This was originally provided as an example message. # It is deprecated as of Foxy # It is recommended to create your own semantically meaningful message. # However if you would like to continue using this please use the equivalent in example_msgs. string data ros2 topic echo â‡’ íŠ¹ì • topic ë°ì´í„°ë¥¼ ì—¿ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. $ ros2 topic echo /chatter ... data: Hello ROS Developers --- data: Hello ROS Developers --- ros2 topic hz â‡’ topicì˜ publish/subscribe ì£¼ê¸°ë¥¼ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. $ ros2 topic hz /chatter average rate: 1.000 min: 1.000s max: 1.000s std dev: 0.00013s window: 3 average rate: 1.000 min: 1.000s max: 1.000s std dev: 0.00017s window: 5 ... ros2 topic pub â‡’ í”„ë¡œê·¸ë˜ë° ì—†ì´ í„°ë¯¸ë„ ë¼ì¸ì—ì„œ publishê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. (ë‹¨, ì£¼ë¡œ ê°„ë‹¨í•œ ë¬¸ìì—´ ì •ë„ì—ë§Œ ì‚¬ìš©ë˜ë©° ì´ë¯¸ì§€ ë°ì´í„° ë“±ì—ëŠ” ì‚¬ìš©ì´ ë¶ˆê°€í•©ë‹ˆë‹¤.) $ ros2 topic pub /chatter std_msgs/String \u0026#34;data: Hello ROS Developers\u0026#34; ... publishing #1: std_msgs.msg.String(data=\u0026#39;Hello ROS Developers\u0026#39;) publishing #2: std_msgs.msg.String(data=\u0026#39;Hello ROS Developers\u0026#39;) publishing #3: std_msgs.msg.String(data=\u0026#39;Hello ROS Developers\u0026#39;) ROS 2 Topic CLI ì •ë¦¬ CMD Description ros2 topic list ì „ì²´ topic ì¡°íšŒ ros2 topic info íŠ¹ì • topic ì •ë³´ ì¡°íšŒ ros2 topic type íŠ¹ì • topic type ì¡°íšŒ ros2 interface show msg type ì¡°íšŒ ros2 topic echo topic ì—¿ë³´ê¸° ros2 topic hz topic pub/sub ì£¼ê¸° ì¡°íšŒ ros2 topic pub ê°„ë‹¨í•œ publish ROS 2 Service Topicì— ì´ì–´ ROSì˜ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ ë‘ë²ˆì§¸ë¡œ Serviceë¥¼ ë°°ì›Œë³´ê² ìŠµë‹ˆë‹¤.\nClient Nodeê°€ Server Nodeë¡œ requestë¥¼ ì£¼ë©´, í•´ë‹¹ requestì— ëŒ€ì‘í•˜ëŠ” ì ì ˆí•œ responseê°€ ë‹¤ì‹œ Clientì—ê²Œë¡œ ì „ë‹¬ë©ë‹ˆë‹¤. ì´ ê³¼ì •ì„ Service Callì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤. image from : docs.ros.org\ní•˜ë‚˜ì˜ Service Serverì—ëŠ” ì—¬ëŸ¬ Client Nodeê°€ request í•  ìˆ˜ ìˆì§€ë§Œ, ServerëŠ” ë™ì‹œì— ì—¬ëŸ¬ requestë¥¼ ì²˜ë¦¬í•˜ì§€ëŠ” ëª»í•©ë‹ˆë‹¤. ë‘ Nodeì—ì„œ ë™ì‹œì— requestê°€ ì™”ë‹¤ë©´, ì¡°ê¸ˆì´ë¼ë„ ë¨¼ì € í†µì‹ í•œ Nodeì˜ ì‘ì—…ì„ ìš°ì„  ì§„í–‰í•˜ê³ , ê·¸ë™ì•ˆ ë‹¤ë¥¸ NodeëŠ” ê¸°ë‹¤ë¦¬ê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤. image from : https://docs.ros.org/en/foxy/Tutorials/Services/Understanding-ROS2-Services.html\nService ê°œë… ì •ë¦¬ Serviceë¥¼ ìš”ì²­í•˜ëŠ” ì£¼ì²´ë¥¼ Service Clientë¼ê³  í•˜ë©°, Service ìš”ì²­ ìì²´ë¥¼ Request(í˜¹ì€ Call)ë¼ê³  í•©ë‹ˆë‹¤. Serviceë¥¼ ìš”ì²­ë°›ëŠ” ì£¼ì²´ë¥¼ Service Serverë¼ê³  í•˜ë©°, Service ServerëŠ” Requestì— ëŒ€í•œ ì‘ë‹µ, ì¦‰ Service Responseë¥¼ ë‹¤ì‹œ Service Clientì—ê²Œ íšŒë‹µí•©ë‹ˆë‹¤. Requestì™€ Responseë¥¼ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ë°ì´í„° íƒ€ì…ì€ srvë¼ê³  í•˜ë©° Requestì™€ Responseë¡œ ë‚˜ë‰©ë‹ˆë‹¤. Serviceì˜ ì¤‘ìš”í•œ íŠ¹ì§• â‡’ í•˜ë‚˜ì˜ Service Serverì— ì—¬ëŸ¬ Clientê°€ request í•  ìˆ˜ ìˆì§€ë§Œ, ServerëŠ” ë™ì‹œì— ì—¬ëŸ¬ requestë¥¼ ì²˜ë¦¬í•˜ì§€ ëª»í•©ë‹ˆë‹¤.\nimage from : docs.ros.org\në§ˆì§€ë§‰ìœ¼ë¡œ, Topicê³¼ ë¹„êµí•˜ì—¬ Serviceì˜ íŠ¹ì§•ì„ ì•Œì•„ë´…ì‹œë‹¤.\n1:1 í†µì‹  : Topic publishë¥¼ í•˜ë©´ ì—¬ëŸ¬ Nodeê°€ Subscribe ê°€ëŠ¥í•©ë‹ˆë‹¤. ë°˜ë©´, ServiceëŠ” requestê°€ ì˜¨ ëŒ€ìƒì—ê²Œë§Œ responseë¥¼ ì¤ë‹ˆë‹¤. ìˆœì°¨ì  í†µì‹  : Service ServerëŠ” ë™ì‹œì— ì—¬ëŸ¬ requestë¥¼ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜„ì¬ ì‘ì—…ì¤‘ì¸ requestê°€ ì²˜ë¦¬ë  ë•Œ ê¹Œì§€ ë‹¤ë¥¸ requestëŠ” ê¸°ë‹¤ë¦¬ê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ë‹¨ë°œì„± : Topicì€ ëŒ€ë¶€ë¶„ ì§€ì†ì ìœ¼ë¡œ publishë¥¼ ì§„í–‰í•˜ëŠ” ë°˜ë©´, ServiceëŠ” 1íšŒì„± í†µì‹ ì…ë‹ˆë‹¤. ROS 2 Service CLI ServiceëŠ” Topicê³¼ëŠ” ë‹¤ë¥´ê²Œ ì¼íšŒì„±ì´ê¸° ë•Œë¬¸ì— CLIë¥¼ ì‚¬ìš©í•  ì¼ì´ ë§¤ìš° ì¦ìŠµë‹ˆë‹¤. ìì£¼ ì‚¬ìš©ë˜ëŠ” ë§Œí¼ ì–¼ë¥¸ í•™ìŠµí•´ë´…ì‹œë‹¤!\nì´ë²ˆ í•™ìŠµì„ ìœ„í•´ ì¼ì „ì˜ husky simulatorë¥¼ ì‹¤í–‰í•˜ê² ìŠµë‹ˆë‹¤. ros2 launch husky_gazebo husky_playpen.launch.py ros2 service list â‡’ ì „ì²´ service listë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤. $ ros2 service list /controller_manager/configure_and_start_controller /controller_manager/configure_controller /controller_manager/describe_parameters ... ros2 service type â‡’ íŠ¹ì • serviceì— ëŒ€í•œ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤. (ì‚¬ìš©ë˜ëŠ” type ì •ë„ë¥¼ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.) $ ros2 service type /controller_manager/configure_and_start_controller controller_manager_msgs/srv/ConfigureStartController ros2 interface show â‡’ Topicì˜ msgì™€ ìœ ì‚¬í•˜ê²Œ, Serviceì—ëŠ” srvê°€ ì¡´ì¬í•˜ëŠ”ë°ìš”, ì´ íƒ€ì…ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. $ ros2 interface show controller_manager_msgs/srv/ConfigureStartController # The ConfigureStartController service allows you to configure and start a single controller # inside controller_manager # To configure and start a controller, specify the \u0026#34;name\u0026#34; of the controller. # The return value \u0026#34;ok\u0026#34; indicates if the controller was successfully # configured and started or not. string name --- bool ok ì„œë¹„ìŠ¤ íƒ€ì… ì¤‘ê°„ì— ë³´ì´ëŠ” - - - ë¶€ë¶„ì€ requestì™€ responseì˜ êµ¬ë¶„ìë¼ê³  ìƒê°í•˜ì‹œë©´ ë©ë‹ˆë‹¤.\nros2 service call â‡’ ì»¤ë©˜ë“œ ë¼ì¸ ìƒì—ì„œ Service Callì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°„ë‹¨í•œ serviceë¥¼ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤. $ ros2 service call /get_model_list gazebo_msgs/srv/GetModelList {} requester: making request: gazebo_msgs.srv.GetModelList_Request() response: gazebo_msgs.srv.GetModelList_Response(header=std_msgs.msg.Header(stamp=builtin_interfaces.msg.Time(sec=1594, nanosec=330000000), frame_id=\u0026#39;\u0026#39;), model_names=[\u0026#39;ground_plane\u0026#39;, \u0026#39;jersey_barrier\u0026#39;, \u0026#39;jersey_barrier_0\u0026#39;, \u0026#39;jersey_barrier_1\u0026#39;, \u0026#39;jersey_barrier_2\u0026#39;, \u0026#39;jersey_barrier_3\u0026#39;, \u0026#39;jersey_barrier_4\u0026#39;, \u0026#39;jersey_barrier_5\u0026#39;, \u0026#39;jersey_barrier_6\u0026#39;, \u0026#39;jersey_barrier_7\u0026#39;, \u0026#39;jersey_barrier_8\u0026#39;, \u0026#39;jersey_barrier_9\u0026#39;, \u0026#39;jersey_barrier_10\u0026#39;, \u0026#39;jersey_barrier_11\u0026#39;, \u0026#39;jersey_barrier_12\u0026#39;, \u0026#39;jersey_barrier_13\u0026#39;, \u0026#39;jersey_barrier_14\u0026#39;, \u0026#39;fire_hydrant\u0026#39;, \u0026#39;fire_hydrant_0\u0026#39;, \u0026#39;fire_hydrant_1\u0026#39;, \u0026#39;Dumpster\u0026#39;, \u0026#39;Dumpster_0\u0026#39;, \u0026#39;jersey_barrier_15\u0026#39;, \u0026#39;Construction Cone\u0026#39;, \u0026#39;Construction Barrel\u0026#39;, \u0026#39;Construction Cone_0\u0026#39;, \u0026#39;Construction Barrel_0\u0026#39;, \u0026#39;asphalt_plane\u0026#39;, \u0026#39;Construction Barrel_1\u0026#39;, \u0026#39;Construction Barrel_2\u0026#39;, \u0026#39;Construction Barrel_3\u0026#39;, \u0026#39;Construction Barrel_4\u0026#39;, \u0026#39;Construction Barrel_5\u0026#39;, \u0026#39;Construction Barrel_6\u0026#39;, \u0026#39;Construction Barrel_7\u0026#39;, \u0026#39;Construction Cone_1\u0026#39;, \u0026#39;husky\u0026#39;], success=True) â‡’ Gazebo ìƒì— ì¡´ì¬í•˜ëŠ” ëª¨ë¸ë“¤ì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ responseë¡œ ë°›ì•˜ìŠµë‹ˆë‹¤. (gazebo rosì—ì„œ ì´ëŸ¬í•œ ê¸°ëŠ¥ë“¤ì´ ì œê³µë©ë‹ˆë‹¤.)\nROS 2 Service CLI ì •ë¦¬ CMD Description ros2 service list ì „ì²´ Service ë¦¬ìŠ¤íŠ¸ ros2 service type íŠ¹ì • Serviceê°€ ì‚¬ìš©í•˜ëŠ” ë°ì´í„° íƒ€ì… ì¡°íšŒ ros2 interface show íŠ¹ì • srvì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ ì¡°íšŒ ros2 service call í„°ë¯¸ë„ì„ í†µí•´ Service Call ROS 2 Action ROS 2ì˜ ë§ˆì§€ë§‰ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì¸ Actionì„ ë°°ì›Œë³´ê² ìŠµë‹ˆë‹¤.\në³µìŠµ ì°¨ì›ì—ì„œ Serviceì˜ ì¤‘ìš”í•œ íŠ¹ì§• í•œ ê°€ì§€ë¥¼ ë³µê¸°í•´ë³´ê² ìŠµë‹ˆë‹¤. í•˜ë‚˜ì˜ Service Serverì— ì—¬ëŸ¬ Clientê°€ request í•  ìˆ˜ ìˆì§€ë§Œ, ServerëŠ” ë™ì‹œì— ì—¬ëŸ¬ requestë¥¼ ì²˜ë¦¬í•˜ì§€ ëª»í•©ë‹ˆë‹¤. image from : docs.ros.org Actionì€ ë°”ë¡œ ì´ëŸ¬í•œ Serviceì˜ ë‹¨ì ì„ ê·¹ë³µí•˜ê¸° ìœ„í•´ íƒ„ìƒí•œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. Actionì€ Serviceì™€ Topicì˜ íŠ¹ì„±ì„ ëª¨ë‘ ê°–ê³  ìˆìœ¼ë©°, ì‹¤ì œë¡œ ê°€ì¥ ëŠ¦ê²Œ íƒ„ìƒí•œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.\nActionì˜ íŠ¹ì§•\naction clientëŠ” action serverê°€ Resultë¥¼ ë³´ë‚´ê¸° ì „ê¹Œì§€ ë§ˆëƒ¥ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³ , ë‹¤ë¥¸ ì¼ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. action clientëŠ” Result Responseë¥¼ ë°›ê¸° ì „ì—ë„ ì§€ì†ì ìœ¼ë¡œ Feedbackì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, Feedbackì„ ë°›ê³  ìˆë‹¤ê°€, ë­”ê°€ ì˜ëª» ëŒì•„ê°€ê³  ìˆë‹¤ëŠ” ê²ƒì„ ê°ì§€í•œ ê²½ìš° cancelì„ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. â‡’ í•˜ì§€ë§Œ, ì—¬ëŸ¬ requestë¥¼ ë™ì‹œì— ì‘ì—…í•˜ëŠ” ê²ƒì´ë‚˜, Feedback ì¤‘ì— topic subscribeì™€ ê°™ì€ ì‘ì—…ì€ ë³¸ì§ˆì ìœ¼ë¡œ ë¶ˆê°€í•©ë‹ˆë‹¤. ì´ì— ëŒ€í•œ í•´ê²° ë°©ë²•ë„ í›„ì— ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nimage from : https://docs.ros.org/en/foxy/Tutorials/Understanding-ROS2-Actions.html ì‚¬ì§„ê³¼ ê°™ì´ Action Clientì™€ Serverê°€ ì£¼ê³ ë°›ëŠ” ë‚´ìš©ì€ í¬ê²Œ 5ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.\nClient â‡’ Server, Goal Request (service requestì™€ ìœ ì‚¬í•©ë‹ˆë‹¤.) server â‡’ client, Goal Response client â‡’ server, Result Request server â‡’ client, Feedback (topicê³¼ ìœ ì‚¬í•©ë‹ˆë‹¤.) server â‡’ client, Result Response ë§Œì•½ 4ë²ˆ ë„ì¤‘ cancelì´ ë°œìƒí•˜ë©´ Actionì€ ì¢…ë£Œë©ë‹ˆë‹¤.\nì´ë ‡ê²Œ Actionì€ Topic, Serviceì˜ íŠ¹ì§•ì„ ëª¨ë‘ ê°–ê³  ìˆìœ¼ë©° Feedback ê²°ê³¼ì— ë”°ë¼ Cancelì´ë¼ëŠ” ì¶”ê°€ ê¸°ëŠ¥ê¹Œì§€ ê°–ì¶”ê³  ìˆëŠ” ë³µì¡í•œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.\nROS 2 Action CLI ì´ë²ˆ ì˜ˆì‹œë¥¼ ìœ„í•´ turtlesimì´ë¼ëŠ” í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰ì‹œí‚¨ ë’¤, ì‹¤ìŠµì„ ì§„í–‰í•´ë´…ì‹œë‹¤. sudo apt install ros-foxy-turtlesim -y ros2 run turtlesim turtlesim_node ros2 action list â‡’ ì‹¤í–‰ ì¤‘ì¸ actionë“¤ì„ ì¡°íšŒ ê°€ëŠ¥í•©ë‹ˆë‹¤. $ ros2 action list /turtle1/rotate_absolute ros2 action info â‡’ ****íŠ¹ì • actionì˜ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤. $ ros2 action info /turtle1/rotate_absolute Action: /turtle1/rotate_absolute Action clients: 0 Action servers: 1 /turtlesim ros2 interface show â‡’ Actionì—ì„œ ì‚¬ìš©ë˜ëŠ” ë°ì´í„° íƒ€ì…ì€ actionì…ë‹ˆë‹¤. ì´ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤. $ ros2 interface show turtlesim/action/RotateAbsolute # The desired heading in radians float32 theta --- # The angular displacement in radians to the starting position float32 delta --- # The remaining rotation in radians float32 remaining ros2 action send_goal â‡’ ì»¤ë©˜ë“œ ë¼ì¸ì—ì„œ ì†ì‰½ê²Œ Action Goalì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (feedback optionì„ ì œê³µí•©ë‹ˆë‹¤.) $ ros2 action send_goal \u0026lt;action_name\u0026gt; \u0026lt;action_type\u0026gt; \u0026lt;values\u0026gt; $ ros2 action send_goal /turtle1/rotate_absolute turtlesim/action/RotateAbsolute \u0026#34;{theta : 0.0}\u0026#34; --feedback 1657646954.088327 [0] ros2: using network interface enp7s0 (udp/166.104.135.89) selected arbitrarily from: enp7s0, docker0 Waiting for an action server to become available... Sending goal: theta: 0.0 Goal accepted with ID: d3ddca85948d4099a13dbeb8183e5ecc Result: delta: -0.7839995622634888 Goal finished with status: SUCCEEDED /turtle1/rotate_absoluteëŠ” ê±°ë¶ì´ë¥¼ íŠ¹ì •í•œ ì ˆëŒ€ ê°ë„ë¡œ íšŒì „ì‹œí‚¤ëŠ” actionìœ¼ë¡œ feedback ì˜µì…˜ ì§€ì • ì‹œ ì»¤ë©˜ë“œ ë¼ì¸ ìƒì— ë³€í™”í•˜ëŠ” ê°ë„ë¡ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nROS 2 Action CLI ì •ë¦¬ CMD Description ros2 action list ì „ì²´ action list ì¡°íšŒ ros2 action info íŠ¹ì • action ì •ë³´ ì¡°íšŒ ros2 interface show íŠ¹ì • action ë°ì´í„° íƒ€ì…ì— ëŒ€í•œ ì¡°íšŒ ros2 action send_goal í„°ë¯¸ë„ì„ í†µí•œ action goal request ì—¬ê¸°ê¹Œì§€ ë°°ì› ë‹¤ë©´ ROS 2ì˜ ê°œë…ì ì¸ ë¶€ë¶„ì€ ëŒ€ë¶€ë¶„ ìŠµë“í•˜ì…¨ë‹¤ê³  ë³´ì•„ë„ ì¢‹ìŠµë‹ˆë‹¤. ê·¸ëŸ¼ ì•ìœ¼ë¡œ í”„ë¡œê·¸ë˜ë°ê³¼ ì˜ˆì‹œë“¤ì„ í†µí•´ ROS 2 ì‹œìŠ¤í…œì— ë”ìš± ëŠ¥ìˆ™í•´ì ¸ë³´ê² ìŠµë‹ˆë‹¤.\n"
},
{
	"uri": "/kr/ros2_foxy/lecture6/",
	"title": "Lecture6. ROS 2 Tools",
	"tags": [],
	"description": "",
	"content": "\nROS 2ëŠ” rqtë¼ëŠ” í”„ë¡œê·¸ë¨ì˜ ì§‘í•©ì„ ì œê³µí•©ë‹ˆë‹¤. rqtì˜ GUIë¥¼ ì‚¬ìš©í•˜ë©´ ë°ì´í„° ì‹œê°í™”, ì½”ë”© ì—†ì´ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ê³¼ ìƒí˜¸ ì‘ìš©, tf frameì˜ ì‹œê°í™” ë“± ROS 2 í”„ë¡œê·¸ë˜ë°ì´ ë§¤ìš° ë§¤ìš° í¸í•´ì§‘ë‹ˆë‹¤.\nì´ë²ˆ ì‹œê°„ì„ í†µí•´ ëª‡ê°€ì§€ ìì£¼ ì‚¬ìš©ë˜ëŠ” rqtë“¤ì„ ì‚´í´ë³´ê³ , ì•½ê°„ì˜ ì‹¤ìŠµë„ ì§„í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.\nrqtì˜ ì‹¤í–‰ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. rqt â‡’ ì´ˆê¸° ì‹¤í–‰ ì‹œ ë¹ˆ í™”ë©´ì´ ë“±ì¥í•˜ì§€ë§Œ, ìƒë‹¨ íƒ­ì„ í†µí•´ ìˆ˜ë§ì€ ì‘ìš© í”„ë¡œê·¸ë¨ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nrqt_graph rqt_graphëŠ” nodeì™€ topicì— ëŒ€í•´ ì‹œê°í™”í•˜ì—¬ í•œ ì¥ì˜ ì´ë¯¸ì§€ë¥¼ ë³´ì—¬ì£¼ëŠ” íˆ´ë¡œ, ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” Rqt Toolì…ë‹ˆë‹¤.\nrqt_graphëŠ” ìì£¼ ì‚¬ìš©ë˜ëŠ” ë§Œí¼ ë³´í†µ ê°œë³„ì ìœ¼ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤. rqt_graph ì‚¬ì§„ì— ë³´ì´ëŠ” ë™ê·¸ë¼ë¯¸ëŠ” nodeë¥¼, ë„¤ëª¨ëŠ” topicì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ë”ë¶ˆì–´ í™”ì‚´í‘œì˜ ë°©í–¥ì„ í†µí•´ topicì˜ ì†¡/ìˆ˜ì‹ ìë¥¼ êµ¬ë³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”ë¶ˆì–´ rqt_graphëŠ” ë‹¤ì–‘í•œ ì‹œê°í™” ì˜µì…˜ë“¤ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. Node Option Hide Option ETC Node Only Dead sinks Group Option Nodes/Topics (Active) Leaf Topics Actions Nodes/Topics (All) Debug tf tf Images Unreachable Highlight Params Fit â‡’ ì°¸ê³ ë¡œ, rqt_graphì˜ nodeì— ë§ˆìš°ìŠ¤ ì»¤ì„œë¥¼ ê°€ì ¸ê°€ë©´ ê´€ë ¨ topicë“¤ì˜ ìƒ‰ìƒì„ ë°”ê¿”ì¤ë‹ˆë‹¤. (Highlight)\nTopic ì´ë¦„ì„ ì˜ëª» ìƒì„±í•˜ê±°ë‚˜ ê²¹ì¹˜ëŠ” ê²½ìš°, ì½”ë“œ ì°¨ì›ì—ì„œ ë””ë²„ê¹…ì´ í˜ë“¤ì§€ë§Œ rqt_graphë¥¼ ì‚¬ìš©í•˜ë©´ ì†ì‰½ê²Œ íŒë³„ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nTopic Tools - Message Publisher \u0026amp; Topic Monitor rqt ìƒë‹¨ì˜ íƒ­ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ í™”ë©´ì„ êµ¬ì„±í•©ë‹ˆë‹¤.\nplugins â‡’ topics â‡’ Message Publisher pulgins â‡’ topics â‡’ Topic Monitor message publisherë¥¼ ì‚¬ìš©í•˜ë©´ ì½”ë”© ì—†ì´ ì›í•˜ëŠ” topicì„ publish ê°€ëŠ¥í•©ë‹ˆë‹¤. Topic Msgì— ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì±„ì›Œë„£ì€ ë’¤, ì²´í¬ë°•ìŠ¤ë¥¼ í´ë¦­í•˜ë©´ ë¡œë´‡ì´ ì›€ì§ì´ê¸° ì‹œì‘í•©ë‹ˆë‹¤. ì‹¤ìŠµì„ ìœ„í•´ ì¼ì „ husky gazeboë¥¼ ì‹¤í–‰ì‹œí‚¤ê³  ë¡œë´‡ì„ ì œì–´í•´ ë³´ê² ìŠµë‹ˆë‹¤. # Terminal 1 ros2 launch husky_gazebo husky_playpen.launch.py # Terminal 2 rqt Topic Monitorë¥¼ ì‚¬ìš©í•˜ë©´, Topic ë°ì´í„°ë“¤ì„ íš¨ê³¼ì ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§ ê°€ëŠ¥í•©ë‹ˆë‹¤. Topic Publisherì™€ ë™ì¼í•˜ê²Œ ì²´í¬ë°•ìŠ¤ë¥¼ ëˆŒëŸ¬ topicì„ ì„ íƒí•œ ë’¤, ë³€í•˜ëŠ” ë°ì´í„°ë¥¼ í™•ì¸í•´ë´…ì‹œë‹¤. Service Tools - Service Caller rqt ìƒë‹¨ì˜ íƒ­ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ í™”ë©´ì„ êµ¬ì„±í•©ë‹ˆë‹¤.\nplugins â‡’ services â‡’ Service Caller Service Callerë¥¼ í†µí•´ ì½”ë”© ì—†ì´ ê°„í¸í•˜ê²Œ Service Callì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. Service Srvì— ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì±„ì›Œë„£ì€ ë’¤, Call ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ Requestì™€ Responseë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Gazeboìƒì˜ ë¬¼ì²´ë¥¼ ì œê±°í•˜ëŠ” ê°„ë‹¨í•œ ì‹¤ìŠµì„ í•´ë´…ì‹œë‹¤. gazebo_rosì™€ rqtë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. # Terminal 1 - Run Gazebo ROS ros2 launch gazebo_ros gazebo.launch.py # Terminal 2 - rqt \u0026amp; Service Caller rqt rqt Service Callerë¥¼ ì‹¤í–‰ì‹œí‚¨ ë’¤, /delete_entity serviceë¥¼ ì„ íƒí•©ë‹ˆë‹¤. gazeboìƒì—ì„œ ëª¨ë¸ì„ ë“±ì¥ì‹œí‚¨ ë’¤, í•´ë‹¹ ëª¨ë¸ì˜ ì´ë¦„ì„ service srvë¥¼ í†µí•´ ì „ë‹¬í•˜ë©´ ë¬¼ì²´ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤! Rviz2 Rviz2ëŠ” ROS 2 ê°œë°œ ì¤‘ ë°œìƒí•˜ëŠ” ìˆ˜ë§ì€ ë¡œë´‡ ë°ì´í„°ë“¤ì„ ì‹œê°í™”í•´ì£¼ëŠ” ê³ ë§ˆìš´ íˆ´ì…ë‹ˆë‹¤. ë‹¤ë¥¸ rqt í”„ë¡œê·¸ë¨ë“¤ì€ ëª°ë¼ë„, Rviz2ì˜ ì‚¬ìš©ë²•ì€ ë°˜ë“œì‹œ ìµí˜€ë‘ì‹œê¸°ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤.\nrviz2 ì˜ˆì‹œë¥¼ ìœ„í•´ ì¢€ ë” ê°–ì¶°ì§„ gazebo í™˜ê²½ì„ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤. # install requirements cd du2023-ros2 ./setup_scripts.sh # package build cd ~/ros2_ws cbp src_controller \u0026amp;\u0026amp; source install/local_setup.bash cbp src_gazebo \u0026amp;\u0026amp; source install/local_setup.bash cbp src_odometry \u0026amp;\u0026amp; source install/local_setup.bash # demo env launch ros2 launch src_gazebo racecourse.launch.py â‡’ í˜„ì¬ëŠ” ì œê°€ ë¯¸ë¦¬ ì¤€ë¹„í•´ë‘” rviz2 í™”ë©´ì´ ë“±ì¥í–ˆì§€ë§Œ, ì‹¤ìŠµì„ í†µí•´ ì´ëŸ° rviz2 í™”ë©´ì„ êµ¬ì„±í•˜ê³  launch fileì„ í†µí•´ ì‹¤í–‰í•˜ëŠ” ë²•ê¹Œì§€ ë‹¤ë£¨ì–´ ë³´ê² ìŠµë‹ˆë‹¤.\nRviz2ì˜ ê°œë³„ ì‹¤í–‰ì€ í„°ë¯¸ë„ì—ì„œ ê°€ëŠ¥í•©ë‹ˆë‹¤. rviz2 rvizì—ì„œ viewë¥¼ ì „í™˜í•˜ëŠ” ë°©ì‹ì€ gazeboì™€ëŠ” ë‹¤ë¥´ê²Œ ë§ˆìš°ìŠ¤ íœ  í´ë¦­ì´ í‰í–‰ì´ë™, ì™¼ìª½ í´ë¦­ì´ íšŒì „ì´ë™ì…ë‹ˆë‹¤. ë”ë¶ˆì–´, ìš°ì¸¡ ìƒë‹¨ì˜ viewë¥¼ í†µí•´ ì‹œì ì„ ë°”ê¿€ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. â‡’ Orbitì´ ê¸°ë³¸ì´ë©°, ì¢…ì¢… TopDownOrthoë„ ì‚¬ìš©ë©ë‹ˆë‹¤.\nì¢Œì¸¡ Displays íŒ¨ë„ì„ í†µí•´ ê°ì¢… Topic, TF ë°ì´í„°ë“¤ì„ ì¶”ê°€, ìˆ˜ì •, ì˜µì…˜ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ displayë¥¼ ì¶”ê°€í•˜ê¸° ìœ„í•´ì„œ, íŒ¨ë„ í•˜ë‹¨ Add ë²„íŠ¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. rviz2ì—ì„œëŠ” By display type / By Topicì˜ ë‘ê°€ì§€ add optionì„ ì œê³µí•©ë‹ˆë‹¤.\nTopic typeì„ ì‚¬ìš©í•˜ë©´ rviz2ê°€ í˜„ì¬ ì‹¤í–‰ë˜ê³  ìˆëŠ” topicì„ ì¸ì‹í•˜ì—¬ ì í•©í•œ ì‹œê°í™”ë¥¼ í•´ì£¼ê²Œë©ë‹ˆë‹¤.\nDisplay typeì€ ì›í•˜ëŠ” ì‹œê°í™” íƒ€ì…ì„ ë¨¼ì € ì„ íƒí•˜ê³ , í•´ë‹¹ íƒ€ì…ì„ ê°–ëŠ” topicì„ ì‚¬ìš©ìê°€ ë§¤ì¹­í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.\nì‹œê°í™” ì‹œ, ìƒ‰ìƒ/í¬ê¸°/íˆ¬ëª…ë„ ë“± ë‹¤ì–‘í•œ ì˜µì…˜ì„ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ros2 launchë¡œ rviz2 ì‹¤í–‰í•˜ê¸° rviz2 ë˜í•œ ros2 nodeì…ë‹ˆë‹¤. ê·¸ë ‡ê¸°ì— launch fileì—ì„œì˜ ì‹¤í–‰ì€ ì¼ë°˜ nodeì™€ ë™ì¼í•©ë‹ˆë‹¤.\n# Launch RViz rviz = Node( package=\u0026#39;rviz2\u0026#39;, executable=\u0026#39;rviz2\u0026#39;, name=\u0026#39;rviz2\u0026#39;, output=\u0026#39;screen\u0026#39;, ) í•˜ì§€ë§Œ, ì´ë ‡ê²Œ ì‹¤í–‰ ì‹œ, ë§¤ë²ˆ ì‹œê°í™”í•  ë°ì´í„°ë¥¼ ì„ íƒí•˜ê³ , ì˜µì…˜ì„ ë°”ê¾¸ëŠ” ë“±ì˜ ìˆ˜ê³ ìŠ¤ëŸ¬ì›€ì´ ìƒê¹ë‹ˆë‹¤. ë”°ë¼ì„œ rviz2ëŠ” ì„¤ì •ì„ ì €ì¥í•˜ê³  ë¶ˆëŸ¬ì˜¤ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. (ì´ëŠ” rviz2 ìƒë‹¨ íŒ¨ë„ì—ì„œë„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.) save configë¥¼ í†µí•´ ë‚˜ë§Œì˜ ì„¤ì •ì„ ì €ì¥í•˜ê³ , launch fileì„ í†µí•´ ì‹¤í–‰í•˜ëŠ” ì‹¤ìŠµì„ ì§„í–‰í•´ë´…ì‹œë‹¤. ì—¬ëŸ¬ë¶„ë§Œì˜ rviz2 í™”ë©´ì„ êµ¬ì„±í•©ë‹ˆë‹¤. í•´ë‹¹ ì„¤ì •(config file)ì„ íŠ¹ì • íŒ¨í‚¤ì§€ ë‚´ë¶€ì— ì €ì¥í•˜ê³ , ìœ„ì¹˜ë¥¼ ê¸°ì–µí•©ë‹ˆë‹¤. íŒ¨í‚¤ì§€ ë‚´ ìƒˆë¡œìš´ launch fileì„ ì‘ì„±í•˜ê³  rviz2 nodeë¥¼ ì¶”ê°€í•œ ë’¤, config fileì„ ì˜µì…˜ìœ¼ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤. import os from ament_index_python.packages import get_package_share_directory from launch import LaunchDescription from launch_ros.actions import Node def generate_launch_description(): pkg_path = os.path.join(get_package_share_directory(\u0026#39;src_gazebo\u0026#39;)) rviz_config_file = os.path.join(pkg_path, \u0026#39;rviz\u0026#39;, \u0026#39;gazebo_racecourse.rviz\u0026#39;) # Launch RViz rviz = Node( package=\u0026#39;rviz2\u0026#39;, executable=\u0026#39;rviz2\u0026#39;, name=\u0026#39;rviz2\u0026#39;, output=\u0026#39;screen\u0026#39;, arguments=[\u0026#39;-d\u0026#39;, rviz_config_file] ) return LaunchDescription([ rviz ]) ì°¸ê³ ë¡œ, ìƒˆë¡œìš´ í´ë”ê°€ ì¶”ê°€ë˜ì—ˆì„ ì‹œ CMakeLists.txtì— í•´ë‹¹ í´ë”ë¥¼ ì¶”ê°€í•˜ì—¬ì•¼ ì´í›„ launch fileì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤. install( DIRECTORY launch meshes models config worlds rviz urdf DESTINATION share/${PROJECT_NAME}/ ) ìƒˆë¡œìš´ íŒŒì¼, í´ë”ê°€ ì¶”ê°€ë˜ì—ˆìœ¼ë¯€ë¡œ colcon buildë¥¼ ìˆ˜í–‰í•œ ë’¤, ì˜ˆì œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. # Package build again cbp src_gazebo source install/local_setup.bash # execute your launch file ros2 launch src_gazebo \u0026lt;your-launch-file\u0026gt; rqt_robot_steering rqt_robot_steeringë¥¼ ì‚¬ìš©í•˜ë©´ ì›€ì§ì´ëŠ” ë¡œë´‡ì„ ì¡°ì¢…í•˜ê¸° ìœ„í•´ ë³„ë„ì˜ ì½”ë”©ì„ í•˜ì§€ ì•Šê³ ë„ GUIë¥¼ í†µí•œ ì¡°ì¢…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. # package install sudo apt install ros-foxy-rqt-robot-steering # run node rqt_robot_steering GUIì˜ ê°€ë¡œ ìŠ¬ë¼ì´ë“œëŠ” angular velocity, ì„¸ë¡œ ìŠ¬ë¼ì´ë“œëŠ” linear velocityë¥¼ ëœ»í•˜ë©° ë¡œë´‡ì˜ topicì´ë¦„ì„ ë§ì¶°ì¤€ ë’¤ ì›í•˜ëŠ” ì¡°ì¢…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì‹¤ìŠµì„ ìœ„í•´ ì´ì „ husky ì˜ˆì‹œë¥¼ ì‹¤í–‰í•˜ê³  rqt_robot_steeringë¥¼ í†µí•´ ë¡œë´‡ì„ ì¡°ì¢…í•´ë³´ê² ìŠµë‹ˆë‹¤. # Terminal 1 ros2 launch husky_gazebo husky_playpen.launch.py # Terminal 2 rqt_robot_steering rosbag2 rosbagì€ í”„ë¡œê·¸ë¨ ë™ì‘ ì¤‘ ë°œìƒí•˜ëŠ” message ë°ì´í„°ë¥¼ ê¸°ë¡í•˜ê³  ë³µê¸°í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” íˆ´ì…ë‹ˆë‹¤. ë¡œë´‡ ì•Œê³ ë¦¬ì¦˜ì„ ê°œë°œí•  ë•Œ, ê°™ì€ ìƒí™©ì— ëŒ€í•´ ì„±ëŠ¥ì„ ë¹„êµí•˜ëŠ” ê²½ìš°, í˜¹ì€ êµìœ¡ ëª©ì ìœ¼ë¡œ ë°ì´í„°ì…‹ì„ ì œê³µí•˜ëŠ” ê²½ìš° ë“±ì— ë§¤ìš° ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nrosbag ì‚¬ìš©ë²•ì„ í•¨ê»˜ ì‹¤ìŠµí•´ë³´ê² ìŠµë‹ˆë‹¤! ì‹¤ìŠµì„ ìœ„í•´ gazebo ì˜ˆì‹œë¥¼ ë¹Œë“œí•˜ê³  ì‹¤í–‰í•©ë‹ˆë‹¤. # Example package clone cd ~/ros2_ws/src git clone https://github.com/RB2023ROS/gz_ros2_examples cd ~/ros2_ws # Example package build cbp lidar_world # Run Example package ros2 launch lidar_world lidar_world.launch.py í•´ë‹¹ ì˜ˆì‹œëŠ” GPU Sensorë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ ì¼ë°˜ ë©íƒ‘ì—ì„œ ì‹¤í–‰ ì‹œ ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë©íƒ‘ì—ì„œì˜ ì‹¤í–‰ì„ ì›í•˜ì‹ ë‹¤ë©´ lidar_world/urdf/sensor_stick.urdf.xacro íŒŒì¼ì—ì„œ CPU ë²„ì „ìœ¼ë¡œ í† ê¸€í•©ë‹ˆë‹¤.\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;robot name=\u0026#34;sensor_stick\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34;\u0026gt; ... \u0026lt;!--Import gazebo elements--\u0026gt; \u0026lt;!-- \u0026lt;xacro:include filename=\u0026#34;$(find lidar_world)/urdf/sensor_stick.gazebo.xacro\u0026#34; /\u0026gt; --\u0026gt; \u0026lt;!-- \u0026lt;xacro:include filename=\u0026#34;$(find lidar_world)/urdf/sensor_stick_gpu.gazebo.xacro\u0026#34; /\u0026gt; --\u0026gt; ì´ëŸ° ì—¬ëŸ¬ ê¸°ëŠ¥ì„ ê°€ì§„ ì‹œë®¬ë ˆì´ì…˜ì€ ë§¤ìš° ëŠë¦¬ê²Œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì— ì •í™•í•œ ì•Œê³ ë¦¬ì¦˜ì˜ ê²€ì¦ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.\nROS ê°œë°œìë“¤ì€ ì´ëŸ¬í•œ ì´ìœ ë¡œ rosbag2ë¥¼ í†µí•´ í™˜ê²½ì—ì„œì˜ ë°ì´í„°ì…‹ì„ ì œì‘í•©ë‹ˆë‹¤. ì‹¤ì œë¡œ ì»´í“¨í„° ë¹„ì „ í•™íšŒë‚˜ ë¡œë´‡ í•™íšŒì—ì„œë„ ë³¸ì¸ì˜ í…ŒìŠ¤íŠ¸ë² ë“œë¥¼ rosbagìœ¼ë¡œ ì €ì¥í•œ ë’¤ publishí•˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤. ê·¸ëŸ¼ ì‹¤ìŠµì„ í†µí•´ rosbag2ì˜ ì‚¬ìš© ë°©ë²•ì„ ì•Œì•„ë´…ì‹œë‹¤. # Terminal 1 - gazebo env ros2 launch lidar_world lidar_world.launch.py # Terminal 2 - rosbag2 install \u0026amp; run sudo apt-get install ros-foxy-ros2bag ros-foxy-rosbag2* # create seperate dir for rosbag2 mkdir ~/ros2_ws/rosbag2 cd ~/ros2_ws/rosbag2 ros2 bag record -a -o lidar_world ... [INFO] [1681816765.163369771] [rosbag2_transport]: Listening for topics... [INFO] [1681816765.164494950] [rosbag2_transport]: Subscribed to topic \u0026#39;/tf_static\u0026#39; [INFO] [1681816765.165085302] [rosbag2_transport]: Subscribed to topic \u0026#39;/clicked_point\u0026#39; [INFO] [1681816765.165696583] [rosbag2_transport]: Subscribed to topic \u0026#39;/tf\u0026#39; [INFO] [1681816765.166304849] [rosbag2_transport]: Subscribed to topic \u0026#39;/goal_pose\u0026#39; â‡’ recordì˜ ì¢…ë£ŒëŠ” ctrl + cë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\ninfo ì˜µì…˜ì„ í†µí•´ ì €ì¥ì„ ë§ˆì¹œ rosbag2ì˜ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 16ì´ˆ ë™ì•ˆ ì•½ 570MBì˜ ë°ì´í„°ê°€ ì €ì¥ëœ ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. $ ros2 bag info lidar_world/lidar_world_0.db3 [INFO] [1681817128.588731891] [rosbag2_storage]: Opened database \u0026#39;lidar_world/lidar_world_0.db3\u0026#39; for READ_ONLY. Files: lidar_world/lidar_world_0.db3 Bag size: 569.4 MiB Storage id: sqlite3 Duration: 16.325s Start: Apr 18 2023 20:19:25.172 (1681816765.172) End: Apr 18 2023 20:19:41.497 (1681816781.497) Messages: 1068 Topic information: Topic: /clock | Type: rosgraph_msgs/msg/Clock | Count: 173 | Serialization Format: cdr Topic: /performance_metrics | Type: gazebo_msgs/msg/PerformanceMetrics | Count: 82 | Serialization Format: cdr ... ì €ì¥ ì™„ë£Œëœ rosbag2ë¥¼ ë‹¤ì‹œ ë³µê¸°í•´ë³´ê³  rviz2ë¥¼ í†µí•´ ì‹œê°í™”ê¹Œì§€ í•´ë´…ì‹œë‹¤. # Terminal 1 - ros2 bag play $ ros2 bag play lidar_world/lidar_world_0.db3 [INFO] [1681817182.011798950] [rosbag2_storage]: Opened database \u0026#39;lidar_world/lidar_world_0.db3\u0026#39; for READ_ONLY. ... # Terminal 2 - rviz2 $ rviz2 â‡’ Fixed Frameì„ link_1ìœ¼ë¡œ ë³€ê²½í•´ì•¼ í¬ì¸íŠ¸ë“¤ì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.\ní•œì°¨ë¡€ ì‹¤ìŠµì„ ì§„í–‰í•´ ë³´ì•˜ëŠ”ë°ìš”, ì´ì œ ê°ê°ì˜ ì»¤ë©˜ë“œ ë¼ì¸ ì˜µì…˜ë“¤ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nros2 bag í‚¤ì›Œë“œ Command Description record topic dataë¥¼ ì €ì¥í•©ë‹ˆë‹¤. info ì €ì¥ëœ rosbag ë°ì´í„°ì˜ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤. play ì €ì¥ëœ rosbag ë°ì´í„°ë¥¼ ì¬ìƒí•©ë‹ˆë‹¤. ros2 bag record ì˜µì…˜ Command Description -a ëª¨ë“  topic dataë¥¼ ì €ì¥í•©ë‹ˆë‹¤. -o ì €ì¥ë  rosbagì˜ ì´ë¦„ì„ ì§€ì •í•©ë‹ˆë‹¤. -b rosbag ì €ì¥ ì‹œ, ìµœëŒ€ ì‚¬ì´ì¦ˆë¥¼ ì§€ì •í•˜ë©° ì‚¬ì´ì¦ˆ ì´ˆê³¼ ì‹œ ìƒˆë¡œìš´ rosbagìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤. -d rosbag ì €ì¥ ì‹œ, ìµœëŒ€ ì‹œê°„ì„ ì§€ì •í•˜ë©° ì‚¬ì´ì¦ˆ ì´ˆê³¼ ì‹œ ìƒˆë¡œìš´ rosbagìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤. ë”ë¶ˆì–´, convert ê¸°ëŠ¥ì„ í†µí•´ rosbag2ë¥¼ ìª¼ê°œê±°ë‚˜ í•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìì„¸í•œ ì‚¬ìš©ë²•ì€ ë§í¬ë¡œ ë‚¨ê²¨ë‘ê² ìŠµë‹ˆë‹¤. https://github.com/ros2/rosbag2#converting-bags\nì‹¤ì œ ë¡œë´‡ ì œí’ˆì´ ì—†ë”ë¼ë„ ê¸°ë¡ëœ rosbag2 ë°ì´í„°ë¥¼ í†µí•´ ì•Œê³ ë¦¬ì¦˜ì˜ ê²€ì¦ê³¼ ì‹œì—°ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ë²ˆ ê°•ì˜ì—ì„œë„ rosbag2 ë°ì´í„°ë¥¼ ì ê·¹ ì‚¬ìš©í•˜ê³ ì í•˜ë‹ˆ ì˜ ê¸°ì–µí•´ì£¼ì„¸ìš”!\n"
},
{
	"uri": "/kr/ros2_foxy/lecture7/",
	"title": "Lecture7. ROS 2 Topic and Programming",
	"tags": [],
	"description": "",
	"content": "ROS 2 Topic and Programming ê°•ì˜ë¥¼ ì—´ì‹¬íˆ ë”°ë¼ì˜¤ë©´ì„œ ê°œë…ì„ ìŠì–´ë²„ë ¸ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ Topicì— ëŒ€í•´ì„œ ê°„ë‹¨íˆ ê°œë… ë³µìŠµì„ í•´ë³´ê² ìŠµë‹ˆë‹¤.\nTopicì€ Nodeë“¤ ì‚¬ì´ì— ë°ì´í„°(Message)ê°€ ì˜¤ê°€ëŠ” ê¸¸(Bus)ì˜ ì´ë¦„ì´ë©°, ì ì ˆí•œ ì´ë¦„ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì†¡ìˆ˜ì‹ í•˜ì§€ ì•Šìœ¼ë©´ ì›í•˜ëŠ” ë™ì‘ì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. image from : docs.ros.org\nTopicì˜ ì¤‘ìš”í•œ íŠ¹ì§•ìœ¼ë¡œ Topicì€ ì—¬ëŸ¬ Nodeë“¤ë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìˆê³ , ì „ì†¡ ì‹œì—ë„ ì—¬ëŸ¬ Nodeë“¤ì—ê²Œ ì „ì†¡ì´ ê°€ëŠ¥í•œ ë°©ì‹ì…ë‹ˆë‹¤. image from : docs.ros.org\ntopicì„ í†µí•´ ë°ì´í„°ê°€ ì „ë‹¬ë˜ëŠ” ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\në°ì´í„°ë¥¼ ë³´ë‚´ëŠ” ì£¼ì²´ì¸ publisherëŠ” ë°ì´í„°ë¥¼ ë°›ëŠ” ì£¼ì²´, subscriberë¥¼ ì§€ì •í•œ ë’¤, topicì„ í†µí•´ ì›í•˜ëŠ” ì •ë³´ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤. ì´ê²ƒì„ topic publishë¼ê³  ë¶€ë¥´ì§€ìš”. ë°˜ëŒ€ë¡œ, ë°ì´í„°ë¥¼ ë°›ëŠ” ì£¼ì²´ì¸ subscriber ì…ì¥ì—ì„  topicì„ í†µí•´ ë°ì´í„°ë¥¼ ë°›ê²Œ ë˜ë©° ì´ê²ƒì€ topic subscribeë¼ê³  ë¶ˆë¦½ë‹ˆë‹¤. Topicì„ ì‚¬ìš©í•  ì‹œ Publisher, Subscriber ì‚¬ì´ì—ëŠ” íŠ¹ì •í•œ í˜•ì‹ì„ ê°–ëŠ” ë°ì´í„°, msgê°€ ì˜¤ê°‘ë‹ˆë‹¤. ì›í•˜ëŠ” ë°ì´í„°ì— ì í•©í•œ topic msgë¥¼ ì‚¬ìš©í•˜ë©´ ë”ìš± íš¨ìœ¨ì ì¸ ë¡œë´‡ í”„ë¡œê·¸ë˜ë°ì´ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤. image from : ethz.ch\níŠ¹ì • messageê°€ ì–´ë–»ê²Œ êµ¬ì„±ë˜ì–´ ìˆëŠ”ì§€ ì•Œê³  ì‹¶ì„ ë•ŒëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. $ ros2 interface show geometry_msgs/msg/Twist # This expresses velocity in free space broken into its linear and angular parts. Vector3 linear Vector3 angular SRC Gazebo ì´ë²ˆ ROS 2 ê°•ì˜ì˜ ì‹¤ìŠµë“¤ì€ Road Balanceì˜ ì°¨ëŸ‰í˜• ë¡œë´‡ SRCë¥¼ í†µí•´ ì§„í–‰í•˜ê³ ì í•©ë‹ˆë‹¤. ì‹¤ìŠµì„ ì§„í–‰í•˜ê¸° ì „ Gazebo í™˜ê²½ì„ í•¨ê»˜ ì„¸íŒ…í•´ë³´ê² ìŠµë‹ˆë‹¤.\nsrc_gazebo ì‹¤í–‰ ì„¸íŒ… cd ~/ros2_ws/src/du2023-ros2 ./setup_scripts.sh # Package build cbp src_controller source install/local_setup.bash cbp src_gazebo source install/local_setup.bash ëª¨ë“  ì¤€ë¹„ê°€ ì™„ë£Œë˜ì—ˆë‹¤ë©´ ros2 launchë¥¼ í†µí•´ ì´ë²ˆ ì‹¤ìŠµì— ì‚¬ìš©ë  Gazebo í™˜ê²½ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ros2 launch src_gazebo empty_world.launch.py ì•„ë¬´ê²ƒë„ ì—†ëŠ” Gazebo í™˜ê²½ì— ì°¨ëŸ‰í˜• ë¡œë´‡ì´ ë“±ì¥í•  ê²ƒì…ë‹ˆë‹¤. í•¨ê»˜ ë“±ì¥í•˜ëŠ” rqt_robot_steeringì„ í†µí•´ ë¡œë´‡ì„ ì›€ì§ì—¬ë³´ì„¸ìš”. â‡’ í˜„ì¬ /cmd_vel topicì„ ì‚¬ìš©í•´ì„œ ë¡œë´‡ì„ ì¡°ì¢…í•˜ê³  ìˆëŠ” ìƒí™©ì…ë‹ˆë‹¤. ì§€ë‚œ ì‹œê°„ í•™ìŠµí•œ rqt toolë“¤ì„ ì‚¬ìš©í•´ì„œ ì‹œìŠ¤í…œ ë¶„ì„ì„ ì§„í–‰í•´ë´…ì‹œë‹¤.\nrqt_graphë¥¼ í†µí•´ í•´ë‹¹ topicì˜ publisher / subscriber í™•ì¸ topic ì¡°íšŒ $ ros2 topic list /clicked_point /clock /cmd_vel /dynamic_joint_states /forward_position_controller/commands /goal_pose /imu/data /initialpose /joint_states /logi_camera_sensor/camera_info /logi_camera_sensor/image_raw /parameter_events /performance_metrics /robot_description /rosout /scan /steering_angle_middle /tf /tf_static /throttling_vel_middle /velocity_controller/commands íŠ¹ì • topic ì •ë³´ í™•ì¸ $ ros2 topic info /forward_position_controller/commands Type: std_msgs/msg/Float64MultiArray Publisher count: 1 Subscription count: 1 â‡’ ì´ë ‡ê²Œ ì‹œìŠ¤í…œì— ëŒ€í•œ ë¶„ì„ì„ í•´ë‘ë©´ ì½”ë”© ì „ ëª…í™•í•œ ëª©í‘œì™€ ê¸°ëŠ¥ì„ ì„¸ìš¸ ìˆ˜ ìˆê³ , ë§ì€ ì‹œê°„ì„ ë‹¨ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nROS 2 Topic í”„ë¡œê·¸ë˜ë° - python example 1 - cmd_vel publish ì¤€ë¹„ëœ ì˜ˆì‹œë¥¼ ìš°ì„  ì‹¤í–‰í•´ë´…ì‹œë‹¤. # Terminal 1 ros2 launch src_gazebo empty_world.launch.py # Terminal 2 cd ~/ros2_ws colcon build --packages-select py_topic_tutorial source install/local_setup.bash ros2 run py_topic_tutorial topic_pub_node â‡’ ë¡œë´‡ì´ ì›ì„ ê·¸ë¦¬ë©° ì›€ì§ì´ê¸° ì‹œì‘í•©ë‹ˆë‹¤.\nì½”ë“œ ë¶„ì„ ROS 2ì—ì„œ íŒŒì´ì¬ í”„ë¡œê·¸ë˜ë°ì„ í•˜ê¸° ìœ„í•´ì„œ, rclpy.node.Nodeë¥¼ import í•´ì•¼ í–ˆìŠµë‹ˆë‹¤. ë”ë¶ˆì–´, Topicì— ì‚¬ìš©ë˜ëŠ” msg, Twistë¥¼ importí•˜ëŠ” ë¶€ë¶„ë„ ëˆˆì—¬ê²¨ë´…ì‹œë‹¤. import random from geometry_msgs.msg import Twist import rclpy from rclpy.node import Node í•µì‹¬ì´ ë˜ëŠ” TwistPubNode í´ë˜ìŠ¤ì˜ ìƒì„±ìë¶€í„° ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. class TwistPubNode(Node): def __init__(self): super().__init__(\u0026#39;twist_pub_node\u0026#39;) self.get_logger().info( f\u0026#39;TwistPubNode Created at {self.get_clock().now().to_msg().sec}\u0026#39; ) # self.twist_publisher = self.create_publisher(Twist, \u0026#34;twist_topic\u0026#34;, 10) self.twist_publisher = self.create_publisher(Twist, \u0026#39;/cmd_vel\u0026#39;, 10) create_publisherëŠ” topic publisherë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ë¡œ 3ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ìœ¼ë©° ê°ê°ì— ëŒ€í•œ ì„¤ëª…ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. Parameters Description message type Topic í†µì‹ ì— ì‚¬ìš©ë  msg Type topic name ì‚¬ìš©í•  Topic ì´ë¦„ì„ ì§€ì • (ì´ ì´ë¦„ì„ ì˜ëª» ì„¤ì •í•˜ë©´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” topicì— Publishí•˜ëŠ” ì˜¤ë¥˜ ìƒí™©ì´ ë°œìƒí•˜ë‹ˆ ì£¼ì˜í•©ë‹ˆë‹¤.) queue_size topic í†µì‹  ì‹œ ëŒ€ê¸°ì—´ì˜ í¬ê¸° ì´ì–´ì„œ, timer callbackì—ì„œ publishê°€ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì¸ìŠ¤í„´ìŠ¤í™”í•œ publisherì—ì„œ publish í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©° ë§¤ê°œë³€ìˆ˜ë¡œ messageê°€ ì „ë‹¬ë©ë‹ˆë‹¤. ... self.create_timer(0.2, self.timer_callback) def timer_callback(self): \u0026#34;\u0026#34;\u0026#34;Timer will run this function periodically.\u0026#34;\u0026#34;\u0026#34; msg = Twist() # Fill in msg with compatible values msg.linear.x = 0.5 msg.angular.z = 1.0 self.twist_publisher.publish(msg) example 2 - scan subscription ì´ë²ˆ ì˜ˆì‹œëŠ” 2D ë¼ì´ë‹¤ ë°ì´í„°ë¥¼ ë‹¤ë¤„ë³´ê³ ì í•©ë‹ˆë‹¤. ì•„ë˜ì˜ ì»¤ë©˜ë“œ ë¼ì¸ë“¤ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”. # Terminal 1 $ ros2 launch src_gazebo empty_world.launch.py # Terminal 2 $ ros2 run py_topic_tutorial topic_sub_node [INFO] [1672494602.141200628] [scan_sub_node]: msg.ranges[0] : inf msg.ranges[30] : inf msg.ranges[60] : 0.7975894212722778 msg.ranges[90] : inf msg.ranges[119] : inf ... ì˜ˆì‹œë¥¼ ì‹¤í–‰ì‹œí‚¨ ìƒí™©ì—ì„œ Gazebo ìƒì˜ ë¡œë´‡ ì£¼ë³€ìœ¼ë¡œ ë¬¼ì²´ë¥¼ ë“±ì¥ì‹œí‚¨ ë’¤, topic nodeë¥¼ ì‹¤í–‰í•˜ê³  ìˆëŠ” í„°ë¯¸ë„ ì°½ì˜ ë³€í™”ë¥¼ ì‚´í´ë´…ì‹œë‹¤. â‡’ scan dataì˜ rangesëŠ” ì‚¬ì§„ê³¼ ê°™ì€ ê±°ë¦¬ ë°ì´í„°ë¥¼ ë‹´ê³  ìˆìœ¼ë©°, ê° ì§€ì ì— í•´ë‹¹í•˜ëŠ” lidar dataë¥¼ í„°ë¯¸ë„ì— í‘œì‹œí•˜ëŠ” ì˜ˆì‹œì˜€ìŠµë‹ˆë‹¤.\nì½”ë“œ ë¶„ì„ ì´ë²ˆ ì˜ˆì‹œëŠ” 2D lidar ë°ì´í„°ë¥¼ ìœ„í•´ ì œê³µë˜ëŠ” sensor_msgs/msg/LaserScan msgë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. import rclpy from rclpy.node import Node from sensor_msgs.msg import LaserScan â‡’ í•´ë‹¹ msgì— ëŒ€í•œ ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” ë°©ë²•, ì´ì œëŠ” ëª¨ë‘ ìˆ™ì§€í•˜ì…¨ìœ¼ë¦¬ë¼ ë¯¿ìŠµë‹ˆë‹¤.\n$ ros2 interface show sensor_msgs/msg/LaserScan ScanSubNode í´ë˜ìŠ¤ì˜ ìƒì„±ìì—ì„œëŠ” scan topicì˜ subscriberê°€ ìƒì„±ë©ë‹ˆë‹¤. class ScanSubNode(Node): def __init__(self): super().__init__(\u0026#39;scan_sub_node\u0026#39;) queue_size = 10 # Queue Size self.pose_subscriber = self.create_subscription( LaserScan, \u0026#39;scan\u0026#39;, self.sub_callback, queue_size ) create_subscriptionì€ 4ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤. ê°ê°ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ë³´ë©´ì„œ ì™œ ì´ëŸ° ê°’ë“¤ì´ í•„ìš”í• ì§€ ìƒê°í•´ë³´ì„¸ìš”. Parameters Description Message Type Topic í†µì‹ ì— ì‚¬ìš©ë  msg Type topic name ë°ì´í„°ë¥¼ Subscribeí•  Topicì˜ ì´ë¦„ subscribe callback ë°ì´í„°ê°€ ì „ë‹¬ë  ë•Œë§ˆë‹¤ ì‹¤í–‰ë˜ëŠ” callback í•¨ìˆ˜. ì „ë‹¬ëœ ë°ì´í„°ë¥¼ í†µí•´ ì‹¤í–‰í•  ì‘ì—…ì´ ì´ í•¨ìˆ˜ ì•ˆì— êµ¬í˜„ë¨ queue_size create_publisherë•Œì™€ ë§ˆì°¬ê°€ì§€ë¡œ, ëŒ€ê¸°ì—´ì˜ í¬ê¸° ë”ë¶ˆì–´, sub_callbackì˜ ì²«ë²ˆì¨° ë§¤ê°œë³€ìˆ˜ëŠ” í•­ìƒ topic message dataê°€ ë©ë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ êµ¬í˜„ì—ì„œëŠ” í•´ë‹¹ messageì—ì„œ ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì¶”ì¶œí•œ ë‹¤ìŒ, ì´í›„ì˜ ì²˜ë¦¬ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤. def sub_callback(self, msg): \u0026#34;\u0026#34;\u0026#34;Timer will run this function periodically.\u0026#34;\u0026#34;\u0026#34; self.get_logger().info(f\u0026#39; \\ \\nmsg.ranges[0] : {msg.ranges[0]} \\ \\nmsg.ranges[30] : {msg.ranges[30]} \\ \\nmsg.ranges[60] : {msg.ranges[60]} \\ \\nmsg.ranges[90] : {msg.ranges[90]} \\ \\nmsg.ranges[119] : {msg.ranges[119]} \\ \u0026#39;) example 3 - parking ì´ë²ˆ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•˜ê¸° ì „ì—, empty_world.launch.pyë¥¼ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤. gazebo_ros serverì˜ ì‹¤í–‰ ì‹œ ì „ë‹¬ë˜ëŠ” í™˜ê²½ íŒŒì¼ì„ ë³€ê²½í•˜ëŠ” ì‘ì—…ì…ë‹ˆë‹¤. # gazebo pkg_gazebo_ros = FindPackageShare(package=\u0026#39;gazebo_ros\u0026#39;).find(\u0026#39;gazebo_ros\u0026#39;) pkg_path = os.path.join(get_package_share_directory(\u0026#39;src_gazebo\u0026#39;)) # world_path = os.path.join(pkg_path, \u0026#39;worlds\u0026#39;, \u0026#39;empty_world.world\u0026#39;) world_path = os.path.join(pkg_path, \u0026#39;worlds\u0026#39;, \u0026#39;wall_world.world\u0026#39;) ì´ë²ˆ ì˜ˆì‹œëŠ” ì¼ì • ê±°ë¦¬ ë‚´ ë²½ì´ ê²€ì¶œë˜ë©´ ìë™ìœ¼ë¡œ ë¡œë´‡ì„ ì •ì§€ì‹œí‚µë‹ˆë‹¤. # Terminal 1 $ ros2 launch src_gazebo empty_world.launch.py # Terminal 2 $ ros2 run py_topic_tutorial parking_node ... [INFO] [1672563255.067421128] [parking_node]: Distance from Front Object : 0.6280616521835327 [INFO] [1672563255.173734128] [parking_node]: Distance from Front Object : 0.5546504259109497 [INFO] [1672563255.281276729] [parking_node]: Distance from Front Object : 0.5124648809432983 [INFO] [1672563255.389067729] [parking_node]: ==== Parking Done!!! ==== ... ì´ ê¸°ëŠ¥ì„ ìœ„í•´ Topic Publishì™€ Subscribeê°€ ëª¨ë‘ í•„ìš”í•©ë‹ˆë‹¤.\n/cmd_vel topic publish /scan topic subscribe ë”°ë¼ì„œ, Nodeì˜ ìƒì„±ìì—ì„œ Publisherì™€ Subscriberë¥¼ ëª¨ë‘ ìƒì„±í•©ë‹ˆë‹¤. class ParkingNode(Node): def __init__(self): super().__init__(\u0026#39;parking_node\u0026#39;) queue_size = 10 # Queue Size self.twist_publisher = self.create_publisher(Twist, \u0026#39;cmd_vel\u0026#39;, queue_size) self.scan_subscriber = self.create_subscription( LaserScan, \u0026#39;scan\u0026#39;, self.sub_callback, queue_size ) sub_callbackì—ì„œ ì „ë°© (msg.ranges[60]) ë¬¼ì²´ì™€ì˜ ê±°ë¦¬ë¥¼ íƒì§€í•˜ê³ , ì´ ê±°ë¦¬ê°€ 0.5m ì´í•˜ê°€ ë  ì‹œ ì •ì§€ topicì„ publish í•©ë‹ˆë‹¤. def sub_callback(self, msg): twist_msg = Twist() distance_forward = msg.ranges[60] if distance_forward \u0026gt; 0.5: self.get_logger().info(f\u0026#39;Distance from Front Object : {distance_forward}\u0026#39;) twist_msg.linear.x = 0.5 self.twist_publisher.publish(twist_msg) else: self.get_logger().info(\u0026#39;==== Parking Done!!! ====\\n\u0026#39;) twist_msg.linear.x = 0.0 self.twist_publisher.publish(twist_msg) ROS 2 Topic Programming - C++ example 1 - cmd_vel publish ì¤€ë¹„ëœ ì˜ˆì‹œë“¤ì„ ë¹Œë“œ í•´ë´…ì‹œë‹¤. cbp cpp_topic_tutorial source install/local_setup.bash # Terminal 1 ros2 launch src_gazebo empty_world.launch.py # Terminal 2 ros2 run cpp_topic_tutorial cpp_topic_pub_node â‡’ êµ¬í˜„ ìì²´ëŠ” ë™ì¼í•©ë‹ˆë‹¤. ë¡œë´‡ì´ ì›ì„ ê·¸ë¦¬ë©° ì›€ì§ì´ê¸° ì‹œì‘í•©ë‹ˆë‹¤.\nì½”ë“œ ë¶„ì„ ë¡œë´‡ì„ ì›€ì§ì´ê¸° ìœ„í•´ì„œ geometry_msgs/msg/Twist í˜•ì‹ì˜ topic message typeì„ ì‚¬ìš©í•´ì•¼ í•¨ì„ ë°°ìš´ ë°” ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ì„œ ë‹¤ìŒê³¼ ê°™ì´, í—¤ë”ë¥¼ include í•˜ë©´ ë©ë‹ˆë‹¤. #include \u0026#34;geometry_msgs/msg/twist.hpp\u0026#34; #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; ë‹¨, íŒŒì´ì¬ê³¼ ë‹¬ë¦¬ c++ í—¤ë”ëŠ” snake_caseë¥¼ ì·¨í•˜ë©°, ì½”ë“œ ì‚¬ìš© ì‹œ CamelCaseë¥¼ ì‚¬ìš©í•¨ì— ì£¼ì˜í•©ë‹ˆë‹¤.\nImplementation Python from geometry_msgs.msg import Twist Cpp #include \u0026ldquo;geometry_msgs/msg/twist.hpp\u0026rdquo; publisherëŠ” create_publisher í•¨ìˆ˜ë¥¼ í†µí•´ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Implementation rclcpp::Publisher templateì„ í†µí•´ message typeì„ ì ìŠµë‹ˆë‹¤. topic_name publishí•  topicì˜ ì´ë¦„ queue size ì¼ì „ê³¼ ë™ì¼ rclcpp::Publisher\u0026lt;geometry_msgs::msg::Twist\u0026gt;::SharedPtr twist_publisher; ... twist_publisher = this-\u0026gt;create_publisher\u0026lt;geometry_msgs::msg::Twist\u0026gt;(\u0026#34;turtle1/cmd_vel\u0026#34;, 10); geometry_msgs::msg::Twistì™€ ê°™ì´ íƒ€ì…ì´ ê¸¸ê¸° ë•Œë¬¸ì— usingì„ ì‚¬ìš©í•˜ì—¬ ì¶•ì•½í•˜ê³¤ í•©ë‹ˆë‹¤.\nexample 2 - scan subscription ë¡œë´‡ ë‚´ ì¥ì°©ëœ 2D Lidar dataë¥¼ ì ì ˆíˆ í‘œì‹œí•˜ëŠ” ì˜ˆì‹œì˜€ìŠµë‹ˆë‹¤. # Terminal 1 $ ros2 launch src_gazebo empty_world.launch.py # Terminal 2 $ ros2 run cpp_topic_tutorial cpp_topic_sub_node [INFO] [1672494602.141200628] [scan_sub_node]: msg.ranges[0] : inf msg.ranges[30] : inf msg.ranges[60] : 0.7975894212722778 msg.ranges[90] : inf msg.ranges[119] : inf ... ì½”ë“œ ë¶„ì„ subscriberëŠ” create_subscription í•¨ìˆ˜ë¥¼ í†µí•´ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Implementation rclcpp::Subscription\u0026lt;\u0026gt; templateì„ í†µí•´ message typeì„ ì ìŠµë‹ˆë‹¤. topic_name subscribeí•  topicì˜ ì´ë¦„ queue size ì¼ì „ê³¼ ë™ì¼ callback std::bindë¥¼ í†µí•´ callback í•¨ìˆ˜ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤. ì˜ˆì‹œì—ì„œëŠ” callback í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜ê°€ 1ê°œì´ê¸°ì— std::placeholders::_1ì´ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤. LaserSubNode() : Node(\u0026#34;laser_sub_node\u0026#34;) { laser_subscriber = this-\u0026gt;create_subscription\u0026lt;LaserScan\u0026gt;( \u0026#34;scan\u0026#34;, 10, std::bind(\u0026amp;LaserSubNode::sub_callback, this, std::placeholders::_1) ); } callback í•¨ìˆ˜ì˜ ì²«ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ì¸ ë°ì´í„°ëŠ” SharedPtr íƒ€ì…ì´ ì‚¬ìš©ëœë‹¤ëŠ” ê²ƒì— ì£¼ì˜í•˜ë©°, ë•Œë¬¸ì— ë ˆí¼ëŸ°ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ìì£¼ ìˆëŠ” ì‹¤ìˆ˜ì´ë¯€ë¡œ ì˜¤ë¥˜ ìƒí™©ë„ í•¨ê»˜ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.) void sub_callback(const LaserScan::SharedPtr msg){ RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;msg.ranges[0]: \u0026#39;%f\u0026#39;\u0026#34;, msg-\u0026gt;ranges[0]); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;msg.ranges[30]: \u0026#39;%f\u0026#39;\u0026#34;, msg-\u0026gt;ranges[30]); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;msg.ranges[60]: \u0026#39;%f\u0026#39;\u0026#34;, msg-\u0026gt;ranges[60]); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;msg.ranges[90]: \u0026#39;%f\u0026#39;\u0026#34;, msg-\u0026gt;ranges[90]); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;msg.ranges[119]: \u0026#39;%f\u0026#39;\\n\u0026#34;, msg-\u0026gt;ranges[119]); } SharedPtrì€ rclcpp ë‚´ë¶€ì ìœ¼ë¡œ ì •ì˜ë˜ì–´ ìˆëŠ” ìŠ¤ë§ˆíŠ¸ í¬ì¸í„°ì…ë‹ˆë‹¤. í˜„ ìƒí™©ì—ì„œ ë ˆí¼ëŸ°ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ConstSharedPtrì„ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤. void sub_callback(const LaserScan::ConstSharedPtr \u0026amp;msg){ RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;msg.ranges[0]: \u0026#39;%f\u0026#39;\u0026#34;, msg-\u0026gt;ranges[0]); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;msg.ranges[30]: \u0026#39;%f\u0026#39;\u0026#34;, msg-\u0026gt;ranges[30]); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;msg.ranges[60]: \u0026#39;%f\u0026#39;\u0026#34;, msg-\u0026gt;ranges[60]); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;msg.ranges[90]: \u0026#39;%f\u0026#39;\u0026#34;, msg-\u0026gt;ranges[90]); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;msg.ranges[119]: \u0026#39;%f\u0026#39;\\n\u0026#34;, msg-\u0026gt;ranges[119]); } example 3 - parking ì¼ì • ê±°ë¦¬ ë‚´ ë²½ì´ ê²€ì¶œë˜ë©´ ìë™ìœ¼ë¡œ ë¡œë´‡ì´ ì •ì§€í•˜ëŠ” ì˜ˆì‹œì˜€ìŠµë‹ˆë‹¤. # Terminal 1 $ ros2 launch src_gazebo empty_world.launch.py # Terminal 2 $ ros2 run cpp_topic_tutorial cpp_parking_node ... [INFO] [1672563255.067421128] [parking_node]: Distance from Front Object : 0.6280616521835327 [INFO] [1672563255.173734128] [parking_node]: Distance from Front Object : 0.5546504259109497 [INFO] [1672563255.281276729] [parking_node]: Distance from Front Object : 0.5124648809432983 [INFO] [1672563255.389067729] [parking_node]: ==== Parking Done!!! ==== ... ì´ ê¸°ëŠ¥ì„ ìœ„í•´ Topic Publishì™€ Subscribeê°€ ëª¨ë‘ í•„ìš”í•©ë‹ˆë‹¤. ë”°ë¼ì„œ, Nodeì˜ ìƒì„±ìì—ì„œ Publisherì™€ Subscriberë¥¼ ëª¨ë‘ ìƒì„±í•©ë‹ˆë‹¤. public: ParkingNode() : Node(\u0026#34;laser_sub_node\u0026#34;) { twist_publisher = this-\u0026gt;create_publisher\u0026lt;Twist\u0026gt;(\u0026#34;cmd_vel\u0026#34;, 10); laser_subscriber = this-\u0026gt;create_subscription\u0026lt;LaserScan\u0026gt;( \u0026#34;scan\u0026#34;, 10, std::bind(\u0026amp;ParkingNode::sub_callback, this, std::placeholders::_1) ); } sub_callbackì—ì„œ ì „ë°© (msg.ranges[60]) ë¬¼ì²´ì™€ì˜ ê±°ë¦¬ë¥¼ íƒì§€í•˜ê³ , ì´ ê±°ë¦¬ê°€ 0.5m ì´í•˜ê°€ ë  ì‹œ ì •ì§€ topicì„ publish í•©ë‹ˆë‹¤. void sub_callback(const LaserScan::SharedPtr msg){ auto distance_forward = msg-\u0026gt;ranges[60]; if(distance_forward \u0026gt; 0.5){ auto msg = Twist(); msg.linear.x = 0.5; twist_publisher-\u0026gt;publish(msg); }else{ auto msg = Twist(); msg.linear.x = 0.0; twist_publisher-\u0026gt;publish(msg); } } rclcppì˜ ê²½ìš° CMakeLists.txtë¥¼ ìˆ˜ì •í•˜ì—¬ nodeë¥¼ ì»´íŒŒì¼í•´ì•¼ í–ˆìŠµë‹ˆë‹¤. ì´ë²ˆ ì˜ˆì‹œì—ì„œë„ ë§ˆì°¬ê°€ì§€ ì‘ì—…ì´ í•„ìš”í•˜ë©°, íŠ¹íˆ ì½”ë“œì—ì„œ include í•˜ì˜€ë˜ sensor_msgs geometry_msgsë¥¼ ë°”ì¸ë”© í•˜ëŠ” ì ì— ìœ ì˜í•˜ì„¸ìš”. # find_packageë¥¼ í†µí•´ ì¢…ì†ì„±ë“¤ì„ ì¶”ê°€í•©ë‹ˆë‹¤. find_package(rclcpp REQUIRED) find_package(geometry_msgs REQUIRED) find_package(sensor_msgs REQUIRED) ... add_executable(cpp_topic_pub_node src/cpp_topic_pub_node.cpp) ament_target_dependencies(cpp_topic_pub_node rclcpp geometry_msgs) add_executable(cpp_topic_sub_node src/cpp_topic_sub_node.cpp) ament_target_dependencies(cpp_topic_sub_node rclcpp sensor_msgs) add_executable(cpp_parking_node src/cpp_parking_node.cpp) ament_target_dependencies(cpp_parking_node rclcpp sensor_msgs geometry_msgs) Custom Interface Generation Topicì˜ msg, Serviceì˜ srv, Actionì˜ actionâ€¦ ê°ê° í†µì‹  ë©”ì»¤ë‹ˆì¦˜ë§ˆë‹¤. ì‚¬ìš©í•˜ëŠ” ë°ì´í„° íƒ€ì…ì€ ì´ì œ ìµìˆ™í•´ì§€ì…¨ìœ¼ë¦¬ë¼ ìƒê°í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ROS 2 ì—ì„œëŠ” ìì£¼ ì‚¬ìš©ë˜ëŠ” ë°ì´í„° íƒ€ì…ë“¤ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.\nëª‡ê°€ì§€ë¥¼ í•¨ê»˜ ì¡°íšŒí•´ ë´…ì‹œë‹¤. ros2 interface show sensor_msgs/msg/PointCloud2 ros2 interface show geometry_msgs/msg/Quaternion ros2 interface show nav_msgs/srv/GetPlan ì´ë ‡ê²Œ ë¯¸ë¦¬ ì œê³µë˜ëŠ” ë°ì´í„° íƒ€ì…ë“¤ì€ common interfacesë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì œê³µë˜ê³  ìˆìŠµë‹ˆë‹¤.\nâ‡’ https://github.com/ros2/common_interfaces\nê·¸ëŸ°ë°, ë§Œì•½ ë‚˜ë§Œì˜ ìƒˆë¡œìš´ ë°ì´í„° íƒ€ì…ì„ ë§Œë“¤ê³  ì‹¶ë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”? ROS 2ì—ì„œëŠ” custom interfaceì˜ ìƒì„±ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. í•¨ê»˜ ì‹¤ìŠµí•´ë´…ì‹œë‹¤. ROS 2ì—ì„œ custom interfaceë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” C++ Packageì—ì„œ ì‘ì—…ì´ ì´ë£¨ì–´ì ¸ì•¼ í•©ë‹ˆë‹¤. C++ packageëŠ” build type ament_cmakeë¥¼ ì‚¬ìš©í•˜ëŠ” packageì˜€ìŠµë‹ˆë‹¤.\n$ ros2 pkg create --build-type ament_cmake \u0026lt;package-name\u0026gt; $ ros2 pkg create --build-type ament_cmake custom_interfaces í•´ë‹¹ íŒ¨í‚¤ì§€ ë‚´ action, msg, srv ë¼ëŠ” í´ë”ë¥¼ ë§Œë“¤ê³  í•´ë‹¹ í´ë” ì•ˆì— ë‚˜ë§Œì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. example - MyFirstMsg.msg string name float32 height float32 weight uint8 age example - TurningControl.srv uint32 time_duration float64 angular_vel_z float64 linear_vel_x --- bool success example - Parking.action #goal definition bool start_flag --- #result definition string message --- #feedback definition float32 distance custom interface ë‚´ë¶€ì—ëŠ” primitive type / pre-defined typeì´ ì¡´ì¬ ê°€ëŠ¥í•©ë‹ˆë‹¤. â‡’ primitive typeì€ ì•„ë˜ì˜ ê·¸ë¦¼ì„ ì°¸ê³ í•˜ì‹œê³ \nâ‡’ pre-defined typeì€ í•´ë‹¹ ROS 2 ì‹œìŠ¤í…œì—ì„œ ì´ë¯¸ ì •ì˜ëœ (std_msgs, std_srvs, etcâ€¦)ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nimage from : https://design.ros2.org/articles/interface_definition.html\nâ‡’ ì´ì œ í•´ë‹¹ interfaceë¥¼ rclpy, rclcppì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•˜ë„ë¡ í•´ë´…ì‹œë‹¤.\nCMakeLists.txt ìˆ˜ì • rosidl_generate_interfaces(${PROJECT_NAME} \u0026#34;action/DataGen.action\u0026#34; \u0026#34;action/Parking.action\u0026#34; \u0026#34;srv/CircleTurtle.srv\u0026#34; \u0026#34;srv/TurtleJail.srv\u0026#34; ) package.xml ìˆ˜ì • \u0026lt;build_depend\u0026gt;rosidl_default_generators\u0026lt;/build_depend\u0026gt; \u0026lt;exec_depend\u0026gt;rosidl_default_runtime\u0026lt;/exec_depend\u0026gt; \u0026lt;member_of_group\u0026gt;rosidl_interface_packages\u0026lt;/member_of_group\u0026gt; íŒ¨í‚¤ì§€ ë¹Œë“œì™€ ì†Œì‹± $ colcon build --packages-select custom_interfaces Starting \u0026gt;\u0026gt;\u0026gt; custom_interfaces Finished \u0026lt;\u0026lt;\u0026lt; custom_interfaces [0.62s] Summary: 1 package finished [0.84s] $ source install/local_setup.bash ì´ì œ ROS 2ì—ì„œ í•´ë‹¹ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ë‹¨, í˜„ì¬ custom_interfaces íŒ¨í‚¤ì§€ëŠ” ros2_wsì— ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— í•´ë‹¹ workspaceë¥¼ ì†Œì‹±í•œ í„°ë¯¸ë„ì—ì„œë§Œ ì¡°íšŒê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. ) $ ros2 interface show custom_interfaces/srv/TurtleJail float32 width float32 height --- bool success â‡’ ê·¸ëŸ¼, custom interfaceì˜ ì‹¤ì œ ì‚¬ìš©ì€ ì–´ë–»ê²Œ í• ê¹Œìš”? ë°©ê¸ˆ ìƒì„±í•œ custom_interfaces/srv/TurtleJailë¥¼ì˜ˆì‹œë¡œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nrclpy from custom_interfaces.srv import TurtleJail rclcpp #include \u0026#34;custom_interfaces/srv/turtle_jail.hpp\u0026#34; using TurtleJail = custom_interfaces::srv::TurtleJail; pythonì„ ì‚¬ìš©í•˜ëŠ” íŒ¨í‚¤ì§€ì—ì„œ ë³„ë„ ì‘ì—… ì—†ì´ ì‚¬ìš© ê°€ëŠ¥í•˜ì§€ë§Œ C++ íŒ¨í‚¤ì§€ëŠ” ì½”ë”© ì‹œ CMakeLists.txtì˜ ìˆ˜ì •ì´ í•„ìš”í•©ë‹ˆë‹¤. find_package(ament_cmake REQUIRED) find_package(rclcpp REQUIRED) find_package(\u0026lt;custom-interface-pkg\u0026gt; REQUIRED) # CHANGE add_executable(talker src/publisher_member_function.cpp) ament_target_dependencies(talker rclcpp \u0026lt;custom-interface-pkg\u0026gt;) # CHANGE install(TARGETS talker DESTINATION lib/${PROJECT_NAME}) ament_package() ì‹¤ì œ ROS 2 í˜¸í™˜ ì¹´ë©”ë¼ íŒ¨í‚¤ë“¤ì„ ë³´ì•„ë„ í•„ìš”ì— ë”°ë¼ custom interfaceë“¤ì„ ì„ ì–¸í•œ ëª¨ìŠµì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nrealsense_ros "
},
{
	"uri": "/kr/ros2_foxy/lecture8/",
	"title": "Lecture8. ROS 2 Service and Programming",
	"tags": [],
	"description": "",
	"content": "ROS 2 Service ROS 2 Serviceì˜ ê°œë…ì„ ë‹¤ì‹œ ë³µìŠµí•´ë´…ì‹œë‹¤.\nimage from : docs.ros.org\nService ê°œë… ì •ë¦¬\nServiceë¥¼ ìš”ì²­í•˜ëŠ” ì£¼ì²´ë¥¼ Service Clientë¼ê³  í•˜ë©°, Service ìš”ì²­ ìì²´ë¥¼ **Request(í˜¹ì€ Call)**ë¼ê³  í•©ë‹ˆë‹¤. Serviceë¥¼ ìš”ì²­ë°›ëŠ” ì£¼ì²´ë¥¼ Service Serverë¼ê³  í•˜ë©°, Service ServerëŠ” Requestì— ëŒ€í•œ ì‘ë‹µ, ì¦‰ Service Responseë¥¼ ë‹¤ì‹œ Service Clientì—ê²Œ íšŒë‹µí•©ë‹ˆë‹¤. Requestì™€ Responseë¥¼ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ë°ì´í„° íƒ€ì…ì€ srvë¼ê³  í•˜ë©° Requestì™€ Responseë¡œ ë‚˜ë‰©ë‹ˆë‹¤. Serviceì˜ ì¤‘ìš”í•œ íŠ¹ì§• í•œ ê°€ì§€ ì¶”ê°€í•˜ìë©´, í•˜ë‚˜ì˜ Service Serverì— ì—¬ëŸ¬ Clientê°€ request í•  ìˆ˜ ìˆì§€ë§Œ, ServerëŠ” ë™ì‹œì— ì—¬ëŸ¬ requestë¥¼ ì²˜ë¦¬í•˜ì§€ ëª»í•©ë‹ˆë‹¤.\nimage from : docs.ros.org\nService í†µì‹  ì‹œ srvë¼ëŠ” ë°ì´í„° í˜•ì‹ì´ ì‚¬ìš©ë©ë‹ˆë‹¤. íŠ¹ì • srvê°€ ì–´ë–»ê²Œ êµ¬ì„±ë˜ì–´ ìˆëŠ”ì§€ ì•Œê³  ì‹¶ì„ ë•ŒëŠ” ros2 interface showë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. $ ros2 interface show gazebo_msgs/srv/SpawnEntity string name # Name of the entity to be spawned (optional). string xml # Entity XML description as a string, either URDF or SDF. string robot_namespace # Spawn robot and all ROS interfaces under this namespace geometry_msgs/Pose initial_pose # Initial entity pose. string reference_frame # initial_pose is defined relative to the frame of this entity. # If left empty or \u0026#34;world\u0026#34; or \u0026#34;map\u0026#34;, then gazebo world frame is # used. # If non-existent entity is specified, an error is returned # and the entity is not spawned. --- bool success # Return true if spawned successfully. string status_message # Comments if available. ì„œë¹„ìŠ¤ íƒ€ì… ì¤‘ê°„ì— ë³´ì´ëŠ” - - - ë¶€ë¶„ì€ requestì™€ responseì˜ êµ¬ë¶„ìë¼ê³  ìƒê°í•˜ì‹œë©´ ë©ë‹ˆë‹¤.\nì´ë²ˆ ì‹œê°„ì˜ ì‹¤ìŠµì„ ìœ„í•´, ìƒˆë¡œìš´ Gazebo í™˜ê²½ì„ ì†Œê°œí•˜ê³ ì í•©ë‹ˆë‹¤. í•´ë‹¹ í™˜ê²½ì˜ ì‹¤í–‰ì„ ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ ì‘ì—…ì„ í•¨ê»˜í•´ì£¼ì„¸ìš”! # package clone cd ~/ros2_ws/src git clone https://github.com/RB2023ROS/gz_ros2_examples.git # package build \u0026amp; sourcing cd ~/ros2_ws cbp rgbd_world \u0026amp;\u0026amp; source install/setup.bash ros2 launchë¥¼ í†µí•´ ì´ë²ˆ ì‹¤ìŠµì„ ìœ„í•œ í™˜ê²½ì„ ì‹¤í–‰í•´ë´…ì‹œë‹¤. ros2 launch rgbd_world depth_world.launch.py â‡’ ì¹´ë©”ë¼ì™€ ë²½ì´ í¬í•¨ëœ ê°„ë‹¨í•œ í™˜ê²½ì„ êµ¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤. ì°¸ê³ ë¡œ PC ì„±ëŠ¥ì— ë”°ë¼ Rviz2 í™”ë©´ì´ ë§¤ìš° ëŠë¦´ ìˆ˜ ìˆìœ¼ë‹ˆ ë¶ˆí¸í•˜ì‹œë‹¤ë©´ point cloud ì‹œê°í™”ëŠ” ì œê±°í•´ì£¼ì„¸ìš”!!\nROS 2 Service Programming - Python example 1 - Service Client Example (Spawn Entity) ì´ë²ˆ ì˜ˆì‹œì˜ ë°ëª¨ë¥¼ ë¨¼ì € ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤. # Demo package build cd ~/ros2_ws/src cbp py_service_tutorial source install/local_setup.bash # Terminal 1 - gazebo env launch ros2 launch rgbd_world depth_world.launch.py # Terminal 2 - Execute Service Client ros2 run py_service_tutorial spawn_object_wo_gravity Terminal 2ì—ì„œ ì•„ë˜ì™€ ê°™ì€ ì½˜ì†” ë¡œê·¸ë¥¼ ë³¼ ìˆ˜ ìˆìœ¼ë©°, ì›í•˜ëŠ” ë¬¼ì²´ë¥¼ ì„ íƒí•˜ë©´ gazebo í™˜ê²½ ìƒì—ì„œ í•´ë‹¹ ë¬¼ì²´ê°€ ë“±ì¥í•˜ëŠ” ê²ƒì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. Enter Model name Among Below List 1.arm_part\t2.beer 3.biscuits 4.book 5.bowl 6.create 7.disk_part\t8.eraser 9.glue 10.hammer 11.plastic_cup\t12.snacks 13.soap 14.soap2 15.soda_can 16.sticky_notes [Type your choice]: ì˜ˆì‹œ ì„¤ëª… GazeboëŠ” ê°œë°œ ì´ˆê¸°ë¶€í„° ROSì˜ ì‚¬ìš©ì„ ê³ ë ¤í•œ ì‹œìŠ¤í…œì…ë‹ˆë‹¤. Gazeboì™€ ROS ì‚¬ì´ì˜ ì¸í„°í˜ì´ìŠ¤ëŠ” gazebo_ros_pkgê°€ ë‹´ë‹¹í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nâ‡’ https://github.com/ros-simulation/gazebo_ros_pkgs\nâ‡’ https://classic.gazebosim.org/tutorials?cat=connect_ros\ngazebo_ros_pkgë¥¼ í†µí•´ gazeboë¥¼ ì‹¤í–‰í•˜ë©´ ì—¬ëŸ¬ ìœ ìš©í•œ topic, serviceê°€ í•¨ê»˜ ì‹¤í–‰ë©ë‹ˆë‹¤. # Terminal 1 ros2 launch gazebo_ros_pkg gazebo.launch.py # Terminal 2 ros2 topic list ros2 servie list ì´ë“¤ ì¤‘, ì§€ê¸ˆ ì˜ˆì‹œì—ì„œëŠ” â€œ/spawnâ€ serviceì— requestí•œ ê²ƒì´ë©°, ì´ëŠ” xml ë¬¸ë²•ì„ í†µí•´ ì›í•˜ëŠ” ëª¨ë¸ì„ Gazebo Clientì— ë“±ì¥ì‹œì¼œì¦™ë‹ˆë‹¤. (ì¦‰, Service Clientë¥¼ ì‹¤í–‰í•œ ê²ƒì…ë‹ˆë‹¤.) # get info about service ros2 service type /spawn # get info about srv ros2 interface show \u0026lt;sth\u0026gt; ì½”ë“œ ë¶„ì„ ì²« ë²ˆì§¸ë¡œ ë¶„ì„í•  ì½”ë“œëŠ” spawn_object.py ì…ë‹ˆë‹¤. ì‚¬ìš©í•  srvë¥¼ importí•˜ê³  ìˆìŠµë‹ˆë‹¤. from gazebo_msgs.srv import SpawnEntity import rclpy from rclpy.node import Node Service Clientì˜ ìƒì„±ì€ create_clientë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. class SpawnClientNode(Node): def __init__(self): super().__init__(\u0026#39;gazebo_model_spawner\u0026#39;) self.client = self.create_client(SpawnEntity, \u0026#39;spawn_entity\u0026#39;) Parameter Description Srv Type Serviceì— ì‚¬ìš©ë  ë°ì´í„° íƒ€ì… Service Name Request ëŒ€ìƒì´ ë˜ëŠ” Service ì´ë¦„ Client ì…ì¥ì—ì„œ ì¡´ì¬í•˜ì§€ë„ ì•Šì€ Serverë¥¼ ê³„ì† ê¸°ë‹¤ë¦¬ë©´ ì•ˆë  ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ì¼ë°˜ì ìœ¼ë¡œ íŠ¹ì • ì‹œê°„ ë™ì•ˆ ëŒ€ê¸°í•˜ëŠ” ë¡œì§ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. while not self.client.wait_for_service(timeout_sec=1.0): self.get_logger().error(\u0026#39;service not available, waiting again...\u0026#39;) í´ë˜ìŠ¤ë¥¼ ë” ë¶„ì„í•˜ê¸° ì „ì— mainë¬¸ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. Nodeë¥¼ ìƒì„±í•˜ë©°, í•´ë‹¹ Nodeë‚´ë¶€ì—ëŠ” Service Clientê°€ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. send_req()ë¥¼ í†µí•´ Service Callì„ ì‹¤í–‰í•©ë‹ˆë‹¤. (ë‚´ë¶€ì ìœ¼ë¡œ call_async() ì‹¤í–‰) ì´ì— ë”°ë¥¸ ê²°ê³¼ë¡œ futureë¼ëŠ” ê°’ì´ ë°˜í™˜ë©ë‹ˆë‹¤. spin_until_future_complete()ë¥¼ í†µí•´ futureê°€ ì§„í–‰ë˜ëŠ” ë™ì•ˆ ë¹„ë™ê¸°ë¡œ ëŒ€ê¸°í•©ë‹ˆë‹¤. futureê°€ ì™„ë£Œ ìƒíƒœê°€ ë˜ë©´ Responseë¥¼ ì¶œë ¥í•˜ê²Œ ë©ë‹ˆë‹¤. def main(args=None): rclpy.init(args=args) robot_spawn_node = SpawnClientNode() future = robot_spawn_node.send_req() rclpy.spin_until_future_complete(robot_spawn_node, future) if future.done(): try: response = future.result() except Exception: raise RuntimeError( \u0026#39;exception while calling service: %r\u0026#39; % future.exception() ) else: robot_spawn_node.get_logger().info(\u0026#39;==== Service Call Done ====\u0026#39;) robot_spawn_node.get_logger().info(f\u0026#39;Status_message : {response.status_message}\u0026#39;) finally: robot_spawn_node.get_logger().warn(\u0026#39;==== Shutting down node. ====\u0026#39;) robot_spawn_node.destroy_node() rclpy.shutdown() Futureë€ rclpyì—ì„œ ë©€í‹°ì“°ë ˆë”©ì„ ìœ„í•´ ì‚¬ìš©ë˜ë©°, taskì˜ ìƒíƒœë¥¼ ë‹´ê³  ìˆëŠ” ê°ì²´ì…ë‹ˆë‹¤.\në‹¤ì‹œ í´ë˜ìŠ¤ë¡œ ëŒì•„ì™€ì„œ, send_req() ë©”ì†Œë“œë¥¼ ì‚´í´ë´…ì‹œë‹¤. Srvë¥¼ ì±„ìš°ê³  call_async() í•¨ìˆ˜ë¥¼ í†µí•´ ì´ë¥¼ Service Serverì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤. ê·¸ ê²°ê³¼ë¡œ ì–»ê²Œ ëœ futureë¥¼ ë°˜í™˜í•˜ê²Œ ë©ë‹ˆë‹¤. def send_req(self): ... self.get_logger().debug(\u0026#39;==== Sending service request to `/spawn_entity` ====\u0026#39;) self.future = self.client.call_async(self.req) return self.future ë™ê¸° Requestì¸ call()ë„ ìˆì§€ë§Œ, ì´ë ‡ê²Œ ë˜ëŠ” ê²½ìš° ë‹¤ë¥¸ callbackì˜ ì‚¬ìš©, í˜¹ì€ spinì˜ ë™ì‘ì„ ë§‰ê²Œ ë˜ì–´ ì „ì²´ ì‹œìŠ¤í…œì˜ deadlockì„ ìœ ë°œí•©ë‹ˆë‹¤. ë•Œë¬¸ì— ê³µì‹ íŠœí† ë¦¬ì–¼ì—ì„œë„ ë¹„ë™ê¸° Callì„ ì¶”ì²œí•˜ê³  ìˆìŠµë‹ˆë‹¤. def send_req(self): ... self.get_logger().debug(\u0026#39;==== Sending service request to `/spawn_entity` ====\u0026#39;) self.future = self.client.call(self.req) return self.future Service Client ê´€ë ¨ ë©”ì†Œë“œë“¤ì„ ì •ë¦¬í•´ë´…ì‹œë‹¤. Code Description create_client(, ) client ìƒì„± spin_until_future_complete(,) Client Request Taskê°€ ì™„ë£Œë˜ê¸°ê¹Œì§€ ë¹„ë™ê¸° ëŒ€ê¸° future.done(), future.result() Futureì˜ ìƒíƒœë¥¼ ë‹¤ë£¨ëŠ” í•¨ìˆ˜ë“¤ call_async(), call() ë¹„ë™ê¸°, ë™ê¸° service call ê¸°ëŠ¥ìƒìœ¼ë¡œ, ìƒˆë¡œìš´ ë¬¼ì²´ë¥¼ ë“±ì¥ì‹œí‚¤ë©´ ì¤‘ë ¥ì— ì˜í•´ ë¬¼ì²´ê°€ ë°”ë‹¥ìœ¼ë¡œ ë–¨ì–´ì ¸ë²„ë¦½ë‹ˆë‹¤. ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ gazeboì˜ ë¬¼ì„±ì¹˜ ì˜µì…˜ì„ êº¼ì¤˜ì•¼ í•©ë‹ˆë‹¤. spawn_object_wo_gravity.pyì—ëŠ” ì´ë¥¼ ìœ„í•œ êµ¬í˜„ì´ ì¶”ê°€ë˜ì–´ ìˆìŠµë‹ˆë‹¤. self.physics_client = self.create_client(Empty, \u0026#39;pause_physics\u0026#39;) ... # physics pause request pause_future = robot_spawn_node.send_pause_req() rclpy.spin_until_future_complete(robot_spawn_node, pause_future) future_pending_logic(\u0026#34;Pause\u0026#34;,robot_spawn_node, pause_future) example 2 - Service Server Example (Snapshot) ì´ë²ˆì— ë³´ì—¬ë“œë¦´ ROS 2 service ì˜ˆì‹œëŠ” Gazeboìƒì˜ ì¹´ë©”ë¼ë¥¼ í†µí•´ ì‚¬ì§„ì„ ì°ëŠ” Service Serverì…ë‹ˆë‹¤.\nì˜ˆì‹œ ì‹¤í–‰ - rqtë¥¼ í†µí•´ service callì´ ì„±ê³µí•˜ë©´ í˜„ì¬ ì‹œê°„ì— í•´ë‹¹í•˜ëŠ” íŒŒì¼ì´ë¦„ìœ¼ë¡œ ì¹´ë©”ë¼ê°€ ë°”ë¼ë³´ëŠ” ì‹œì•¼ ì´ë¯¸ì§€ê°€ ì €ì¥ë©ë‹ˆë‹¤. # Terminal 1 - Execute Gazebo World ros2 launch rgbd_world depth_world.launch.py # Terminal 2 - Execute Service Server ros2 run py_service_tutorial take_picture_server # Terminal 3 - Execute rqt\u0026#39;s service caller rqt Service Callerì˜ ì‚¬ìš©ë²•ê³¼ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. â‡’ data í•„ë“œì— Trueë¥¼ ì „ë‹¬í•˜ë©´ ì‚¬ì§„ì„ ì°ì–´ workspaceì— ì €ì¥í•´ì¤ë‹ˆë‹¤.\nì½”ë“œ ë¶„ì„ ì½”ë“œë¥¼ ì‚´í´ë³´ê¸° ì „ì—, ì´ë¥¼ ì–´ë–»ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆì„ì§€ ê°™ì´ ìƒê°í•´ë´…ì‹œë‹¤.\nì‚¬ì§„ ì´¬ì˜ ì‹ í˜¸ë¥¼ ë°›ì•„ ìˆ˜í–‰í•˜ëŠ” Service Server ì¹´ë©”ë¼ image data Subscriber í•­ìƒ ì‚¬ì§„ì„ ì°ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ Service Callì´ ì˜¤ëŠ” ê·¸ ìˆœê°„ì—ë§Œ ì‚¬ì§„ì„ ì €ì¥í•´ì•¼ í•©ë‹ˆë‹¤.\nâ‡’ ìœ„ ì¡°ê±´ì— ë”°ë¼ ì‘ì„±í•œ Nodeì˜ ìƒì„±ìëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nclass PictureNode(Node): def __init__(self): super().__init__(\u0026#39;turtle_circle_server\u0026#39;) self.img_topic_name = \u0026#34;/rgb_cam/rgb_cam/image_raw\u0026#34; self.server = self.create_service( SetBool, \u0026#39;take_picture\u0026#39;, self.take_picture_callback ) self.subscriber = self.create_subscription( Image, self.img_topic_name, self.sub_callback, 10 ) self.br = CvBridge() self.is_request = False Service Serverì˜ ìƒì„±ì€ create_serviceë¥¼ ì‚¬ìš©í•˜ë©° í•„ìš”í•œ ë§¤ê°œë³€ìˆ˜ë“¤ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. Parameter Description SetBool Srv Type \u0026rsquo;take_picture' Service Name self.take_picture_callback Request ì‹œ ì‹¤í–‰ë  Service Callback ì°¸ê³ ë¡œ ì´ë²ˆì— ì‚¬ìš©í•˜ëŠ” srvëŠ” example_interfaces/srv/SetBoolì´ë©°, Bool Typeì˜ requestì™€ String responseë¥¼ ê°–ê³  ìˆìŠµë‹ˆë‹¤. (ros2 interface showë¥¼ í†µí•´ ì¡°íšŒ ê°€ëŠ¥í•©ë‹ˆë‹¤.) $ ros2 interface show example_interfaces/srv/SetBool # This is an example of a service to set a boolean value. # This can be used for testing but a semantically meaningful # one should be created to be built upon. bool data # e.g. for hardware enabling / disabling --- bool success # indicate successful run of triggered service string message # informational, e.g. for error messages service callì— ëŒ€í•œ callback, take_picture_callback()ì…ë‹ˆë‹¤. ì´ callbackì€ requestì™€ response 2ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ í•„ìš”ë¡œ í•˜ëŠ” í•¨ìˆ˜ë¡œ, bool typeì˜ dataê°€ Trueì´ë©´ ë‚´ë¶€ ìƒíƒœë¥¼ ë³€í™”ì‹œí‚µë‹ˆë‹¤. def take_picture_callback(self, request, response): if request.data is True: self.get_logger().info(\u0026#39;KimChi~\u0026#39;) self.is_request = True response.success = True response.message = \u0026#34;Successfully image written\u0026#34; return response í´ë˜ìŠ¤ ë‚´ë¶€ is_requestì˜ ìƒíƒœê°€ ë³€í™”í•˜ë©´ subscription callbackì—ì„œ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ëŠ” ë¡œì§ì´ ì‹¤í–‰ë©ë‹ˆë‹¤. CV Bridgeë¥¼ í†µí•´ ROS topicì„ OpenCV í¬ë§·ìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ìˆìœ¼ë©°, imwriteë¥¼ í†µí•´ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. def sub_callback(self, data): if self.is_request: current_frame = self.br.imgmsg_to_cv2(data, \u0026#34;bgr8\u0026#34;) file_name = str(self.get_clock().now().to_msg().sec) + \u0026#39;.png\u0026#39; cv2.imwrite(file_name, current_frame) self.get_logger().info(f\u0026#39;Image saved in {file_name}\u0026#39;) self.is_request = False ROS 2 Service Programming - C++ example 1 - Service Client Example (Spawn Entity) ì´ë²ˆì—ëŠ” ë™ì¼í•œ ì½”ë“œë¥¼ C++ë¡œ êµ¬í˜„í•´ ë´…ì‹œë‹¤. ì¼ì „ ì˜ˆì‹œì™€ ê¸°ëŠ¥ì€ ë™ì¼í•˜ë¯€ë¡œ ì‹¤í–‰ë§Œ í•´ë³´ê² ìŠµë‹ˆë‹¤. # Terminal 1 - gazebo env launch ros2 launch rgbd_world depth_world.launch.py # Terminal 2 - Execute Service Client ros2 run cpp_service_tutorial spawn_object_wo_gravity ì½”ë“œ ë¶„ì„ ì´ë²ˆì— ë¶„ì„í•  ì½”ë“œëŠ” spawn_object_wo_gravity.cpp ****ì…ë‹ˆë‹¤. includeì‹œ snake caseë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ì ì— ìœ ì˜í•©ë‹ˆë‹¤. (ì €ëŠ” copilotì„ í†µí•´ ì†ì‰½ê²Œ ê°œë°œí•˜ê³  ìˆìŠµë‹ˆë‹¤.) #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; #include \u0026#34;std_srvs/srv/empty.hpp\u0026#34; #include \u0026#34;gazebo_msgs/srv/spawn_entity.hpp\u0026#34; Service Clientì˜ ìƒì„±ì€ create_clientë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì¤‘ë ¥ì„ ì •ì§€í‚¤ì‹œëŠ” serviceì™€ ëª¨ë¸ì„ ë“±ì¥ì‹œí‚¤ëŠ” service ì´ 2ê°€ì§€ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. class GZSpawnClient : public rclcpp::Node { private: rclcpp::Client\u0026lt;Spawn\u0026gt;::SharedPtr spawn_client; rclcpp::Client\u0026lt;Empty\u0026gt;::SharedPtr pause_client; ... public: GZSpawnClient() : Node(\u0026#34;gazebo_model_spawner\u0026#34;){ pause_client = this-\u0026gt;create_client\u0026lt;Empty\u0026gt;(\u0026#34;pause_physics\u0026#34;); spawn_client = this-\u0026gt;create_client\u0026lt;Spawn\u0026gt;(\u0026#34;spawn_entity\u0026#34;); Parameter Description template argument Serviceì— ì‚¬ìš©ë  ë°ì´í„° íƒ€ì… service name Request ëŒ€ìƒì´ ë˜ëŠ” Service ì´ë¦„ pythonì˜ˆì‹œì™€ ë™ì¼í•˜ê²Œ ê° Service Client ë§ˆë‹¤ íŠ¹ì • ì‹œê°„ ë™ì•ˆ ëŒ€ê¸°í•˜ëŠ” ë¡œì§ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. while (!pause_client-\u0026gt;wait_for_service(1s)) { if (!rclcpp::ok()) { RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Interrupted while waiting for the service. Exiting.\u0026#34;); exit(0); } RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Pause service not available, waiting again...\u0026#34;); } mainë¬¸ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. Nodeë¥¼ ìƒì„±í•˜ë©°, í•´ë‹¹ Nodeë‚´ë¶€ì—ëŠ” Service Clientê°€ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. send_pause_request()ë¥¼ í†µí•´ Pause Service Callì„ ì‹¤í–‰í•©ë‹ˆë‹¤. (ë‚´ë¶€ì ìœ¼ë¡œ async_send_request() ì‹¤í–‰) ì´ì— ë”°ë¥¸ ê²°ê³¼ë¡œ futureê°€ ë°˜í™˜ë©ë‹ˆë‹¤. Pauseì— ëŒ€í•œ responseë¥¼ ì™„ë£Œí•©ë‹ˆë‹¤. Spawn Serviceë¥¼ ìœ„í•´ ì‚¬ìš©ìë¡œë¶€í„° ë“±ì¥ì‹œí‚¬ ë¬¼ì²´ë¥¼ ì„ íƒë°›ìŠµë‹ˆë‹¤. spin_until_future_complete()ë¥¼ í†µí•´ spawn futureê°€ ì§„í–‰ë˜ëŠ” ë™ì•ˆ ë¹„ë™ê¸°ë¡œ ëŒ€ê¸°í•©ë‹ˆë‹¤. futureê°€ ì™„ë£Œ ìƒíƒœê°€ ë˜ë©´ Responseë¥¼ ì¶œë ¥í•˜ê²Œ ë©ë‹ˆë‹¤. int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;GZSpawnClient\u0026gt;(); auto pause_result = node-\u0026gt;send_pause_request(); if (rclcpp::spin_until_future_complete(node, pause_result) == rclcpp::FutureReturnCode::SUCCESS) { RCLCPP_INFO(node-\u0026gt;get_logger(), \u0026#34;Pause Successfully Done.\u0026#34;); } else { RCLCPP_ERROR(node-\u0026gt;get_logger(), \u0026#34;Failed to pause physics!\u0026#34;); } std::string model_name; ... auto spawn_result = node-\u0026gt;send_spawn_request(model_name); // Wait for the spawn_result. if (rclcpp::spin_until_future_complete(node, spawn_result) == rclcpp::FutureReturnCode::SUCCESS) { RCLCPP_INFO(node-\u0026gt;get_logger(), \u0026#34;Spawn Successfully Done.\u0026#34;); } else { RCLCPP_ERROR(node-\u0026gt;get_logger(), \u0026#34;Failed to spawn model!\u0026#34;); } rclcpp::shutdown(); return 0; } rclcpp::FutureReturnCodeëŠ” 3ê°€ì§€ ìƒíƒœë¥¼ ê°–ëŠ” enum typeì…ë‹ˆë‹¤. Enumerator SUCCESS INTERRUPTED TIMEOUT ë¬¼ì„±ì¹˜ë¥¼ ì •ì§€ì‹œí‚¤ëŠ” pause service callì€ ë”±íˆ ì¶”ê°€ ì‘ì—…ì´ í•„ìš” ì—†ìŠµë‹ˆë‹¤. (Empty Callì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.) auto send_pause_request(){ return pause_client-\u0026gt;async_send_request(pause_request); } spawn requestì—ì„œëŠ” ë¬¼ì²´ì˜ sdf íŒŒì¼ì„ ì½ì–´ë“¤ì´ê³  ì´ë¥¼ service srv ë°ì´í„° í•„ë“œì— ì±„ìš´ ë’¤, ìµœì¢… service callì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ë¬¼ì²´ì˜ ì´ë¦„ê³¼ ë²ˆí˜¸ ë§¤ì¹­ì„ ìœ„í•´ map ìë£Œêµ¬ì¡°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. auto send_spawn_request(const std::string \u0026amp;model_name){ auto item = model_map.find(model_name); std::string model_path; ... spawn_request-\u0026gt;xml = ss.str(); ... return spawn_client-\u0026gt;async_send_request(spawn_request); } service callì˜ ë™ê¸°, ë¹„ë™ê¸° ì‹¤í–‰ì— ëŒ€í•´ì„œëŠ” ì´í›„ Advanced ê°•ì˜ì—ì„œ ì¢€ ë” ìì„¸í•˜ê²Œ ë‹¤ë£¨ì–´ ë³¼ ì˜ˆì •ì…ë‹ˆë‹¤.\nService Client ê´€ë ¨ ë©”ì†Œë“œë“¤ì„ ì •ë¦¬í•´ë´…ì‹œë‹¤. Code Description create_client() client ìƒì„± rclcpp::spin_until_future_complete(,) Client Request Taskê°€ ì™„ë£Œë˜ê¸°ê¹Œì§€ ë¹„ë™ê¸° ëŒ€ê¸° rclcpp::FutureReturnCode Futureì˜ ìƒíƒœë¥¼ ë‹´ê³  ìˆëŠ” enum type async_send_request(std::make_sharedSpawn::Request) ë¹„ë™ê¸° service call example 2 - Service Server Example (Snapshot) python ë•Œì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. # Terminal 1 - Execute Gazebo World ros2 launch rgbd_world depth_world.launch.py # Terminal 2 - Execute Service Server ros2 run cpp_service_tutorial take_picture_server # Terminal 3 - Execute rqt\u0026#39;s service caller rqt Service Callerì˜ ì‚¬ìš©ë²•ê³¼ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ì½”ë“œ ë¶„ì„ ì§€ê¸ˆ, ìš°ë¦¬ì—ê²Œ í•„ìš”í•œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì€ 2ê°€ì§€ ì…ë‹ˆë‹¤.\nì‚¬ì§„ ì´¬ì˜ ì‹ í˜¸ë¥¼ ë°›ì•„ ìˆ˜í–‰í•˜ëŠ” Service Server ì¹´ë©”ë¼ image data Subscriber ë³µìŠµì„ í•´ë³¼ ê²¸, ì´ ë¶€ë¶„ì„ ì§ì ‘ ì½”ë”©í•´ë³´ëŠ” ê²ƒë„ ì¢‹ì€ í•™ìŠµì´ ë  ê²ƒì…ë‹ˆë‹¤.\nNodeì˜ ìƒì„±ìëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. class PictureNode : public rclcpp::Node { private: rclcpp::Service\u0026lt;SetBool\u0026gt;::SharedPtr bool_server; rclcpp::Subscription\u0026lt;Image\u0026gt;::SharedPtr image_subscriber; ... public: PictureNode() : Node(\u0026#34;take_picture_server\u0026#34;){ image_subscriber = this-\u0026gt;create_subscription\u0026lt;Image\u0026gt;( this-\u0026gt;img_topic_name, 10, std::bind(\u0026amp;PictureNode::img_sub_callback, this, std::placeholders::_1) ); bool_server = this-\u0026gt;create_service\u0026lt;SetBool\u0026gt;( \u0026#34;take_picture\u0026#34;, std::bind(\u0026amp;PictureNode::server_callback, this, std::placeholders::_1, std::placeholders::_2) ); client service ë¨¼ì € ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nService Serverì˜ ìƒì„±ì€ create_serviceë¥¼ ì‚¬ìš©í•˜ë©° í•„ìš”í•œ ë§¤ê°œë³€ìˆ˜ë“¤ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. Parameter Description template argument Srv Type â€œtake_pictureâ€ Service Name std::bind(Class, Method) Request ì‹œ ì‹¤í–‰ë  Service Callback create_serviceì˜ callback í•¨ìˆ˜ëŠ” requestì™€ response 2ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ê°–ìŠµë‹ˆë‹¤. requestë¥¼ í†µí•´ ì¼ë ¨ì˜ ë¡œì§ì„ ì‹¤í–‰í•˜ê³  ê²°ê³¼ë¥¼ responseë¡œ ë¦¬í„´í•˜ëŠ” ë°©ì‹ì„ ê°–ê³  ìˆìŠµë‹ˆë‹¤. void server_callback(const std::shared_ptr\u0026lt;SetBool::Request\u0026gt; request, const std::shared_ptr\u0026lt;SetBool::Response\u0026gt; response){ if (request-\u0026gt;data) { RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;KimChi~\u0026#34;); this-\u0026gt;is_request = true; } response-\u0026gt;success = true; response-\u0026gt;message = \u0026#34;Successfully image written\u0026#34;; } subscription callbackì—ì„œëŠ” ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ëŠ” ë¡œì§ì´ ì‹¤í–‰ë©ë‹ˆë‹¤. CV Bridgeë¥¼ í†µí•´ ROS topicì„ OpenCV í¬ë§·ìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ìˆëŠ”ë°ìš”. OpenCVì™€ ROS 2ë¥¼ ë‹¤ë£¨ëŠ” ë‚´ìš©ì´ ë“±ì¥í–ˆëŠ”ë° ì§€ê¸ˆì€ ìš°ì„  ê°„ë‹¨í•˜ê²Œ ì‚´í´ë³¸ ë’¤, ì´í›„ ê°•ì˜ì—ì„œ ë‹¤ì‹œ í•œ ë²ˆ ìì„¸íˆ ë‹¤ë£° ì˜ˆì •ì…ë‹ˆë‹¤. #include \u0026lt;cv_bridge/cv_bridge.h\u0026gt; #include \u0026lt;image_transport/image_transport.hpp\u0026gt; // Using image_transport allows us to publish and subscribe to compressed image streams in ROS2 #include \u0026lt;opencv2/opencv.hpp\u0026gt; // We include everything about OpenCV as we don\u0026#39;t care much about compilation time at the moment. #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; #include \u0026#34;sensor_msgs/msg/image.hpp\u0026#34; #include \u0026#34;example_interfaces/srv/set_bool.hpp\u0026#34; ... void img_sub_callback(const Image::ConstSharedPtr msg){ if (this-\u0026gt;is_request){ cv::Mat img = cv_bridge::toCvShare(msg, \u0026#34;bgr8\u0026#34;)-\u0026gt;image; std::string file_name = std::to_string(this-\u0026gt;get_clock()-\u0026gt;now().seconds()) + \u0026#34;.jpg\u0026#34;; cv::imwrite(file_name, img); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Image saved as %s\u0026#34;, file_name.c_str()); this-\u0026gt;is_request = false; } } ì£¼ì˜í•  ì ìœ¼ë¡œ ë¹Œë“œ ì‹œ OpenCV ì¢…ì†ì„±ì„ ê¸°ì…í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤. find_package(rclcpp REQUIRED) find_package(std_srvs REQUIRED) find_package(turtlesim REQUIRED) find_package(sensor_msgs REQUIRED) find_package(gazebo_msgs REQUIRED) find_package(geometry_msgs REQUIRED) find_package(custom_interfaces REQUIRED) find_package(example_interfaces REQUIRED) find_package(OpenCV REQUIRED) find_package(cv_bridge REQUIRED) find_package(image_transport REQUIRED) add_executable(take_picture_server src/take_picture_server.cpp) ament_target_dependencies(take_picture_server rclcpp example_interfaces std_msgs sensor_msgs cv_bridge image_transport OpenCV) ì°¸ê³ ë¡œ ì €ëŠ” ROS 2ë¥¼ ì„¤ì¹˜í•  ì‹œ ê¸°ë³¸ ì„¸íŒ…ë˜ëŠ” OpenCVë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. "
},
{
	"uri": "/kr/ros2_foxy/lecture9/",
	"title": "Lecture9. ROS 2 Action Programming",
	"tags": [],
	"description": "",
	"content": "ROS 2 Action Programming ê°•ì˜ë¥¼ ì—´ì‹¬íˆ ë”°ë¼ì˜¤ë©´ì„œ ê°œë…ì„ ìŠì–´ë²„ë ¸ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ Actionì— ëŒ€í•´ì„œ ê°„ë‹¨íˆ ê°œë… ë³µìŠµì„ í•´ë³´ê² ìŠµë‹ˆë‹¤.\nimage from : https://docs.ros.org/en/foxy/Tutorials/Understanding-ROS2-Actions.html ì‚¬ì§„ê³¼ ê°™ì´ Action Clientì™€ Serverê°€ ì£¼ê³ ë°›ëŠ” ë‚´ìš©ì€ í¬ê²Œ 5ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.\nClient â‡’ Server, Goal Request (service requestì™€ ìœ ì‚¬í•©ë‹ˆë‹¤.) server â‡’ client, Goal Response client â‡’ server, Result Request server â‡’ client, Feedback (topicê³¼ ìœ ì‚¬í•©ë‹ˆë‹¤.) server â‡’ client, Result Response ë§Œì•½ 4ë²ˆ ë„ì¤‘ cancelì´ ë°œìƒí•˜ë©´ Actionì€ ì¢…ë£Œë©ë‹ˆë‹¤.\nì´ë ‡ê²Œ Actionì€ Topic, Serviceì˜ íŠ¹ì§•ì„ ëª¨ë‘ ê°–ê³  ìˆìœ¼ë©° Cancelì´ë¼ëŠ” ì¶”ê°€ ê¸°ëŠ¥ê¹Œì§€ ê°–ì¶”ê³  ìˆëŠ” ë³µì¡í•œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì´ì—ˆìŠµë‹ˆë‹¤. ì´ë²ˆ ì˜ˆì‹œì—ì„œëŠ” ActionServerì™€ ActionClient, ê·¸ë¦¬ê³  ê³¼ì œë¡œ ë³„ë„ ActionServerê¹Œì§€ ì œì‹œí•´ë³´ê² ìŠµë‹ˆë‹¤.\nROS 2 Action Programming - python example 1 - Action Server (Parking Master) image from : ê¸°í˜¸ì¼ë³´\nActionì„ ì‚¬ìš©í•˜ëŠ” ì¬ë¯¸ìˆëŠ” ì˜ˆì‹œë¥¼ ì¤€ë¹„í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”\n# Terminal 1 ros2 launch src_gazebo wall_world.launch.py # Terminal 2 cbp py_action_tutorial \u0026amp;\u0026amp; source install/local_setup.bash ros2 run py_action_tutorial parking_action_server # Terminal 3 ros2 action send_goal /src_parking custom_interfaces/action/Parking \u0026#34;start_flag: true\u0026#34; --feedback í˜„ì¬ custom interfaceë¥¼ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë¯€ë¡œ workspaceë¥¼ sourcing í•´ì•¼ í•©ë‹ˆë‹¤!\nì˜ˆì‹œ ì‹¤í–‰ ì‹œ ë²½ì— ì¸ì ‘í•˜ì—¬ í°ìƒ‰ ìƒìë“¤ì´ ì£¼ì°¨ ê³µê°„ì„ ë°°ì •í•´ì¤„ ê²ƒì…ë‹ˆë‹¤ â‡’ rqt_robot_steeringìœ¼ë¡œ ë¡œë´‡ì„ ì˜ ì œì–´í•˜ì—¬ ì£¼ì–´ì§„ ì£¼ì°¨ ê³µê°„ì— ì•Œë§ê²Œ ì£¼ì°¨ë¥¼ í•´ë³´ì„¸ìš”!\ní„°ë¯¸ë„ ìƒì˜ Feedbackì„ í†µí•´ ë²½ê³¼ì˜ ê±°ë¦¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, ì´ ê±°ë¦¬ê°€ 0.5m ì´ë‚´ê°€ ë˜ë©´ ì£¼ì°¨ê°€ ì™„ë£Œë©ë‹ˆë‹¤. ì™„ë£Œ ì‹œ ì¢Œìš° ê³µê°„ì´ ì–¼ë§ˆê°€ ê· í˜•ì´ ë§ëŠ”ì§€ì— ë”°ë¼ ë‹¤ë¥¸ Resultë¥¼ ì–»ê²Œ ë©ë‹ˆë‹¤. Feedback: distance: 0.7399989366531372 Feedback: distance: 0.630066454410553 Result: message: \u0026#39;[Success!] Oh... Teach me how you did :0\u0026#39; í”„ë¡œê·¸ë˜ë°ì„ ì‹œì‘í•˜ê¸° ì „, í•„ìš”í•œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ë“¤ì„ ì‚´í´ë´…ì‹œë‹¤.\nAction Server : Goalì„ ë°›ìœ¼ë©´, ì •ë©´ ë²½ê³¼ì˜ ê±°ë¦¬ë¥¼ feedbackìœ¼ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤. ìµœì¢… ResultëŠ” Stringìœ¼ë¡œ ì„±ê³µ ì—¬ë¶€ë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤.\nLaserScan Sub : ì£¼ë³€ ë¬¼ì²´ì™€ì˜ ìŠ¤ìº”ëœ ê±°ë¦¬ë¥¼ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nâ‡’ Feedback Callbackê³¼ Subscription Callback ë‘ Callback í•¨ìˆ˜ë„ êµ¬í˜„í•´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤.\nì´ë²ˆ ì˜ˆì‹œë¥¼ ìœ„í•´ custom interfaceë¥¼ ë§Œë“¤ì–´ ë³´ì•˜ìŠµë‹ˆë‹¤. (custom interfaceë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ë³µìŠµì„ í•´ë³¼ ì¢‹ì€ ê¸°íšŒì…ë‹ˆë‹¤. â‡’ 7ê°•. ROS 2 Topic and Programming) $ ros2 interface show custom_interfaces/action/Parking #goal definition bool start_flag --- #result definition string message --- #feedback definition float32 distance ì½”ë“œ ë¶„ì„ rclpyì—ì„œ Action Serverë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ActionServerë¼ëŠ” ë³„ë„ì˜ íŒ¨í‚¤ì§€ë¥¼ import í•´ì•¼ í•©ë‹ˆë‹¤. import rclpy from rclpy.node import Node from rclpy.action import ActionServer ì½”ë“œ ë¶„ì„ ì „ ì‚´í´ë³¸ ë°”ì™€ ê°™ì´ ë‘ ì¢…ë¥˜ì˜ í•¸ë“¤ëŸ¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. class ParkingActionServer(Node): def __init__(self): super().__init__(\u0026#39;parking_action_server\u0026#39;) self.laser_sub = self.create_subscription( LaserScan, \u0026#39;scan\u0026#39;, self.sub_callback, 10 ) self.action_server = ActionServer( self, Parking, \u0026#39;src_parking\u0026#39;, goal_callback=self.goal_callback, cancel_callback=self.cancel_callback, execute_callback=self.execute_callback, ) ì´ì œ Actionì˜ callback ì§€ì˜¥ì„ ì‹œì‘í•´ë³´ë ¤ í•˜ëŠ”ë°ìš”, ë‹¤ì‹œ í•œ ë²ˆ ê°œë…ì„ ë‹¤ì¡ê³  ê°‘ì‹œë‹¤. Description goal_callback clientë¡œë¶€í„° ì²« goal request ë°œìƒ ì‹œ ì‹¤í–‰ë˜ëŠ” cb cancel_callback feedback ë„ì¤‘ cancel request ë°œìƒ ì‹œ ì‹¤í–‰ë˜ëŠ” cb execute_callback feedback ì¤‘ ì‹¤í–‰ë˜ëŠ” cb goal_callbackì€ goal messageë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ê°€ì§€ë©°, ACCEPT í˜¹ì€ Reject ê°’ì„ ë¦¬í„´í•©ë‹ˆë‹¤. from rclpy.action import GoalResponse ... def goal_callback(self, goal_request): self.get_logger().info(\u0026#39;Received goal request.\u0026#39;) self.goal = goal_request return GoalResponse.ACCEPT cancel_callbackì€ goal_handleì´ë¼ëŠ” action handler objectë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ìŠµë‹ˆë‹¤. ì´ goal_handle ë‚´ë¶€ì—ëŠ” ì—¬ëŸ¬ APIë“¤ì´ êµ¬í˜„ë˜ì–´ ìˆì–´ ì§ì ‘ í™•ì¸í•´ë³´ê³  ë„˜ì–´ê°€ê³ ì í•©ë‹ˆë‹¤. from rclpy.action import CancelResponse ... def cancel_callback(self, goal_handle): self.is_sub = False self.is_done = True # print(dir(goal_handle)) goal_handle.canceled() self.get_logger().info(\u0026#39;Received cancel request\u0026#39;) return CancelResponse.ACCEPT execute_callbackì—ì„œ ì£¼ë¡œ ì‹¤ì œ ë¡œì§ì´ êµ¬í˜„ë˜ë©°, ì—…ë°ì´íŠ¸ë˜ëŠ” í™˜ê²½ì— ë”°ë¼ clientì—ê²Œ feedbackì„ ì „ë‹¬í•˜ê³ , ìµœì¢… resultê°€ ë°œë™ë˜ëŠ” ì¡°ê±´ë„ êµ¬í˜„í•©ë‹ˆë‹¤. def execute_callback(self, goal_handle): ... feedback_msg = Parking.Feedback() while self.f_obs_distance \u0026gt; 0.5 and self.is_done == False: goal_handle.publish_feedback(feedback_msg) ... ... return result ì´ë²ˆ ì˜ˆì‹œì˜ ë¡œì§ì„ ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•´ë³´ê² ìŠµë‹ˆë‹¤. ë¡œë´‡ì´ ë²½ì— ì¸ì ‘í•˜ê²Œ ë˜ì–´ while loopë¥¼ ë²—ì–´ë‚˜ë©´ goal succedë¥¼ ìˆ˜í–‰í•˜ê³ , Resultë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤. ì™„ë£Œ ì‹œ ì¢Œìš° ë¬¼ì²´ì™€ì˜ ê±°ë¦¬ê°€ ê· ì¼í•  ë•Œ ì„±ê³µìœ¼ë¡œ íŒì •ì§“ìŠµë‹ˆë‹¤.\ngoal_handle.succeed() result = Parking.Result() lr_diff = abs(self.r_obs_distance - self.l_obs_distance) if lr_diff \u0026lt; 0.15: result.message = \u0026#34;[Success!] Oh... Teach me how you did :0\u0026#34; else: result.message = \u0026#34;[Fail] Be careful, Poor Driver! \u0026#34; self.is_done = True return result ì´ë²ˆ ì˜ˆì‹œì˜ mainë¬¸ì—ì„œ íŠ¹ë³„í•œ ì ì„ ì°¾ì•„ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. MultiThreadedExecutorë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ë°ìš”. ì´ê²ƒì´ í•˜ëŠ” ì—­í• ì´ ë¬´ì—‡ì¼ì§€ ì§€ê¸ˆì€ ê°„ë‹¨í•˜ê²Œ ì‹¤ìŠµì„ í†µí•´ ì‚´í´ë´…ì‹œë‹¤. â‡’ main ë¬¸ì˜ ì£¼ì„ì„ í† ê¸€í•˜ê³ , ë‹¤ì‹œ ì˜ˆì œë¥¼ ì‹¤í–‰ ì‹œì¼œë´…ë‹ˆë‹¤. ì–´ë– í•œ ê²°ê³¼ë¥¼ ì–»ìœ¼ì…¨ë‚˜ìš”? def main(args=None): rclpy.init(args=args) # parking_action_server = ParkingActionServer() # rclpy.spin(parking_action_server) # parking_action_server.destroy_node() # rclpy.shutdown()ã… ... í˜„ ì˜ˆì‹œëŠ” ì—¬ëŸ¬ ì¢…ë¥˜ì˜ callbackì„ ê°–ê³  ìˆìŠµë‹ˆë‹¤. ë¬¸ì œëŠ” execute_callbackì´ ì‹¤í–‰ë˜ë©´ì„œ while loopë¡œ ì§„ì…í•˜ë©´, ìì›ì„ ì ìœ í•˜ì—¬ sub_callbackì´ ë™ì‘í•  ìˆ˜ ì—†ëŠ” êµ¬ì¡°ê°€ ë©ë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ROS 2ì—ì„œëŠ” Executorë¼ëŠ” ê°œë…ì„ ë„ì…í•©ë‹ˆë‹¤. (ìì„¸í•œ ë‚´ìš©ì€ ì´í›„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.) image from : docs.ros.org ì´í›„ ì—¬ëŸ¬ê°€ì§€ êµ¬í˜„ì„ í•˜ë‹¤ ë³´ë©´ ì§€ê¸ˆì²˜ëŸ¼ ë‹¤ì¤‘ Subscribeë¥¼ í•´ì•¼í•˜ëŠ” ê²½ìš°, í˜¹ì€ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì—¬ëŸ¬ê°œì˜ Nodeë¥¼ ì‹¤í–‰ì‹œì¼œì•¼ í•˜ëŠ” ê²½ìš°ê°€ ë°œìƒí•©ë‹ˆë‹¤. ì´ë•Œ, Node Compositionê³¼ MultiThreadedExecutorë¥¼ ì ê·¹ ì‚¬ìš©í•´ë³´ì„¸ìš”!\nexample 2 - Action Client (Parking Master) Action ìì²´ë„ ì‰½ì§€ ì•Šì€ ê°œë…ì¸ë° MultiThreadedExecutorë“± ìƒˆë¡œìš´ ê°œë…ìœ¼ë¡œ ë§ì€ í˜¼ë€ì´ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ Action ClientëŠ” ì¼ì „ Parking Exampleì˜ Clientë§Œ êµ¬í˜„í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.\nì´ì „ ì˜ˆì‹œì—ì„œëŠ” ì½˜ì†” ì°½ì„ í†µí•´ ì§ì ‘ Action Clientë¥¼ ì‹¤í–‰í•˜ì˜€ìŠµë‹ˆë‹¤. â‡’ ros2 action send_goal ros2 action send_goal /src_parking custom_interfaces/action/Parking \u0026#34;start_flag: true\u0026#34; --feedback Action Client ì˜ˆì‹œëŠ” ë°”ë¡œ ì´ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì½”ë“œë¡œ í˜¸ì¶œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ros2 run cpp_action_tutorial parking_status_client ì½”ë“œ ë¶„ì„ parking_status_client.pyë¥¼ ì°¸ê³ í•˜ì‹œë©´ ë©ë‹ˆë‹¤. íŒŒì¼ì˜ ì²˜ìŒìœ¼ë¡œ ActionClientì™€ action data typeì„ importí•˜ê³  ìˆìŠµë‹ˆë‹¤. import rclpy from rclpy.node import Node from rclpy.action import ActionClient from custom_interfaces.action import Parking ì´ë²ˆ ì˜ˆì‹œì—ì„œë„ Callbackì´ ë§ì•„ ì •ë¦¬ë¶€í„° í•˜ê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤. Description feedback_callback Action Serverë¡œë¶€í„°ì˜ feedback cb goal_response_callback Action Serverë¡œë¶€í„°ì˜ Response cb get_result_callback Action Serverë¡œë¶€í„°ì˜ Result cb cancel_goal Action Serverë¡œ ì „ë‹¬í•˜ëŠ” Cancel cb goal_canceled_callback Action Serverë¡œë¶€í„°ì˜ Cancel cb ìƒì„±ìì—ì„œëŠ” Action Client ìƒì„± ì™¸ì— í° ì‘ì—…ì€ ì—†ìŠµë‹ˆë‹¤. class ParkingActionClient(Node): def __init__(self): super().__init__(\u0026#39;parking_action_client\u0026#39;) self._action_client = ActionClient(self, Parking, \u0026#39;src_parking\u0026#39;) Description Parking Action data type \u0026lsquo;src_parkingâ€™ Action name send_goal()ì€ mainì—ì„œ ì§ì ‘ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ë¡œ, feedback_callbackê³¼ goal_response_callbackì„ ë°”ì¸ë”©í•©ë‹ˆë‹¤. def send_goal(self): ... self._send_goal_future = self._action_client.send_goal_async(goal_msg, feedback_callback=self.feedback_callback) self._send_goal_future.add_done_callback(self.goal_response_callback) def main(args=None): ... action_client.send_goal() goal_response_callback ì™„ë£Œ ì‹œ, get_result_callbackì´ ì‹¤í–‰ë˜ë©°, resultë¥¼ ë°›ì•˜ë‹¤ëŠ” ê²ƒì€ actionì´ ì™„ë£Œë˜ì—ˆë‹¤ëŠ” ëœ»ì´ë¯€ë¡œ ì¢…ë£Œ ë¡œì§ì´ í¬í•¨ë©ë‹ˆë‹¤. def goal_response_callback(self, future): self.goal_handle = future.result() if not self.goal_handle.accepted: self.get_logger().info(\u0026#39;Goal rejected :(\u0026#39;) return self.get_logger().info(\u0026#39;Goal accepted :)\u0026#39;) self._get_result_future = self.goal_handle.get_result_async() self._get_result_future.add_done_callback(self.get_result_callback) def get_result_callback(self, future): result = future.result().result self.get_logger().info(f\u0026#39;Result: {result.message}\u0026#39;) rclpy.shutdown() cancel ë¡œì§ì€ feedback_callbackì•ˆì— ì¡´ì¬í•©ë‹ˆë‹¤. í”¼ë“œë°±ì„ í†µí•´ ë°›ì€ ì „ë°© ë¬¼ì²´ì™€ì˜ ê±°ë¦¬ê°€ ë„ˆë¬´ ë©€ì–´ì ¸ë²„ë¦¬ë©´ ì˜¤ë¥˜ë¡œ ì¸ì§€í•˜ê³  cancelì´ ì´ë£¨ì–´ì§€ëŠ” ê²ƒì…ë‹ˆë‹¤. def feedback_callback(self, feedback_msg): ... if feedback.distance \u0026gt; 6.0: self.cancel_goal() def cancel_goal(self): self.get_logger().info(\u0026#39;Canceling goal\u0026#39;) future = self.goal_handle.cancel_goal_async() future.add_done_callback(self.goal_canceled_callback) def goal_canceled_callback(self, future): cancel_response = future.result() if len(cancel_response.goals_canceling) \u0026gt; 0: self.get_logger().info(\u0026#39;Cancelling of goal complete\u0026#39;) else: self.get_logger().warning(\u0026#39;Goal failed to cancel\u0026#39;) â‡’ ë”°ë¼ì„œ ì˜ˆì‹œ ì‹¤í–‰ ì‹œ ì˜ë„ì ìœ¼ë¡œ ë’¤ë¡œ ê°€ë²„ë¦¬ë©´ Actionì´ ì¢…ë£Œë©ë‹ˆë‹¤.\nmainë¬¸ì—ì„œ send_goalì„ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ ìŠì§€ ë§ˆì„¸ìš”. def main(args=None): rclpy.init(args=args) action_client = ParkingActionClient() action_client.send_goal() rclpy.spin(action_client) example 3 - Action Server (Dataset Generation) ì´ì œ Topic, Service, Actionì„ ëª¨ë‘ ë°°ì›Œë³´ì•˜ìŠµë‹ˆë‹¤. ë•Œë¬¸ì— ì´ë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ëŠ” ê³¼ì œë¥¼ ë‚´ë“œë¦¬ê³ ì í•©ë‹ˆë‹¤.\nDataset Generation # Terminal1 - gazebo env ros2 launch rgbd_world depth_world.launch.py # Terminal2 - Assignment Node ros2 run py_action_tutorial dataset_generation_server # Terminal3 - Action Call ros2 action send_goal /dataset_generation custom_interfaces/action/DataGen \u0026#34;{x: 1, z: 1, model_name: beer}\u0026#34; ì„ íƒí•œ ë¬¼ì²´ì™€ ìœ„ì¹˜ì— ë”°ë¼ ì´ 6ë²ˆ spawn, capture, deletionì´ ë°˜ë³µë©ë‹ˆë‹¤. â‡’ ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œëœ í›„ workspaceì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ì§„ datasetì´ ìƒì„±ë©ë‹ˆë‹¤.\nğŸ’ªÂ ì´ Nodeë¥¼ ê°œë°œí•´ë³´ëŠ” ê²ƒì´ ì´ë²ˆ ì‹œê°„ì˜ ê³¼ì œì…ë‹ˆë‹¤. Hint 1. í•„ìš”í•œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ Description create_subscription image topicì„ ë°›ì•„ ì €ì¥í•´ì•¼ í•©ë‹ˆë‹¤. create_client ì¼ì „ Service Client ë•Œì²˜ëŸ¼ ë¬¼ì„±ì¹˜ë¥¼ ì •ì§€ì‹œí‚¤ê³ , ì›í•˜ëŠ” ìœ„ì¹˜ì— ë¬¼ì²´ë¥¼ ë“±ì¥ì‹œí‚¤ê³ , ë˜ ì‚­ì œí•˜ëŠ” ì‘ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤. ActionServer Actionì„ í†µí•´ ì˜ ì§„í–‰ë˜ê³  ìˆëŠ”ì§€ ë¡œì§ì„ êµ¬í˜„í•˜ê³ , Serviceë“¤ë„ í•¸ë“¤ë§í•©ë‹ˆë‹¤. Hint 2. action data type ì´ë²ˆ ì˜ˆì‹œë¥¼ ìœ„í•´ ì‚¬ìš©í•  ë°ì´í„° íƒ€ì…ì„ ë¯¸ë¦¬ ì¤€ë¹„í•´ë‘ì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, ì§ì ‘ ì—¬ëŸ¬ë¶„ë§Œì˜ interfaceë¥¼ ë§Œë“¤ì–´ë³´ê³ , ì‚¬ìš©í•´ë³´ê¸°ë¥¼ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.\n#goal definition string model_name float32 x float32 y float32 z --- #result definition string message --- #feedback definition string message Hint 3. sleep ì‚¬ì§„ì´ ì°íˆê¸°ê¹Œì§€ ì‹œê°„ ì—¬ìœ ë¥¼ ì£¼ê¸° ìœ„í•´ create_rate í•¨ìˆ˜ ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤. (ë‹¨ìœ„ëŠ” Hz)\nself.rate = self.create_rate(0.3) self.rate.sleep() â‡’ í•´ì„¤ì€ ë‹¤ìŒ ì‹œê°„ì— ì§„í–‰í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤!!\nROS 2 Action Programming - C++ example 1 - Action Server (Parking Master) ë°”ë¡œ ì˜ˆì‹œ ì‹¤í–‰ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. # Terminal 1 ros2 launch src_gazebo wall_world.launch.py # Terminal 2 ros2 run cpp_action_tutorial parking_status_server # Terminal 3 ros2 action send_goal /src_parking custom_interfaces/action/Parking \u0026#34;start_flag: true\u0026#34; --feedback ì½”ë“œ ë¶„ì„ í”„ë¡œê·¸ë˜ë° ì¤‘ íƒ€ì´í•‘ì„ ìµœì†Œí™”í•˜ê¸°ìœ„í•´ ServerGoalHandleì— ëŒ€í•œ í‚¤ì›Œë“œë¥¼ ì¬ì •ì˜í•˜ì˜€ìŠµë‹ˆë‹¤. #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; #include \u0026#34;sensor_msgs/msg/laser_scan.hpp\u0026#34; #include \u0026#34;rclcpp_action/rclcpp_action.hpp\u0026#34; #include \u0026#34;custom_interfaces/action/parking.hpp\u0026#34; using LaserScan = sensor_msgs::msg::LaserScan; using Parking = custom_interfaces::action::Parking; using GoalHandleParking = rclcpp_action::ServerGoalHandle\u0026lt;Parking\u0026gt;; íŒŒì´ì¬ ë•Œì™€ ë™ì¼í•˜ê²Œ Action Serverì™€ Topic Subscriberê°€ í•„ìš”í•©ë‹ˆë‹¤. public: ParkingActionServer() : Node(\u0026#34;parking_action_server\u0026#34;) { using namespace std::placeholders; m_action_server = rclcpp_action::create_server\u0026lt;Parking\u0026gt;( this, \u0026#34;src_parking\u0026#34;, std::bind(\u0026amp;ParkingActionServer::handle_goal, this, _1, _2), std::bind(\u0026amp;ParkingActionServer::handle_cancel, this, _1), std::bind(\u0026amp;ParkingActionServer::handle_accepted, this, _1) ); m_laser_sub = this-\u0026gt;create_subscription\u0026lt;LaserScan\u0026gt;( \u0026#34;scan\u0026#34;, 10, std::bind(\u0026amp;ParkingActionServer::laser_callback, this, _1) ); RCLCPP_INFO(get_logger(), \u0026#34;Action Ready...\u0026#34;); } rclcpp Action Serverì˜ callbackë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. íŒŒì´ì¬ê³¼ ë‹¬ë¦¬ acceptì— ëŒ€í•œ callbackì„ ê°–ìŠµë‹ˆë‹¤. Description handle_goal clientë¡œë¶€í„° ì²« goal request ë°œìƒ ì‹œ ì‹¤í–‰ë˜ëŠ” cb handle_cancel feedback ë„ì¤‘ cancel request ë°œìƒ ì‹œ ì‹¤í–‰ë˜ëŠ” cb handle_accepted goal accept ì‹œ ì‹¤í–‰ë˜ëŠ” cb template argument action data type \u0026ldquo;src_parking\u0026rdquo; action name handle_goalì€ goal id, goal ìì²´ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ê°€ì§€ë©°, REJECT, ACCEPT_AND_EXECUTE, ACCEPT_AND_DEFERì„ ë¦¬í„´ìœ¼ë¡œ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. rclcpp_action::GoalResponse handle_goal(const rclcpp_action::GoalUUID \u0026amp;uuid, std::shared_ptr\u0026lt;const Parking::Goal\u0026gt; goal) { RCLCPP_INFO(get_logger(), \u0026#34;Got goal request with order %s\u0026#34;, goal-\u0026gt;start_flag ? \u0026#34;true\u0026#34; : \u0026#34;false\u0026#34;); (void)uuid; return rclcpp_action::GoalResponse::ACCEPT_AND_EXECUTE; } handle_cancelì€ action goal handler objectë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ìŠµë‹ˆë‹¤. íŒŒì´ì¬ê³¼ ë™ì¼í•˜ê²Œ ì´ goal_handle ë‚´ë¶€ì—ëŠ” ì—¬ëŸ¬ APIë“¤ì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. â‡’ CancelResponseëŠ” ACCEPT, REJECT ë‘ì¢…ë¥˜ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nrclcpp_action::CancelResponse handle_cancel(const std::shared_ptr\u0026lt;GoalHandleParking\u0026gt; goal_handle) { RCLCPP_WARN(get_logger(), \u0026#34;Got request to cancel goal\u0026#34;); (void)goal_handle; return rclcpp_action::CancelResponse::ACCEPT; } handle_acceptedì—ì„œ feedbackì„ êµ¬í˜„í•˜ëŠ” executeë¡œ ì—°ê²°ì´ ë©ë‹ˆë‹¤. ì´ ë¶€ë¶„ì—ì„œ íŒŒì´ì¬ê³¼ ì°¨ì´ë¥¼ ê°–ëŠ”ë°, ë³µìŠµì„ í•´ë³¼ ê²¸ ë¹„êµë¥¼ í•´ë³´ê² ìŠµë‹ˆë‹¤. void handle_accepted(const std::shared_ptr\u0026lt;GoalHandleParking\u0026gt; goal_handle) { // this needs to return quickly to avoid blocking the executor, so spin up a // new thread using namespace std::placeholders; std::thread{std::bind(\u0026amp;ParkingActionServer::execute, this, _1), goal_handle}.detach(); } class ParkingActionServer(Node): def __init__(self): super().__init__(\u0026#39;parking_action_server\u0026#39;) self.laser_sub = self.create_subscription( LaserScan, \u0026#39;scan\u0026#39;, self.sub_callback, 10 ) self.action_server = ActionServer( self, Parking, \u0026#39;src_parking\u0026#39;, goal_callback=self.goal_callback, cancel_callback=self.cancel_callback, execute_callback=self.execute_callback, ) executeì˜ ë¡œì§ì€ ì‚´í´ë³¼ ë°” ìˆì–´ ê°„ë‹¨íˆ ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤. ë‹¤ë§Œ, cancel ë¡œì§ì´ ì‚½ì…ë˜ëŠ” ë¶€ë¶„ê³¼ êµ¬í˜„ì— ì§‘ì¤‘í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. while (f_obs_distance \u0026gt; 0.5 \u0026amp;\u0026amp; is_done == false) { if (goal_handle-\u0026gt;is_canceling()) { result-\u0026gt;message = \u0026#34;Canceled\u0026#34;; goal_handle-\u0026gt;canceled(result); is_done = true; RCLCPP_WARN(get_logger(), \u0026#34;Goal Canceled\u0026#34;); return; } feedback-\u0026gt;distance = f_obs_distance; goal_handle-\u0026gt;publish_feedback(feedback); RCLCPP_INFO(get_logger(), \u0026#34;Distance from forward obstacle %f\u0026#34;, f_obs_distance); loop_rate.sleep(); } rclcppì—ì„œ MultiThreadedExecutorë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. add_nodeì— ì—¬ëŸ¬ nodeë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” ê²ƒì´ì§€ìš”. int main(int argc, char * argv[]){ rclcpp::init(argc, argv); rclcpp::executors::MultiThreadedExecutor executor; auto server_node = std::make_shared\u0026lt;ParkingActionServer\u0026gt;(); executor.add_node(server_node); executor.spin(); rclcpp::shutdown(); return 0; } example 2 - Action Client (Parking Master) cancelì„ í¬í•¨í•œ rclcpp Action Client ì‘ì„±ë²•ì„ ì•Œì•„ë´…ì‹œë‹¤.\nros2 run cpp_action_tutorial parking_status_client ì½”ë“œ ë¶„ì„ Actionì€ ìì²´ê°€ ì‰½ì§€ ì•Šì€ ê°œë…ì´ì–´ ì½”ë”© ì‹œ ê°œë…ì´ ì¡í˜€ìˆì§€ ì•Šìœ¼ë©´ ë¬´ì²™ í˜ë“¤ì–´ì§‘ë‹ˆë‹¤. ì½”ë“œ ë¶„ì„ ì „, ê°œìš”ë¥¼ ë¨¼ì € ì‚´í´ë³´ê³  ë„˜ì–´ê°‘ì‹œë‹¤.\nAction Client Logic ìƒì„±ìì—ì„œ Action Client ìƒì„± mainì—ì„œ send_goal ì‹¤í–‰ send_goalì—ì„œ ì—¬ëŸ¬ callbackì´ ì •ì˜ë˜ì–´ ìˆìœ¼ë©° ìƒí™©ì— ë”°ë¼ ì ì ˆí•œ callbackì´ ì‹¤í–‰ë¨ goal_response_callback feedback_callback result_callback action server ë•Œì™€ ë§ˆì°¬ê°€ì§€ë¡œ rclcpp_actionì˜ includeì™€ í¸ì˜ë¥¼ ìœ„í•´ ClientGoalHandle í‚¤ì›Œë“œë¥¼ ë‹¤ì‹œ ì •ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤. #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; #include \u0026#34;rclcpp_action/rclcpp_action.hpp\u0026#34; #include \u0026#34;custom_interfaces/action/parking.hpp\u0026#34; using namespace std::placeholders; using Parking = custom_interfaces::action::Parking; using GoalHandleParking = rclcpp_action::ClientGoalHandle\u0026lt;Parking\u0026gt;; rclcpp action clientëŠ” ë‹¤ìŒê³¼ ê°™ì´ ìƒì„±í•©ë‹ˆë‹¤. (ì‹¤ì œ callbackë“¤ì€ send_goal ì‹œ Handlerì— ì˜í•´ ë°”ì¸ë”©ë©ë‹ˆë‹¤.) class ParkingActionClient : public rclcpp::Node { private: rclcpp_action::Client\u0026lt;Parking\u0026gt;::SharedPtr m_action_client; public: ParkingActionClient() : Node(\u0026#34;parking_action_client\u0026#34;){ m_action_client = rclcpp_action::create_client\u0026lt;Parking\u0026gt;(this, \u0026#34;src_parking\u0026#34;); } Description Parking Action data type \u0026lsquo;src_parkingâ€™ Action name ë‹¤ì‹œê¸ˆ ì´ë²ˆ ì˜ˆì‹œì—ì„œì˜ callbackê³¼ ì£¼ìš” í•¨ìˆ˜ë¥¼ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤. Description feedback_callback Action Serverë¡œë¶€í„°ì˜ feedback cb goal_response_callback Action Serverë¡œë¶€í„°ì˜ Response cb result_callback Action Serverë¡œë¶€í„°ì˜ Result cb async_cancel_all_goals Action Serverë¡œ Cancel call goal_response_callbackì€ GoalHandler shared_pointerì˜ shared_futureë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ê°–ìŠµë‹ˆë‹¤. ë‹¤ì†Œ ë³µì¡í•œë°, GoalHandler ìì²´ê°€ ì•„ë‹Œ futureì´ê¸° ë•Œë¬¸ì— get() í•¨ìˆ˜ë¥¼ í†µí•´ ê°’ì„ ë”°ë¡œ ë°›ì•„ ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤. void goal_response_callback(std::shared_future\u0026lt;GoalHandleParking::SharedPtr\u0026gt; future){ auto goal_handle = future.get(); if (!goal_handle) { RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Goal was rejected by server\u0026#34;); } else { RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Goal accepted by server, waiting for result\u0026#34;); } } feedback_callback ë‚´ë¶€ cancel ë¡œì§ì—ì„œ ì´ì „ê³¼ ìƒˆë¡œìš´ ì ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. êµ¬í˜„ì˜ í¸ì˜ë¥¼ ìœ„í•´ async_cancel_all_goalsì„ ì‚¬ ìš©í•˜ì˜€ëŠ”ë°ìš”, í˜„ì¬ ì‚¬ìš©ì¤‘ì¸ actionì´ í•˜ë‚˜ë¿ì´ë¼ ë¬¸ì œê°€ ì—†ì§€ë§Œ ë‹¤ìˆ˜ì˜ actionì´ ì¡´ì¬í•˜ëŠ” ê²½ìš° async_cancel_goal ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤. void feedback_callback(GoalHandleParking::SharedPtr, const std::shared_ptr\u0026lt;const Parking::Feedback\u0026gt; feedback){ RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Received feedback: %f\u0026#34;, feedback-\u0026gt;distance); if(feedback-\u0026gt;distance \u0026gt; 6.0) m_action_client-\u0026gt;async_cancel_all_goals(); } Description async_cancel_goal(goal_handler) async_cancel_goalÂ (typename GoalHandle::SharedPtr goal_handle,Â CancelCallbackÂ cancel_callback=nullptr) async_cancel_all_goals() async_cancel_all_goalsÂ (CancelCallbackÂ cancel_callback=nullptr) result_callbackì€ WrappedResultë¼ëŠ” 1ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ê°–ìŠµë‹ˆë‹¤. goal resultë¥¼ ë‹¤ë£¨ê¸° ìœ„í•œ ë³„ë„ì˜ ê°ì²´ì´ë©°, ResultCodeë¼ëŠ” enum typeì„ ê°–ê³  ìˆìŠµë‹ˆë‹¤. void result_callback(const GoalHandleParking::WrappedResult \u0026amp; result){ switch (result.code) { case rclcpp_action::ResultCode::SUCCEEDED: break; case rclcpp_action::ResultCode::ABORTED: RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Goal was aborted\u0026#34;); return; case rclcpp_action::ResultCode::CANCELED: RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Goal was canceled\u0026#34;); return; default: RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Unknown result code\u0026#34;); return; } RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Result received: %s\u0026#34;, result.result-\u0026gt;message.c_str()); rclcpp::shutdown(); } Enumerator UNKNOWNÂ SUCCEEDEDÂ CANCELEDÂ ABORTEDÂ ì´ë²ˆ ì˜ˆì‹œì—ì„œë„ mainë¬¸ì—ì„œ send_goalì„ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ ìŠì§€ ë§ˆì„¸ìš”.\n"
},
{
	"uri": "/kr/ros2_foxy/lecture10/",
	"title": "Lecture10. TF and ROS 2",
	"tags": [],
	"description": "",
	"content": "Introduction to tf2 ëŒ€ë¶€ë¶„ì˜ ë¡œë³´í‹±ìŠ¤ ê³¼ì •ë“¤ì—ì„œ ê°€ì¥ ë¨¼ì € ë‹¤ë£¨ëŠ” ê²ƒì´ ë°”ë¡œ ì¢Œí‘œê³„ ë³€í™˜ - Transformationì…ë‹ˆë‹¤. ë¡œë´‡ì€ ìˆ˜ë§ì€ jointì™€ linkë¡œ ì´ë£¨ì–´ì ¸ ìˆìœ¼ë©°, ì„¼ì„œì™€ ì›€ì§ì„ì„ ë‹¤ë£¨ê¸° ë•Œë¬¸ì— ì¢Œí‘œê³„ë¥¼ ë‹¤ë£¨ëŠ” ì¼ì´ ë§¤ìš° ë¹ˆë²ˆí•©ë‹ˆë‹¤.\nROS 2ì—ì„œëŠ” TF2ë¼ëŠ” íŠ¹ìˆ˜í•œ í˜•íƒœë¡œ ì´ ì¢Œí‘œê³„ì™€ ì‹œê°„ì„ í•¨ê»˜ ë‹¤ë£¨ê³  ìˆìŠµë‹ˆë‹¤. ì˜ˆì‹œì™€ ì„¤ëª…ì„ í†µí•´ ROS 2ì˜ TF2ì— ëŒ€í•´ ë°°ì›Œë´…ì‹œë‹¤ ğŸ˜Š\nimage from : eth robot dynamics lecture notes Husky Again ì¼ì „ husky ì˜ˆì‹œë¥¼ í†µí•´ tf2ì— ëŒ€í•œ ê°œìš”ì„ íŒŒì•…í•´ë³´ê³ ì í•©ë‹ˆë‹¤.\n# Terminal 1 - husky gazebo ros2 launch husky_gazebo husky_playpen.launch.py # Terminal 2 - rviz rviz2 â‡’ rvizì—ì„œ ë³´ì´ëŠ” ì„¸ê°€ì§€ ìƒ‰ìƒì˜ ë§‰ëŒ€ê°€ ë°”ë¡œ tf2 ì…ë‹ˆë‹¤. x,y,zì˜ ê° ì¶•ì„ ê°ê¸° ë‹¤ë¥¸ ìƒ‰ìœ¼ë¡œ í‘œí˜„í•˜ì˜€ìœ¼ë©°, ì—°ê´€ëœ ì¢Œí‘œê³„ë¼ë¦¬ëŠ” ë…¸ë€ ì„ ì„ í†µí•´ ì—°ê²°í•œ ëª¨ìŠµì´ ë³´ì…ë‹ˆë‹¤.\nrviz2 í™”ë©´ì—ì„œ fixed frameì„ ë³€ê²½í•´ë³´ë©´, ëª¨ë“  ë°ì´í„°, ì¢Œí‘œë“¤ì˜ ì›ì ì´ ë°”ë€ŒëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. â‡’ ì´ë ‡ê²Œ ì¢Œí‘œë³€í™˜ì— ë”°ë¥¸ ë°ì´í„° ì‹œê°í™”ê°€ ê°€ëŠ¥í•˜ë ¤ë©´ ëª¨ë“  ì¢Œí‘œê³„ë“¤ ì‚¬ì´ì˜ íšŒì „, í‰í–‰ ì´ë™ ë³€í™˜ ì •ë³´ë¥¼ ì•Œê³  ìˆì–´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤. ROS 2ì—ì„œ ì´ë¥¼ ì–´ë–»ê²Œ ë‹¤ë£° ìˆ˜ ìˆëŠ”ì§€ ë˜ í•˜ë‚˜ì˜ ì˜ˆì‹œë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nTF2 Tree tf2 view frame - ì´ì „ huskyëŠ” ì‹¤í–‰ ìƒíƒœë¡œ ìœ ì§€í•©ë‹ˆë‹¤. # Terminal1 - husky gazebo ros2 launch husky_gazebo husky_playpen.launch.py # Terminal2 - tf2 view frame cd ~/ros2_ws ros2 run tf2_tools view_frames.py ì•½ 5ì´ˆê°„ ëŒ€ê¸° í›„, í´ë”ë¥¼ ì¡°íšŒí•´ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ tree ì‚¬ì§„ì´ ì €ì¥ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. treeë¥¼ í™•ëŒ€í•´ì„œ ì‚´í´ë´…ì‹œë‹¤.\nëª¨ë“  nodeë“¤ë¼ë¦¬ëŠ” í•˜ë‚˜ì˜ ì—°ê²° ìƒíƒœë¥¼ ê°–ìŠµë‹ˆë‹¤. rviz2ì˜ fixed frameì—ì„œëŠ” ë°”ë¡œ ì´ nodeë¥¼ ì„ íƒí–ˆë˜ ê²ƒì…ë‹ˆë‹¤. í•´ë‹¹ ì—°ê²°ì„ ë‹´ë‹¹í•˜ëŠ” Broadcaster ì •ë³´, í‰ê·  rate, buffer length ë“±ì˜ ì •ë³´ë¥¼ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë§Œì•½ tf treeê°€ ì˜¨ì „íˆ ì—°ê²°ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´ ì–´ë–¤ ì¼ì´ ë°œìƒí• ê¹Œìš”?\nâ‡’ tf2ê°„ ì—°ê²°ì´ ëŠì–´ì§€ê²Œ ë˜ë©´, ëŠì–´ì§„ ì•„ë˜ ì‹œì ì— ëŒ€í•´ì„œëŠ” ê·¸ ì–´ë– í•œ ì •ë³´ë„ ì•Œ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ rviz2ì—ì„œì˜ ì‹œê°í™”ë‚˜, SLAM, ììœ¨ì£¼í–‰ ì‹œ ì´ëŠ” í° ë¬¸ì œê°€ ë©ë‹ˆë‹¤.\në”ë¶ˆì–´, tf2ê°€ ì œëŒ€ë¡œ ì—°ê²°ë˜ì–´ ìˆë”ë¼ê³  ì •í™•í•œ ì‹œê°„ê³¼ ì •í™•í•œ ì¢Œí‘œ ë³€í™˜ì„ ê°–ëŠ” ê²ƒì´ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë¼ì´ë‹¤ì˜ tfë¥¼ 180ë„ ë°˜ëŒ€ë¡œ ì„¤ì •í•´ë²„ë¦¬ë©´ í›„ë°©ì— ìˆëŠ” ì¥ì• ë¬¼ì„ ì „ë°© ì¥ì• ë¬¼ë¡œ ì˜ëª» ì¸ì‹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. image from : answers.ros.org\në•Œë¬¸ì— sensor topic messageë“¤ì€ ê³µí†µì ìœ¼ë¡œ tf2 ì •ë³´ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. $ ros2 interface show sensor_msgs/msg/PointCloud2 **std_msgs/Header header** uint32 height uint32 width sensor_msgs/PointField[] fields bool is_bigendian uint32 point_step uint32 row_step uint8[] data bool is_dense $ ros2 interface show std_msgs/msg/Header uint32 seq time stamp string frame_id â‡’ frame_idì™€ stampì´ ë°”ë¡œ tf2ì™€ ê´€ë ¨ëœ ë°ì´í„°ë¡œ ì´ë ‡ê²Œ ì„¼ì„œ ë°ì´í„°ë“¤ì€ ëŒ€ë¶€ë¶„ ì¢Œí‘œì™€ ì‹œê°„ì— ëŒ€í•œ ì •ë³´ë¥¼ í¬í•¨í•˜ê²Œ ë©ë‹ˆë‹¤.\nì´ë²ˆ ì‹œê°„ì—ëŠ” í¬ê²Œ 3ê°€ì§€ ì˜ˆì‹œë¥¼ í†µí•´ tf2ì— ëŒ€í•´ í•™ìŠµí•  ì˜ˆì •ì…ë‹ˆë‹¤.\nstatic transform â‡’ ì›€ì§ì´ì§€ ì•ŠëŠ” ì¢Œí‘œê³„ tf2 broadcast â‡’ tf2 ë°ì´í„°ì˜ ì†¡ì‹  tf2 listen â‡’ tf2 ë°ì´í„°ì˜ ìˆ˜ì‹  topic publishë¥¼ í•˜ëŠ”ë° ì™œ ë˜ tf2 boradcastê°€ í•„ìš”í• ê¹Œìš”?\nâ‡’ ë°”ë¡œ ìœ„ ì˜ˆì‹œì²˜ëŸ¼ topicì— ë‹´ê¸´ ì •ë³´ëŠ” ì‹¤ì œ ì¢Œí‘œë³€í™˜ì´ ì•„ë‹Œ, frame idì…ë‹ˆë‹¤. ì´ëŠ” topic dataë¥¼ ë°›ì€ subscriber node ì…ì¥ì—ì„œ ì„¼ì„œ ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ìƒí™©ì„ ìƒê°í•´ë³´ë©´ ì´í•´í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.\ntopic sub sub msgë‚´ frame id í™•ì¸ tf2 ë°ì´í„°ì—ì„œ í•´ë‹¹ frameì˜ ë³€í™˜ listen ì´í›„ ë¡œì§ êµ¬í˜„ ê·¸ëŸ¼, ì˜ˆì‹œì™€ ì½”ë“œë¥¼ í†µí•´ tf2ë¥¼ ë§ˆìŠ¤í„°í•´ë´…ì‹œë‹¤!\nstatic broadcaster Orbit World tf2ì˜ í•™ìŠµì„ ìœ„í•´ gazebo í™˜ê²½ì„ ë§Œë“¤ì–´ ë‘ì—ˆìŠµë‹ˆë‹¤. í•¨ê»˜ ì‹¤í–‰í•´ë´…ì‹œë‹¤.\ncd ~/ros2_ws cbp tf2_world \u0026amp;\u0026amp; source install/local_setup.bash ros2 launch tf2_world tf2_world.launch.py ë§ˆì¹˜ í–‰ì„±ê³¼ ìœ„ì„± ê°™ì€ í™˜ê²½ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\ní˜„ ìƒí™©ì—ì„œ tf2 treeë¥¼ ì¡°íšŒí•´ë´…ì‹œë‹¤. ros2 run tf2_tools view_frames.py tf2 ë°ì´í„°ëŠ” ì•„ë¬´ê²ƒë„ ì—†ì§€ìš”? ì´ë²ˆ ì‹œê°„ì˜ ëª©í‘œëŠ” ìš°ë¦¬ê°€ ì§ì ‘ ì½”ë”©ê³¼ launch fileì„ í†µí•´ treeë¥¼ êµ¬ì„±í•´ ë³´ëŠ” ê²ƒì…ë‹ˆë‹¤.\nlaunch file ì‹¤í–‰ í„°ë¯¸ë„ì„ ìì„¸íˆ ì‚´í´ë³´ë©´, ì•„ë˜ì™€ ê°™ì€ ë¬¸êµ¬ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. [gzserver-1] [INFO] [1681981785.437867364] [gazebo_ros_state]: Publishing states of gazebo models at [/model_states] [gzserver-1] [INFO] [1681981785.438120429] [gazebo_ros_state]: Publishing states of gazebo links at [/link_states] í˜„ gazebo í™˜ê²½ì—ì„œì˜ ì¡´ì¬í•˜ëŠ” ëª¨ë“  ëª¨ë¸ì˜ stateë¥¼ /model_state topicì„ í†µí•´ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. topic monitorë¥¼ í†µí•´ ì‚´í´ë´…ì‹œë‹¤. static transform publisher image from : theegeek ì›€ì§ì´ì§€ ì•ŠëŠ” static objectì˜ tf2 ë°ì´í„°ëŠ” static transform publisherê°€ ë‹´ë‹¹í•©ë‹ˆë‹¤. ë•ë¶„ì— ìš°ë¦¬ëŠ” êµ³ì´ ì½”ë”©ì„ í•˜ì§€ ì•Šì•„ë„ ë¯¸ë¦¬ ì¤€ë¹„ëœ nodeë¥¼ ì‹¤í–‰í•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.\nlaunch fileì„ í†µí•´ static transform publisherë¥¼ ì‚¬ìš©í•´ë´…ì‹œë‹¤. static_transform_publisher = Node( package = \u0026#34;tf2_ros\u0026#34;, executable = \u0026#34;static_transform_publisher\u0026#34;, arguments = [\u0026#34;0\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;0.5\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;world\u0026#34;, \u0026#34;unit_sphere\u0026#34;], ) return LaunchDescription( [ static_transform_publisher, ] ) argumentsì— ë“¤ì–´ê°€ëŠ” ë§¤ê°œë³€ìˆ˜ë“¤ì€ ìˆœì„œëŒ€ë¡œ (x y z roll pitch yaw parent_frame child_frame)ì´ ë©ë‹ˆë‹¤. â‡’ world frame ê¸°ì¤€ unit_sphere frameë¥¼ zì¶•ìœ¼ë¡œ 0.5ë§Œí¼ ë–¨ì–´ëœ¨ë ¤ tf2 dataê°€ ìƒì„±ë©ë‹ˆë‹¤.\në¡œë´‡ ê°œë°œìë“¤ì€ ì•”ë¬µì ìœ¼ë¡œ ëª¨ë“  ìƒí™©ì˜ ì›ì ì´ ë˜ëŠ” ì ˆëŒ€ ì¢Œí‘œê³„ë¥¼ world frameì´ë¼ê³  ì •í•©ë‹ˆë‹¤.\në‹¤ì‹œ í•œ ë²ˆ tf2 treeë¥¼ ì‚´í´ë´…ì‹œë‹¤ ros2 run tf2_tools view_frames.py â‡’ world to unit_sphere tfê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\nì´ì œ rviz2 í™”ë©´ì„ í†µí•´ì„œë„ tf2ë¥¼ ì‹œê°í™” í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì›€ì§ì´ì§€ ì•ŠëŠ” ë¬¼ì²´ ë¿ë§Œ ì•„ë‹ˆë¼, ë¡œë´‡ ë‚´ë¶€ì—ì„œ ê³ ì •ëœ ë¶€ë¶„ì—ì„œë„ static_transform_publisherë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìì£¼ íƒˆë¶€ì°©ë˜ëŠ” ì„¼ì„œ frameì´ ëŒ€í‘œì ì¸ ì˜ˆì‹œì…ë‹ˆë‹¤.\nimage from : articulatedrobotics TF2 Broadcaster \u0026amp; Lisenter \u0026amp; Add frame ì§€ë‚œ ê°•ì˜ì—ì„œ ê³ ì •ëœ ë¬¼ì²´ì— ëŒ€í•œ tf2 ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ë²ˆ ì‹œê°„ë¶€í„° tf2ë¥¼ ë‹¤ë£¨ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•´ ë³´ê² ìœ¼ë©°, ìµœì¢…ì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì€ ì‹œìŠ¤í…œì„ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.\nTF2 Python Programming TF2 Broadcaster (Python) topicì—ì„œëŠ” publish/subscribeë¼ëŠ” ìš©ì–´ë¥¼ ì‚¬ìš©í•˜ì˜€ì§€ë§Œ tf2ì—ì„œëŠ” broadcast/listenì´ë¼ëŠ” ìš©ì–´ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. topicê³¼ tf2ëŠ” ì™„ì „ ë³„ê°œì˜ ê°œë…ì…ë‹ˆë‹¤! í˜¼ë€ë˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•˜ì„¸ìš”.\nìš°ì„ , ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. # Terminal1 - gazebo ros2 launch tf2_world tf2_world.launch.py # Terminal2 - tf2 broadcaster cbp py_tf2_tutorial \u0026amp;\u0026amp; source install/local_setup.bash ros2 run py_tf2_tutorial tf2_broadcaster rviz2ë¥¼ í†µí•´ ì›€ì§ì´ëŠ” êµ¬ì˜ tf2ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ì´ë²ˆ ì˜ˆì œì˜ ëª©í‘œì…ë‹ˆë‹¤. ì½”ë“œ ë¶„ì„ ì´ì „ ê°•ì˜ì—ì„œ gazebo ë‚´ ëª¨ë“  ë¬¼ì²´ë“¤ì˜ ì •ë³´ë¥¼ ë‹´ì€ /model_state topicì„ ì‚´í´ë³¸ ë°” ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì½”ë“œ êµ¬í˜„ì— ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì •ë³´ë¥¼ ì¡°íšŒí•´ë´…ì‹œë‹¤. $ ros2 interface show gazebo_msgs/msg/ModelStates # broadcast all model states in world frame string[] name # model names geometry_msgs/Pose[] pose # desired pose in world frame geometry_msgs/Twist[] twist # desired twist in world frame â‡’ ì´ ëª¨ì–‘ì„ ê¸°ì–µí•˜ë©´ì„œ ì½”ë“œë¡œ ì§„ì…í•´ë³´ê² ìŠµë‹ˆë‹¤.\në”ë¶ˆì–´, tf2ì˜ ë°ì´í„° íƒ€ì…ì€ geometry_msgs/msg/TransformStamped ì…ë‹ˆë‹¤. â‡’ link $ ros2 interface show geometry_msgs/msg/TransformStamped # This expresses a transform from coordinate frame header.frame_id # to the coordinate frame child_frame_id # # This message is mostly used by the # tf package. # See its documentation for more information. Header header string child_frame_id # the frame id of the child frame Transform transform ì½”ë“œë¡œ ëŒì•„ì™€ import ë¶€ë¶„ì…ë‹ˆë‹¤. tf2 ë°ì´í„°ë¥¼ ë‹¤ë£¨ê¸° ìœ„í•œ íŒ¨í‚¤ì§€ì¸ tf2_ros, ModelStates ë°ì´í„° íƒ€ì…ì„ importí•©ë‹ˆë‹¤. import rclpy from rclpy.node import Node from tf2_ros import TransformBroadcaster from gazebo_msgs.msg import ModelStates from geometry_msgs.msg import TransformStamped ìš°ë¦¬ì˜ ëª©í‘œë¥¼ ì •ë¦¬í•´ë´…ì‹œë‹¤. model_state topicì—ì„œ ì›€ì§ì´ëŠ” ë¬¼ì²´ì˜ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤. í•´ë‹¹ ë°ì´í„°ë¥¼ ì •ì œí•˜ì—¬ TF2ì˜ í˜•íƒœë¡œ ë³€í˜•í•œ ë’¤ broadcast í•©ë‹ˆë‹¤. â‡’ ë”°ë¼ì„œ topic subê³¼ tf2 broadcastê°€ í•„ìš”í•œ ìƒí™©ì…ë‹ˆë‹¤.\nclass OrbitBroadcaster(Node): def __init__(self): super().__init__(\u0026#39;tf2_frame_broadcaster\u0026#39;) # Initialize the transform broadcaster self.tf_broadcaster = TransformBroadcaster(self) # Subscribe to a turtle{1}{2}/pose topic and call handle_turtle_pose # callback function on each message self.m_model_state_sub = self.create_subscription( ModelStates, \u0026#34;model_states\u0026#34;, self.handle_turtle_pose, 1 ) ì½”ë“œì˜ í•µì‹¬ì€ sub callbackì— ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤. model_state msgì¤‘ ìš°ë¦¬ê°€ ì›í•˜ëŠ” animated_sphereì˜ ì •ë³´ë¥¼ íŒŒì‹±í•˜ì—¬ TransformStamped msgì— ì§‘ì–´ë„£ì€ ë’¤, broadcast í•©ë‹ˆë‹¤. def handle_turtle_pose(self, msg): index = [i for i in range(len(msg.name)) if msg.name[i] == \u0026#34;animated_sphere\u0026#34;][0] t = TransformStamped() # Read message content and assign it to # corresponding tf variables t.header.stamp = self.get_clock().now().to_msg() t.header.frame_id = \u0026#39;world\u0026#39; t.child_frame_id = \u0026#39;animated_sphere\u0026#39; t.transform.translation.x = msg.pose[index].position.x t.transform.translation.y = msg.pose[index].position.y t.transform.translation.z = msg.pose[index].position.z t.transform.rotation.x = msg.pose[index].orientation.x t.transform.rotation.y = msg.pose[index].orientation.y t.transform.rotation.z = msg.pose[index].orientation.z t.transform.rotation.w = msg.pose[index].orientation.w # Send the transformation self.tf_broadcaster.sendTransform(t) tf2 broadcasttë¥¼ ìœ„í•œ APIë¥¼ ì •ë¦¬í•˜ê³  ë„˜ì–´ê°‘ì‹œë‹¤. ë‹¤ì‹œ í•œ ë²ˆ ë§í•˜ì§€ë§Œ topicê³¼ í—·ê°ˆë¦¬ë©´ ì•ˆë©ë‹ˆë‹¤! Description TransformBroadcaster() broadcaster ìƒì„± TransformStamped() tf2 msg ìƒì„± sendTransform(msg) tf2 broadcast TF2 Listener [Python] rqt_monitorë¥¼ í†µí•´ model_state topicì„ ì¡°íšŒí•œ ê²°ê³¼ì…ë‹ˆë‹¤. poseëŠ” ì˜ ë³´ì´ëŠ”ë°, ì†ë„ ë°ì´í„°ì¸ twistëŠ” ë¹„ì–´ìˆëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. â‡’ TF2 Listenerë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë¥¼ êµ¬í˜„í•´ë´…ì‹œë‹¤!\nì˜ˆì‹œ ì‹¤í–‰ â‡’ ì„ ì†ë„ì™€ ê°ì†ë„ë¥¼ ì½˜ì†”ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. # Terminal1 - gazebo $ ros2 launch tf2_world tf2_world.launch.py # Terminal2 - tf2 broadcaster $ ros2 run py_tf2_tutorial tf2_broadcast # Terminal3 - tf2 listener $ ros2 run py_tf2_tutorial tf2_listener [INFO] [1681998128.822169076] [tf2_frame_listener]: linear vel : 2.542703, angular vel : 1.810120 [INFO] [1681998128.922124745] [tf2_frame_listener]: linear vel : 2.501199, angular vel : 1.610775 ... ì½”ë“œì˜ import ë¶€ë¶„ì…ë‹ˆë‹¤. tf2 listenì„ ìœ„í•´ TransformListenerì™€ Bufferë¥¼ importí•˜ê³  ìˆìŠµë‹ˆë‹¤. import math from geometry_msgs.msg import Twist import rclpy from rclpy.node import Node from tf2_ros import TransformException from tf2_ros.buffer import Buffer from tf2_ros.transform_listener import TransformListener í˜„ì¬ ìš°ë¦¬ê°€ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ì‘ì—…ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. tf2 ë°ì´í„° listen â‡’ ì´ë¥¼ í†µí•´ ì›€ì§ì´ëŠ” ë¬¼ì²´ì˜ ì¢Œí‘œ ë³€í™”ë¥¼ ê°ì§€í•©ë‹ˆë‹¤. ì†ë„ ê³„ì‚° â‡’ ìœ„ì¹˜ë¥¼ í†µí•´ ì„ ì†ë„ì™€ ê°ì†ë„ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤. topic publish class TF2Listener(Node): def __init__(self): super().__init__(\u0026#39;tf2_frame_listener\u0026#39;) self.tf_buffer = Buffer() self.tf_listener = TransformListener(self.tf_buffer, self) # Create turtle2 velocity publisher self.publisher = self.create_publisher(Twist, \u0026#39;sphere_vel\u0026#39;, 10) # Call timer_cb function every 10 seconds self.timer = self.create_timer(0.1, self.timer_cb) â‡’ TransformListenerì˜ ìƒì„± ì´í›„, ëª¨ë“  tf2ì˜ listenì„ ì‹œì‘í•˜ë©´ ì´ë¥¼ Bufferì— ë‹´ì•„ë‘ëŠ” ì‹ì…ë‹ˆë‹¤.\nâ‡’ ì£¼ê¸°ì ìœ¼ë¡œ listen, publishë¥¼ ìœ„í•´ timerë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\në‹¤ìŒìœ¼ë¡œ, timer_cb í•¨ìˆ˜ë¥¼ ëœ¯ì–´ë´…ì‹œë‹¤.\ntf2 listenì„ ìœ„í•´ lookup_transformì´ë¼ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©° 3ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤. Target frame Source frame time from_frame_rel = \u0026#39;animated_sphere\u0026#39; to_frame_rel = \u0026#39;world\u0026#39; try: t = self.tf_buffer.lookup_transform( from_frame_rel, to_frame_rel, rclpy.time.Time()) except TransformException as ex: self.get_logger().info( f\u0026#39;Could not transform {to_frame_rel} to {from_frame_rel}: {ex}\u0026#39;) return tf2 ë°ì´í„°ì—ì„œ ìš°ë¦¬ê°€ ì›í•˜ëŠ” ì†ë„ë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ ê°„ë‹¨í•œ ì—°ì‚°ì„ ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤. msg = Twist() scale_rotation_rate = 1.0 msg.angular.z = scale_rotation_rate * math.atan2( t.transform.translation.y, t.transform.translation.x) scale_forward_speed = 0.5 msg.linear.x = scale_forward_speed * math.sqrt( t.transform.translation.x ** 2 + t.transform.translation.y ** 2) ìµœì¢… ì™„ì„±ëœ Twist msgë¥¼ publish í•©ë‹ˆë‹¤. self.get_logger().info(f\u0026#34;linear_vel: {msg.linear.x}, angular_vel: {msg.angular.z}\u0026#34;) self.publisher.publish(msg) â‡’ í˜„ì¬ ì˜ˆì‹œì´ë¯€ë¡œ ì •í™•í•œ 3ì°¨ì› ì†ë„ë¥¼ ê³„ì‚°í•˜ì§€ëŠ” ì•Šì•˜ì§€ë§Œ, gazeboì˜ model_state ë°ì´í„°ì— ê¸°ë°˜í•˜ì—¬ í™˜ê²½ì˜ ground_truthë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nTF2 Add Frame (Python) tf2 êµ¬í˜„ì˜ ë§ˆì§€ë§‰ ì˜ˆì‹œì…ë‹ˆë‹¤. # Terminal1 - gazebo $ ros2 launch tf2_world tf2_world.launch.py # Terminal2 - tf2 broadcaster $ ros2 run py_tf2_tutorial tf2_broadcast # Terminal3 - tf2 add frame $ ros2 run py_tf2_tutorial tf2_add_frame animated_sphereì˜ ì£¼ìœ„ë¥¼ ìœ„ì„±ì²˜ëŸ¼ ê¶¤ë„ ìš´ë™í•˜ëŠ” ìƒˆë¡œìš´ frameì´ ë³´ì…ë‹ˆë‹¤. â‡’ ì´ë²ˆ ì˜ˆì‹œëŠ” ìƒˆë¡œìš´ dynamic frameì„ ì¶”ê°€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì¼ì „ ì •ì  frameì€ ì¼ì „ launch fileì—ì„œ static_transform_publisherë¥¼ ì‚¬ìš©í•˜ì˜€ì§€ìš”? dynamics frameì€ ì½”ë“œë¡œ êµ¬í˜„í•´ë³´ê² ìŠµë‹ˆë‹¤.\ntf2 ë°ì´í„°ë¥¼ broadcastí•´ì•¼ í•˜ëŠ” ê²ƒì€ ì¼ì „ ì˜ˆì‹œì™€ ë™ì¼í•©ë‹ˆë‹¤. ë”°ë¼ì„œ importì™€ ìƒì„±ì ë¶€ë¶„ì— ëŒ€í•œ ì„¤ëª…ì€ ìƒëµí•˜ê² ìŠµë‹ˆë‹¤. import rclpy import numpy as np from rclpy.node import Node from tf2_ros import TransformBroadcaster from geometry_msgs.msg import TransformStamped class InverOrbitFrame(Node): def __init__(self): super().__init__(\u0026#39;inverse_orbit_frame_tf2_broadcaster\u0026#39;) self.count = 0 self.freq_factor = 2* np.pi / 20; self.tf_broadcaster = TransformBroadcaster(self) self.timer = self.create_timer(0.1, self.broadcast_timer_callback) timerì— ì˜í•´ ë°˜ë³µ ì‹¤í–‰ë˜ëŠ” callback í•¨ìˆ˜ë¥¼ ì‚´í´ë´…ì‹œë‹¤. â‡’ animated_sphereì„ ê¸°ì¤€ìœ¼ë¡œ ì› ìš´ë™ì„ í•˜ëŠ” ìƒˆë¡œìš´ frameì„ ë§Œë“œëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤. ë”°ë¼ì„œ (cos(theta), sin(theta))ì˜ ì¢Œí‘œë¥¼ ê°–ëŠ” tf2 dataë¥¼ êµ¬ì¶•í•˜ê³  ì´ë¥¼ ì‹œê°„ì— ë”°ë¼ broadcast í•˜ì˜€ìŠµë‹ˆë‹¤.\ndef broadcast_timer_callback(self): t = TransformStamped() t.header.stamp = self.get_clock().now().to_msg() t.header.frame_id = \u0026#39;animated_sphere\u0026#39; t.child_frame_id = \u0026#39;inverse_orbit_frame\u0026#39; t.transform.translation.x = np.cos(-self.count * self.freq_factor) t.transform.translation.y = np.sin(-self.count * self.freq_factor) t.transform.translation.z = 0.5 t.transform.rotation.x = 0.0 t.transform.rotation.y = 0.0 t.transform.rotation.z = 0.0 t.transform.rotation.w = 1.0 self.tf_broadcaster.sendTransform(t) self.count += 1 if self.count \u0026gt;= 20: self.count = 0 TF2 C++ Programming TF2 Broadcaster (C++) ì‹¤ì œ ê°œë°œì—ì„œ tf2 ë°ì´í„°ëŠ” ì‹¤ì‹œê°„ì„±ì´ ë¬´ì²™ ì¤‘ìš”í•œ ì¢Œí‘œë³€í™˜ì„ ë‹¤ë£¨ë¯€ë¡œ, c++ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ë¹„ì¤‘ì´ ë” í½ë‹ˆë‹¤. ë”°ë¼ì„œ, ìš°ì„  ëª¨ë“  ì˜ˆì‹œë¥¼ ì‚´í´ë³´ê³  ì„¼ì„œ íŒ¨í‚¤ì§€ì— ê¸°ë°˜í•˜ì—¬ ì‹¤ ì‚¬ìš© ì‚¬ë¡€ë„ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.\nì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. # Terminal1 - gazebo ros2 launch tf2_world tf2_world.launch.py # Terminal2 - tf2 broadcaster ros2 run cpp_tf2_tutorial tf2_broadcaster rviz2ë¥¼ í†µí•´ ì›€ì§ì´ëŠ” êµ¬ì˜ tf2ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì½”ë“œ ë¶„ì„ ì½”ë“œë¡œ ëŒì•„ì™€ include ë¶€ë¶„ì…ë‹ˆë‹¤. tf2 ë°ì´í„°ë¥¼ ë‹¤ë£¨ê¸° ìœ„í•œ íŒ¨í‚¤ì§€ì¸ tf2_ros, ModelStates ë°ì´í„° íƒ€ì…ì„ importí•©ë‹ˆë‹¤. #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; #include \u0026#34;tf2/LinearMath/Quaternion.h\u0026#34; #include \u0026#34;tf2_ros/transform_broadcaster.h\u0026#34; #include \u0026#34;gazebo_msgs/msg/model_states.hpp\u0026#34; #include \u0026#34;geometry_msgs/msg/transform_stamped.hpp\u0026#34; tf_broadcasterë¥¼ ì´ˆê¸°í™”í•˜ëŠ” ì½”ë“œ APIì—ì„œ unique_ptrì´ ì‚¬ìš©ë©ë‹ˆë‹¤. ê°œë°œìì˜ ì‹¤ìˆ˜ë¡œ tf2_broadcasterê°€ ì—¬ëŸ¬ê°œ ìƒê¸¸ ì‹œ ì´ë¥¼ ë””ë²„ê¹…í•˜ê¸° í˜ë“¤ì–´ ì‚¬ì „ì— ë°©ì§€í•œ ê²½ìš°ì…ë‹ˆë‹¤. class OrbitBroadcaster : public rclcpp::Node { private: rclcpp::Subscription\u0026lt;ModelStates\u0026gt;::SharedPtr m_model_state_sub; std::unique_ptr\u0026lt;tf2_ros::TransformBroadcaster\u0026gt; m_tf_broadcaster; public: OrbitBroadcaster() : Node(\u0026#34;tf2_frame_broadcaster\u0026#34;){ m_model_state_sub = this-\u0026gt;create_subscription\u0026lt;ModelStates\u0026gt;( \u0026#34;model_states\u0026#34;, 10, std::bind(\u0026amp;OrbitBroadcaster::model_state_sub_cb, this, std::placeholders::_1) ); // Initialize the transform broadcaster m_tf_broadcaster = std::make_unique\u0026lt;tf2_ros::TransformBroadcaster\u0026gt;(*this); } model_states íƒ€ì…ì€ 3ê°œì˜ std::vectorë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ìš°ë¦¬ê°€ ì›í•˜ëŠ” ê°’, animated_sphereì˜ indexë¥¼ ë¨¼ì € ì•Œì•„ë‚¸ ë’¤, pose ë°ì´í„°ë¥¼ íŒŒì‹±í•©ë‹ˆë‹¤. private: void model_state_sub_cb(const ModelStates::ConstSharedPtr msg) { geometry_msgs::msg::TransformStamped t; std::string model_name = \u0026#34;animated_sphere\u0026#34;; auto it = find(msg-\u0026gt;name.begin(), msg-\u0026gt;name.end(), model_name); auto index = it - msg-\u0026gt;name.begin(); ì´ë²ˆ ì½”ë“œì—ì„œ ë‹¤ë£¨ì§€ëŠ” ì•Šì§€ë§Œ, tf2ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì˜¤ì¼ëŸ¬ ê°ë„ ì²´ê³„ê°€ ì•„ë‹Œ ì¿¼í„°ë‹ˆì–¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì˜¤ì¼ëŸ¬ ê°ë„ â‡’ ì¿¼í„°ë‹ˆì–¸ì˜ ë³€í™˜ê³¼ ê°™ì€ APIëŠ” tf2 íŒ¨í‚¤ì§€ì— êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. #include \u0026#34;tf2/LinearMath/Quaternion.h\u0026#34; // tf2::Quaternion q; // q.setRPY(0, 0, msg-\u0026gt;theta); t.transform.rotation.x = msg-\u0026gt;pose[index].orientation.x; t.transform.rotation.y = msg-\u0026gt;pose[index].orientation.y; t.transform.rotation.z = msg-\u0026gt;pose[index].orientation.z; t.transform.rotation.w = msg-\u0026gt;pose[index].orientation.w; // Send the transformation m_tf_broadcaster-\u0026gt;sendTransform(t); } cpp ì½”ë“œì¸ë§Œí¼ CMakeLists.txtë„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. find_package(tf2 REQUIRED) find_package(tf2_ros REQUIRED) find_package(gazebo_msgs REQUIRED) find_package(geometry_msgs REQUIRED) add_executable(tf2_broadcast src/tf2_broadcast.cpp) ament_target_dependencies(tf2_broadcast tf2 tf2_ros gazebo_msgs geometry_msgs) tf2 broadcastë¥¼ ìœ„í•œ APIë¥¼ ì •ë¦¬í•˜ê³  ë„˜ì–´ê°‘ì‹œë‹¤. Description std::make_unique\u0026lt;tf2_ros::TransformBroadcaster\u0026gt; broadcaster ìƒì„± geometry_msgs::msg::TransformStamped tf2 msg ìƒì„± tf_broadcaster-\u0026gt;sendTransform(t) tf2 broadcast TF2 Listener (C++) animated_sphereì˜ tf2 listenì„ í†µí•´ ì†ë„ topicì„ publishí•˜ëŠ” ì˜ˆì‹œì˜€ìŠµë‹ˆë‹¤. # Terminal1 - gazebo $ ros2 launch tf2_world tf2_world.launch.py # Terminal2 - tf2 broadcaster $ ros2 run py_tf2_tutorial tf2_broadcast # Terminal3 - tf2 listener $ ros2 run py_tf2_tutorial tf2_listener [INFO] [1681998128.822169076] [tf2_frame_listener]: linear vel : 2.542703, angular vel : 1.810120 [INFO] [1681998128.922124745] [tf2_frame_listener]: linear vel : 2.501199, angular vel : 1.610775 ... ì½”ë“œì˜ include ë¶€ë¶„ì…ë‹ˆë‹¤. tf2 listenì„ ìœ„í•´ tf2_ros/transform_listener.hë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; #include \u0026#34;tf2/exceptions.h\u0026#34; #include \u0026#34;tf2_ros/transform_listener.h\u0026#34; #include \u0026#34;tf2_ros/buffer.h\u0026#34; #include \u0026#34;geometry_msgs/msg/twist.hpp\u0026#34; #include \u0026#34;geometry_msgs/msg/transform_stamped.hpp\u0026#34; using namespace std::chrono_literals; using Twist = geometry_msgs::msg::Twist; using TransformStamped = geometry_msgs::msg::TransformStamped; listenerì˜ ìƒì„± ì‹œ Bufferê°€ í•„ìš”í•œ ë¶€ë¶„ë„ ë™ì¼í•˜ë©°, ëŒ€ì‹ , bufferê°€ unique_ptr íƒ€ì…ì„ ì·¨í•˜ê³  ìˆì–´ pointerê°€ ì•„ë‹Œ valueë¥¼ ì „ë‹¬í•¨ì— ìœ ì˜í•©ë‹ˆë‹¤. public: TF2Listener(): Node(\u0026#34;tf2_frame_listener\u0026#34;){ m_tf_buffer = std::make_unique\u0026lt;tf2_ros::Buffer\u0026gt;(this-\u0026gt;get_clock()); m_tf_listener = std::make_shared\u0026lt;tf2_ros::TransformListener\u0026gt;(*m_tf_buffer); pythonê³¼ ë™ì¼í•˜ê²Œ lookupTransformì€ 3ê°€ì§€ ë§¤ê°œë³€ìˆ˜ë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤. Target frame Source frame time void timer_cb(){ // Store frame names in variables that will be used to // compute transformations TransformStamped t; try { t = m_tf_buffer-\u0026gt;lookupTransform( \u0026#34;animated_sphere\u0026#34;, \u0026#34;world\u0026#34;, tf2::TimePointZero ); TF2 Add Frame (C++) tf2 êµ¬í˜„ì˜ ë§ˆì§€ë§‰ ì˜ˆì‹œì…ë‹ˆë‹¤. # Terminal1 - gazebo $ ros2 launch tf2_world tf2_world.launch.py # Terminal2 - tf2 broadcaster $ ros2 run cpp_tf2_tutorial tf2_broadcast # Terminal3 - tf2 add frame $ ros2 run cpp_tf2_tutorial tf2_add_frame â‡’ tf2 broadcasterì™€ í° ì°¨ì´ê°€ ì—†ìœ¼ë¯€ë¡œ, êµ¬ì²´ì ì¸ ì„¤ëª…ì€ ìƒëµí•˜ê² ìŠµë‹ˆë‹¤.\nTF2 Example ì´ë²ˆ ì‹œê°„ì—ëŠ” ì‹¤ì œ ì„¼ì„œ ë°ì´í„° ROS 2 íŒ¨í‚¤ì§€ì—ì„œ tf2ê°€ ì‚¬ìš©ëœ ëª¨ìŠµì„ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.\në‘ ì„¼ì„œ íŒ¨í‚¤ì§€ë¥¼ ì°¸ê³ í•´ë³´ë ¤ í•©ë‹ˆë‹¤.\nintel realsense ros2 package my ahrs imu package ìš°ì„ , my ahrs ì½”ë“œì…ë‹ˆë‹¤. publishtfë¼ëŠ” ë§¤ê°œë³€ìˆ˜ì— ë”°ë¼ tf2 ë°ì´í„°ì˜ broadcast ì—¬ë¶€ê°€ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ì´ë ‡ê²Œ í•´ë‘” ì´ìœ ëŠ”, ì„¼ì„œ ìì²´ë¥¼ í†µí•œ ê°œë°œ ì‹œì—ëŠ” tf2ì˜ ì‚¬ìš©ì´ í•„ìš” ì—†ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. // publish tf if (publish_tf_) { geometry_msgs::msg::TransformStamped tf; tf.header.stamp = now; tf.header.frame_id = parent_frame_id_; tf.child_frame_id = frame_id_; tf.transform.translation.x = 0.0; tf.transform.translation.y = 0.0; tf.transform.translation.z = 0.0; tf.transform.rotation = imu_data_msg.orientation; broadcaster_-\u0026gt;sendTransform(tf); } â‡’ link1\në‹¤ìŒìœ¼ë¡œ, realsense-ros íŒ¨í‚¤ì§€ì…ë‹ˆë‹¤. ì´ë²ˆì—ë„ ë§ˆì°¬ê°€ì§€ë¡œ, ìƒí™©ì— ë”°ë¼ statics tf / odom tfë¥¼ êµ¬ë³„í•˜ì—¬ êµ¬í˜„í•´ë‘” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. void BaseRealSenseNode::publish_static_tf(const rclcpp::Time\u0026amp; t, const float3\u0026amp; trans, const tf2::Quaternion\u0026amp; q, const std::string\u0026amp; from, const std::string\u0026amp; to) { geometry_msgs::msg::TransformStamped msg; msg.header.stamp = t; msg.header.frame_id = from; msg.child_frame_id = to; // Convert x,y,z (taken from camera extrinsics) // from optical cooridnates to ros coordinates msg.transform.translation.x = trans.z; msg.transform.translation.y = -trans.x; msg.transform.translation.z = -trans.y; msg.transform.rotation.x = q.getX(); msg.transform.rotation.y = q.getY(); msg.transform.rotation.z = q.getZ(); msg.transform.rotation.w = q.getW(); _static_tf_msgs.push_back(msg); } void BaseRealSenseNode::publishStaticTransforms(std::vector\u0026lt;rs2::stream_profile\u0026gt; profiles) { // Publish static transforms if (_publish_tf) { for (auto \u0026amp;profile : profiles) { calcAndPublishStaticTransform(profile, _base_profile); } if (_static_tf_broadcaster) _static_tf_broadcaster-\u0026gt;sendTransform(_static_tf_msgs); } } ... void BaseRealSenseNode::pose_callback(rs2::frame frame) { ... geometry_msgs::msg::PoseStamped pose_msg; pose_msg.pose.position.x = -pose.translation.z; ... static tf2_ros::TransformBroadcaster br(_node); geometry_msgs::msg::TransformStamped msg; msg.header.stamp = t; msg.header.frame_id = DEFAULT_ODOM_FRAME_ID; msg.child_frame_id = FRAME_ID(POSE); msg.transform.translation.x = pose_msg.pose.position.x; msg.transform.translation.y = pose_msg.pose.position.y; msg.transform.translation.z = pose_msg.pose.position.z; msg.transform.rotation.x = pose_msg.pose.orientation.x; msg.transform.rotation.y = pose_msg.pose.orientation.y; msg.transform.rotation.z = pose_msg.pose.orientation.z; msg.transform.rotation.w = pose_msg.pose.orientation.w; if (_publish_odom_tf) br.sendTransform(msg); â‡’ ì°¸ê³  ë§í¬ 1\nâ‡’ ì°¸ê³  ë§í¬ 2\n"
},
{
	"uri": "/kr/ros2_foxy/lecture11/",
	"title": "Lecture11. About Gazebo - 1",
	"tags": [],
	"description": "",
	"content": "URDFì™€ Robot Description ë¡œë´‡ì— ì„¼ì„œë¥¼ ë¶€ì°©í•˜ê³ , ì™¸í˜•ì„ ì •ì˜í•˜ê¸° ìœ„í•´ ê°€ì¥ ê¸°ë³¸ì´ ë˜ëŠ” ê²ƒì´ ë°”ë¡œ URDFì…ë‹ˆë‹¤. ì´ë²ˆ ì‹œê°„, ì‹¤ìŠµì„ í†µí•´ URDFì— ëŒ€í•œ ê°œë…ê³¼ robot desciptionì„ ì‹¤ìŠµí•´ ë³´ê² ìŠµë‹ˆë‹¤.\nì¼ë°˜ì ìœ¼ë¡œ, ë¡œë´‡ì€ Linksì™€ Joints ë‘ê°€ì§€ ìš”ì†Œë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. Description Link ë‹¨ë‹¨í•˜ê²Œ ê³ ì •ëœ ê°•ì²´(rigid-body)ì´ë©°, ì‚¬ëŒì˜ ê³¨ê²©ì— í•´ë‹¹í•©ë‹ˆë‹¤. Joint link ì‚¬ì´ë¥¼ ê²°í•©í•´ì£¼ê³  ì´ë“¤ ì‚¬ì´ ìš´ë™ì„ ê²°ì •ì§“ìŠµë‹ˆë‹¤. ì‚¬ëŒì˜ ê´€ì ˆì— í•´ë‹¹í•©ë‹ˆë‹¤. ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ jointë“¤ì´ ì¡´ì¬í•˜ì§€ë§Œ, ì´ë¡ ì ìœ¼ë¡œ ì´ë“¤ì€ ê²°êµ­ prismatic + revolute jointì˜ ê²°í•©ìœ¼ë¡œ ì„¤ëª…ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nDescription revolute joint íšŒì „ ìš´ë™ì„ ê°–ëŠ” joint prismatic joint ìˆ˜í‰ ë³‘ì§„ ìš´ë™ì„ ê°–ëŠ” joint â‡’ ROS 2ì—ì„œëŠ” ê°œë°œ ìƒ í¸ì˜ë¥¼ ìœ„í•´ í¬ê²Œ 6ê°€ì§€ì˜ jointë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤ë§Œ ê·¸ë¦¼ìœ¼ë¡œë§Œ ë³´ê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.\nLinkì™€ Jointë¡œ ê²°í•©ëœ ë¡œë´‡ì„ ê²°êµ­ í…ìŠ¤íŠ¸ë¡œ í‘œí˜„í•  ìˆ˜ ìˆì§€ ì•Šê² ëƒëŠ” ê¸°ë³¸ ì „ì œ í•˜ì—, ë¡œë´‡ ê³µí•™ìë“¤ì€ **URDF(Unified Robot Description Format)**ë¼ëŠ” í‘œì¤€ì„ ë§Œë“¤ê²Œ ë©ë‹ˆë‹¤. ì‹¤ì œë¡œ urdfë§Œ ìˆë‹¤ë©´ ì‹œë®¬ë ˆì´í„° ì¢…ë¥˜ì— ìƒê´€ ì—†ì´ ë™ì¼í•œ ë¡œë´‡ ì™¸í˜•ì„ ë“±ì¥ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. image from : Martin Androvich\nâ‡’ URDFëŠ” XML ë¬¸ë²•ì„ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë©° ë‹¤ì–‘í•œ tagë¥¼ í†µí•´ ë¡œë´‡ì„ í‘œí˜„í•˜ê²Œ ë©ë‹ˆë‹¤. ì˜ˆì‹œë¥¼ í†µí•´ URDFì— ëŒ€í•œ ì´í•´ë„ë¥¼ ê°€ì ¸ë´…ì‹œë‹¤.\nURDF Link Example \u0026lt;link name=\u0026#34;base_link\u0026#34;\u0026gt; \u0026lt;inertial\u0026gt; \u0026lt;origin xyz=\u0026#34;0 0 0\u0026#34; rpy=\u0026#34;0 0 0\u0026#34; /\u0026gt; \u0026lt;mass value=\u0026#34;8.3\u0026#34; /\u0026gt; \u0026lt;inertia ixx=\u0026#34;5.249466E+13\u0026#34; ixy=\u0026#34;-1.398065E+12\u0026#34; ixz=\u0026#34;-3.158592E+12\u0026#34; iyy=\u0026#34;5.786727E+13\u0026#34; iyz=\u0026#34;-5.159120E+11\u0026#34; izz=\u0026#34;3.114993E+13\u0026#34; /\u0026gt; \u0026lt;/inertial\u0026gt; \u0026lt;visual\u0026gt; \u0026lt;origin xyz=\u0026#34;0 0 0\u0026#34; rpy=\u0026#34;0 3.1415 3.1415\u0026#34; /\u0026gt; \u0026lt;geometry\u0026gt; \u0026lt;mesh filename=\u0026#34;package://neuronbot2_description/meshes/neuronbot2/base_link.stl\u0026#34; scale=\u0026#34;0.001 0.001 0.001\u0026#34; /\u0026gt; \u0026lt;/geometry\u0026gt; \u0026lt;material name=\u0026#34;black\u0026#34; /\u0026gt; \u0026lt;/visual \u0026lt;collision\u0026gt; \u0026lt;origin xyz=\u0026#34;0 0 0.125\u0026#34; rpy=\u0026#34;0 0 0\u0026#34; /\u0026gt; \u0026lt;geometry\u0026gt; \u0026lt;box size=\u0026#34;0.25 0.25 0.25\u0026#34; /\u0026gt; \u0026lt;/geometry\u0026gt; \u0026lt;material name=\u0026#34;black\u0026#34; /\u0026gt; \u0026lt;/collision\u0026gt; \u0026lt;/link\u0026gt; Description inertial í•´ë‹¹ linkì˜ ì§ˆëŸ‰, ê´€ì„± ëª¨ë©˜íŠ¸ì™€ ê°™ì€ ë¬¼ì„±ì¹˜ë¥¼ í¬í•¨í•©ë‹ˆë‹¤. visual ë¡œë´‡ì´ ê²‰ìœ¼ë¡œ ë³´ì—¬ì§€ëŠ” ì‹œê°ì ì¸ ìš”ì†Œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. STLê³¼ ê°™ì€ 3D ëª¨ë¸ë§ íŒŒì¼ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. collision visualì€ ê²‰ìœ¼ë¡œ ë³´ì—¬ì§€ëŠ” ëª¨ìŠµì¼ ë¿, ì‹¤ì œ í•´ë‹¹ linkê°€ ìì¹˜í•˜ëŠ” ë¶€í”¼ëŠ” collisionì—ì„œ ì§€ì •ë©ë‹ˆë‹¤. Visualê³¼ collisionì„ ì¼ì¹˜ì‹œí‚¬ìˆ˜ë¡ ì¢‹ê¸° ë•Œë¬¸ì— 3D ëª¨ë¸ë§ íŒŒì¼ì„ ì‚¬ìš©í•˜ê¸°ë„ í•©ë‹ˆë‹¤. (ì¢…ì¢… ê³„ì‚° ë‹¨ìˆœí™”ë¥¼ ìœ„í•´ ê°„ì†Œí™”ëœ ëª¨ë¸ì„ ì‚¬ìš©í•˜ê¸°ë„ í•©ë‹ˆë‹¤.) URDF JointExample \u0026lt;joint name=\u0026#34;r_wheel_joint\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34;/\u0026gt; \u0026lt;child link=\u0026#34;wheel_right_link\u0026#34;/\u0026gt; \u0026lt;origin xyz=\u0026#34;0.0 -0.09 0.0415\u0026#34; rpy=\u0026#34;0 0 0\u0026#34;/\u0026gt; \u0026lt;axis xyz=\u0026#34;0 1 0\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;joint name=\u0026#34;l_wheel_joint\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34;/\u0026gt; \u0026lt;child link=\u0026#34;wheel_left_link\u0026#34;/\u0026gt; \u0026lt;origin xyz=\u0026#34;0.0 0.109 0.0415\u0026#34; rpy=\u0026#34;0 0 0\u0026#34;/\u0026gt; \u0026lt;axis xyz=\u0026#34;0 1 0\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; Description name jointì˜ ì´ë¦„ì€ í›„ì— tf publish ì‹œ ê·¸ëŒ€ë¡œ ì‚¬ìš©ë˜ê¸° ë•Œë¬¸ì— í˜¼ë€ì„ ì•¼ê¸°í•˜ì§€ ì•Šë„ë¡ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤. type ì˜ˆì‹œì—ì„œ ì‚¬ìš©ì¤‘ì¸ joint typeì€ fixedì™€ continuousë¡œ. fixedëŠ” ë‹¨ë‹¨íˆ ê²°í•©ëœ jointë¥¼, continuousëŠ” ë¬´í•œíˆ ëŒì•„ê°ˆ ìˆ˜ ìˆëŠ” jointë¥¼ ëœ»í•©ë‹ˆë‹¤. origin parent linkì˜ ì›ì ì„ ê¸°ì¤€ìœ¼ë¡œ í•œ jointì˜ ìœ„ì¹˜ë¥¼ ì§€ì •í•˜ê²Œ ë˜ë©°, ì´ëŸ¬í•œ ìˆ˜ì¹˜ëŠ” ëª¨ë¸ë§ íŒŒì¼ì„ í†µí•´ ë¯¸ë¦¬ ì¡°ì‚¬ëœ ì´í›„ URDFë¡œ ë³€í™˜ë©ë‹ˆë‹¤. axis íšŒì „í•˜ëŠ” jointì˜ ê²½ìš° ì–´ë– í•œ ì¶•ì„ ê¸°ì¤€ìœ¼ë¡œ íšŒì „ë˜ëŠ”ì§€ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤. parent, child í•´ë‹¹ jointì˜ ì „, í›„ linkë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ê¸°íƒ€ ì†ì„±ë“¤ limit, dynamics, calibration, mimic, safety_controllerë“±ì´ ìˆìœ¼ë©°, ê°ì¢… ì—­í•™ì ì¸ ì†ì„±ì„ í‘œí˜„í•©ë‹ˆë‹¤. urdfì˜ jointëŠ” ì ˆëŒ€ ì¢Œí‘œë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•˜ëŠ” extrinsic ì²´ê³„ë¥¼ ê°–ìŠµë‹ˆë‹¤.\nê¸°íƒ€ ì†ì„±ë“¤ Description origin í•´ë‹¹ ìš”ì†Œì˜ ì›ì ì„ ê¸°ì¤€ìœ¼ë¡œ, ìœ„ì¹˜ì™€ ë°©í–¥ì„ ê²°ì •í•©ë‹ˆë‹¤. 3ì¶• ì§êµ ì¢Œí‘œê³„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ x,y,z ì¶•ê³¼ roll pitch yaw íšŒì „ê°ì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. geometry visualê³¼ collisionì˜ ê¸°í•˜í•™ì  ìš”ì†Œë¥¼ ê²°ì •í•˜ëŠ” íƒœê·¸ì…ë‹ˆë‹¤. urdfì—ì„œëŠ” box, cylinder, sphereì™€ ê°™ì´ ë‹¨ìˆœí•œ ë„í˜•ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. ë³„ë„ stl íŒŒì¼ì„ ì‚¬ìš©í•´ë„ ë˜ì§€ë§Œ ë¡œë´‡ì„ ë‹¨ìˆœí™”í•˜ê³  ì‹¶ì€ ê²½ìš° ì´ë¥¼ í†µí•´ ê°„ì†Œí™”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. material color, textureë“±ì„ ì§€ì •í•  ìˆ˜ ìˆìœ¼ë©°, ì™¸í–¥ì ì¸ ë””ìì¸ì„ ìœ„í•œ ìš”ì†Œì…ë‹ˆë‹¤. Basic Stick URDFë¥¼ ì„¤ëª…í•˜ê¸´ í–ˆëŠ”ë°â€¦ ì‹¤ì œë¡œ ì™€ë‹¿ì§€ ì•Šì§€ìš”? ì´ëŸ¬í•œ ì´ìœ ë¡œ 2ê°€ì§€ ì˜ˆì‹œë¥¼ í†µí•´ URDFì— ëŒ€í•œ ê°œìš”ë¥¼ í™•ì‹¤íˆ ì§šê³  ë„˜ì–´ê°€ë³´ê² ìŠµë‹ˆë‹¤.\nBasic Stick Fusion Bot basic stick 2ê°œì˜ linkë¡œ êµ¬ì„±ë˜ì–´ ìˆëŠ” ì•„ì£¼ ê¸°ë³¸ì ì¸ ëª¨ë¸ì„ í•¨ê»˜ ë¶„ì„í•´ë³¼ ê²ƒì…ë‹ˆë‹¤. launch fileì„ ì‹¤í–‰í•´ë´…ì‹œë‹¤. cbp basic_stick \u0026amp;\u0026amp; source install/local_setup.bash ros2 launch basic_stick description.launch.py ì „ì— ë°°ì› ë˜ tf2 ê¸°ì–µí•˜ì‹œì£ ?? ê¹Œë¨¹ìœ¼ë©´ ì•ˆë©ë‹ˆë‹¤â€¦\nlauch file ë¶„ì„ â‡’ launch fileì€ í•­ìƒ ìµœí•˜ë‹¨ë¶€í„° ë¶„ì„í•©ë‹ˆë‹¤. ì§€ê¸ˆ 2ê°œì˜ nodeê°€ ì‹¤í–‰ë˜ê³  ìˆìŠµë‹ˆë‹¤.\nreturn LaunchDescription([ robot_state_publisher, rviz, ]) robot_state_publisher nodeëŠ” xacro fileì„ ë°›ì•„ ì¼ë ¨ì˜ ì²˜ë¦¬ ê³¼ì •ì„ ê±°ì¹œ ê²°ê³¼ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ìŠµë‹ˆë‹¤. # Get URDF via xacro robot_description_content = Command( [ PathJoinSubstitution([FindExecutable(name=\u0026#34;xacro\u0026#34;)]), \u0026#34; \u0026#34;, PathJoinSubstitution( [FindPackageShare(\u0026#34;basic_stick\u0026#34;), \u0026#34;urdf\u0026#34;, \u0026#34;basic_stick_desc.xacro\u0026#34;] ), ] ) robot_description = {\u0026#34;robot_description\u0026#34;: robot_description_content} # Robot State Publisher robot_state_publisher = Node( package=\u0026#39;robot_state_publisher\u0026#39;, executable=\u0026#39;robot_state_publisher\u0026#39;, name=\u0026#39;robot_state_publisher\u0026#39;, output=\u0026#39;screen\u0026#39;, parameters=[robot_description], ) rviz2 launchëŠ” ê°„ë‹¨í•˜ì§€ë§Œ ë³µìŠµì„ ìœ„í•´ ë‹¤ì‹œ ì‚´í´ë´…ì‹œë‹¤. pkg_path = os.path.join(get_package_share_directory(\u0026#39;basic_stick\u0026#39;)) rviz_config_file = os.path.join(pkg_path, \u0026#39;rviz\u0026#39;, \u0026#39;desc.rviz\u0026#39;) # Launch RViz rviz = Node( package=\u0026#39;rviz2\u0026#39;, executable=\u0026#39;rviz2\u0026#39;, name=\u0026#39;rviz2\u0026#39;, output=\u0026#39;screen\u0026#39;, arguments=[\u0026#34;-d\u0026#34;, rviz_config_file], ) robot state publisher robot state publisherëŠ” ëª¨ë“  linkì™€ joint ê°’ì„ ì§€ì†ì ìœ¼ë¡œ ë°›ì•„ ì „ì²´ ë¡œë´‡ì˜ êµ¬ì¡°ë¥¼ tf2 í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. tf2 ì˜ˆì‹œì—ì„œ static/dynamic tf2ì— ëŒ€í•´ì„œ ì‚´í´ë³´ì•˜ì§€ìš”? ì§€ê¸ˆ basic stickì€ ì›€ì§ì´ëŠ” ë¶€ë¶„ì´ ì—†ê¸° ë•Œë¬¸ì— ëª¨ë“  íŒŒíŠ¸ê°€ staticì´ë¼ëŠ” ì ì„ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.\nrobot state publisherëŠ” URDF fileì˜ joint/link ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ tf2 broadcastë¥¼ í•©ë‹ˆë‹¤. ë•Œë¬¸ì— tf2 treeë¥¼ ì‚´í´ë³´ì•„ë„ ì•„ë˜ì™€ ê°™ì€ ê·¸ë¦¼ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. robot state publisherê°€ ë„ì¶œí•˜ëŠ” ë˜ ë‹¤ë¥¸ ê²ƒì€ robot_description topicì…ë‹ˆë‹¤. stringë§Œ ê°€ë“í•œ topicì´ì§€ë§Œ ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹œê°í™”, Gazebo spawn ë“± ì—¬ëŸ¬ ì‘ì—…ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. $ ros2 topic info /robot_description Type: std_msgs/msg/String Publisher count: 1 Subscription count: 0 data: \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;!-- =================================================================================== --\u0026gt; \u0026lt;!-- | Th... --- basic_stick_desc.xacro URDF ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ëŒì´ ëª¨ë‘ ì‘ì„±í•˜ê¸°ëŠ” ë§¤ìš° ë¹„íš¨ìœ¨ì ì…ë‹ˆë‹¤. ë”ë¶ˆì–´, Gazeboì—ì„œë§Œ ì‚¬ìš©í•˜ëŠ” ì†ì„±ì„ ë”°ë¡œ ë¶„ë¦¬í•˜ê³  ì‹¶ì€ ê²½ìš°, íŒŒì¼ì„ ë‚˜ëˆ„ì–´ ê´€ë¦¬í•˜ê³  ì‹¶ì„ ê²ƒì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ìš•êµ¬ë¥¼ ì¶©ì¡±ì‹œí‚¤ê¸° ìœ„í•´ì„œ ROS 2ëŠ” URDFì˜ ì‘ì„±ì„ ë³´ë‹¤ í¸í•˜ê²Œ í•´ì£¼ëŠ” XML Macro, Xacroë¥¼ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤.\níŠ¹íˆ xacroëŠ” ìˆ˜ì‹, ì¡°ê±´ì„ ì‚¬ìš© ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ë¡œë´‡ íŒŒì¼ì„ ë‹¤ë£¨ê¸° ë§¤ìš° ìš©ì´í•˜ë©°, íŠ¹ì • ìš”ì†Œë¥¼ ëª¨ë“ˆí™” í›„ ì¬ì‚¬ìš©í•˜ëŠ” ë“± íš¨ìœ¨ì ì¸ URDF ì‘ì„±ì´ ê°€ëŠ¥í•˜ë„ë¡ ë„ì™€ì¤ë‹ˆë‹¤.\nbasic_stick_desc.xacroì˜ ì´ˆë°˜ë¶€ë¥¼ ë³´ë©´ xacro ë³€ìˆ˜ê°€ ì„¤ì •ë˜ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;robot name=\u0026#34;basic_stick\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34;\u0026gt; \u0026lt;xacro:property name=\u0026#34;PI\u0026#34; value=\u0026#34;3.14159\u0026#34;/\u0026gt; \u0026lt;xacro:property name=\u0026#34;mass1\u0026#34; value=\u0026#34;10\u0026#34; /\u0026gt; \u0026lt;xacro:property name=\u0026#34;mass2\u0026#34; value=\u0026#34;1\u0026#34; /\u0026gt; \u0026lt;xacro:property name=\u0026#34;width1\u0026#34; value=\u0026#34;0.1\u0026#34; /\u0026gt; \u0026lt;!--link_1 radius--\u0026gt; \u0026lt;xacro:property name=\u0026#34;width2\u0026#34; value=\u0026#34;0.1\u0026#34; /\u0026gt; \u0026lt;!--link_2 radius--\u0026gt; \u0026lt;xacro:property name=\u0026#34;length0\u0026#34; value=\u0026#34;0.1\u0026#34; /\u0026gt; \u0026lt;!--link_1 length--\u0026gt; \u0026lt;xacro:property name=\u0026#34;length1\u0026#34; value=\u0026#34;1.5\u0026#34; /\u0026gt; \u0026lt;!--link_2 length--\u0026gt; \u0026lt;xacro:property name=\u0026#34;length2\u0026#34; value=\u0026#34;0.1\u0026#34; /\u0026gt; \u0026lt;!--link_3 length--\u0026gt; \u0026lt;xacro:property name=\u0026#34;mass_camera\u0026#34; value=\u0026#34;0.2\u0026#34; /\u0026gt; ë³¸ë¡ ìœ¼ë¡œ ëŒì•„ì™€ í˜„ì¬ basic stickì€ link 3ê°œ joint 2ê°œë¥¼ ê°–ëŠ”, ëª¨ë“  jointê°€ fixed jointì¸ ë¡œë´‡ì…ë‹ˆë‹¤. \u0026lt;!--Links--\u0026gt; \u0026lt;link name=\u0026#34;world\u0026#34;/\u0026gt; \u0026lt;link name=\u0026#34;link_1\u0026#34;\u0026gt; \u0026lt;link name=\u0026#34;link_2\u0026#34;\u0026gt; ê° ë§í¬ì˜ 3ê°€ì§€ ì†ì„±ì„ í†µí•´ ë¬¼ì„±ì¹˜ì™€ ì‹œê°ì  íŠ¹ì„±ì„ êµ¬í˜„í•˜ê³ , Gazeboì—ì„œ ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìš°ë¦¬ì—ê²Œ ì‹œê°í™”í•´ì£¼ê²Œ ë˜ëŠ” ì›ë¦¬ì…ë‹ˆë‹¤. \u0026lt;link name=\u0026#34;link_1\u0026#34;\u0026gt; \u0026lt;visual\u0026gt; \u0026lt;collision\u0026gt; \u0026lt;inertial\u0026gt; \u0026lt;/link\u0026gt; jointì—ì„œëŠ” í•­ìƒ parentì™€ childì˜ ì—°ê²°ì´ ì™„ì„±ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. xacro propertyë¥¼ ì‚¬ìš©í•œ ëª¨ìŠµë„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. \u0026lt;!--Joints--\u0026gt; \u0026lt;joint name=\u0026#34;fixed_base_joint\u0026#34; type=\u0026#34;fixed\u0026#34;\u0026gt; \u0026lt;parent link=\u0026#34;world\u0026#34;/\u0026gt; \u0026lt;child link=\u0026#34;link_1\u0026#34;/\u0026gt; \u0026lt;origin xyz=\u0026#34;0 0 ${length1/2}\u0026#34; rpy=\u0026#34;0 0 0\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;joint name=\u0026#34;pan_joint\u0026#34; type=\u0026#34;fixed\u0026#34;\u0026gt; \u0026lt;parent link=\u0026#34;link_1\u0026#34;/\u0026gt; \u0026lt;child link=\u0026#34;link_2\u0026#34;/\u0026gt; \u0026lt;!-- \u0026lt;axis xyz=\u0026#34;0 0 1\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;origin xyz=\u0026#34;0 0 ${length1/2+length2/2}\u0026#34; rpy=\u0026#34;0 0 -${pi/2}\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; ì´ë ‡ê²Œ basic stickì„ ì™„ì„±í•´ë³´ì•˜ìŠµë‹ˆë‹¤. ê·¸ëŸ¼, Gazeboì—ì„œ ì´ë¥¼ ë“±ì¥ì‹œì¼œë´…ì‹œë‹¤. Gazebo launch ì˜ˆì‹œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. ros2 launch basic_stick gz.launch.py â‡’ ìƒ‰ë„ ì—†ê³ , ë°‹ë°‹í•œ basic stickì´ ë™ì¥í•  ê²ƒì…ë‹ˆë‹¤.\nì´ launch fileì„ ë¶„ì„í•´ ë³´ë©´ì„œ gazebo ì—°ë™ì˜ ê°œë…ì„ ì¡ì•„ë´…ì‹œë‹¤. return LaunchDescription( [ start_gazebo_server_cmd, start_gazebo_client_cmd, robot_state_publisher, spawn_entity, ] ) start_gazebo_server_cmd / start_gazebo_client_cmdëŠ” ê°ê° gzserverì™€ clientë¥¼ ì‹¤í–‰í•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. ë”ë¶ˆì–´, world fileì„ gzserverì—ê²Œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. def generate_launch_description(): pkg_path = os.path.join(get_package_share_directory(\u0026#39;basic_stick\u0026#39;)) pkg_gazebo_ros = FindPackageShare(package=\u0026#39;gazebo_ros\u0026#39;).find(\u0026#39;gazebo_ros\u0026#39;) world_path = os.path.join(pkg_path, \u0026#39;worlds\u0026#39;, \u0026#39;empty_world.world\u0026#39;) # Start Gazebo server start_gazebo_server_cmd = IncludeLaunchDescription( PythonLaunchDescriptionSource(os.path.join(pkg_gazebo_ros, \u0026#39;launch\u0026#39;, \u0026#39;gzserver.launch.py\u0026#39;)), launch_arguments={\u0026#39;world\u0026#39;: world_path}.items() ) # Start Gazebo client start_gazebo_client_cmd = IncludeLaunchDescription( PythonLaunchDescriptionSource(os.path.join(pkg_gazebo_ros, \u0026#39;launch\u0026#39;, \u0026#39;gzclient.launch.py\u0026#39;)) ) ë©”ì¸ íŒŒíŠ¸ì¸ spawn ë¶€ë¶„ì…ë‹ˆë‹¤. spawn nodeëŠ” robot state publisherì˜ outputì¸ robot_description topicì„ subscribeí•˜ì—¬ gazebo ìƒì— ë¬¼ì²´ë¥¼ ë“±ì¥ì‹œí‚µë‹ˆë‹¤. â‡’ ë“±ì¥ì‹œí‚¬ ì‹œì˜ ì´ë¦„, ìœ„ì¹˜ì™€ ë°©í–¥ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n# Spawn Robot spawn_entity = Node( package=\u0026#39;gazebo_ros\u0026#39;, executable=\u0026#39;spawn_entity.py\u0026#39;, arguments=[ \u0026#39;-topic\u0026#39;, \u0026#39;robot_description\u0026#39;, \u0026#39;-entity\u0026#39;, \u0026#39;sensor_stick\u0026#39;, \u0026#39;-x\u0026#39;, str(0), \u0026#39;-y\u0026#39;, str(0.0), \u0026#39;-Y\u0026#39;, str(0.0), ], output=\u0026#39;screen\u0026#39; ) ë°©ê¸ˆ ì „, Gazebo ìƒì—ì„œ sensor stickì´ ë°‹ë°‹í–ˆì§€ìš”? ìƒ‰ìƒì„ ì¶”ê°€í•˜ê¸° ìœ„í•´ì„œ ë‹¤ë¥¸ xacro fileì„ include í•©ì‹œë‹¤. â‡’ basic_stick.xacroì—ì„œ basic_stick.gazebo.xacroë¥¼ include í•©ë‹ˆë‹¤.\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;robot\u0026gt; \u0026lt;!--base_link--\u0026gt; \u0026lt;gazebo reference=\u0026#34;base_link\u0026#34;\u0026gt; \u0026lt;material\u0026gt;Gazebo/White\u0026lt;/material\u0026gt; \u0026lt;/gazebo\u0026gt; ... \u0026lt;/robot\u0026gt; \u0026lt;!--Import gazebo elements--\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find basic_stick)/urdf/basic_stick.gazebo.xacro\u0026#34; /\u0026gt; ìƒ‰ìƒì´ ë°˜ì˜ëœ ìƒˆë¡œìš´ xacro fileì„ ë‹¤ì‹œ gazebo spawn ì‹œì¼œë´…ì‹œë‹¤. robot_description_content = Command( [ PathJoinSubstitution([FindExecutable(name=\u0026#34;xacro\u0026#34;)]), \u0026#34; \u0026#34;, PathJoinSubstitution( [FindPackageShare(\u0026#34;basic_stick\u0026#34;), \u0026#34;urdf\u0026#34;, \u0026#34;basic_stick.xacro\u0026#34;] ), ] ) Basic Stickì„ í†µí•´ ë°°ìš´ ë‚´ìš©ë“¤ì„ ë³µìŠµí•˜ìë©´\nROS 2ì—ê²Œ ë¡œë´‡ì˜ ì •ë³´ë¥¼ ì „ë‹¬í•˜ê¸° ìœ„í•´ urdfë¼ëŠ” í¬ë©§ì„ ì‚¬ìš©í–ˆê³ , ì´ëŠ” linkì™€ jointë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. robot state publisherëŠ” URDFë¥¼ ë°›ì•„ tf2ë¥¼ broadcastí•˜ë©° robot_description publishë¥¼ í•©ë‹ˆë‹¤. robot_description topicì„ í†µí•´ gazeboì—ì„œ ë¡œë´‡ì„ ë“±ì¥ì‹œí‚¬ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. fusion bot ì¼ì „ sensor stickì€ ì›€ì§ì´ëŠ” íŒŒì¸ ê°€ ì—†ì´ ì •ì ì¸ ëª¨ë¸ì´ì—ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì´ë²ˆì—ëŠ” ì›€ì§ì´ëŠ” jointë¥¼ ê°–ëŠ” ëª¨ë°”ì¼ ë¡œë´‡ì˜ ì˜ˆì‹œë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. rviz2ì— ë“±ì¥í•˜ëŠ” jointë“¤ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. cbp fusionbot_description \u0026amp;\u0026amp; source install/local_setup.bash ros2 launch fusionbot_description description.launch.py tf2 treeë„ í™•ì¸í•´ë´…ì‹œë‹¤. $ ros2 run tf2_tools view_frames.py ê·¸ë¦¬ê³  í•¨ê»˜ ë“±ì¥í•˜ëŠ” joint_state_publisher_guiì˜ ìŠ¬ë¼ì´ë“œë°”ë¥¼ ì›€ì§ì´ë©´, rviz2 ìƒì˜ tfê°€ ë³€í™”í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. fusionbot_description.urdfì„ ë³´ë©´ ì•Œ ìˆ˜ ìˆë“¯ì´, ì´ë²ˆ ë¡œë´‡ì€ continuous jointë¥¼ ê°–ìŠµë‹ˆë‹¤. ì´ëŠ” ë°”í€´ì™€ ê°™ì´ ëì—†ì´ ëŒì•„ê°ˆ ìˆ˜ ìˆëŠ” jointì…ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34;\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/materials.xacro\u0026#34; /\u0026gt; \u0026lt;!-- \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/fusionbot.gazebo\u0026#34; /\u0026gt; --\u0026gt; \u0026lt;link name=\u0026#39;base_footprint\u0026#39; /\u0026gt; \u0026lt;link name=\u0026#34;base_link\u0026#34;\u0026gt; \u0026lt;link name=\u0026#34;right_wheel\u0026#34;\u0026gt; ... \u0026lt;joint name=\u0026#39;base_link_joint\u0026#39; type=\u0026#39;fixed\u0026#39;\u0026gt; \u0026lt;joint name=\u0026#34;right_wheel_joint\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;joint name=\u0026#34;left_wheel_joint\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; ... \u0026lt;/robot\u0026gt; joint state publisher joint state publisherëŠ” ë¡œë´‡ ë‚´ ì¡´ì¬í•˜ëŠ” ë‹¤ì–‘í•œ joint ê°’ë“¤ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°±ì‹ í•˜ì—¬ /joint_statesë¼ëŠ” topicìœ¼ë¡œ publish í•˜ê³  tf2 broadcastë„ ë‹´ë‹¹í•©ë‹ˆë‹¤.\n/joint_states topicì€ sensor_msgs/msg/JointState msgë¥¼ ì‚¬ìš©í•˜ë©°, ê° jointë“¤ì˜ ì´ë¦„, í˜„ì¬ ìœ„ì¹˜, ì†ë„ì™€ í˜ì„ ë°°ì—´ í˜•íƒœë¡œ ë‹´ê²Œ ë©ë‹ˆë‹¤. $ ros2 interface show sensor_msgs/msg/JointState # This is a message that holds data to describe the state of a set of torque controlled joints. # # # The state of each joint (revolute or prismatic) is defined by: # * the position of the joint (rad or m), # * the velocity of the joint (rad/s or m/s) and # * the effort that is applied in the joint (Nm or N). # ... std_msgs/Header header string[] name float64[] position float64[] velocity float64[] effort ì˜ˆì œ ì‹¤í–‰ ì‹œ ë“±ì¥í–ˆë˜ ì¡°ê·¸ë§Œ ì°½ì€ joint_state_publisher_guië¼ê³  ë¶ˆë¦¬ë©°, ë¡œë´‡ ë‚´ ì¡°ì‘ì´ ê°€ëŠ¥í•œ jointë“¤ì„ ê°„ë‹¨í•˜ê²Œ ì œì–´í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ì‘ì€ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ êµ¬ì„±í•œ URDFì˜ ë°©í–¥ì€ ì•Œë§ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ì§€, ì›ì ì€ ì˜ ë§ëŠ”ì§€ ë“±ì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. topic echoë¥¼ ê±¸ì–´ë‘” ìƒíƒœì—ì„œ guiì˜ ìŠ¬ë¼ì´ë“œë°”ë¥¼ ì›€ì§ì—¬ë´…ì‹œë‹¤. $ ros2 topic echo /joint_states header: stamp: frame_id: \u0026#39;\u0026#39; name: - right_wheel_joint - left_wheel_joint position: - 1.918884792812646 - -1.409318464400381 velocity: [] effort: [] --- â‡’ ì´ë ‡ê²Œ joint state publisherëŠ” í˜„ì¬ ë¡œë´‡ì´ ê°€ì§„ ì›€ì§ì¼ ìˆ˜ ìˆëŠ” ëª¨ë“  jointë“¤ì„ ì˜ˆì˜ì£¼ì‹œí•˜ê³  ìˆìŠµë‹ˆë‹¤.\nrviz2 ìƒì—ì„œ ë³´ì‹œë‹¤ì‹œí”¼ tf2 frameë„ íšŒì „í•˜ê¸° ë•Œë¬¸ì—, ì´ëŠ” ë¡œë´‡íŒ”ì„ í¬í•¨ ì›€ì§ì´ëŠ” ëª¨ë“  ë¡œë´‡ì—ê²Œ í•„ìˆ˜ì ì¸ ë°ì´í„°ì…ë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ robot state publisher, joint state publisher, tf2ëŠ” ì–´ë– í•œ ê´€ê³„ë¥¼ ê°€ì§ˆê¹Œìš”? rqt_graphë¥¼ í†µí•´ ì‚´í´ë´…ì‹œë‹¤. FusionBot Gazebo fusionbotì˜ gazebo ì˜ˆì‹œë„ ì‹¤í–‰í•´ë´…ì‹œë‹¤. ros2 launch fusionbot_description gz.launch.py í˜„ì¬ ë¡œë´‡ì´ ì›€ì§ì¼ ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤. ì´ëŠ” ë‹¤ìŒ ì‹œê°„ pluginì„ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í•´ë³´ê² ìŠµë‹ˆë‹¤.\nì´ë²ˆ launch fileì˜ í•˜ë‹¨ì„ ë³´ë©´ì„œ ì´ë²ˆ ì‹œê°„ ë°°ìš´ ë‚´ìš©ë“¤ì„ ë‹¤ì‹œê¸ˆ ì •ë¦¬í•´ë´…ì‹œë‹¤. return LaunchDescription( [ start_gazebo_server_cmd, start_gazebo_client_cmd, robot_state_publisher, joint_state_publisher, spawn_entity, ] ) ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ë‚´ìš©ì„ ì´ì •ë¦¬í•´ë´…ì‹œë‹¤.\nROS 2ì™€ ì†Œí†µí•˜ê¸° ìœ„í•´ urdfë¥¼ ì‚¬ìš©í–ˆê³ ,ì´ëŠ” linkì™€ jointë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. jointëŠ” joint state publisherê°€ ë‹´ë‹¹í•˜ë©°, robot state publisherëŠ” joint stateì™€ í•¨ê»˜ linkë¥¼ ê²°í•©í•˜ì—¬ ìµœì¢… tfë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë°ì´í„°ë“¤ì— ê¸°ë°˜í•˜ì—¬ gazeboëŠ” ì‹œë®¬ë ˆì´ì…˜ì„ í•©ë‹ˆë‹¤. Gazebo Basic Gazeboì˜ íŠ¹ì§•ê³¼ ê¸°ë³¸ì ì¸ UI, ê·¸ë¦¬ê³  ì‚¬ìš©ë²•ì„ ì§šê³  ë„˜ì–´ê°€ê³ ì í•©ë‹ˆë‹¤.\nimage from :Â Open Robotics GazeboëŠ” ë¡œë´‡ê³µí•™ì„ ìœ„í•´ ì œì‘ëœ ì „ìš© ë¬¼ë¦¬ ì—”ì§„ ê¸°ë°˜ì˜ ë†’ì€ 3D ì‹œë®¬ë ˆì´í„°ë¡œ ROSë¥¼ ê´€ë¦¬í•˜ëŠ” Open Roboticsì—ì„œ ë¹„ë¡¯ëœ ì‹œë®¬ë ˆì´í„°ì¸ ë§Œí¼ ROSì™€ ë†’ì€ í˜¸í™˜ì„±ì„ ìë‘í•©ë‹ˆë‹¤. ì´í›„ Gazebo ì‚¬ìš© ë° ì˜¤ë¥˜ ë°œìƒ ì‹œ ë””ë²„ê¹…ì„ ìœ„í•´, Gazeboë¥¼ êµ¬ì„±í•˜ëŠ” ìš”ì†Œë“¤ì„ ê°„ë‹¨í•˜ê²Œ ì§šê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.\ngzserver \u0026amp; gzclient GazeboëŠ” Socket-Based Communicationì„ ê°–ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì„œë²„ì™€ Clientë¥¼ ë¶„ë¦¬í•˜ì—¬ ì‹¤í–‰ ê°€ëŠ¥í•˜ë©° ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œì˜ ì‹¤í–‰ í›„ ì—°ë™ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nGazebo Server gzserverëŠ” Gazebo ë™ì‘ì˜ ëŒ€ë¶€ë¶„ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì‹œë®¬ë ˆì´ì…˜í•˜ë ¤ëŠ” ì¥ë©´ê³¼ ê·¸ ì•ˆì— ìˆëŠ” ê°œì²´ íŒŒì¼ì„ ë¶„ì„í•˜ê³ , ê·¸ëŸ° ë‹¤ìŒ ë¬¼ë¦¬ ì—”ì§„ê³¼ ì„¼ì„œ ì—”ì§„ì„ ì‚¬ìš©í•˜ì—¬ ì „ì²´ ì¥ë©´ì„ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤. â‡’ í„°ë¯¸ë„ì—ì„œ gzserverë¥¼ ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. $ gzserver Gazebo Client gzclientëŠ” gzserverì— ì—°ê²°í•˜ì—¬ ëŒ€í™”í˜• ë„êµ¬ì™€ í•¨ê»˜ ì‹œë®¬ë ˆì´ì…˜ì„ ë Œë”ë§í•˜ëŠ” Graphic Clientë¥¼ ì œê³µí•©ë‹ˆë‹¤. $ gzserver â‡’ clientë§Œ ì‹¤í–‰í•˜ë©´, ì—°ê²°ë˜ê³  ëª…ë ¹ì„ ìˆ˜ì‹ í•  ì„œë²„ê°€ ì—†ê¸° ë•Œë¬¸ì— (ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤ë¥¼ ì†Œë¹„í•˜ëŠ” ê²ƒì„ ì œì™¸í•˜ê³ ) ì•„ë¬´ ê²ƒë„ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\ngazebo ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ë©´ ë‚´ë¶€ì ìœ¼ë¡œ serverì™€ clientê°€ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤. # Terminal1 - gazebo ì‹¤í–‰ $ gazebo # Terminal2 - gazebo process check $ ps faux | grep gz â‡’ ì´ëŸ¬í•œ ì´ìœ ë¡œ Gazeboë¥¼ ì¢…ë£Œí–ˆë‹¤ê³  ìƒê°í•˜ì§€ë§Œ gzserverê°€ ê¹”ë”í•˜ê²Œ ì¢…ë£Œë˜ì§€ ì•Šì•„ ì •ìƒ ë™ì‘í•˜ë˜ ì˜ˆì‹œì—ì„œ ì˜¤ë¥˜ë¥¼ ì–»ëŠ” ìƒí™©ì´ ë°œìƒí•©ë‹ˆë‹¤.\nWorld File and Model File image from :Â dronecode World Files â‡’ Gazebo world fileì—ëŠ” ë¡œë´‡ ëª¨ë¸, í™˜ê²½, ì¡°ëª…, ì„¼ì„œ, ë‹¤ë¥¸ ê¸°íƒ€ ë¬¼ì²´ë“¤ê¹Œì§€ ì‹œë®¬ë ˆì´ì…˜ í™˜ê²½ì˜ ëª¨ë“  ìš”ì†Œê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©°, ì´ëŠ” ì¼ë°˜ì ìœ¼ë¡œ í™•ì¥ìëª…Â .worldë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì•„ë˜ ì˜ˆì‹œì™€ ê°™ì´ Gazebo ì‹¤í–‰ ì‹œ world íŒŒì¼ì„ ì˜µì…˜ìœ¼ë¡œ í•˜ì—¬ ë‹¨ë… ì‹¤í–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n$ gazebo \u0026lt;yourworld\u0026gt;.world Model Files â‡’ Gazeboì˜ WorldëŠ” ë‹¤ì–‘í•œ Modelë“¤ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ Model íŒŒì¼ë§Œìœ¼ë¡œ gazeboë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤.\nâ‡’ ëª¨ë¸ì„ ë³„ë„ì˜ íŒŒì¼ë¡œ ë³´ê´€í•˜ëŠ” ì´ìœ ëŠ” ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì— ì¬ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œì´ë©°, ë¡œë´‡ì˜ ëª¨ë¸ íŒŒì¼ ë˜ëŠ” ë‹¤ë¥¸ ëª¨ë¸ì„ ì›”ë“œ íŒŒì¼ ë‚´ì— í¬í•¨í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´Â íƒœê·¸ë¥¼ í†µí•´ import í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\u0026lt;include\u0026gt;\u0026lt;uri\u0026gt;model://model_file_name\u0026lt;/uri\u0026gt;\u0026lt;/include\u0026gt; Plugins Gazeboì˜ World, Modelì— ì¥ì°©ë˜ëŠ” ê°ì¢… ì„¼ì„œì™€ ì œì–´ë¥¼ ìœ„í•œ ë‹¤ì–‘í•œ í”ŒëŸ¬ê·¸ì¸ì´ ì¤€ë¹„ë˜ì–´ ìˆìœ¼ë©°, ì´ëŸ¬í•œ í”ŒëŸ¬ê·¸ì¸ì€ ì»¤ë©˜ë“œ ë¼ì¸ì—ì„œ ë¡œë“œí•˜ê±°ë‚˜ SDF íŒŒì¼ ë‚´ë¶€ì— ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ìì²´ Pluginì„ ê°œë°œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.)\nUnderstanding Gazebo GUI ì´ë²ˆì—ëŠ” Gazeboì˜ ê¸°ë³¸ ì¡°ì‘ ë°©ë²•ê³¼ ë‚´ì¥ Toolë“¤ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nGazeboì˜ ì‹œì  ë³€í™˜ì€ ë§ˆìš°ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì†ì‰½ê²Œ ì¡°ì‘ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë§ˆìš°ìŠ¤ ì™¼ìª½ ë²„íŠ¼ì„ ëˆ„ë¥´ê³  ë“œë˜ê·¸í•˜ë©´ ì‹œì ì„ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§ˆìš°ìŠ¤ íœ ì„ ëˆ„ë¥¸ ìƒíƒœë¡œ ì´ë™ì‹œí‚¤ë©´ íšŒì „ ì‹œì ì„ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‚´ì¥ toolë“¤ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ìš°ì„ , ìµœìƒë‹¨ì— ìœ„ì¹˜í•œÂ Top Toolbarë¶€í„° ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. â‡’ ì™¼ìª½ë¶€í„° ì˜¤ë¥¸ìª½ ìˆœì„œëŒ€ë¡œ ê° ì•„ì´ì½˜ ë³„ ê¸°ëŠ¥ì„ ì„¤ëª…í•´ë³´ê² ìŠµë‹ˆë‹¤.\nSelect mode Select modeëŠ” ê°€ì¥ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì»¤ì„œ ëª¨ë“œì…ë‹ˆë‹¤. ì¥ë©´ì„ íƒìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nTranslate mode ì»¤ì„œ ëª¨ë“œë¥¼ ì„ íƒí•œ ë‹¤ìŒ ì´ë™ì‹œí‚¤ê¸¸ ì›í•˜ëŠ” ê°ì²´ë¥¼ í´ë¦­í•©ë‹ˆë‹¤. ì´í›„ ë“±ì¥í•˜ëŠ” 3ì¶• ì¤‘ ì ì ˆí•œ ì¶•ì„ ì‚¬ìš©í•˜ì—¬ ê°œì²´ë¥¼ ì›í•˜ëŠ” ìœ„ì¹˜ë¡œ ëŒê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.\nRotate mode translate modeì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì´ ì»¤ì„œ ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì£¼ì–´ì§„ ëª¨ë¸ì˜ ë°©í–¥ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nScale mode Scale modeë¥¼ ì‚¬ìš©í•˜ë©´ ê°ì²´ì˜ ì „ì²´ í¬ê¸°ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nUndo/Redo ì•,ë’¤ë¡œ ë˜ëŒë¦¬ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.\nSimple shapes íë¸Œ, êµ¬ì²´ ë˜ëŠ” ì‹¤ë¦°ë”ì™€ ê°™ì€ ê¸°ë³¸ 3D ëª¨ë¸ì„ í™˜ê²½ì— ì‚½ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nLights ìŠ¤í¬íŠ¸ë¼ì´íŠ¸, í¬ì¸íŠ¸ ë¼ì´íŠ¸ ë˜ëŠ” ë°©í–¥ì´ ì •í•´ì§„ ì¡°ëª…ê³¼ ê°™ì€ ë‹¤ì–‘í•œ ê´‘ì›ì„ í™˜ê²½ì— ì¶”ê°€í•©ë‹ˆë‹¤.\nCopy/Paste ëª¨ë¸ì„ ë³µì‚¬/ë¶™ì—¬ë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (Ctrl+C/Vë¥¼ í†µí•´ì„œë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.)\nAlign ì´ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ë©´ x y z ì¶• ì¤‘ í•˜ë‚˜ë¥¼ ë”°ë¼ í•œ ëª¨í˜•ì„ ë‹¤ë¥¸ ëª¨ë¸ê³¼ ì •ë ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nâ‡’ ë˜ëŠ” ë‘ ëª¨ë¸ì„ íŠ¹ì •í•œ ë©´ ê¸°ë°˜ìœ¼ë¡œ ì„œë¡œ ë¶™ì´ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nChange view ìƒë‹¨ ë·°, ì¸¡ë©´ ë·°, ì „ë©´ ë·°, í•˜ë‹¨ ë·°ì™€ ê°™ì€ ë‹¤ì–‘í•œ ê´€ì ì—ì„œ ì¥ë©´ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\në‹¤ìŒìœ¼ë¡œÂ Side Panelì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nWorld í˜„ì¬ ì‚¬ìš©ì¤‘ì¸ ì¡°ëª… ë° ëª¨ë¸ë“¤ì´ í‘œì‹œë©ë‹ˆë‹¤. ê°œë³„ ëª¨ë¸ì„ í´ë¦­í•˜ì—¬ ìœ„ì¹˜ ë° ë°©í–¥ê³¼ ê°™ì€ ëª¨ë¸ì˜ ê¸°ë³¸ íŒŒë¼ë¯¸í„°ë¥¼ ë³´ê±°ë‚˜ í¸ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ë¬¼ë¦¬ ì˜µì…˜ì„ í†µí•´ ì¤‘ë ¥ ë° ìê¸°ì¥ê³¼ ê°™ì€ ë¬¼ì„±ì¹˜ë„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. GUI ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´ ê¸°ë³¸ ì¹´ë©”ë¼ ë·° ê°ë„ ë° í¬ì¦ˆì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nInsert ì¶”ê°€í•  ëª¨ë¸ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í™˜ê²½ ë³€ìˆ˜ì— ì§€ì •ëœ í´ë”ì—ì„œ ëª¨ë¸ë“¤ì„ ê²€ìƒ‰í•œ ë’¤ ë°°ì¹˜í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë©°, í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ì—†ì´ë„ Add Path ì˜µì…˜ì„ í†µí•´ ì •í•´ì§„ í¬ë§·ì„ ê°–ëŠ” ëª¨ë¸ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nGazebo and ROS 2 GazeboëŠ” ROS 2ì™€ í˜¸í™˜ì´ ê°€ì¥ ì¢‹ì€ ë¡œë´‡ ì‹œë®¬ë ˆì´ì…˜ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. gazebo_rosì— ëŒ€í•´ì„œ ì‚´í´ë´…ì‹œë‹¤.\ngazebo_ros ì‹¤í–‰ $ ros2 launch gazebo_ros gazebo.launch.py ê²‰ë³´ê¸°ì—ëŠ” ì¼ë°˜ gazebo ì‹¤í–‰ê³¼ ì°¨ì´ê°€ ì—†ëŠ” ê²ƒ ê°™ì§€ë§Œ, ë‚´ë¶€ì ìœ¼ë¡œ ì´ëŠ” í° ì°¨ì´ë¥¼ ê°–ìŠµë‹ˆë‹¤. =\u0026gt; ë°”ë¡œ ROS 2ì™€ í˜¸í™˜í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ APIë¥¼ í¬í•¨í•œ Gazeboê°€ ì‹¤í–‰ëœë‹¤ëŠ” ì ì…ë‹ˆë‹¤.\n$ ros2 topic list /clock /parameter_events /performance_metrics /rosout $ ros2 service list /apply_joint_effort /apply_link_wrench /clear_joint_efforts /clear_link_wrenches /delete_entity /gazebo/describe_parameters /gazebo/get_parameter_types /gazebo/get_parameters /gazebo/list_parameters /gazebo/set_parameters /gazebo/set_parameters_atomically /get_model_list /pause_physics /reset_simulation /reset_world /spawn_entity /unpause_physics ì§€ê¸ˆê¹Œì§€ ì‹¤í–‰í–ˆë˜ launch fileì„ ì‚´í´ë³´ë©´ ëª¨ë‘ gazebo_rosë¥¼ ì‹¤í–‰í•¨ì„ ì•Œ ìˆ˜ ìˆìœ¼ë©°, íŠ¹íˆ serverì™€ clientë¥¼ ë‚˜ëˆ„ì–´ ì‹¤í–‰í•˜ê³  ìˆìŒì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. # Start Gazebo server start_gazebo_server_cmd = IncludeLaunchDescription( PythonLaunchDescriptionSource(os.path.join(pkg_gazebo_ros, \u0026#39;launch\u0026#39;, \u0026#39;gzserver.launch.py\u0026#39;)), launch_arguments={\u0026#39;world\u0026#39;: world_path}.items() ) # Start Gazebo client start_gazebo_client_cmd = IncludeLaunchDescription( PythonLaunchDescriptionSource(os.path.join(pkg_gazebo_ros, \u0026#39;launch\u0026#39;, \u0026#39;gzclient.launch.py\u0026#39;)) ) â‡’ serverì™€ clientë¥¼ ë‚˜ëˆˆ ì´ìœ ëŠ” serverë‹¨ì—ì„œ world íŒŒì¼ì´ ì „ë‹¬ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.\ngazebo_rosë¥¼ ì‹¤í–‰í•œ ë’¤ ì¡°íšŒë˜ì—ˆë˜ topicê³¼ serviceë“¤ ì¤‘ ì˜ë¯¸ìˆëŠ” ê²ƒë“¤ì„ ë‹¤ì‹œ í•œ ë²ˆ ì‚´í´ë´…ì‹œë‹¤. (ìš°ë¦¬ì—ê²Œ ìµìˆ™í•œ ê²ƒë„ ìˆìŠµë‹ˆë‹¤.) Topic Name Description /clock Gazebo ìì²´ì˜ ì‹œê°„ìœ¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ì´ ì‹œì‘ë˜ëŠ” ì‹œì ì´ 0ì´ˆê°€ ë©ë‹ˆë‹¤. Service Name Description /delete_entity ëª¨ë¸ì„ ë“±ì¥ì‹œí‚µë‹ˆë‹¤. /spawn_entity ì¡´ì¬í•˜ëŠ” ëª¨ë¸ì„ ì œê±°í•©ë‹ˆë‹¤. /get_model_list ì „ì²´ ëª¨ë¸ ë¦¬ìŠ¤íŠ¸ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤. /pause_physics ì¤‘ë ¥, ë°”ëŒ ë“± ë¬¼ë¦¬ëŸ‰ë“¤ì„ ëª¨ë‘ ì •ì§€ì‹œí‚µë‹ˆë‹¤. /unpause_physics ë¬¼ë¦¬ëŸ‰ë“¤ì„ ë‹¤ì‹œ ì‹œì‘í•©ë‹ˆë‹¤. /reset_simulation World ì „ì²´ë¥¼ Reset /reset_world Worldë‚´ Model Poseë¥¼ Reset Gazebo Building Editor gazeboë¥¼ ì‹¤í–‰ì‹œí‚¨ ë’¤, ìƒë‹¨ Edit ì˜µì…˜ì—ì„œ Building Editorë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. ìƒë‹¨ ëª¨ëˆˆì¢…ì´ì— ìŠ¤ì¼€ì¹˜ë¥¼ í†µí•´ ê±´ë¬¼ ë²½ì„ ìƒì„±í•  ìˆ˜ ìˆìœ¼ë©°, í•˜ë‹¨ viewë¥¼ í†µí•´ ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ëŠ” ê±´ë¬¼ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í˜¹ì—¬ ì‹¤ìˆ˜ë¥¼ í–ˆê±°ë‚˜, ë³´ë‹¤ ì •í™•í•œ ìˆ˜ì¹˜ë¥¼ ì…ë ¥í•˜ê³  ì‹¶ì€ ê²½ìš°, ëª¨ëˆˆì¢…ì´ ìœ„ì˜ ê²€ì€ ì„ ì„ ë”ë¸” í´ë¦­í•˜ë©´ ì‚¬ì§„ê³¼ ê°™ì´ êµ¬ì²´ì ì¸ ì„¤ì •ì„ ë³€ê²½í•  ìˆ˜ ìˆëŠ” íƒ­ì´ ë“±ì¥í•©ë‹ˆë‹¤. ìˆ˜ì •ì´ ì™„ë£Œë˜ì—ˆë‹¤ë©´, ì™¼ìª½ íƒ­ì—ì„œ door, stairsë„ ì‚¬ìš©í•´ë³´ê³ , Textureë„ ì…í˜€ë´…ì‹œë‹¤. ëª¨ë“  ì‘ì—…ì„ ë§ˆì¹œ ë’¤, File íƒ­ì—ì„œ Save Asë¥¼ ì„ íƒí•˜ì—¬ ì™„ì„±í•œ ë¬¼ì²´ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. (ì €ëŠ” wall ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì €ì¥í•´ë³´ê² ìŠµë‹ˆë‹¤.) ì €ì¥ëœ í´ë” ë‚´ë¶€ëŠ” ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¥¼ ê°–ê²Œ ë©ë‹ˆë‹¤. â”œâ”€ wall â”œâ”€â”€ model.config â””â”€â”€ model.sdf Description model.config í•´ë‹¹ modelì˜ ì´ë¦„, ì‘ì„±ì ë“± ê¸°ë³¸ì ì¸ ì •ë³´ë“¤ì´ ê¸°ì…ë©ë‹ˆë‹¤. model.sdf ì‹¤ì§ì ì¸ sdf í˜•ì‹ì˜ ëª¨ë¸ì´ ìœ„ì¹˜í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ ìƒì„±í•œ ë¬¼ì²´ë¥¼ Gazeboì—ì„œ ë‘ê³ ë‘ê³  ì‚¬ìš©í•˜ëŠ” ëª‡ê°€ì§€ ë°©ë²•ë“¤ì´ ìˆìŠµë‹ˆë‹¤.\nGAZEBO_MODEL_PATHì— ì¶”ê°€í•˜ê¸° â‡’ ~/.gazebo/gui.ini íŒŒì¼ ë‚´ model_pathsì— building í´ë”ì— ì ˆëŒ€ ê²½ë¡œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. $ gedit ~/.gazebo/gui.ini [geometry] x=0 y=0 [model_paths] filenames=/home/kimsooyoung/\u0026lt;your-folder-location\u0026gt; launch fileì—ì„œ GAZEBO_MODEL_PATH ìˆ˜ì •í•˜ê¸° ëŒ€ì‹  ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´, í•´ë‹¹ launch fileì„ ì‚¬ìš©í•´ì•¼ GAZEBO_MODEL_PATHê°€ ë°˜ì˜ë©ë‹ˆë‹¤.\nif \u0026#39;GAZEBO_MODEL_PATH\u0026#39; in os.environ: os.environ[\u0026#39;GAZEBO_MODEL_PATH\u0026#39;] += \u0026#34;:\u0026#34; + gazebo_model_path else: os.environ[\u0026#39;GAZEBO_MODEL_PATH\u0026#39;] = gazebo_model_path ìœ„ ë°©ë²•ì„ ì ìš©í•œ ë’¤ ë‹¤ì‹œ Gazeboë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´, ì‚¬ì§„ê³¼ ê°™ì´ Insert ë¶€ë¶„ì— buildingì´ ì¶”ê°€ë˜ì–´ìˆìŒì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ë¥¼ í´ë¦­ í›„ gazebo í™˜ê²½ìœ¼ë¡œ ì»¤ì„œë¥¼ ì˜®ê¸°ë©´ ì›í•˜ëŠ” ìœ„ì¹˜ì— wallì„ ìœ„ì¹˜ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 3D Gems ì´ë²ˆ ì‹œê°„ì—ëŠ” ì˜¤í”ˆì†ŒìŠ¤ ë°ì´í„°ì…‹ 3DGEMSë¥¼ ì‚¬ìš©í•˜ì—¬ ë‚˜ë§Œì˜ Worldë¥¼ ê¾¸ë¯¸ëŠ” ì˜ˆì‹œë¥¼ ì§„í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤. =\u0026gt; ğŸ“Â 3DGEMS.zip\nì œê³µë˜ëŠ” 3DGEMS í´ë”ë¥¼ ì••ì¶•í•´ì œí•œ ë’¤, ~/.gazebo/models í´ë”ì— ìœ„ì¹˜ì‹œí‚µë‹ˆë‹¤. WSL2ë¥¼ ì‚¬ìš©í•˜ì‹œëŠ” ë¶„ë“¤ê»˜ì„œëŠ” í„°ë¯¸ë„ì—ì„œ explorer.exe . ë¥¼ ì…ë ¥í•˜ë©´ ìœˆë„ìš° íŒŒì¼ íƒìƒ‰ê¸°ë¥¼ ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.\në‹¤ì‹œ í•œ ë²ˆ Gazeboë¥¼ ì‹¤í–‰ì‹œì¼œ ë³´ë©´ Insert íƒ­ì— ì¶”ê°€ëœ ìƒˆë¡œìš´ ëª¨ë¸ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì ì‹œ ì‹œê°„ì„ ê°–ê³  ë‚˜ë§Œì˜ buildingê³¼ modelì„ ì¶”ê°€í•˜ì—¬ ë‚˜ë§Œì˜ worldë¥¼ ë§Œë“¤ì–´ ë´…ì‹œë‹¤!\në§Œë“  ëª¨ë¸ì€ launch ì‹¤ìŠµì„ ìœ„í•´ gz_ros2_examples â‡’ my_world â‡’ worlds í´ë”ì— ì €ì¥í•´ë‘¡ë‹ˆë‹¤. File â‡’ Save World Asë¥¼ í´ë¦­í•˜ì—¬ ì™„ì„±ëœ world íŒŒì¼ì„ ì €ì¥í•©ì‹œë‹¤. ì—¬ëŸ¬ë¶„ë“¤ì´ ë§Œë“  world íŒŒì¼ê³¼ ê¸°ë³¸ empty worldë¥¼ ë¹„êµí•´ë³´ì„¸ìš”. \u0026lt;sdf version=\u0026#39;1.7\u0026#39;\u0026gt; \u0026lt;world name=\u0026#39;default\u0026#39;\u0026gt; \u0026lt;include\u0026gt; \u0026lt;uri\u0026gt;model://ground_plane\u0026lt;/uri\u0026gt; \u0026lt;/include\u0026gt; \u0026lt;include\u0026gt; \u0026lt;uri\u0026gt;model://sun\u0026lt;/uri\u0026gt; \u0026lt;/include\u0026gt; \u0026lt;/world\u0026gt; \u0026lt;/sdf\u0026gt; â‡’ world íŒŒì¼ì€ SDFë¼ëŠ” í¬ë©§ì„ ì‚¬ìš©í•˜ì—¬ ì‘ì„±ë˜ì—ˆìœ¼ë©°, ì´ëŠ” Gazeboì—ì„œ ì“°ì´ëŠ” ë…íŠ¹í•œ ë¬¸ë²•ì…ë‹ˆë‹¤.\nì—¬ëŸ¬ë¶„ì´ ë§Œë“  launch fileì„ gazebo_rosë¥¼ í†µí•´ ì‹¤í–‰í•´ë³´ì„¸ìš”. pkg_path = os.path.join(get_package_share_directory(\u0026#39;my_world\u0026#39;)) # world_path = os.path.join(pkg_path, \u0026#39;worlds\u0026#39;, \u0026lt;your-world-file\u0026gt;) # Start Gazebo server start_gazebo_server_cmd = IncludeLaunchDescription( PythonLaunchDescriptionSource(os.path.join(pkg_gazebo_ros, \u0026#39;launch\u0026#39;, \u0026#39;gzserver.launch.py\u0026#39;)), launch_arguments={\u0026#39;world\u0026#39;: world_path}.items() ) # Start Gazebo client start_gazebo_client_cmd = IncludeLaunchDescription( PythonLaunchDescriptionSource(os.path.join(pkg_gazebo_ros, \u0026#39;launch\u0026#39;, \u0026#39;gzclient.launch.py\u0026#39;)) ) ìƒˆë¡œìš´ íŒŒì¼ì´ ì¶”ê°€ë˜ì—ˆìœ¼ë‹ˆ, packageë¥¼ ë¹Œë“œí•˜ê³ , launch fileì„ ë‹¤ì‹œ ì‹¤í–‰í•´ë´…ì‹œë‹¤. my_world packageì— worlds í´ë” ì¶”ê°€ worlds í´ë” ì•ˆì— ì—¬ëŸ¬ë¶„ì˜ world íŒŒì¼ì„ ìœ„ì¹˜ì‹œí‚µë‹ˆë‹¤. ìƒˆë¡œìš´ folderê°€ ì¶”ê°€ë˜ì—ˆìœ¼ë‹ˆ CMakeLists.txtë¥¼ ìˆ˜ì •í•˜ê³  ë¹Œë“œí•©ë‹ˆë‹¤. launch file ìˆ˜ì • (ì§ì ‘ ì‘ì„±í•˜ì…”ë„ ì¢‹ê³ , ì œê°€ ì œê³µë“œë¦¬ëŠ” templateì„ ì‚¬ìš©í•˜ì…”ë„ ë©ë‹ˆë‹¤.) ros2 launchë¥¼ í†µí•´ gazebo_rosì—ì„œ ì—¬ëŸ¬ë¶„ì˜ worldë¥¼ ë¶ˆëŸ¬ì™€ë´…ì‹œë‹¤! colcon build --packages-select src_gazebo source install/local_setup.bash ros2 launch my_world template.py world ì œì‘ ì‹œ ì‚¬ìš©ëœ SDF í¬ë©§ì€ Blenderë¼ëŠ” í”„ë¡œê·¸ë¨ì—ì„œ export í•  ìˆ˜ ìˆì–´ ë§ì€ ì‚¬ëŒë“¤ì´ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì´ì œ world íŒŒì¼ì„ ë³¼ ìˆ˜ ìˆìœ¼ë‹ˆ Githubì— ìˆëŠ” ìˆ˜ë§ì€ ì˜ˆì‹œë“¤ì„ ê°€ì ¸ë‹¤ ì“¸ ìˆ˜ ìˆê²Œ ëœ ê²ƒì…ë‹ˆë‹¤!\n"
},
{
	"uri": "/kr/ros2_foxy/lecture12/",
	"title": "Lecture12. About Gazebo - 2",
	"tags": [],
	"description": "",
	"content": "Gazebo Sensor Plugin Description ì˜ˆì‹œë¥¼ í†µí•´ URDFì— ëŒ€í•´ ìŠµë“í•˜ì˜€ë‹¤ë©´, ì´ì œ Gazeboì— ë¡œë´‡ì„ ë“±ì¥ì‹œí‚¤ê³ , ì´ë™, ì„¼ì‹±ì„ êµ¬í˜„í•  ì°¨ë¡€ì…ë‹ˆë‹¤. sensor stickì„ í†µí•´ ì‹¤ìŠµì„ ì§„í–‰í•´ë³´ê³ , fusionbotë„ í•¨ê»˜ ë¶„ì„í•´ ë³´ê² ìŠµë‹ˆë‹¤.\në‹¤ë¤„ë³¼ ì„¼ì„œë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nMono Camera Depth Camera 2D Lidar 3D Lidar ë¯¸ë¦¬ ë§í•˜ìë©´ sensor pluginì„ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ ë°©ë²•ë§Œ ì•Œë©´ gazebo_ros pkg wikië¥¼ í†µí•´ ì–¼ë§ˆë“ ì§€ ì‘ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì ì–´ë„ í•œë²ˆì€ ì§ì ‘ pluginì„ ì ìš©í•´ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤.\nâ‡’ https://github.com/ros-simulation/gazebo_ros_pkgs/wiki\nSensor Plugin ì¶”ê°€ ì ˆì°¨ ë‹¤ìŒì€ ì¼ë°˜ì ìœ¼ë¡œ ì œê°€ Gazebo Modelì— ì„¼ì„œë¥¼ ì—°ë™í•  ë•Œ ì ìš©í•˜ëŠ” ì ˆì°¨ì…ë‹ˆë‹¤.\nì„¼ì„œê°€ ë¶€ì°©ë  link/joint ì¶”ê°€ ê¸°ë³¸ plugin xml ì—°ë™ plugin parameter ìˆ˜ì • Gazeboë¥¼ í†µí•´ ë™ì‘ ê²€ì¦ â‡’ ë‹¤ì‹œ 2ë¡œ ë°˜ë³µ\nbasic_stickì„ í†µí•´ ì¹´ë©”ë¼ ì„¼ì„œë“¤ì„, fusionbotì„ í†µí•´ ë‚˜ë¨¸ì§€ë¥¼ ì‹¤ìŠµí•´ë´…ì‹œë‹¤!! ì„¼ì„œê°€ ë¶€ì°©ë  link/joint ì¶”ê°€ â‡’ linkê°€ í•˜ë‚˜ ì¶”ê°€ë˜ë©´ í•„ì—°ì ìœ¼ë¡œ jointë„ ì¶”ê°€ë©ë‹ˆë‹¤. ì´ë¥¼ ê¸°ë³¸ ë¡œë´‡ xacroì— ë°˜ì˜í•©ë‹ˆë‹¤.\n\u0026lt;link name=\u0026#34;camera_rgb_frame\u0026#34; /\u0026gt; \u0026lt;joint name=\u0026#34;camera_rgb_joint\u0026#34; type=\u0026#34;fixed\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0 0.022 0\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;camera_link\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;camera_rgb_frame\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;link name=\u0026#34;camera_rgb_optical_frame\u0026#34; /\u0026gt; \u0026lt;joint name=\u0026#34;camera_rgb_optical_joint\u0026#34; type=\u0026#34;fixed\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;-1.57079632679 0 -1.57079632679\u0026#34; xyz=\u0026#34;0 0 0\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;camera_rgb_frame\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;camera_rgb_optical_frame\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;link name=\u0026#34;camera_depth_frame\u0026#34; /\u0026gt; \u0026lt;joint name=\u0026#34;camera_depth_joint\u0026#34; type=\u0026#34;fixed\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0 0.049 0\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;camera_link\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;camera_depth_frame\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;link name=\u0026#34;camera_depth_optical_frame\u0026#34; /\u0026gt; \u0026lt;joint name=\u0026#34;camera_depth_optical_joint\u0026#34; type=\u0026#34;fixed\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;-1.57079632679 0 -1.57079632679\u0026#34; xyz=\u0026#34;0 0 0\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;camera_depth_frame\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;camera_depth_optical_frame\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; ê¸°ë³¸ plugin xml ì—°ë™ â‡’ ì•ì„œ ì œì‹œë“œë¦° gazebo_ros pkg wiki ì˜ˆì‹œë¥¼ ì°¸ê³ í•˜ì—¬ ì›í•˜ëŠ” linkì— ì„¼ì„œ ì†ì„±ì„ ë¶€ì—¬í•©ë‹ˆë‹¤. ì§€ê¸ˆì€ Mono Cameraë¥¼ ë¶€ì°©í•´ë³´ê² ìŠµë‹ˆë‹¤.\n\u0026lt;gazebo reference=\u0026#34;camera_rgb_frame\u0026#34;\u0026gt; \u0026lt;sensor type=\u0026#34;camera\u0026#34; name=\u0026#34;rgb_cam\u0026#34;\u0026gt; \u0026lt;update_rate\u0026gt;60\u0026lt;/update_rate\u0026gt; \u0026lt;visualize\u0026gt;true\u0026lt;/visualize\u0026gt; \u0026lt;always_on\u0026gt;1\u0026lt;/always_on\u0026gt; \u0026lt;camera name=\u0026#34;head\u0026#34;\u0026gt; \u0026lt;horizontal_fov\u0026gt;1.3962634\u0026lt;/horizontal_fov\u0026gt; \u0026lt;image\u0026gt; \u0026lt;width\u0026gt;1280\u0026lt;/width\u0026gt; \u0026lt;height\u0026gt;720\u0026lt;/height\u0026gt; \u0026lt;format\u0026gt;R8G8B8\u0026lt;/format\u0026gt; \u0026lt;!-- \u0026lt;format\u0026gt;B8G8R8\u0026lt;/format\u0026gt; --\u0026gt; \u0026lt;/image\u0026gt; \u0026lt;clip\u0026gt; \u0026lt;near\u0026gt;0.02\u0026lt;/near\u0026gt; \u0026lt;far\u0026gt;300\u0026lt;/far\u0026gt; \u0026lt;/clip\u0026gt; \u0026lt;noise\u0026gt; \u0026lt;type\u0026gt;gaussian\u0026lt;/type\u0026gt; \u0026lt;mean\u0026gt;0.0\u0026lt;/mean\u0026gt; \u0026lt;stddev\u0026gt;0.007\u0026lt;/stddev\u0026gt; \u0026lt;/noise\u0026gt; \u0026lt;/camera\u0026gt; \u0026lt;plugin name=\u0026#34;camera_controller\u0026#34; filename=\u0026#34;libgazebo_ros_camera.so\u0026#34;\u0026gt; \u0026lt;ros\u0026gt; \u0026lt;namespace\u0026gt;rgb_cam\u0026lt;/namespace\u0026gt; \u0026lt;remapping\u0026gt;image_raw:=image_raw\u0026lt;/remapping\u0026gt; \u0026lt;remapping\u0026gt;camera_info:=camera_info\u0026lt;/remapping\u0026gt; \u0026lt;/ros\u0026gt; \u0026lt;!-- camera_name\u0026gt;omit so it defaults to sensor name\u0026lt;/camera_name--\u0026gt; \u0026lt;!-- \u0026lt;frame_name\u0026gt;omit so it defaults to link name\u0026lt;/frame_name\u0026gt; --\u0026gt; \u0026lt;camera_name\u0026gt;front_camera\u0026lt;/camera_name\u0026gt; \u0026lt;frame_name\u0026gt;camera_rgb_frame\u0026lt;/frame_name\u0026gt; \u0026lt;hack_baseline\u0026gt;0.07\u0026lt;/hack_baseline\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/sensor\u0026gt; \u0026lt;/gazebo\u0026gt; Mono Camera pluginì˜ ë§¤ê°œë³€ìˆ˜ë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ì´ë“¤ì„ ì—¬ëŸ¬ë¶„ì˜ ëª©ì ì— ë§ê²Œ ìˆ˜ì •í•œ ë’¤, gazeboì—ì„œ ì‹¤í–‰í•˜ì—¬ ê²€ì¦ì„ í•©ë‹ˆë‹¤.\nParameter Description gazebo reference cameraê°€ ì¥ì°©ë˜ëŠ” link update_rate data publish rate visualize ì‹œê°í™” ì˜µì…˜ horizontal_fov ì¹´ë©”ë¼ì˜ í™”ê° image í™”ì§ˆ, í¬ë§· ì˜µì…˜ noise ì„¼ì„œ ë…¸ì´ì¦ˆ remapping topic ì´ë¦„ ì¬ì„¤ì • camera_name topicì˜ namespaceê°€ ë©ë‹ˆë‹¤. frame_name cameraê°€ ì¥ì°©ë˜ëŠ” link hack_baseline stereo camera ì‚¬ìš© ì‹œ - ì¹´ë©”ë¼ ì‚¬ì´ ê±°ë¦¬ namespace ë™ì¼ ì„¼ì„œê°€ ì—¬ëŸ¬ê°œ ìˆì„ ì‹œ namespaceë¥¼ í†µí•´ êµ¬ë¶„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Gazeboë¥¼ í†µí•´ ê²€ì¦í•˜ê¸° ìœ„í•´ì„œ, ì¼ë°˜ Gazeboê°€ ì•„ë‹Œ, gazebo_rosë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë˜ì•¼ ì„¼ì„œ ë°ì´í„°ë“¤ì´ topic publish ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë”°ë¼ì„œ launch file ìˆ˜ì • í›„ ì‹¤í–‰ì˜ ì ˆì°¨ë¥¼ ë°˜ë³µí•©ë‹ˆë‹¤. gazebo ì‹¤í–‰ í›„ 3DGEMS Modelì„ ë“±ì¥ì‹œì¼œ rviz2ë¡œ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.\nros2 launch basic_stick sensor_stick.launch.py Gazebo ì—°ë™ í›„ rqt, topic echo, rviz2, tf2 tree ë“± ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ëª¨ë“  ê¸°ëŠ¥ë“¤ì„ ì‚¬ìš©í•´ ê²€ì¦í•˜ê³ , ë””ë²„ê¹…í•©ë‹ˆë‹¤. ìœ„ ê³¼ì •ì€ ë°˜ë³µë˜ë¯€ë¡œ, ì„¼ì„œ plugin ì˜ˆì‹œì™€ ë§¤ê°œë³€ìˆ˜ë“¤ì„ ìœ„ì£¼ë¡œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nDepth Camera â‡’ Depth Camera ì‚¬ìš© ì‹œ ì£¼ì˜í•´ì•¼ í•  ì ì´ ìˆìŠµë‹ˆë‹¤. Depth Cameraì˜ ì¢Œí‘œê³„ê°€ ROS 2 ì¢Œí‘œê³„ì™€ ì¼ì¹˜í•˜ì§€ ì•Šì•„ í•´ë‹¹ joint angleì„ í†µí•´ offsetí•´ì•¼ í•©ë‹ˆë‹¤.\n\u0026lt;link name=\u0026#34;camera_rgb_optical_frame\u0026#34; /\u0026gt; \u0026lt;joint name=\u0026#34;camera_rgb_optical_joint\u0026#34; type=\u0026#34;fixed\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;-1.57079632679 0 -1.57079632679\u0026#34; xyz=\u0026#34;0 0 0\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;camera_rgb_frame\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;camera_rgb_optical_frame\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; Depth Camera ParameterëŠ” Mono Cameraì™€ ì°¨ì´ë‚˜ëŠ” ë¶€ë¶„ì„ ì‚´í´ë´…ì‹œë‹¤. \u0026lt;gazebo reference=\u0026#34;depth_camera_link\u0026#34;\u0026gt; \u0026lt;sensor name=\u0026#34;front_depth_camera\u0026#34; type=\u0026#34;depth\u0026#34;\u0026gt; ... \u0026lt;plugin filename=\u0026#34;libgazebo_ros_camera.so\u0026#34; name=\u0026#34;camera_controller\u0026#34;\u0026gt; \u0026lt;ros\u0026gt; \u0026lt;!-- \u0026lt;namespace\u0026gt;custom_ns\u0026lt;/namespace\u0026gt; --\u0026gt; \u0026lt;remapping\u0026gt;front_depth_camera/image_raw:=front_depth_camera/image_raw\u0026lt;/remapping\u0026gt; \u0026lt;remapping\u0026gt;front_depth_camera/image_depth:=front_depth_camera/image_depth\u0026lt;/remapping\u0026gt; \u0026lt;remapping\u0026gt;front_depth_camera/camera_info:=front_depth_camera/camera_info\u0026lt;/remapping\u0026gt; \u0026lt;remapping\u0026gt;front_depth_camera/camera_info_depth:=front_depth_camera/camera_info_depth\u0026lt;/remapping\u0026gt; \u0026lt;remapping\u0026gt;front_depth_camera/points:=front_depth_camera/points\u0026lt;/remapping\u0026gt; \u0026lt;/ros\u0026gt; \u0026lt;camera_name\u0026gt;front_depth_camera\u0026lt;/camera_name\u0026gt; \u0026lt;frame_name\u0026gt;depth_camera_optical_link\u0026lt;/frame_name\u0026gt; \u0026lt;hack_baseline\u0026gt;0.07\u0026lt;/hack_baseline\u0026gt; \u0026lt;min_depth\u0026gt;0.001\u0026lt;/min_depth\u0026gt; \u0026lt;max_depth\u0026gt;300.0\u0026lt;/max_depth\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/sensor\u0026gt; \u0026lt;/gazebo\u0026gt; Parameter Description type=\u0026ldquo;depth\u0026rdquo; min_depth, max_depth depth ìµœì†Œ, ìµœëŒ€ íƒì§€ê±°ë¦¬ image_depth depth image topicì´ë©°, camera_info_depth depth cameraì˜ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” topicì…ë‹ˆë‹¤. points pointcloud data topicìœ¼ë¡œ XYZì™€ RGBê°€ ê²°í•©ëœ ë°ì´í„°ë¥¼ ì–»ê²Œ ë©ë‹ˆë‹¤. xacro íŒŒì¼ ë³€ê²½ í›„ Gazebo ì˜ˆì œ ì‹¤í–‰ sensor_stick.xacroì˜ line 13ì„ ë³´ë©´ ë‹¤ë¥¸ pluginë“¤ì„ ì‚¬ìš©í•˜ëŠ” ì¶”ê°€ xacro fileë“¤ì„ ë‚˜ëˆ ë‘” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. sensor_stick_mono â‡’ sensor_stick_depthë¡œ í† ê¸€ë§í•œ ë’¤ ë‹¤ì‹œ launch í•´ë´…ì‹œë‹¤.\nros2 launch basic_stick sensor_stick.launch.py ë‹¤ìŒìœ¼ë¡œ 2D/3D ë¼ì´ë‹¤ ë°ì´í„°ë¥¼ ì—°ë™í•´ë´…ì‹œë‹¤. ë¼ì´ë‹¤ëŠ” ë°”í€´ë¥¼ ê°€ì§„ fusionbotìœ¼ë¡œ ì‹¤ìŠµí•´ ë³´ê² ìŠµë‹ˆë‹¤.\n2D lidar plugin \u0026lt;gazebo reference=\u0026#34;lidar\u0026#34;\u0026gt; \u0026lt;sensor name=\u0026#34;lidar\u0026#34; type=\u0026#34;ray\u0026#34;\u0026gt; \u0026lt;pose\u0026gt;0 0 0 0 0 0\u0026lt;/pose\u0026gt; \u0026lt;always_on\u0026gt;1\u0026lt;/always_on\u0026gt; \u0026lt;visualize\u0026gt;1\u0026lt;/visualize\u0026gt; \u0026lt;update_rate\u0026gt;10\u0026lt;/update_rate\u0026gt; \u0026lt;ray\u0026gt; \u0026lt;scan\u0026gt; \u0026lt;horizontal\u0026gt; \u0026lt;samples\u0026gt;360\u0026lt;/samples\u0026gt; \u0026lt;resolution\u0026gt;1.000000\u0026lt;/resolution\u0026gt; \u0026lt;min_angle\u0026gt;-3.14159\u0026lt;/min_angle\u0026gt; \u0026lt;max_angle\u0026gt;3.14159\u0026lt;/max_angle\u0026gt; \u0026lt;/horizontal\u0026gt; \u0026lt;/scan\u0026gt; \u0026lt;range\u0026gt; \u0026lt;min\u0026gt;0.2\u0026lt;/min\u0026gt; \u0026lt;max\u0026gt;10.0\u0026lt;/max\u0026gt; \u0026lt;resolution\u0026gt;0.05\u0026lt;/resolution\u0026gt; \u0026lt;/range\u0026gt; \u0026lt;noise\u0026gt; \u0026lt;type\u0026gt;gaussian\u0026lt;/type\u0026gt; \u0026lt;mean\u0026gt;0.0\u0026lt;/mean\u0026gt; \u0026lt;stddev\u0026gt;0.01\u0026lt;/stddev\u0026gt; \u0026lt;/noise\u0026gt; \u0026lt;/ray\u0026gt; \u0026lt;plugin filename=\u0026#34;libgazebo_ros_ray_sensor.so\u0026#34; name=\u0026#34;scan\u0026#34;\u0026gt; \u0026lt;ros\u0026gt; \u0026lt;remapping\u0026gt;~/out:=scan\u0026lt;/remapping\u0026gt; \u0026lt;/ros\u0026gt; \u0026lt;output_type\u0026gt;sensor_msgs/LaserScan\u0026lt;/output_type\u0026gt; \u0026lt;frame_name\u0026gt;lidar\u0026lt;/frame_name\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/sensor\u0026gt; \u0026lt;/gazebo\u0026gt; Parameter Description type=\u0026ldquo;ray\u0026rdquo; samples ë¼ì´ë‹¤ì˜ ìƒ˜í”Œ ìˆ˜ë¥¼ ì§€ì •í•©ë‹ˆë‹¤. ì§€ê¸ˆì€ 360ê°œì˜ pointë¥¼ ê° 1ë„ì”© ë§¤í•‘í•´ì„œ 360ë„ë¥¼ ìŠ¤ìº”í•˜ê²Œ ë©ë‹ˆë‹¤. resolution ìŠ¤ìº” í•´ìƒë„ë¡œ ë‹¨ìœ„ëŠ” ê°ë„ì…ë‹ˆë‹¤. min_angle / max_angle ìµœëŒ€, ìµœì†Œ ê°ë„ì´ë©° ì§€ê¸ˆì€ -180 ~ 180 ì¦‰ 360ë„ë¥¼ ìŠ¤ìº”í•©ë‹ˆë‹¤. range íƒì§€ê±°ë¦¬ì˜ ë²”ìœ„, í•´ìƒë„ë¥¼ ì •ì˜í•©ë‹ˆë‹¤. scan ë¼ì´ë‹¤ì˜ ìŠ¤ìº” ê²°ê³¼ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ scanì´ë¼ëŠ” topicìœ¼ë¡œ publish ë©ë‹ˆë‹¤. output_type ROS 2ì—ì„œ ì‚¬ìš©í•˜ëŠ” 2D ë¼ì´ë‹¤ ë°ì´í„°ë¡œ ê¸°ë³¸ì€ sensor_msgs/msg/LaserScanì…ë‹ˆë‹¤. ì˜ˆì œ ì‹¤í–‰ ros2 launch fusionbot_description sensor_gz.launch.py 3D Lidar plugin â‡’ 2D lidarì™€ pluginì€ ê°™ì§€ë§Œ, verticalì´ë¼ëŠ” ì†ì„±ì´ ì¶”ê°€ë©ë‹ˆë‹¤.\nì´ ì„¼ì„œëŠ” ì—°ì‚°ëŸ‰ì´ ë§ì•„ gpu ë²„ì „ì„ ë³„ë„ë¡œ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.\n\u0026lt;!-- Gazebo requires the velodyne_gazebo_plugins package --\u0026gt; \u0026lt;gazebo reference=\u0026#34;velodyne\u0026#34;\u0026gt; \u0026lt;sensor type=\u0026#34;gpu_ray\u0026#34; name=\u0026#34;block_laser_sensor\u0026#34;\u0026gt; \u0026lt;ray\u0026gt; \u0026lt;scan\u0026gt; \u0026lt;horizontal\u0026gt; \u0026lt;samples\u0026gt;1200\u0026lt;/samples\u0026gt; \u0026lt;resolution\u0026gt;1\u0026lt;/resolution\u0026gt; \u0026lt;min_angle\u0026gt;-3.141592653589793\u0026lt;/min_angle\u0026gt; \u0026lt;max_angle\u0026gt;3.141592653589793\u0026lt;/max_angle\u0026gt; \u0026lt;/horizontal\u0026gt; \u0026lt;vertical\u0026gt; \u0026lt;samples\u0026gt;64\u0026lt;/samples\u0026gt; \u0026lt;resolution\u0026gt;1\u0026lt;/resolution\u0026gt; \u0026lt;min_angle\u0026gt;-0.436322083\u0026lt;/min_angle\u0026gt; \u0026lt;max_angle\u0026gt;0.2617993877991494\u0026lt;/max_angle\u0026gt; \u0026lt;/vertical\u0026gt; \u0026lt;/scan\u0026gt; \u0026lt;range\u0026gt; \u0026lt;min\u0026gt;0.3\u0026lt;/min\u0026gt; \u0026lt;max\u0026gt;201.0\u0026lt;/max\u0026gt; \u0026lt;resolution\u0026gt;0.001\u0026lt;/resolution\u0026gt; \u0026lt;/range\u0026gt; \u0026lt;!-- Using gazebo\u0026#39;s noise instead of plugin\u0026#39;s --\u0026gt; \u0026lt;noise\u0026gt; \u0026lt;type\u0026gt;gaussian\u0026lt;/type\u0026gt; \u0026lt;mean\u0026gt;0.0\u0026lt;/mean\u0026gt; \u0026lt;stddev\u0026gt;0.0\u0026lt;/stddev\u0026gt; \u0026lt;/noise\u0026gt; \u0026lt;/ray\u0026gt; \u0026lt;!-- Using gazebo\u0026#39;s update rate instead of plugin\u0026#39;s --\u0026gt; \u0026lt;update_rate\u0026gt;30\u0026lt;/update_rate\u0026gt; \u0026lt;plugin name=\u0026#34;gazebo_ros_block_laser_controller\u0026#34; filename=\u0026#34;libgazebo_ros_ray_sensor.so\u0026#34;\u0026gt; \u0026lt;!-- Change namespace and output topic so published topic is /rrbot/laser/pointcloud --\u0026gt; \u0026lt;ros\u0026gt; \u0026lt;!-- \u0026lt;namespace\u0026gt;/rrbot/laser\u0026lt;/namespace\u0026gt; --\u0026gt; \u0026lt;remapping\u0026gt;~/out:=pointcloud\u0026lt;/remapping\u0026gt; \u0026lt;/ros\u0026gt; \u0026lt;!-- Set output to sensor_msgs/PointCloud to get same output type as gazebo_ros_block_laser --\u0026gt; \u0026lt;output_type\u0026gt;sensor_msgs/PointCloud2\u0026lt;/output_type\u0026gt; \u0026lt;!-- \u0026lt;frame_name\u0026gt; ommited, will default to block_laser_link --\u0026gt; \u0026lt;!-- min_intensity instead of hokuyoMinIntensity --\u0026gt; \u0026lt;min_intensity\u0026gt;100.0\u0026lt;/min_intensity\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/sensor\u0026gt; \u0026lt;/gazebo\u0026gt; Parameter Description type=\u0026ldquo;ray\u0026rdquo; horizontal ë¼ì´ë‹¤ì˜ ìˆ˜ì§ ìƒ˜í”Œë§ ì†ì„±ì„ ì§€ì •í•©ë‹ˆë‹¤. 3D LidarëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 2D lidarë¥¼ ìŒ“ì•„ë‘” ê²ƒê³¼ ìœ ì‚¬í•œ ì›ë¦¬ë¥¼ ê°–ìŠµë‹ˆë‹¤. pointcloud ë¼ì´ë‹¤ì˜ ìŠ¤ìº” ê²°ê³¼ëŠ” topic ì´ë¦„ì…ë‹ˆë‹¤. sensor_msgs/PointCloud2 ROS 2ì—ì„œ ì‚¬ìš©í•˜ëŠ” 2D ë¼ì´ë‹¤ ë°ì´í„°ë¡œ ê¸°ë³¸ì€ sensor_msgs/msg/PointCloudì…ë‹ˆë‹¤. í•˜ì§€ë§Œ foxy ì´í›„ë¶€í„° PointCloud2ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. min_intensity PointCloudì˜ íŠ¹ì„± ì¤‘ ë¬¼ì²´ì˜ ì„±ì§ˆì— ë”°ë¼ ë‹¬ë¼ì§€ëŠ” intensityê°€ ìˆìŠµë‹ˆë‹¤. ì´ì— ëŒ€í•œ ì„ê³„ê°’ì…ë‹ˆë‹¤. xacro íŒŒì¼ ë³€ê²½ í›„ Gazebo ì˜ˆì œ ì‹¤í–‰ ros2 launch fusionbot_description sensor_gz.launch.py ê³¼ì œë¥¼ í†µí•´ ìœ„ ì‘ì—…ì„ ì¶©ë¶„íˆ ì—°ìŠµí•´ë³´ê³  ë„˜ì–´ê°€ê³ ì í•©ë‹ˆë‹¤. â‡’ ì§ì ‘, basic stickì„ sensor stickìœ¼ë¡œ ë³€í™˜í•´ ë³´ì„¸ìš”!\nGazebo Movement Plugin ì§€ê¸ˆê¹Œì§€ ì‚´í´ë³´ì•˜ë˜ gazebo ì˜ˆì‹œë“¤ì€ ëª¨ë‘ ì •ì ì¸ ë¡œë´‡ + ì„¼ì„œì˜€ìŠµë‹ˆë‹¤. ì‚¬ì‹¤ ë¡œë´‡ ì‹œë®¬ë ˆì´ì…˜ì€ ë¬¼ì²´ì˜ ì •í™•í•œ ìœ„ì¹˜ì™€ ìƒíƒœë¥¼ ì•Œ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì•Œê³ ë¦¬ì¦˜ì˜ ê²€ì¦ì„ ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ë²ˆ ì‹œê°„ì—ëŠ” Gazeboìƒ ë¬¼ì²´ì˜ ì›€ì§ì„ê³¼ ê´€ë ¨ëœ pluginë“¤ì„ ì‚´í´ë´…ì‹œë‹¤.\nDiff Drive Controller ë¡œë´‡ ì²­ì†Œê¸°ì™€ ê°™ì´ ì œìë¦¬ íšŒì „ì´ ê°€ëŠ¥í•˜ë©°, ì–‘ìª½ ë°”í€´ íšŒì „ìˆ˜ ì°¨ì´ë¡œ ë¡œë´‡ì„ ì´ë™ì‹œí‚¤ëŠ” íƒ€ì…ì„ DD Typeì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤. ì¼ì „ fusionbotì´ ì—¬ê¸°ì— í•´ë‹¹í•©ë‹ˆë‹¤. ì´ ëª¨ë¸ì´ í•˜ë„ ë§ì´ ì‚¬ìš©ë˜ì–´ì„œ ê·¸ëŸ°ì§€ gazebo_ros ì°¨ì›ì—ì„œ pluginì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.\nì˜ˆì‹œ ì‹¤í–‰ ì „ plugin ì ìš©ì„ ìœ„í•´ fusionbot_description/urdf/fusionbot.urdf.xacro íŒŒì¼ì—ì„œ line 5, include line ì£¼ì„ì„ í•´ì œí•©ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34;\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/materials.xacro\u0026#34; /\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/fusionbot.gazebo\u0026#34; /\u0026gt; ìˆ˜ì •, ì €ì¥ í›„ ì˜ˆì‹œë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•´ë´…ì‹œë‹¤. ros2 launch fusionbot_description gz.launch.py dd controller pluginì´ ì œê³µí•˜ëŠ” topicë“¤ì„ í™•ì¸í•´ë´…ì‹œë‹¤. $ ros2 topic list /clock /cmd_vel /front_camera/camera_info /front_camera/image_raw /joint_states /odom /parameter_events /performance_metrics /robot_description /rosout /scan /tf /tf_static Topic Name Description /cmd_vel ë¡œë´‡ ì œì–´ë¥¼ ìœ„í•œ topicìœ¼ë¡œ geometry_msgs/msg/Twist íƒ€ì…ì„ ê°–ìŠµë‹ˆë‹¤. /odom ë¡œë´‡ì˜ ìœ„ì¹˜ì™€ ì†ë„, ë°©í–¥ì„ ëª¨ë‘ í¬í•¨í•˜ëŠ” odometry data topic ì…ë‹ˆë‹¤. /tf tf2 dataë¡œ odom ë° fixed tf2ë“¤ì´ publish ë©ë‹ˆë‹¤. /joint_states ë¡œë´‡ ë°”í€´ê°€ êµ´ëŸ¬ê°ì— ë”°ë¼ ë³€í™”í•˜ëŠ” joint angleë“¤ì„ publish í•©ë‹ˆë‹¤. rqt_robot_steeringì„ í†µí•´ ë¡œë´‡ì„ ì œì–´í•´ë´…ì‹œë‹¤. rqt_robot_steering â‡’ ì¼ì „ ê»ë°ê¸°ì— ë¶ˆê³¼í–ˆë˜ fusionbotì´ ì–´ë–»ê²Œ ì œì–´ë  ìˆ˜ ìˆì—ˆëŠ”ì§€ ê³¼ì •ì„ ì„¤ëª…í•´ë³´ê² ìŠµë‹ˆë‹¤.\nurdf í´ë”ì— 2ê°€ì§€ pluginì„ ì¶”ê°€í•˜ê³ , ë§¤ê°œë³€ìˆ˜ë¥¼ ë§ì¶°ì¤ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34; \u0026gt; \u0026lt;gazebo\u0026gt; \u0026lt;plugin name=\u0026#39;fusionbot_joint_state\u0026#39; filename=\u0026#39;libgazebo_ros_joint_state_publisher.so\u0026#39;\u0026gt; \u0026lt;ros\u0026gt; \u0026lt;remapping\u0026gt;~/out:=joint_states\u0026lt;/remapping\u0026gt; \u0026lt;/ros\u0026gt; \u0026lt;update_rate\u0026gt;30\u0026lt;/update_rate\u0026gt; \u0026lt;joint_name\u0026gt;right_wheel_joint\u0026lt;/joint_name\u0026gt; \u0026lt;joint_name\u0026gt;left_wheel_joint\u0026lt;/joint_name\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;gazebo\u0026gt; \u0026lt;plugin name=\u0026#39;differential_drive_controller\u0026#39; filename=\u0026#39;libgazebo_ros_diff_drive.so\u0026#39;\u0026gt; \u0026lt;update_rate\u0026gt;30\u0026lt;/update_rate\u0026gt; \u0026lt;left_joint\u0026gt;left_wheel_joint\u0026lt;/left_joint\u0026gt; \u0026lt;right_joint\u0026gt;right_wheel_joint\u0026lt;/right_joint\u0026gt; \u0026lt;wheel_separation\u0026gt;0.2\u0026lt;/wheel_separation\u0026gt; \u0026lt;wheel_diameter\u0026gt;0.1\u0026lt;/wheel_diameter\u0026gt; \u0026lt;max_wheel_torque\u0026gt;50\u0026lt;/max_wheel_torque\u0026gt; \u0026lt;max_wheel_acceleration\u0026gt;1.0\u0026lt;/max_wheel_acceleration\u0026gt; \u0026lt;command_topic\u0026gt;cmd_vel\u0026lt;/command_topic\u0026gt; \u0026lt;publish_odom\u0026gt;1\u0026lt;/publish_odom\u0026gt; \u0026lt;publish_odom_tf\u0026gt;1\u0026lt;/publish_odom_tf\u0026gt; \u0026lt;publish_wheel_tf\u0026gt;0\u0026lt;/publish_wheel_tf\u0026gt; \u0026lt;odometry_topic\u0026gt;odom\u0026lt;/odometry_topic\u0026gt; \u0026lt;odometry_frame\u0026gt;odom\u0026lt;/odometry_frame\u0026gt; \u0026lt;robot_base_frame\u0026gt;base_footprint\u0026lt;/robot_base_frame\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;/robot\u0026gt; libgazebo_ros_joint_state_publisher Description remapping ?? data typeì„ ê°–ëŠ” joint state topic ì´ë¦„ì„ remapping í•©ë‹ˆë‹¤. update_rate joint state topicì˜ publish rate joint_name trackingí•  jointë“¤ì´ë©° DD robotì€ ì¢Œ-ìš° 2ê°œê°€ ë  ê²ƒì…ë‹ˆë‹¤. libgazebo_ros_diff_drive Description update_rate state topic publish rate left_joint, right_joint DD type ë¡œë´‡ URDFì—ì„œ ì¢Œ-ìš° jointë¥¼ ì ì–´ì¤ë‹ˆë‹¤. wheel_separation ì¢Œ-ìš° ë°”í€´ ì‚¬ì´ì˜ ê±°ë¦¬ wheel_diameter ë°”í€´ì˜ ì§€ë¦„ max_\u0026ldquo;value\u0026rdquo; ì œì–´ì™€ ê´€ë ¨ëœ ë¬¼ì„±ì¹˜ì…ë‹ˆë‹¤. ì •í™•í•˜ê²Œ í•˜ê³  ì‹¶ë‹¤ë©´ ì‹¤ì œ ëª¨í„° ìŠ¤í™ì„ í†µí•´ ë§ì¶°ì¤ë‹ˆë‹¤. command_topic Twist typeì„ ê°–ëŠ” ë¡œë´‡ ì œì–´ topicìœ¼ë¡œ, ê¸°ë³¸ê°’ì€ cmd_velì…ë‹ˆë‹¤. publish_odom odometry topicì˜ publish ì—¬ë¶€ publish_odom_tf odometry tf2ì˜ broadcast ì—¬ë¶€ (topicê³¼ tf2ëŠ” ë‹¤ë¥¸ ê°œë…ì…ë‹ˆë‹¤!) publish_wheel_tf ì–‘ìª½ ë°”í€´ì˜ tf2 publish ì—¬ë¶€ odometry_topic odometry topic name odometry_frame odometry tf2 broadcast ì‹œ ì‚¬ìš©ë  ì´ë¦„ robot_base_frame ë¡œë´‡ tf2ê°€ ì‹œì‘ë˜ëŠ” ê¸°ì¤€ frame rviz2ë¥¼ í†µí•´ odometry topicì„ ì‹œê°í™”í•´ë´…ì‹œë‹¤. Differential Drive Typeì€ Gazeboì—ì„œ ê¸°ë³¸ ì œê³µí•˜ì§€ë§Œ, ì´ëŠ” gazebo_rosê°€ ë§Œë“¤ì–´ì§€ê¸° ì „, Gazebo ê°œë°œìë“¤ì´ ë¡œë´‡ ì˜ˆì‹œë¥¼ ìœ„í•´ ë§Œë“¤ì–´ë‘” ê²ƒì¼ ë¿ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì¢€ ë” ëª¨ë˜í•œ ros2_control ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.\nGazebo State Plugin ì¼ì „ tf2 ì˜ˆì‹œì—ì„œ ì‚¬ìš©ë˜ì—ˆë˜, ë§ˆì¹˜ í–‰ì„±ê³¼ ìœ„ì„± ê°™ì€ ì‹œë®¬ë ˆì´ì…˜ ê¸°ì–µí•˜ì‹œë‚˜ìš”? ros2 launch tf2_world tf2_world.launch.py ì´ ì˜ˆì‹œì—ì„œ gazebo_rosì˜ ê¸°ë³¸ topicì„ í†µí•´ ë§¤ìš° ì •í™•í•œ ìœ„ì¹˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. $ ros2 topic list /clock /link_states /model_states /parameter_events /performance_metrics /rosout ì´ëŸ¬í•œ topicë“¤ì„ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´, gazebo world fileì— libgazebo_ros_state pluginì„ ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤. Multi Object Spawning ì—¬ëŸ¬ëŒ€ì˜ ë¡œë´‡, ì—¬ëŸ¬ê°œì˜ ë™ì¼í•œ ì„¼ì„œë¥¼ ì‹œë®¬ë ˆì´ì…˜í•˜ê³  ì‹¶ì€ ê²½ìš°ë¥¼ ë‹¤ë¤„ë´…ì‹œë‹¤.\nì¤€ë¹„ëœ ì˜ˆì‹œì˜ ì—­ë¶„ì„ì„ í†µí•´ í•™ìŠµí•´ë³´ê³ ì í•©ë‹ˆë‹¤. ìš°ì„  ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. ros2 launch chess_world chess_world.launch.py ì²´ìŠ¤ë³´ë“œ ì–‘ìª½ìœ¼ë¡œ ë™ì¼í•œ realsense cameraê°€ ë“±ì¥í•œ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì´ ì˜ˆì‹œë¥¼ ì—­ìœ¼ë¥´ í•´ì„í•´ê°€ë©´ì„œ multi object ìƒí™©ì— ëŒ€í•œ gazeboí™˜ê²½ì— ëŒ€í•´ í•™ìŠµí•´ë³´ê² ìŠµë‹ˆë‹¤. launch file ë¶„ì„ urdf ë¶„ì„ gazebo plugin ë¶„ì„ launch file ë¶„ì„ - chess_world.launch.py cam1_spawn = robot_spawn_nodes(0, \u0026#34;camera_left.urdf.xacro\u0026#34;, pkg_path) cam2_spawn = robot_spawn_nodes(1, \u0026#34;camera_right.urdf.xacro\u0026#34;, pkg_path) return LaunchDescription( [ arg_show_rviz, start_gazebo_server_cmd, start_gazebo_client_cmd, static_transform_publisher, *cam1_spawn, *cam2_spawn, rviz_node, ] ) â‡’ í•˜ë‚˜ì˜ object ì‹œë®¬ë ˆì´ì…˜ì„ ìœ„í•´ í•„ìš”í•œ nodeë“¤ì„ ë¬¶ì–´ í•¨ìˆ˜í™”í•˜ê³ , ì´ë¥¼ í†µí•´ cam1_spawn, cam2_spawnì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.\në‹¤ì‹œ robot_spawn_nodes í•¨ìˆ˜ë¥¼ ì‚´í´ë´…ì‹œë‹¤. return [ robot_state_publisher, spawn_entity, ] ì„œë¡œ ë‹¤ë¥¸ urdf fileì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— robot_state_publisherê°€, ë¡œë´‡ì„ ë“±ì¥ì‹œí‚¤ëŠ” ê³¼ì •ì´ ë°˜ë³µë˜ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì— spawn_entityê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\nì‚¬ìš©í•  xacro fileê³¼ spawn ìœ„ì¹˜ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ì•„ ì‹¤í–‰ë˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤. ë”ìš±ì´, ì—¬ê¸°ì„œ ì£¼ëª©í•´ì•¼ í•  ì ì€ namespaceë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤ëŠ” ì ì…ë‹ˆë‹¤. def robot_spawn_nodes(id, xacro_name, pkg_path): # Get URDF via xacro robot_description_content = Command( [ PathJoinSubstitution([FindExecutable(name=\u0026#34;xacro\u0026#34;)]), \u0026#34; \u0026#34;, PathJoinSubstitution( [FindPackageShare(\u0026#34;chess_world\u0026#34;), \u0026#34;urdf\u0026#34;, xacro_name] ), ] ) robot_description = {\u0026#34;robot_description\u0026#34;: robot_description_content} ... # Spawn Robot spawn_entity = Node( package=\u0026#39;gazebo_ros\u0026#39;, executable=\u0026#39;spawn_entity.py\u0026#39;, namespace=f\u0026#39;camera_{id}\u0026#39;, arguments=[ \u0026#39;-topic\u0026#39;, \u0026#39;robot_description\u0026#39;, \u0026#39;-entity\u0026#39;, f\u0026#39;d435_camera_{id}\u0026#39;, \u0026#39;-x\u0026#39;, str(0), \u0026#39;-y\u0026#39;, str(0.0), \u0026#39;-Y\u0026#39;, str(0.0), ], output=\u0026#39;screen\u0026#39; ) camera_right.urdf.xacro \u0026amp; camera_left.urdf.xacro â‡’ ë§í¬ë¥¼ í†µí•´ ì´ ë‘˜ì„ ë¹„êµí•´ë´…ì‹œë‹¤. â‡’ camera_right.urdf.xacro / camera_left.urdf.xacro\nâ‡’ ë°˜ë³µë˜ëŠ” êµ¬ë¬¸ì„ í•¨ìˆ˜í™”í•˜ê³ , ê¸°ëŠ¥ìƒì˜ on/offë¥¼ ë³€ìˆ˜í™”í•˜ì—¬ ë³„ë„ ê´€ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤. xacroì˜ ì‚¬ìš©ì´ ì•„ì£¼ ë¹›ë‚˜ëŠ” ìƒí™©ì…ë‹ˆë‹¤.\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;robot xmlns:xacro=\u0026#34;http://ros.org/wiki/xacro\u0026#34; name=\u0026#34;camera_\u0026lt;\u0026gt;\u0026#34;\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find chess_world)/urdf/sensors/_d415.urdf.xacro\u0026#34;/\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find chess_world)/urdf/sensors/cam_holder.urdf.xacro\u0026#34;/\u0026gt; \u0026lt;link name=\u0026#34;chess_frame\u0026#34; /\u0026gt; \u0026lt;!-- sets camera frame w.r.t. to chess frame--\u0026gt; \u0026lt;!-- set only the color camera and a slow frame rate - an image each 5 seconds)--\u0026gt; \u0026lt;xacro:sensor_d415 name=\u0026#34;camera_\u0026lt;\u0026gt;\u0026#34; parent=\u0026#34;chess_frame\u0026#34; flag_color=\u0026#34;1\u0026#34; flag_ir=\u0026#34;0\u0026#34; flag_depth=\u0026#34;0\u0026#34; updaterate=\u0026#34;10\u0026#34;\u0026gt; \u0026lt;origin xyz=\u0026#34;? ? ?\u0026#34; rpy=\u0026#34;? ? ?\u0026#34; /\u0026gt; \u0026lt;/xacro:sensor_d415\u0026gt; \u0026lt;!-- result from calib --\u0026gt; \u0026lt;!-- sets cam holder w.r.t to camera--\u0026gt; \u0026lt;xacro:cam_holder name=\u0026#34;camera_\u0026lt;\u0026gt;_holder\u0026#34; parent=\u0026#34;camera_\u0026lt;\u0026gt;_link\u0026#34;\u0026gt; \u0026lt;origin xyz=\u0026#34;0.0 -0.020 0.0115\u0026#34; rpy=\u0026#34;0 -1.161379 0\u0026#34; /\u0026gt; \u0026lt;/xacro:cam_holder\u0026gt; \u0026lt;/robot\u0026gt; ê°ê°ì˜ xacro fileë‚´ì—ëŠ” ë³€í™”í•˜ëŠ” ë¶€ë¶„ì„ ë³€ìˆ˜ë¡œ ë‘ì–´ ìƒìœ„ xacroì—ì„œ ë§¤ê°œë³€ìˆ˜ë¥¼ ì „ë‹¬í•˜ê¸°ë§Œ í•˜ë©´ ì–¸ì œë“  ë…ë¦½ëœ ëª¨ë¸ì„ ë§Œë“¤ ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;robot name=\u0026#34;cam_holder\u0026#34; xmlns:xacro=\u0026#34;http://ros.org/wiki/xacro\u0026#34;\u0026gt; \u0026lt;xacro:macro name=\u0026#34;cam_holder\u0026#34; params=\u0026#34;name parent *origin\u0026#34;\u0026gt; ... \u0026lt;robot name=\u0026#34;sensor_d415\u0026#34; xmlns:xacro=\u0026#34;http://ros.org/wiki/xacro\u0026#34;\u0026gt; \u0026lt;xacro:macro name=\u0026#34;sensor_d415\u0026#34; params=\u0026#34;name parent flag_color flag_ir flag_depth updaterate *origin\u0026#34;\u0026gt; â‡’ ì´ëŸ¬í•œ ì´ìœ ì—ì„œ xacroì˜ ì‚¬ìš©ì´ ê¶Œì¥ë©ë‹ˆë‹¤.\nì‹¤ì œ ì—ì‹œë¥¼ ì‹¤í–‰í•˜ì—¬ topic listë¥¼ ì¡°íšŒí•´ë³´ì•„ë„ ê²¹ì¹˜ëŠ” ì´ë¦„ ì—†ì´ ì˜ ì‹¤í–‰ë˜ëŠ” ëª¨ìŠµì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. $ ros2 topic list /camera_0/joint_states /camera_0/robot_description /camera_1/joint_states /camera_1/robot_description /camera_left/color/camera_info /camera_left/color/image_raw /camera_right/color/camera_info /camera_right/color/image_raw /clicked_point /clock /goal_pose /initialpose /parameter_events /performance_metrics /rosout /tf /tf_static ë”ìš±ì´ tf2 treeë„ ì™„ë²½í•˜ê²Œ êµ¬ì„±ë˜ì–´ rviz2ì—ì„œì˜ ì‹œê°í™”ë„ ë¬¸ì œì—†ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ World ê°€ì ¸ì™€ì„œ ì¨ë³´ê¸° ì´ë²ˆì—ëŠ”, ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸ë¥¼ í™œìš©í•˜ì—¬ ë‚˜ë§Œì˜ worldë¥¼ ë§Œë“œëŠ” ë°©ë²•ì— ëŒ€í•´ í•™ìŠµí•´ë³´ê² ìŠµë‹ˆë‹¤.\nì˜ˆì‹œ ì‹¤í–‰ $ ros2 launch lidar_world lidar_world.launch.py â‡’ í•´ë‹¹ worldëŠ” ì œê°€ youtube ê²€ìƒ‰ì„ í†µí•´ ê´œì°®ë‹¤ê³  ìƒê°ë˜ì–´ ì§ì ‘ ìˆ˜ì •í•´ë³¸ ê²ƒì…ë‹ˆë‹¤. (ë¬¼ë¡  ë¼ì´ì„¼ìŠ¤ëŠ” ì§€ì¼œì•¼ í•©ë‹ˆë‹¤.) youtube link\nyoutube linkë¥¼ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” í•´ë‹¹ í”„ë¡œì íŠ¸ ì½”ë“œë¥¼ ë¶„ì„í•´ë´…ì‹œë‹¤. â‡’ ì‚¬ìš©ëœ íŒ¨í‚¤ì§€ëŠ” ì´ 5ê°œ ì…ë‹ˆë‹¤. ì´ë“¤ ì¤‘ gazeboì™€ ê´€ë ¨ì´ ê¹Šì„ ê²ƒ ê°™ì€ robot_gazebo íŒ¨í‚¤ì§€ì—ì„œ launch fileì„ ë¶„ì„í•©ë‹ˆë‹¤.\nrobot_sim.launch.py return LaunchDescription([ IncludeLaunchDescription( PythonLaunchDescriptionSource( os.path.join(pkg_gazebo_ros, \u0026#39;launch\u0026#39;, \u0026#39;gzserver.launch.py\u0026#39;) ), launch_arguments={\u0026#39;world\u0026#39;: world}.items(), ), IncludeLaunchDescription( PythonLaunchDescriptionSource( os.path.join(pkg_gazebo_ros, \u0026#39;launch\u0026#39;, \u0026#39;gzclient.launch.py\u0026#39;) ), ), IncludeLaunchDescription( PythonLaunchDescriptionSource( os.path.join(pkg_cart_pole_control, \u0026#39;launch\u0026#39;, \u0026#39;robot_control.launch.py\u0026#39;) ), ), IncludeLaunchDescription( PythonLaunchDescriptionSource([launch_file_dir, \u0026#39;/robot_state_publisher.launch.py\u0026#39;]), launch_arguments={\u0026#39;use_sim_time\u0026#39;: use_sim_time}.items(), ), Node( package = \u0026#34;joy\u0026#34;, executable = \u0026#34;joy_node\u0026#34; ), ]) ìš°ë¦¬ê°€ ê´€ì‹¬ìˆëŠ” ê²ƒì€ world fileì˜ ìœ„ì¹˜ì´ë©°, ì´ë ‡ê²Œ ì°¾ì€ lio_world.modelì„ gazebo_rosê°€ ì•„ë‹Œ ì¼ë°˜ Gazeboë¡œ ë¡œì»¬ ì‹¤í–‰ì‹œì¼œë´…ë‹ˆë‹¤. gazebo lio_world.model â‡’ ì•„ë§ˆ ì‹¤í–‰ë˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤. lio_world.modelì—ì„œëŠ” gazebo ê¸°ë³¸ modelì´ ì•„ë‹Œ ì»¤ìŠ¤í…€ ëª¨ë¸ë“¤ì´ ì‚¬ìš©ë˜ê³  ìˆëŠ”ë°, ì´ë“¤ì„ Gazebo í™˜ê²½ë³€ìˆ˜ì— ì¶”ê°€í•´ì£¼ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.\në”°ë¼ì„œ ë‚˜ë§Œì˜ íŒ¨í‚¤ì§€ë¥¼ êµ¬ì„±í•˜ê³ , ì´ worldë¥¼ ë‹¤ì‹œ ì‹¤í–‰ì‹œì¼œë´…ë‹ˆë‹¤. íŒ¨í‚¤ì§€ ìƒì„± launch file ìƒì„±, world file, models file ë³µì‚¬ CMakeLists.txt ìˆ˜ì • íŒ¨í‚¤ì§€ ë¹Œë“œ í›„, ì‹¤í–‰ ì´ì „ì— ë°°ìš´ sensor plugin, urdf, sensor stick, moving stickì„ ëª¨ë‘ í™œìš©í•´ì„œ ì—¬ëŸ¬ë¶„ë§Œì˜ camera \u0026amp; lidar worldë¥¼ ë§Œë“¤ì–´ ë³´ì„¸ìš”!! - ê³¼ì œì…ë‹ˆë‹¤.\nâ‡’ ì œê°€ ë§Œë“  Worldë¥¼ ì°¸ê³ í•˜ì…”ë„ ì¢‹ì§€ë§Œ ì§ì ‘ í•´ë³´ì‹œê¸°ë¥¼ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.\nâ‡’ object animationì€ ë‹¤ìŒ ë§í¬ë¥¼ ì°¸ê³ í•©ë‹ˆë‹¤. link\n"
},
{
	"uri": "/kr/ros2_foxy/lecture13/",
	"title": "Lecture13. Useful ROS 2 Examples (Sensor Part)",
	"tags": [],
	"description": "",
	"content": "Useful ROS 2 Examples (Sensor Part) Topic, Service, Action, Gazebo ì˜ˆì‹œë“¤ì„ ì§„í–‰í•˜ë©´ì„œ ë‹¤ì–‘í•œ ì„¼ì„œ ë°ì´í„°ë“¤ì„ ë‹¤ë£¨ì–´ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ë²ˆ ì‹œê°„ì—ëŠ” ì˜ˆì‹œë“¤ê³¼ í•¨ê»˜ í•´ë‹¹ ì„¼ì„œ ë°ì´í„°ë“¤ì˜ ROS 2 ì—°ë™ í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•´ ë³´ê² ìŠµë‹ˆë‹¤.\nCV2 and ROS 2 ë‹¤ì–‘í•œ ì»´í“¨í„° ë¹„ì „ ì•Œê³ ë¦¬ì¦˜ì„ ë‹´ê³  ìˆëŠ” ì˜¤í”ˆì†ŒìŠ¤ ë¹„ì „ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ OpenCVë¥¼ ROS 2ì™€ ì—°ë™í•˜ì—¬ ì‚¬ìš©í•´ ë´…ì‹œë‹¤.\ncv2 and rclpy ì²«ë²ˆì§¸ ì‹œê°„ìœ¼ë¡œ ROS 2ì˜ ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ OpenCV Python, cv2ì™€ ì—°ë™í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.\nImage Publish - Python ìš°ì„ , í•­ìƒ ê·¸ë ‡ë“¯ì´ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì˜¨ë¼ì¸ìƒì—ì„œ ì•„ë¬´ ì˜ìƒ í•˜ë‚˜ë¥¼ ë‹¤ìš´ë°›ì•„ ìœ„ì¹˜ë¥¼ ê¸°ì–µí•´ì£¼ì„¸ìš”. img_pub.py ì½”ë“œì˜ VIDEO_FILE_ROOT ë³€ìˆ˜ë¥¼ í•´ë‹¹ ìœ„ì¹˜ë¡œ ë³€ê²½í•´ì¤ë‹ˆë‹¤. # Import the necessary libraries import rclpy # Python Client Library for ROS 2 from rclpy.node import Node # Handles the creation of nodes from sensor_msgs.msg import Image # Image is the message type from cv_bridge import CvBridge # Package to convert between ROS and OpenCV Images import cv2 # OpenCV library VIDEO_FILE_ROOT = \u0026#34;/home/kimsooyoung/ros2_ws/rosbag2/img_pub_test.mp4\u0026#34; íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œí•œ ë’¤, ì˜ˆì‹œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. # Terminal 1 - pkg build and run cbp py_cv_tutorial \u0026amp;\u0026amp; source install/local_setup.bash ros2 run py_cv_tutorial img_pub # Terminal 2 - rqt_image_view ros2 run rqt_image_view rqt_image_view â‡’ rqt image viewëŠ” ì´ë¯¸ì§€ topicë§Œì„ ìœ„í•œ rqt toolë¡œ ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ì‹œê°í™”í•´ì¤ë‹ˆë‹¤.\nì½”ë“œ ë¶„ì„ OpenCVì—ì„œëŠ” ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ë‹¤ë£° ë•Œ cv::Matë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë°˜ë©´ ROS 2ëŠ” sensor_msgs/msg/Imageë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë”°ë¼ì„œ Image \u0026lt;=\u0026gt; Mat ë³€í™˜ì„ ìœ„í•´ CV Bridgeë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. from cv_bridge import CvBridge # Package to convert between ROS and OpenCV Images import cv2 # OpenCV library class ImagePublisher(Node): \u0026#34;\u0026#34;\u0026#34; Create an ImagePublisher class, which is a subclass of the Node class. \u0026#34;\u0026#34;\u0026#34; def __init__(self): ... # Used to convert between ROS and OpenCV images self.br = CvBridge() def timer_callback(self): ... if ret == True: # Publish the image. # The \u0026#39;cv2_to_imgmsg\u0026#39; method converts an OpenCV # image to a ROS 2 image message self.publisher_.publish(self.br.cv2_to_imgmsg(frame, encoding=\u0026#34;bgr8\u0026#34;)) â‡’ CvBridge ê°ì²´ì˜ imgmsg_to_cv2ë¥¼ ì‚¬ìš©í•˜ë©´ ì†ì‰½ê²Œ Image dataë¡œ ë³€í™˜ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nImage Subscribe - Python ì¼ì „ í•™ìŠµí•˜ì˜€ë˜ rosbag2ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë³´ê³ ì í•©ë‹ˆë‹¤. ì œê°€ ë¯¸ë¦¬ ì¤€ë¹„í•œ ë°ì´í„°ì…‹ì„ ì œê³µë“œë¦¬ë‹ˆ, ê¸°ì–µí•˜ê¸° ì‰¬ìš´ ìœ„ì¹˜ì— ë‹¤ìš´ë°›ì•„ ì£¼ì„¸ìš”.\nğŸ“ quadrupped_train.zip\nWindows + WSL2 ìœ ì €ì˜ ê²½ìš° explorer.exe ëª…ë ¹ì–´ë¥¼ í†µí•´ íŒŒì¼ íƒìƒ‰ê¸°ë¥¼ ì—´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\níŒŒì¼ì„ ì ë‹¹í•œ ìœ„ì¹˜ì— ì €ì¥í•˜ê³  replay í•´ë´…ì‹œë‹¤. # ì˜ˆì œ ì‹¤í–‰ ì¤€ë¹„ colcon build --packages-select py_cv_tutorial source install/local_setup.bash # Terminal 1 â€“ ë°ì´í„° ìœ„ì¹˜ë¡œ ì´ë™í•˜ì—¬ ros2 bag ì‹¤í–‰ cd \u0026lt;ë°ì´í„°ë¥¼ ì €ì¥í•œ ìœ„ì¹˜\u0026gt; ros2 bag play quadrupped_train.bag_0.db3 # Terminal 2 â€“ image_view ì‹¤í–‰ ros2 run rqt_image_view rqt_image_view ì‚¬ì§„ê³¼ ê°™ì´ ê¸°ì°¨ ì„ ë¡œ ëª¨ìŠµì´ ë³´ì¸ë‹¤ë©´ ì„±ê³µì…ë‹ˆë‹¤.\ní•´ë‹¹ ë°ì´í„°ì…‹ì€ ê¸°ì°¨ ì„ ë¡œì—ì„œ ì£¼í–‰í•˜ëŠ” 4ì¡± ë³´í–‰ ë¡œë´‡ìœ¼ë¡œë¶€í„° ì·¨ë“í•œ ê²ƒì…ë‹ˆë‹¤. ê¸°ì°¨ ì„ ë¡œëŠ” ì£¼ê¸°ì ìœ¼ë¡œ ê´€ë¦¬ê°€ í•„ìš”í•˜ë©°, ê¸¸ê³  ê¸´ ì„ ë¡œë¥¼ ë¡œë´‡ì´ ìë™ìœ¼ë¡œ ê²€ì‚¬í•´ì¤€ë‹¤ë©´ ì•„ì£¼ ìœ ìš©í•  ê²ƒì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ìƒìƒì„ í•´ë³´ë©´ì„œ ì‹¤ìŠµì— ì„í•´ë´…ì‹œë‹¤.\në‹¤ìŒì€ ros2 bagì„ ì¬ìƒí•˜ë©´ì„œ ìƒê¸°ëŠ” Image topicì„ subscribeí•œ ë’¤, ì´ë¥¼ cv2.imshow()ë¡œ ì‹œê°í™”í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤. # Terminal 1 $ cd \u0026lt;bag íŒŒì¼ ìœ„ì¹˜\u0026gt; $ ros2 bag play quadruped_train/quadruped_train.bag_0.db3 [INFO] [1667077909.362223100] [rosbag2_storage]: Opened database \u0026#39;quadrupped_train/quadrupped_train.bag_0.db3\u0026#39; for READ_ONLY. ... # Terminal 2 $ ros2 run py_cv_tutorial img_sub [INFO] [1667077909.613586300] [image_subscriber]: Receiving video frame [INFO] [1667077910.934147000] [image_subscriber]: Receiving video frame ... ì´ë²ˆì—ëŠ” ROS2 msgë¥¼ cvë°ì´í„° í¬ë©§ìœ¼ë¡œ ë³€í™˜í•´ì•¼ í•˜ì§€ìš”? cv_bridgeë¥¼ í†µí•´ imgmsg_to_cv2 í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ì—¬ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. from cv_bridge import CvBridge # Package to convert between ROS and OpenCV Images import cv2 # OpenCV library class ImageSubscriber(Node): def __init__(self): # Used to convert between ROS and OpenCV images self.br = CvBridge() ... def listener_callback(self, data): ... # Convert ROS Image message to OpenCV image current_frame = self.br.imgmsg_to_cv2(data, \u0026#34;bgr8\u0026#34;) edge_frame = self.hough_transform(current_frame) imgmsg_to_cv2ë¥¼ í†µí•´ CV::Matìœ¼ë¡œ ë³€í™˜ëœ ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ OpenCVì˜ ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤ê³¼ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì½”ë“œì˜ imshow ë¶€ë¶„ì„ ìœ„ì™€ ê°™ì´ ì£¼ì„ í† ê¸€í•˜ì—¬ ì´ë¯¸ì§€ ì²˜ë¦¬ë¥¼ ì ìš©í•´ ë´…ì‹œë‹¤. ì˜ˆì‹œë¥¼ ìœ„í•´ ì§ì„ ê²€ì¶œ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. ì§ì„  ê²€ì¶œì„ ìœ„í•´ ì‚¬ìš©ëœ OpenCV ê¸°ëŠ¥ë“¤ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. ë¡œì§ì„ ì—…ê·¸ë ˆì´ë“œí•˜ì—¬ ì—¬ëŸ¬ë¶„ë§Œì˜ ë¡œì§ì„ ë§Œë“¤ì–´ ë³´ì„¸ìš”!\ncv2.GaussianBlur cv2.fillPoly / cv2.bitwise_and ROI ì„¤ì • cv2.HoughLinesP rosbag2 to seperate image ì»´í“¨í„° ë¹„ì „ë§Œìœ¼ë¡œ ì™„ë²½í•œ ì„ ë¡œ ì¸ì‹ì„ êµ¬í˜„í•˜ê¸°ëŠ” ë„ˆë¬´ë‚˜ í˜ë“­ë‹ˆë‹¤. ë”¥ëŸ¬ë‹ì„ ì‚¬ìš©í•´ì„œ ì´ë¥¼ ê·¹ë³µí•  ìˆ˜ ìˆì„ ê²ƒì´ë©°, ë°ì´í„°ì…‹ì˜ ì œì‘ì„ ìœ„í•´ rosbag2 ë°ì´í„°ì—ì„œ ì´ë¯¸ì§€ë¥¼ ì¶”ì¶œí•˜ëŠ” ì˜ˆì‹œë¥¼ ì¤€ë¹„í•˜ì˜€ìŠµë‹ˆë‹¤.\n$ ros2 run py_cv_tutorial rosbag2_to_timedimg /home/kimsooyoung/ros2_ws/rosbag2/quadrupped_train/quadrupped_train.bag_0.db3 saved: color_1666796292992515592.png saved: color_1666796293035428479.png saved: color_1666796293079139778.png saved: color_1666796293120768031.png saved: color_1666796293161406687.png ... ì˜ˆì œ ì‹¤í–‰ ì „ main í•¨ìˆ˜ì—ì„œ bag íŒŒì¼ì˜ ìœ„ì¹˜ë¥¼ ì—¬ëŸ¬ë¶„ì˜ ê²ƒìœ¼ë¡œ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤. def main(args=None): # Change below roots to your ros2 bag locations ROOT_DIR = \u0026#34;/home/kimsooyoung/ros2_ws/rosbag2/quadrupped_train\u0026#34; FILENAME = \u0026#34;/quadrupped_train.bag_0.db3\u0026#34; DESCRIPTION = \u0026#34;color_\u0026#34; ì˜ˆì œ ì‹¤í–‰ í›„ ì‚¬ì§„ê³¼ ê°™ì´ ìƒì„±ëœ ì´ë¯¸ì§€ë“¤ì´ ë³´ì¸ë‹¤ë©´ ì„±ê³µì…ë‹ˆë‹¤. wslì„ ì‚¬ìš©ì¤‘ì´ì‹  ë¶„ë“¤ì€ ì•„ë˜ì™€ ê°™ì´ íŒŒì¼ íƒìƒ‰ê¸°ë¥¼ ì‚¬ìš©í•˜ì„¸ìš” CV2 and rclcpp íŒŒì´ì¬ì„ í†µí•´ ROS 2ì™€ OpenCVë¥¼ ì—°ë™í•˜ëŠ” ê¸°ë³¸ì ì¸ ë§¥ë½ì€ ì´í•´í•˜ì…¨ìœ¼ë¦¬ë¼ ìƒê°í•©ë‹ˆë‹¤. ë™ì¼í•œì‘ì—…ì„ C++ì—ì„œ ì‘ì—…í•˜ë©´ì„œ ëª‡ê°€ì§€ ìœ ì˜ì ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nì½”ë”©ì„ ì‹œì‘í•˜ê¸° ì „ì—, ì œê°€ ì‚¬ìš©í•œ opencv ë²„ì „ì„ í™•ì¸í•˜ê³  ê°€ê² ìŠµë‹ˆë‹¤. $ pkg-config --modversion opencv4 4.2.0 Image Publish - Python ì´ë²ˆì— ì‚¬ìš©ë˜ëŠ” íŒŒì¼ì€ img_pub.cppì´ë©°, ì •ìƒ ì‹¤í–‰ì„ ìœ„í•´ VIDEO_FILE_ROOT ë³€ìˆ˜ë¥¼ ì—¬ëŸ¬ë¶„ì˜ ì˜ìƒ ê²½ë¡œë¡œ ìˆ˜ì •í•©ë‹ˆë‹¤. #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; #include \u0026#34;std_msgs/msg/header.hpp\u0026#34; #include \u0026#34;sensor_msgs/msg/image.hpp\u0026#34; // cv_bridge converts between ROS 2 image messages and OpenCV image representations. #include \u0026lt;cv_bridge/cv_bridge.h\u0026gt; // Using image_transport allows us to publish and subscribe to compressed image streams in ROS2 #include \u0026lt;image_transport/image_transport.hpp\u0026gt; // We include everything about OpenCV as we don\u0026#39;t care much about compilation time at the moment. #include \u0026lt;opencv2/opencv.hpp\u0026gt; const std::string VIDEO_FILE_ROOT = \u0026#34;/home/kimsooyoung/ros2_ws/go1_lidar.mp4\u0026#34;; ì˜ˆì‹œ ìì²´ëŠ” pythonê³¼ ë™ì¼í•©ë‹ˆë‹¤. # Terminal 1 - run demo ros2 run cpp_cv_tutorial img_pub # Terminal 2 - rqt_image_view ros2 run rqt_image_view rqt_image_view c++ì—ì„œëŠ” CvImage ê°ì²´ë¥¼ êµ³ì´ ìƒì„±í•´ì•¼ í•  í•„ìš” ì—†ì´ toImageMsgë¥¼ ì‚¬ìš©í•´ ë³€í™˜í•©ë‹ˆë‹¤. ëŒ€ì‹  ì‹¤ì œ msgë¡œ ì‚¬ìš©í•  ë•ŒëŠ” get() í•¨ìˆ˜ë¥¼ í†µí•œ forwardingì´ í•„ìš”í•©ë‹ˆë‹¤. #include \u0026lt;cv_bridge/cv_bridge.h\u0026gt; #include \u0026lt;image_transport/image_transport.hpp\u0026gt; #include \u0026lt;opencv2/opencv.hpp\u0026gt; ... void timer_callback() { // // Create a new 640x480 image // cv::Mat my_image(cv::Size(640, 480), CV_8UC3); //--- GRAB AND WRITE LOOP cap.read(my_img); if (my_img.empty()){ std::cerr \u0026lt;\u0026lt; \u0026#34;ERROR! blank frame grabbed\\n\u0026#34;; rclcpp::shutdown(); } // Write message to be sent. Member function toImageMsg() converts a CvImage // into a ROS image message img_msg = cv_bridge::CvImage(std_msgs::msg::Header(), \u0026#34;bgr8\u0026#34;, my_img).toImageMsg(); // Publish the image to the topic defined in the publisher image_pub-\u0026gt;publish(*img_msg.get()); } Image Subscribe - Python ì˜ˆì œ ì‹¤í–‰ì„ ìœ„í•´ gazebo worldë¥¼ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤. ros2 launch chess_world chess_world.launch.py ì‚¬ìš©í•˜ê³  ì‹¶ì€ topic ì´ë¦„ì„ img_sub.cppì— ë°˜ì˜í•œ ë’¤ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. class ImageSubscriber : public rclcpp::Node{ private: rclcpp::Subscription\u0026lt;Image\u0026gt;::SharedPtr m_img_sub; rclcpp::Publisher\u0026lt;Image\u0026gt;::SharedPtr m_img_pub; public: ImageSubscriber(): Node(\u0026#34;image_subscriber\u0026#34;){ std::string topic_name = \u0026#34;video_frames\u0026#34;; m_img_sub = this-\u0026gt;create_subscription\u0026lt;Image\u0026gt;( topic_name, 10, std::bind(\u0026amp;ImageSubscriber::image_cb, this, std::placeholders::_1) ); ì˜ˆì‹œ ì‹¤í–‰ - ì•„ë§ˆ ë‹¨ìˆœ ì´ë¯¸ì§€ í”„ë ˆì„ë§Œ ë°˜ë³µë  ê²ƒì…ë‹ˆë‹¤. ros2 run cpp_cv_tutorial img_sub ì´ë²ˆ ì˜ˆì‹œëŠ” ì¼ì¢…ì˜ template ì²˜ëŸ¼ ì‘ì„±í•´ë³´ì•˜ìŠµë‹ˆë‹¤. image topicì„ ë°›ì•„ í”„ë¡œì„¸ì‹±ì„ ê±°ì¹˜ê³  ì´ ê²°ê³¼ë¥¼ í™”ë©´ì— ë³´ì—¬ì£¼ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤. cv::Mat image_processing(const cv::Mat img_in){ // Create output image cv::Mat img_out; cv::Mat img_small; ... return img_out; } void image_cb(const Image::SharedPtr msg) const{ // Convert ROS Image to CV Image cv::Mat frame = cv_bridge::toCvCopy( msg, sensor_msgs::image_encodings::BGR8 )-\u0026gt;image; // Image processing cv::Mat proced_img = image_processing(frame); } í˜„ ì‹œìŠ¤í…œì—ì„œ OpenCVëŠ” CMakeì˜ find_packageë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— C++ ì˜ˆì‹œë¥¼ ë¹Œë“œí•  ë•Œ CMakeLists.txtì—ì„œ ament_target_dependenciesë¥¼ ëª…ì‹œí•©ë‹ˆë‹¤. find_package(OpenCV REQUIRED) add_executable(img_pub src/img_pub.cpp) ament_target_dependencies(img_pub rclcpp std_msgs sensor_msgs cv_bridge image_transport OpenCV) add_executable(img_sub src/img_sub.cpp) ament_target_dependencies(img_sub rclcpp std_msgs sensor_msgs cv_bridge image_transport OpenCV) PCL and ROS 2 ì´ë²ˆ ì‹œê°„ë¶€í„° 3D PointCloud Data ì²˜ë¦¬ë¥¼ ìœ„í•œ ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” PCL(Point Cloud Library)ì„ ì‹¤ìŠµí•˜ê³  ROS 2ì™€ ì—°ë™í•´ë³´ê³ ì í•©ë‹ˆë‹¤.\nì‚¬ì‹¤ ê¸°ë³¸ì ì¸ PCLì— ëŒ€í•œ ì´í•´ê°€ ìˆë‹¤ë©´ ì¼ì „ cv2 ì˜ˆì‹œì²˜ëŸ¼ ROS 2 â‡’ PCL, PCL â‡’ ROS 2ì˜ Mapping ì‘ì—…ë§Œ ì˜ ìˆ˜í–‰í•˜ë©´ ë˜ëŠ”ë°ìš”. ë”°ë¼ì„œ python, c++ì—ì„œ pclì„ ë‹¤ë£¨ëŠ” ë°©ë²•ì— ëŒ€í•´ ë¨¼ì € ìµìˆ™í•´ì§„ ë’¤ ROS 2ì—ì„œ ì´ë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.\nAbout Point Cloud Point Cloud DataëŠ” ìˆ˜ë§ì€ 3ì°¨ì› ìƒì˜ ë°ì´í„°ë“¤ì´ ëª¨ì¸ ì§‘í•©ì²´ì…ë‹ˆë‹¤. â‡’ í•˜ì§€ë§Œ x,y,zë¥¼ ë¹„ë¡¯í•´ì„œ Point Cloudì˜ ì¶”ê°€ ë°ì´í„° í•­ëª©ë“¤ì´ ìˆìŠµë‹ˆë‹¤. ìì£¼ ì‚¬ìš©ë˜ëŠ” point cloud í¬ë©§ë“¤ì„ ì‚´í´ë´…ì‹œë‹¤.\nPointXYZ ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ xyz ìœ„ì¹˜ ë°ì´í„°ë§Œ ë‹´ê³  ìˆìŠµë‹ˆë‹¤.\nPointXYZI intensityë¼ëŠ” í•„ë“œê°€ ì¶”ê°€ëœ í˜•íƒœë¡œ ì´ëŠ” ë¬¼ì²´ë¡œë¶€í„° ë˜ëŒì•„ì˜¨ ë¹›ì˜ ì–‘ì„ ëœ»í•©ë‹ˆë‹¤. ë°”ë‹¥ì— ê³ ì¸ ë¬¼ì´ë‚˜ íˆ¬ëª…í•œ ë¬¼ì²´ì˜ ê²½ìš° ì´ I í•„ë“œë¥¼ í†µí•´ detection ê°€ëŠ¥í•˜ì—¬ ìµœê·¼ í™œë°œíˆ ì—°êµ¬ë˜ê³  ìˆìŠµë‹ˆë‹¤.\nPointXYZRGB RGB 3ìƒ‰ì´ í¬í•¨ëœ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ rgbd cameraì—ì„œ ì£¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.\nPCD Format Point CloudëŠ” ì—¬ëŸ¬ ë°ì´í„° í¬ë§·ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥í•˜ì§€ë§Œ ê°€ì¥ ìì£¼ ì‚¬ìš©ë˜ëŠ” ê²ƒì€ pcd í¬ë§·ì…ë‹ˆë‹¤. ì´ëŠ” í¬ê²Œ header/dataë¡œ êµ¬ë¶„ë˜ì–´ ìˆìœ¼ë©° ì˜ˆì‹œë¥¼ í†µí•´ í•¨ê»˜ ìµìˆ™í•´ì ¸ë³´ê² ìŠµë‹ˆë‹¤.\nDescription Header ì „ì²´ í¬ì¸íŠ¸ ìˆ˜, ë°ì´í„° íƒ€ì…, í¬ê¸° ë“±ì˜ ì •ë³´ Data x,y,z ë˜ëŠ” x,y,z + ì¶”ê°€ì •ë³´ example - xyzrgb format # .PCD v0.7 - Point Cloud Data file format VERSION 0.7 FIELDS x y z rgb SIZE 4 4 4 4 TYPE F F F U COUNT 1 1 1 1 WIDTH 4421 HEIGHT 1 VIEWPOINT 0 0 0 1 0 0 0 POINTS 4421 DATA ascii -0.8739934 -1.342802 0.73930842 1577997 -0.86556709 -1.342802 0.73930842 1577997 -0.85433203 -1.3428019 0.73930848 1577997 -0.84450132 -1.3428019 0.73930854 1577997 ROS 2ì—ì„œ ì‚¬ìš©í•˜ëŠ” PointCloud ë°ì´í„° í¬ë§·ì€ í¬ê²Œ ë‘ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤. sensor_msgs/msg/PointCloud std_msgs/Header header geometry_msgs/Point32[] points ChannelFloat32[] channels sensor_msgs/msg/PointCloud2 std_msgs/Header header uint32 height uint32 width PointField[] fields bool is_bigendian # Is this data bigendian? uint32 point_step # Length of a point in bytes uint32 row_step # Length of a row in bytes uint8[] data # Actual point data, size is (row_step*height) bool is_dense # True if there are no invalid points PointCloud2ê°€ ë”ìš± í’ë¶€í•œ ë°ì´í„°ë¥¼ ë‹´ê³  ìˆëŠ”ë°ìš”. ROS 2 Foxy ì´ìƒë¶€í„° PointCloud2ë¥¼ ì§€ì›í•˜ë©° ê·¸ ì´í›„ ë²„ì „ë¶€í„° PointCloudëŠ” ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\nPCL ì„¤ì¹˜ PCL c++ì€ ROS 2 ì„¤ì¹˜ ì‹œ ìë™ìœ¼ë¡œ ì„¤ì¹˜ë˜ë¯€ë¡œ ë³„ë„ ì„¤ì¹˜ëŠ” í•„ìš” ì—†ìŠµë‹ˆë‹¤. (ì˜¤íˆë ¤ ì˜ëª» ê±´ë“¤ë©´ ë³µì¡í•´ì§€ë¯€ë¡œ ê°€ë§Œíˆ ëƒ…ë‘¡ì‹œë‹¤.) PCL pythonì€ ubuntu ë²„ì „ì— ë”°ë¼ ì„¤ì¹˜ ë°©ë²•ì´ ë‹¤ë¦…ë‹ˆë‹¤.\nubuntu â‰¤ 18.04 $ sudo pip install cython $ sudo apt-get install pcl-tools $ sudo apt install python3-pcl $ sudo add-apt-repository ppa:sweptlaser/python3-pcl $ sudo apt update $ sudo apt install python3-pcl ubuntu â‰¥ 20.04 $ sudo apt install python3-pcl ì„¤ì¹˜ê°€ ì˜ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ë´…ì‹œë‹¤. $ python3 Python 3.8.10 [GCC 9.4.0] on linux Type \u0026#34;help\u0026#34;, \u0026#34;copyright\u0026#34;, \u0026#34;credits\u0026#34; or \u0026#34;license\u0026#34; for more information. \u0026gt;\u0026gt;\u0026gt; import pcl \u0026gt;\u0026gt;\u0026gt; PCL python ì•„ë˜ í‘œì™€ ê°™ì´ pclì€ ë‹¤ì–‘í•œ ì•Œê³ ë¦¬ì¦˜ì„ API í˜•íƒœë¡œ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì— ìµìˆ™í•´ì§€ê¸° ìœ„í•´ python pclì„ ì‚¬ìš©í•˜ì—¬ ì‹¤ìŠµì„ í•´ë³¸ ë’¤, ì‹¤ì œ ROS 2 topicì„ ì²˜ë¦¬í•´ë³´ê³ , c++ë¡œë„ ì‚¬ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤.\nFuction Description pcl_visualization PointCloud ì‹œê°í™” ë„êµ¬ pcl_surface 3ì°¨ì› ê³¡ë©´ ë³µì› pcl_segmentation PointCloudì˜ Clusteringê³¼ Classification ê¸°ëŠ¥ pcl_sample_consensus ì„ , í‰ë©´, ì‹¤ë¦°ë” ë“± ëª¨ë¸ ì¶”ì •ì„ ìœ„í•œ ì•Œê³ ë¦¬ì¦˜ pcl_kdtree ë¹ ë¥¸ ì²˜ë¦¬, íƒìƒ‰ì„ ìœ„í•œ ìë£Œ êµ¬ì¡° pcl_features PointCloudë¡œë¶€í„° íŠ¹ì§• ì¶”ì¶œì„ ìœ„í•œ ìë£Œ êµ¬ì¡°ì™€ ë°©ë²•ë“¤ pcl_registration ICPì™€ ê°™ì´ ì„œë¡œ ë‹¤ë¥¸ PointCloudë¥¼ Aligní•˜ê³  ì •í•©í•˜ê¸° ìœ„í•œ ë°©ë²•ë“¤ pcl_keypoints Key point ê²€ì¶œ ì•Œê³ ë¦¬ì¦˜ (BRISK, Harris Corner, NARF, SIFT, SUSAN ë“±) pcl_io 3D ì„¼ì„œë¡œë¶€í„° PointCloud ë°ì´í„°ë¥¼ ì§ì ‘ ì½ê³  ì“°ê¸° ìœ„í•œ ì¸í„°í˜ì´ìŠ¤ PCL IO pcd í¬ë©§ì˜ point cloud ë°ì´í„°ë¥¼ ì½ê³ , ì €ì¥í•˜ê³ , ì‹œê°í™”í•˜ëŠ” ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. cd py_pcl_tutorial/exercise python3 example1_load_and_view.py example1_load_and_view.py import pcl import pcl.pcl_visualization # Load point cloud file cloud = pcl.load_XYZRGB(\u0026#39;./data/pcl_sub_node.pcd\u0026#39;) # Create pcl built-in viewer visual = pcl.pcl_visualization.CloudViewing() ##### Visualize APIs ##### # \u0026#39;ShowColorACloud\u0026#39;, # \u0026#39;ShowColorCloud\u0026#39;, # \u0026#39;ShowGrayCloud\u0026#39;, # \u0026#39;ShowMonochromeCloud\u0026#39;, # \u0026#39;WasStopped\u0026#39; filename = \u0026#39;example_save.pcd\u0026#39; pcl.save(cloud, filename) visual.ShowColorCloud(cloud, b\u0026#39;cloud\u0026#39;) v = True while v: v = not(visual.WasStopped()) pcl_sub_node.pcdëŠ” lidar worldì—ì„œ ì œê°€ ë¯¸ë¦¬ ì¶”ì¶œí•´ ë‘” pointcloud ì…ë‹ˆë‹¤.\nDescription pcl.load_XYZRGB() pcd dataë¥¼ loadí•©ë‹ˆë‹¤. ë‹¨, ì €ì¥ëœ ìœ í˜•ì— ë”°ë¼ load_XYZ, load_XYZI ë“± ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ê°€ ë‹¤ë¦…ë‹ˆë‹¤. pcl.pcl_visualization.CloudViewing() ì‹œê°í™”ë¥¼ ìœ„í•œ ë·°ì–´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. pcl.save(, ) ì²˜ë¦¬í•œ cloudë¥¼ ì €ì¥í•©ë‹ˆë‹¤. Voxel Grid Sampling ìˆ˜ë§ì€ point cloudë“¤ì„ ëª¨ë‘ ê°ê° ì²˜ë¦¬í•˜ëŠ” ê²ƒì€ ë§¤ìš° ë§ì€ ì—°ì‚°ì„ ìš”í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ë³´í†µ ì´ë¥¼ 3ì°¨ì› ê²©ìì˜ Voxel í˜•íƒœë¡œ Sampling í•©ë‹ˆë‹¤. Voxelì´ë€, ë§ˆì¹˜ ê²Œì„ ê·¸ë˜í”½ì²˜ëŸ¼ í•´ìƒë„ë¥¼ ë‚®ì¶˜ íë¸Œì´ë©° Voxel ë‚´ ì  êµ° ìœ /ë¬´ì— ë”°ë¼ ì¤‘ì‹¬ì ì„ ìƒ˜í”Œë§í•©ë‹ˆë‹¤.\nexample2_voxelgrid.py # Voxel Grid filter # Create a VoxelGrid filter object for our input point cloud vox = cloud.make_voxel_grid_filter() # Choose a voxel (also known as leaf) size # Note: this (1) is a poor choice of leaf size # Experiment and find the appropriate size! LEAF_SIZE = 0.01 # Set the voxel (or leaf) size vox.set_leaf_size(LEAF_SIZE, LEAF_SIZE, LEAF_SIZE) # Call the filter function to obtain the resultant downsampled point cloud cloud_voxed = vox.filter() LEAF_SIZE = 0.01\nLEAF_SIZE = 0.1\nPass Through Filter ROI(Region of Interest)ë¥¼ ì„¤ì •í•˜ê³  ì›í•˜ëŠ” ìœ„ì¹˜ì˜ point cloudë“¤ë§Œ ì¶”ë ¤ë‚´ë³´ê² ìŠµë‹ˆë‹¤. ì£¼ë¡œ ë°”ë‹¥ ì§€ì ì´ë‚˜, í…Œì´ë¸” ìœ„ ë¬¼ì²´ì—ì„œ ë¬¼ì²´ ë¶€ë¶„ë§Œ ì¶”ì¶œí•˜ëŠ” ê²½ìš° ì‚¬ìš©ë©ë‹ˆë‹¤.\nexample3_roi_filter.py # Pass Through filter passthrough = cloud_voxed.make_passthrough_filter() # Assign axis and range to the passthrough filter object. filter_axis = \u0026#39;z\u0026#39; passthrough.set_filter_field_name(filter_axis) axis_min = -1.1 axis_max = 1.1 passthrough.set_filter_limits(axis_min, axis_max) cloud_filtered = passthrough.filter() â‡’ í˜„ì¬ zì¶•ì„ ê¸°ì¤€ìœ¼ë¡œ -1.1 ~ 1.1 ì˜ì—­ì„ í•„í„°ë§í•˜ì˜€ìŠµë‹ˆë‹¤. x y ì¶•ì— ëŒ€í•´ì„œë„ ë™ì¼ ì‘ì—…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nRANSAC Plane Fitting ì§ì„ ì€ 2ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¡œ, í‰ë©´ì€ 3ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ëª¨ë¸ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. PCLì—ì„œëŠ” ì´ëŸ° ëª¨ë¸ ê¸°ë°˜ Consensusë¥¼ ì‚¬ìš©í•˜ëŠ” ê°€ì¥ ëŒ€í‘œì ì¸ ì˜ˆì‹œì¸ RANSACì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.\nModel Hypothesisë¥¼ í†µí•´ ë§¤ê°œë³€ìˆ˜ë¥¼ êµ¬í–ˆë‹¤ë©´, í•´ë‹¹ ëª¨ë¸ì— í¬í•¨ë˜ëŠ” inlierì™€ outlierë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤. ì´ë•Œ inlierì˜ ì„ê³„ê°’ìœ¼ë¡œ í—ˆìš©í•˜ëŠ” ìµœëŒ€ ê±°ë¦¬ê°€ max_distanceì…ë‹ˆë‹¤. seg.segment()ë¥¼ í†µí•´ ë„ì¶œí•œ inlier index ë“¤ë¡œ ê¸°ì¡´ point cloudì—ì„œ inliner/outlierë“¤ì„ ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. negative=True â‡’ outlier extraction negative=False â‡’ inlier extraction # RANSAC plane segmentation # Create the segmentation object seg = cloud_filtered.make_segmenter() # Set the model you wish to fit seg.set_model_type(pcl.SACMODEL_PLANE) seg.set_method_type(pcl.SAC_RANSAC) # Max distance for a point to be considered fitting the model # Experiment with different values for max_distance # for segmenting the table max_distance = 0.01 seg.set_distance_threshold(max_distance) # Call the segment function to obtain set of inlier indices and model coefficients inliers, coefficients = seg.segment() # Extract inliers extracted_inliers = cloud_filtered.extract(inliers, negative=True) ëª©ì  ìì²´ëŠ” ë°”ë‹¥ì„ ì œê±°í•œë‹¤ëŠ” ì ì—ì„œ Pass Through Filterì™€ ë™ì¼í•˜ì§€ë§Œ, ì‚¬ìš©ë˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì—ì„œ ì°¨ì´ë¥¼ ê°–ìŠµë‹ˆë‹¤.\nStatistical Outlier Removal Filter ì‹¤ì œ ì„¼ì„œë¥¼ ì‚¬ìš©í•˜ë‹¤ë³´ë©´ ì‚¬ì§„ê³¼ ê°™ì´ ë…¸ì´ì¦ˆë„ ì‹¬í•˜ê³ , ì˜ë„ì¹˜ ì•ŠëŠ” ë¹„ì •ìƒì ì¸ ì´ìƒì¹˜ê°€ ë°œìƒí•©ë‹ˆë‹¤. PCLì—ì„œëŠ” ì¼ì¢…ì˜ í‰ê·  í•„í„°ë¥¼ í†µí•´ ì´ë¥¼ ì œê±°í•˜ëŠ” í•¨ìˆ˜ë¥¼ ê°–ê³  ìˆìŠµë‹ˆë‹¤.\n# Much like the previous filters, we start by creating a filter object: outlier_filter = cloud_filtered.make_statistical_outlier_filter() # Set the number of neighboring points to analyze for any given point outlier_filter.set_mean_k(50) # Set threshold scale factor x = 1.0 # Any point with a mean distance larger than global (mean distance+x*std_dev) will be considered outlier outlier_filter.set_std_dev_mul_thresh(x) # Finally call the filter function for magic cloud_filtered = outlier_filter.filter() â‡’ í˜„ì¬ ìš°ë¦¬ ì˜ˆì‹œëŠ” Gazeboì—ì„œ ì¶”ì¶œí•œì§€ë¼ ì´ í•„í„°ì˜ ì˜í–¥ì´ ê±°ì˜ ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì˜ˆì œ ì½”ë“œëŠ” ìƒëµí•˜ê² ìŠµë‹ˆë‹¤.\nKD-Tree Search KD-TreeëŠ” Binary Treeë¥¼ ì‘ìš©í•œ K ì°¨ì›ì˜ ìë£Œ êµ¬ì¡°ì…ë‹ˆë‹¤. x,y,z 3ì°¨ì›ì— ëŒ€í•œ KD-Treeë¥¼ êµ¬ì¶•í•˜ê³ , ì´ ì•ˆì— ëª¨ë“  pointë“¤ì„ ê°€ì§€ëŸ°íˆ ì¶”ê°€í•´ë‘ë©´, ì´í›„ ê±°ë¦¬ ê³„ì‚° ë“± ì—°ì‚° ì‹œ ë§¤ìš° ë¹ ë¥¸ íƒìƒ‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n# create kd tree for the search method of extraction tree = extracted_inliers.make_kdtree() â‡’ XYZRGB ë°ì´í„°ëŠ” make_kdtree_flann()ì´ë¼ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\nEuclidean Clustering (DBSCAN) Point Cloudë“¤ì„ ë¶„ë¥˜í•˜ì—¬ êµ°ì§‘í™”ë¥¼ í•´ì•¼ ë¬¼ì²´ ì¸ì‹ê³¼ ì¶”ì •ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. êµ°ì§‘ê³¼ ì•Œê³ ë¦¬ì¦˜ì—ëŠ” ì—¬ëŸ¬ ì¢…ë¥˜ê°€ ìˆì§€ë§Œ ì´ë²ˆ ì‹¤ìŠµì—ì„œëŠ” ë°€ì§‘ë„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë¶„ë¥˜í•˜ëŠ” Euclidean Clusteringì„ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.\nì´ ë°©ì‹ì€ í´ëŸ¬ìŠ¤í„° ìˆ˜ë¥¼ ì§€ì •í•˜ì§€ ì•Šì•„ë„ ì•Œì•„ì„œ í´ëŸ¬ìŠ¤í„° ìˆ˜ë„ ê²°ì •í•˜ê³ , ë¶ˆíŠ¹ì •í•œ í˜•ìƒì˜ í´ëŸ¬ìŠ¤í„°ë„ ë¶„ë¥˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¿ë§Œ ì•„ë‹ˆë¼ ë…¸ì´ì¦ˆì—ë„ ê°•ì¸í•œ ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤.\nexample5_clustering.py # Load point cloud file cloud = pcl.load_XYZRGB(\u0026#39;./data/pcl_sub_node.pcd\u0026#39;) # eliminate color from cloud for clustering while_cloud = XYZRGB_to_XYZ(cloud) ... # Create a cluster extraction object ec = extracted_inliers.make_EuclideanClusterExtraction() # Set tolerances for distance threshold # as well as minimum and maximum cluster size (in points) ec.set_ClusterTolerance(0.07) ec.set_MinClusterSize(10) ec.set_MaxClusterSize(25000) # Search the k-d tree for clusters ec.set_SearchMethod(tree) # Extract indices for each of the discovered clusters cluster_indices = ec.Extract() # Create Cluster-Mask Point Cloud to visualize each cluster separately get_color_list.color_list =[] cluster_color = get_color_list(len(cluster_indices)) # Assign a color corresponding to each segmented object in scene color_cluster_point_list = [] for j, indices in enumerate(cluster_indices): for i, indice in enumerate(indices): color_cluster_point_list.append([extracted_inliers[indice][0], extracted_inliers[indice][1], extracted_inliers[indice][2], rgb_to_float(cluster_color[j])]) #Create new cloud containing all clusters, each with unique color cluster_cloud = pcl.PointCloud_PointXYZRGB() cluster_cloud.from_list(color_cluster_point_list) ì´ì „ ì˜ˆì‹œì™€ ë‹¬ë¦¬, clusteringì„ ìœ„í•´ í•„ìš”ì—†ëŠ” ìƒ‰ìƒ ë°ì´í„°ëŠ” ì œê±°í•˜ì˜€ìŠµë‹ˆë‹¤. # Load point cloud file cloud = pcl.load_XYZRGB(\u0026#39;./data/pcl_sub_node.pcd\u0026#39;) # eliminate color from cloud for clustering while_cloud = XYZRGB_to_XYZ(cloud) make_EuclideanClusterExtraction()ì„ í†µí•´ filterë¥¼ êµ¬ì„±í•˜ê³  ë§¤ê°œë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. # Create a cluster extraction object ec = extracted_inliers.make_EuclideanClusterExtraction() # Set tolerances for distance threshold # as well as minimum and maximum cluster size (in points) ec.set_ClusterTolerance(0.07) ec.set_MinClusterSize(10) ec.set_MaxClusterSize(25000) Description set_ClusterTolerance point clout ì²˜ë¦¬ ì‹œ clusterë¡œ íŒë‹¨í•˜ëŠ” ê¸°ì¤€ ê±°ë¦¬ set_MinClusterSize clusterê°€ ë˜ê¸° ìœ„í•œ ìµœì†Œ point cloud ê°œìˆ˜ set_MaxClusterSize clusterê°€ ë˜ê¸° ìœ„í•œ ìµœëŒ€ point cloud ê°œìˆ˜ clusterë¥¼ íŒë‹¨í•˜ê¸° ìœ„í•´ ê±°ë¦¬ê³„ì‚°ì´ í•„ìš”í•˜ë©°, ì´ëŠ” ì¼ì „ ìƒì„±í•œ KD treeë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ec.set_SearchMethod(tree) clusteringì˜ ê²°ê³¼ëŠ” point cloud setì´ ì•„ë‹ˆë¼ clusterì™€ ì´ì— í•´ë‹¹í•˜ëŠ” pointë“¤ì˜ indexì…ë‹ˆë‹¤. ë”°ë¼ì„œ extract ì´í›„ ë³„ë„ì˜ í›„ì²˜ë¦¬ ê³¼ì •ì´ í•„ìš”í•©ë‹ˆë‹¤. í˜„ì¬ëŠ” ì„œë¡œ ë‹¤ë¥¸ cluster ë§ˆë‹¤ ìƒ‰ìƒì„ ë¶€ì—¬í•˜ì—¬ ì‹œê°í™”í•˜ê³  ìˆìŠµë‹ˆë‹¤. # Extract indices for each of the discovered clusters cluster_indices = ec.Extract() # Create Cluster-Mask Point Cloud to visualize each cluster separately get_color_list.color_list =[] cluster_color = get_color_list(len(cluster_indices)) # Assign a color corresponding to each segmented object in scene color_cluster_point_list = [] for j, indices in enumerate(cluster_indices): for i, indice in enumerate(indices): color_cluster_point_list.append([extracted_inliers[indice][0], extracted_inliers[indice][1], extracted_inliers[indice][2], rgb_to_float(cluster_color[j])]) PCL python ROS 2 ì—°ë™ ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ë‚´ìš©ë“¤ì„ ì´ë™ì›í•´ì„œ PCLë¥¼ ROS 2ì™€ ì—°ë™í•´ë³´ê² ìŠµë‹ˆë‹¤.\nì˜ˆì‹œ ì‹¤í–‰ # Terminal 1 - gazebo world launch ros2 launch lidar_world lidar_world.launch.py # Terminal 2 - python node run ros2 run py_pcl_tutorial pcl_cluster_pub [INFO] [1682602819.908146533] [pcl_cluster_node]: PCL Cluster Node has been started rviz2ë¥¼ í†µí•´ /cluster topicì„ subscribe í•˜ë©´, ì‚¬ì§„ê³¼ ê°™ì´ ë¬¼ì²´ë³„ë¡œ ë‹¤ë¥¸ ìƒ‰ìƒì´ ì ìš©ëœ ìƒˆë¡œìš´ pointcloud topicì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì½”ë“œë¥¼ ë¶„ì„í•˜ê¸° ì „, ì „ì²´ ì‹œìŠ¤í…œì„ ìš”ì•½í•´ë³´ì•˜ìŠµë‹ˆë‹¤.\nROS 2ì˜ PointCloud2 msgë¥¼ PCL íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. PCL dataì™€ ì¼ì „ ì˜ˆì‹œ ì½”ë“œë¥¼ í†µí•´ clusteringì„ êµ¬í˜„í•©ë‹ˆë‹¤. ë¶„ë¦¬í•œ clusterë“¤ì— ê°œë³„ ìƒ‰ìƒì„ ë¶€ì—¬í•˜ê³ , ë‹¤ì‹œ ROS 2 PointCloud2 íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. topic publish! ROS 2 â‡’ PCL / PCL â‡’ ROS 2 ì‚¬ì´ì˜ ë³€í™˜ì€ pcl_helperë¼ëŠ” ë³„ë„ ì½”ë“œë¥¼ êµ¬í˜„í•´ ë‘ì—ˆìŠµë‹ˆë‹¤. def ros2_to_pcl(ros_cloud): \u0026#34;\u0026#34;\u0026#34; Converts a ROS PointCloud2 message to a pcl PointXYZRGB Args: ros_cloud (PointCloud2): ROS PointCloud2 message Returns: pcl.PointCloud_PointXYZRGB: PCL XYZRGB point cloud \u0026#34;\u0026#34;\u0026#34; ... def pcl_to_ros2(pcl_array, now=None): \u0026#34;\u0026#34;\u0026#34; Converts a pcl PointXYZRGB to a ROS PointCloud2 message Args: pcl_array (PointCloud_PointXYZRGB): A PCL XYZRGB point cloud now (Time): A ROS 2 time object like self.get_clock().now() Returns: PointCloud2: A ROS point cloud \u0026#34;\u0026#34;\u0026#34; ì£¼ì˜í•´ì•¼ í•  ì ìœ¼ë¡œ, PCL â‡’ ROS 2 ë³€í™˜ ì‹œì—ëŠ” ì‹œê°„ì— ëŒ€í•œ ë°ì´í„°ê°€ ì¶”ê°€ë˜ë‹ˆ Node ë‚´ë¶€ì˜ clockì—ì„œ now ê°ì²´ë¥¼ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤.\nPCLClusterNodeì˜ ìƒì„±ìì—ì„œ subscriberì™€ publisherë¥¼ í•˜ë‚˜ì”© ìƒì„±í•©ë‹ˆë‹¤. class PCLClusterNode(Node): def __init__(self): super().__init__(\u0026#39;pcl_cluster_node\u0026#39;) self.pc_subscription = self.create_subscription( PointCloud2, \u0026#39;pointcloud\u0026#39;, self.pcl_callback, 10 ) self.cluster_publisher = self.create_publisher( PointCloud2, \u0026#39;cluster\u0026#39;, 10 ) subscription callbackì—ì„œ ëŒ€ë¶€ë¶„ì˜ ë¡œì§ì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. def pcl_callback(self, pcl_msg): # TODO: Convert ROS msg to PCL data pcl_data = ros2_to_pcl(pcl_msg) ... #Create new cloud containing all clusters, each with unique color cluster_cloud = pcl.PointCloud_PointXYZRGB() cluster_cloud.from_list(color_cluster_point_list) ... callbackì˜ ë§ˆì§€ë§‰ì— pcl_to_ros2ë¥¼ í†µí•´ ì „ì²´ clusterë¥¼ PointCloud2 íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•œ ë’¤ publishí•©ë‹ˆë‹¤. # Convert PCL data to ROS 2 messages cluster_cloud_msg = pcl_to_ros2(cluster_cloud, now=self.get_clock().now()) self.cluster_publisher.publish(cluster_cloud_msg) "
},
{
	"uri": "/kr/ros2_foxy/lecture14/",
	"title": "Lecture14. Useful ROS 2 Examples (Control Part)",
	"tags": [],
	"description": "",
	"content": "Gazebo ROS 2 Control ì§€ë‚œ fusionbot ì˜ˆì‹œì—ì„œ, Differential Driveë§Œ ì˜ˆì™¸ì ìœ¼ë¡œ gazebo pluinì„ ì œê³µí•œë‹¤ê³  í•˜ì˜€ìŠµë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ Gazeboë‚´ì—ì„œ ì›€ì§ì´ëŠ” (=ëª¨í„°ë¥¼ ê°€ì§„) ëª¨ë¸ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œëŠ” gazebo_ros2_controlì„ ì‚¬ìš©í•©ë‹ˆë‹¤.\në‹¤ë§Œ, ROS 2 Control ì „ì²´ ì‹œìŠ¤í…œì„ ì´í•´í•˜ê¸° ìœ„í•´ì„œëŠ” ìƒë‹¹í•œ ë°°ê²½ ì§€ì‹ê³¼ ì‹œê°„ì´ í•„ìš”í•˜ë¯€ë¡œ, ì´ë²ˆ ì˜ˆì‹œì—ì„œëŠ” ë”± í•˜ë‚˜, ìœ„ì¹˜ ì œì–´ë¥¼ í•˜ëŠ” ê°€ì´ë“œë¥¼ ë“œë¦¬ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.\nì¼ì „ sensor_stickì˜ URDFì—ëŠ” tilt_jointë¼ëŠ” jointê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ìš°ë¦¬ì˜ ëª©í‘œëŠ” ì´ tilt_jointë¥¼ ë§ ê·¸ëŒ€ë¡œ ê¸°ìš¸ì—¬ì§ˆ ìˆ˜ ìˆê²Œ í•´ë³´ëŠ” ê²ƒì…ë‹ˆë‹¤. \u0026lt;joint name=\u0026#34;tilt_joint\u0026#34; type=\u0026#34;revolute\u0026#34;\u0026gt; \u0026lt;origin xyz=\u0026#34;0.05 0 ${length2/2+0.02}\u0026#34; rpy=\u0026#34;0 0.5 0\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;link_2\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;camera_link\u0026#34; /\u0026gt; \u0026lt;limit lower=\u0026#34;-1.5707\u0026#34; upper=\u0026#34;1.5707\u0026#34; effort=\u0026#34;10\u0026#34; velocity=\u0026#34;100\u0026#34; /\u0026gt; \u0026lt;axis xyz=\u0026#34;0 1 0\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; ì˜ˆì‹œ ì‹¤í–‰ # Terminal 1 $ ros2 launch basic_stick moving_stick.launch.py \u0026gt; gazebo world ë‚´ì— tableë“± ì›í•˜ëŠ” ë¬¼ì²´ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. # Terminal 2 ros2 topic pub --once /forward_position_controller/commands std_msgs/msg/Float64MultiArray \u0026#34;data: - -0.1\u0026#34; ë§ˆì§€ë§‰ data valueë¥¼ ë°”ê¿”ê°€ë©´ì„œ ì›í•˜ëŠ” ê¸°ìš¸ê¸°ë¡œ ì¡°ì •í•´ë³´ì„¸ìš”!\ngazebo_rosì˜ ForwardCommandControllerë¥¼ ì‚¬ìš©í•˜ì—¬ ì œì‘í•œ ì˜ˆì‹œì´ë©°, ros2 controlì— ëŒ€í•´ í•™ìŠµí•˜ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ, ì´ë¥¼ ìœ„í•œ ì ˆì°¨ë§Œ ê°„ë‹¨íˆ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤.\nURDF ë‚´ ì›€ì§ì¼ ìˆ˜ ìˆëŠ” joint ì¶”ê°€ gazebo_ros2_controlì„ ì •ì˜í•˜ëŠ” xacro ì¶”ê°€ gazebo_ros2_control controller ë§¤ê°œë³€ìˆ˜ë¥¼ ì •ì˜í•˜ëŠ” yaml file ì¶”ê°€ URDF ë‚´ ì›€ì§ì¼ ìˆ˜ ìˆëŠ” joint ì¶”ê°€ \u0026lt;joint name=\u0026#34;tilt_joint\u0026#34; type=\u0026#34;revolute\u0026#34;\u0026gt; \u0026lt;origin xyz=\u0026#34;0.05 0 ${length2/2+0.02}\u0026#34; rpy=\u0026#34;0 0.5 0\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;link_2\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;camera_link\u0026#34; /\u0026gt; \u0026lt;limit lower=\u0026#34;-1.5707\u0026#34; upper=\u0026#34;1.5707\u0026#34; effort=\u0026#34;10\u0026#34; velocity=\u0026#34;100\u0026#34; /\u0026gt; \u0026lt;axis xyz=\u0026#34;0 1 0\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; Description revolute ë¬¸ê³ ë¦¬ì™€ ê°™ì´ limitì„ ê°–ëŠ” joint ì…ë‹ˆë‹¤. limit - lower/upper revolute jointì˜ limitì„ ì„¤ì •í•©ë‹ˆë‹¤. effort ìµœëŒ€ í† í¬ë¥¼ ì •ì˜í•©ë‹ˆë‹¤. (ì´ë¡ ì€ ëª¨ë¥´ì…”ë„ ë©ë‹ˆë‹¤. ì§€ê¸ˆì€ ì ë‹¹íˆ ë„‰ë„‰íˆ í•´ë‘ì—ˆìŠµë‹ˆë‹¤.) velocity ìµœëŒ€ ì†ë„ë¥¼ ì •ì˜í•©ë‹ˆë‹¤. axis jointê°€ ì›€ì§ì¼ ì¶• ë°©í–¥ì„ ì§€ì •í•©ë‹ˆë‹¤. gazebo_ros2_controlì„ ì •ì˜í•˜ëŠ” xacro ì¶”ê°€ - ros2_control.gazebo.xacroì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì¶”ê°€í•˜ì˜€ìœ¼ë©°, ìµœì†Œí•œì˜ ë‚´ìš©ë§Œ ì§šê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;!-- ref github - diffbot_system.ros2_control.xacro --\u0026gt; \u0026lt;robot xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34;\u0026gt; \u0026lt;ros2_control name=\u0026#34;GazeboSystem\u0026#34; type=\u0026#34;system\u0026#34;\u0026gt; \u0026lt;!-- Gazebo --\u0026gt; \u0026lt;hardware\u0026gt; \u0026lt;plugin\u0026gt;gazebo_ros2_control/GazeboSystem\u0026lt;/plugin\u0026gt; \u0026lt;/hardware\u0026gt; \u0026lt;joint name=\u0026#34;tilt_joint\u0026#34;\u0026gt; \u0026lt;command_interface name=\u0026#34;position\u0026#34;\u0026gt; \u0026lt;param name=\u0026#34;min\u0026#34;\u0026gt;-1.5707\u0026lt;/param\u0026gt; \u0026lt;param name=\u0026#34;max\u0026#34;\u0026gt;1.5707\u0026lt;/param\u0026gt; \u0026lt;/command_interface\u0026gt; \u0026lt;state_interface name=\u0026#34;position\u0026#34;\u0026gt; \u0026lt;param name=\u0026#34;initial_value\u0026#34;\u0026gt;0.0\u0026lt;/param\u0026gt; \u0026lt;/state_interface\u0026gt; \u0026lt;state_interface name=\u0026#34;velocity\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;/ros2_control\u0026gt; \u0026lt;gazebo\u0026gt; \u0026lt;plugin name=\u0026#34;gazebo_ros2_control\u0026#34; filename=\u0026#34;libgazebo_ros2_control.so\u0026#34;\u0026gt; \u0026lt;parameters\u0026gt;$(find basic_stick)/config/joint_controller.yaml\u0026lt;/parameters\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;/robot\u0026gt; Description joint name controlì´ í•„ìš”í•œ joint nameì„ ì§€ì •í•©ë‹ˆë‹¤. command_interface position ì œì–´ë¥¼ ìœ„í•´ name=position, ì´ì— ë”°ë¥¸ ìµœëŒ€, ìµœì†Œ ê°ë„ë¥¼ ì§€ì •í•©ë‹ˆë‹¤. state_interface topicì„ í†µí•´ í”¼ë“œë°±ë°›ì„ ë°ì´í„° ì¢…ë¥˜ë¥¼ ì„ íƒí•©ë‹ˆë‹¤. ì§€ê¸ˆì€ ìœ„ì¹˜ í”¼ë“œë°±ì„ ë°›ì„ ì˜ˆì •ì´ë©°, ì´ˆê¸°ê°’ì„ 0ë„ë¡œ ë‘ì—ˆìŠµë‹ˆë‹¤. plugin parameters controller ì‹¤í–‰ì„ ìœ„í•´ ì¶”ê°€ë¡œ í•„ìš”í•œ ë§¤ê°œë³€ìˆ˜ë“¤ì„ yaml fileë¡œ ì „ë‹¬í•©ë‹ˆë‹¤. ì´ë²ˆ ì˜ˆì‹œì—ì„œëŠ” control, state feedback, ì´ 2ê°œì˜ pluginì´ ì‚¬ìš©ë©ë‹ˆë‹¤. ê° pluinë“¤ì— ëŒ€í•´ì„œ í•„ìˆ˜ë¡œ ì •ì˜í•´ì¤˜ì•¼ í•˜ëŠ” ë§¤ê°œë³€ìˆ˜ë“¤ì´ ìˆìœ¼ë©°, forward_position_controllerì˜ ê²½ìš° jointsë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤. controller_manager: ros__parameters: update_rate: 100 # Hz joint_state_broadcaster: type: joint_state_broadcaster/JointStateBroadcaster forward_position_controller: type: forward_command_controller/ForwardCommandController forward_position_controller: ros__parameters: joints: - tilt_joint interface_name: position â‡’ ì—¬ê¸°ê¹Œì§€ í•œë²ˆì— ì™„ì„±ë˜ì—ˆë‹¤ë©´, ë§¤ìš° ìˆœì¡°ë¡œìš´ ê²ƒì…ë‹ˆë‹¤. ë³´í†µ robot_state_publisherì˜ ì‹¤í–‰ì„ í†µí•´ í•˜ë‚˜ì”© ê²€ì¦í•˜ë©° ê°œë°œì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.\në§ˆì§€ë§‰ìœ¼ë¡œ, launch fileì„ ì‚´í´ë´…ì‹œë‹¤. ros2_controlì„ ê´€ë¦¬í•˜ëŠ” controller_managerì—ê²Œ í•„ìš”í•œ pluginì„ ì „ë‹¬í•˜ë©´ spawner.pyê°€ ì´ë“¤ì„ ì‹¤í–‰í•´ì£¼ëŠ” í˜•íƒœë¥¼ ì·¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. fp_controller = Node( package=\u0026#34;controller_manager\u0026#34;, executable=\u0026#34;spawner.py\u0026#34;, arguments=[\u0026#34;forward_position_controller\u0026#34;], output=\u0026#34;screen\u0026#34;, ) jsb_controller = Node( package=\u0026#34;controller_manager\u0026#34;, executable=\u0026#34;spawner.py\u0026#34;, arguments=[\u0026#34;joint_state_broadcaster\u0026#34;], output=\u0026#34;screen\u0026#34;, ) ì´ë²ˆ ì˜ˆì‹œì™€ ì§€ë‚œ dataset_gen action ì˜ˆì‹œ, ê·¸ë¦¬ê³  take picture service ì˜ˆì‹œì™€ my world ìƒì„±ê¹Œì§€ ëª¨ë‘ ê²°í•©í•˜ë©´, ë¬´ê¶ë¬´ì§„í•œ ì—¬ëŸ¬ë¶„ë“¤ë§Œì˜ gazebo ì„¼ì„œ í™˜ê²½ì„ ê°–ì¶”ì‹¤ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.\n"
},
{
	"uri": "/kr/ros2_foxy/lecture15/",
	"title": "Lecture15. Advanced ROS 2, Package Management",
	"tags": [],
	"description": "",
	"content": "ROS 2 Launch ì‹¬í™” Launch arguments ROS 2 launch fileì€ íŒŒì´ì¬ ì‚¬ìš©í•¨ì— ë”°ë¼ ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì§ì ‘ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìˆ˜ ëª¨ë¸ ì‚¬ìš© ì‹œ ë°˜ë³µ ë‚´ìš©ì„ í•¨ìˆ˜ë¡œ ë§Œë“¤ ìˆ˜ë„ ìˆê³ , ì™¸ë¶€ íŒŒì¼ì´ë‚˜ íŒ¨í‚¤ì§€ë¥¼ import í•  ìˆ˜ë„ ìˆì§€ìš”. launch íŒ¨í‚¤ì§€ì—ì„œëŠ” ìì£¼ ì‚¬ìš©ë˜ëŠ” ê¸°ëŠ¥ë“¤ì„ ë¯¸ë¦¬ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ê¸°ëŠ¥ì„ í†µí•´ launch fileì„ ì¢€ ë” í’ì„±í•˜ê²Œ ë§Œë“¤ì–´ ë´…ì‹œë‹¤.\nì˜ˆì œ ì‹¤í–‰ - use_rviz launch ì˜µì…˜ì„ ì‚¬ìš©í•´ë´…ì‹œë‹¤. ros2 launch src_gazebo empty_world.launch.py use_rviz:=true ros2 launch src_gazebo empty_world.launch.py use_rviz:=false â‡’ use_rviz ê°’ì— ë”°ë¼ rviz2 ì‹¤í–‰ ì—¬ë¶€ê°€ ê²°ì •ë©ë‹ˆë‹¤.\nì´ëŸ¬í•œ launch argumentëŠ” LaunchConfiguration, DeclareLaunchArgumentì„ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. from launch.actions import DeclareLaunchArgument from launch.substitutions import LaunchConfiguration def generate_launch_description(): namespace = LaunchConfiguration(\u0026#39;namespace\u0026#39;) declare_namespace_cmd = DeclareLaunchArgument( \u0026#39;namespace\u0026#39;, default_value=\u0026#39;my_robot\u0026#39;, description=\u0026#39;Top-level namespace\u0026#39; ) return LaunchDescription( [ declare_namespace_cmd, ] ) Description LaunchConfiguration ìƒì„±í•  argumentì˜ ì´ë¦„ì„ ë„£ì–´ì£¼ë©´ argument ê°ì²´ê°€ ë°˜í™˜ë©ë‹ˆë‹¤. DeclareLaunchArgument default_valueë¥¼ í†µí•´ argumentì˜ ê¸°ë³¸ê°’ì„, descriptionì„ í†µí•´ ì„¤ëª…ì„ ì ì–´ë‘¡ë‹ˆë‹¤. declare_namespace_cmd LaunchDescriptionì—ê²Œ ìƒì„±ëœ argument ê°ì²´ë¥¼ ì „ë‹¬í•´ì•¼ ë¹„ë¡œì†Œ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. declare_namespace_cmdì˜ ê°’ì„ ë³´ê³  ì‹¶ì€ ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ ê°ì²´ ìì²´ëŠ” str ë§¤ì§ ë©”ì†Œë“œê°€ êµ¬í˜„ë˜ì–´ ìˆëŠ” ê²ƒì´ ì•„ë‹ˆì–´ printì‹œ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ìŠµë‹ˆë‹¤. print(declare_namespace_cmd) \u0026gt;\u0026gt;\u0026gt; result \u0026lt;launch.actions.declare_launch_argument.DeclareLaunchArgument object at 0x7fc89a164730\u0026gt; í•˜ì§€ë§Œ launch argumentì˜ ê°’ì„ ë³¼ ìˆ˜ ìˆëŠ” LogInfoë¼ëŠ” ê¸°ëŠ¥ì´ ì œê³µë˜ê³  ìˆìŠµë‹ˆë‹¤. message_info = LogInfo(msg=LaunchConfiguration(\u0026#39;namespace\u0026#39;)) return LaunchDescription( [ declare_namespace_cmd, message_info, ] ) LaunchDescriptionì— ê°ì²´ë“¤ì„ ë„£ì–´ì¤„ ë•Œ ìˆœì„œì— ì£¼ì˜í•©ë‹ˆë‹¤.\nLogInfo ê²°ê³¼ë¥¼ ì§ì ‘ í™•ì¸í•´ë´…ì‹œë‹¤. $ ros2 launch advanced_tutorial launch_arg_info.launch.py [INFO] [launch]: Default logging verbosity is set to INFO [INFO] [launch.user]: my_robot ì‹¤ì œ ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸ë¥¼ ì‚´í´ë³´ì•„ë„ ì´ëŸ¬í•œ Launch argumentë¥¼ ìˆ˜ë„ ì—†ì´ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ì˜ˆì‹œëŠ” ììœ¨ ì£¼í–‰ì„ ìœ„í•œ ë©”íƒ€í˜í‚¤ì§€ì¸ nav2ì˜ launch exampleì…ë‹ˆë‹¤. def generate_launch_description(): # Get the launch directory bringup_dir = get_package_share_directory(\u0026#39;nav2_bringup\u0026#39;) launch_dir = os.path.join(bringup_dir, \u0026#39;launch\u0026#39;) # Create the launch configuration variables namespace = LaunchConfiguration(\u0026#39;namespace\u0026#39;) use_namespace = LaunchConfiguration(\u0026#39;use_namespace\u0026#39;) slam = LaunchConfiguration(\u0026#39;slam\u0026#39;) map_yaml_file = LaunchConfiguration(\u0026#39;map\u0026#39;) use_sim_time = LaunchConfiguration(\u0026#39;use_sim_time\u0026#39;) params_file = LaunchConfiguration(\u0026#39;params_file\u0026#39;) autostart = LaunchConfiguration(\u0026#39;autostart\u0026#39;) use_composition = LaunchConfiguration(\u0026#39;use_composition\u0026#39;) use_respawn = LaunchConfiguration(\u0026#39;use_respawn\u0026#39;) log_level = LaunchConfiguration(\u0026#39;log_level\u0026#39;) Timer Action ëŒ€ê·œëª¨ gazebo íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ê±°ë‚˜, urdfì— ìˆ˜ë§ì€ meshê°€ ê²°í•©ë˜ì–´ ìˆëŠ” ê²½ìš°, í”„ë¡œì„¸ìŠ¤ ë¡œë”©ì— ìƒë‹¹í•œ ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Timer Actionì€ ì¼ì • ì‹œê°„ë™ì•ˆ ëŒ€ê¸° ì´ë²¤íŠ¸ë¥¼ ê±¸ ìˆ˜ ìˆì–´ ì´ëŸ¬í•œ ìƒí™©ì„ ë‹¤ë£¨ê¸° ìš©ì´í•©ë‹ˆë‹¤.\nfrom launch.actions import TimerAction ... # Launch RViz rviz2 = Node( package=\u0026#34;rviz2\u0026#34;, executable=\u0026#34;rviz2\u0026#34;, name=\u0026#34;rviz2\u0026#34;, output=\u0026#34;screen\u0026#34;, arguments=[\u0026#34;-d\u0026#34;, rviz_config_file], ) ... return LaunchDescription([ TimerAction( period=3.0, actions=[rviz2] ), â‡’ urdf ë¡œë”©ì´ ëë‚œ ë’¤ rviz2ë¥¼ ì‹¤í–‰í•˜ë„ë¡ í•´ë‘” ì˜ˆì‹œì…ë‹ˆë‹¤.\nOnProcessExit node ì‹¤í–‰ ì‹œ ìˆœì„œë¥¼ ì§€ì¼œì•¼ í•˜ëŠ” ê²½ìš° ex - model spawn í›„ ì„¼ì„œ ë°ì´í„° ì²˜ë¦¬ ë“± RegisterEventHandlerì™€ OnProcessExitë¥¼ í†µí•´ ì‹¤í–‰ ìˆœì„œ ë¡œì§ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nfrom launch.actions import RegisterEventHandler from launch.event_handlers import OnProcessExit ì €ì˜ ê²½ìš° ros2_controlì„ ì‚¬ìš©í•  ë•Œ ì£¼ë¡œ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. return LaunchDescription([ declare_use_rviz, RegisterEventHandler( event_handler=OnProcessExit( target_action=spawn_entity, on_exit=[load_joint_state_broadcaster], ) ), RegisterEventHandler( event_handler=OnProcessExit( target_action=load_joint_state_broadcaster, on_exit=[load_forward_position_controller], ) ), Description target_action ë¨¼ì € ì™„ë£Œë˜ì–´ì•¼ í•˜ëŠ” Node on_exit target_action ì¢…ë£Œ í›„ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ” Node IncludeLaunchDescription launch fileì€ ë§¤ìš° ìœ ì—°í•œ êµ¬í˜„ì´ ê°€ëŠ¥í•˜ë„ë¡ ì§€ì›ë˜ë©°, í•˜ë‚˜ì˜ launch fileì—ì„œ ë‹¤ë¥¸ launch fileì„ ì¶”ê°€í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤. from launch.actions import IncludeLaunchDescription ì˜ˆë¥¼ ë“¤ë©´, gazebo ìƒì˜ ë¡œë´‡ì„ ìœ„í•œ ë¶€ë¶„ê³¼ ì‹¤ì œ ë¡œë´‡ì„ ë‹¤ë£¨ëŠ” ë¶€ë¶„ì„ ë³„ë„ì˜ launch fileë¡œ ë¶„ë¦¬í•œ ë’¤, main launch fileì—ì„œëŠ” ì´ ë‘˜ì„ ìŠ¤ìœ„ì¹­í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤. def generate_launch_description(): launch_test_pkg = get_package_share_directory(\u0026#39;launch_test_pkg\u0026#39;) robot_spawn = IncludeLaunchDescription( PythonLaunchDescriptionSource( os.path.join(launch_test_pkg, \u0026#39;launch\u0026#39;,\u0026#39;robot_spawn.launch.py\u0026#39;))) rviz_launch = IncludeLaunchDescription( PythonLaunchDescriptionSource( os.path.join(launch_test_pkg, \u0026#39;launch\u0026#39;, \u0026#39;start_rviz.launch.py\u0026#39;))) return LaunchDescription([ robot_spawn, rviz_launch, ]) IfCondition, UnlessCondition ì¡°ê±´ë¬¸ì— ë”°ë¼ ì •í•´ì§„ Nodeê°€ ì‹¤í–‰ë˜ë„ë¡ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ IfConditionê³¼ UnlessConditionì„ ì‚¬ìš©í•©ë‹ˆë‹¤. from launch.conditions import IfCondition, UnlessCondition ì•„ë˜ ì˜ˆì‹œë¥¼ ë³´ë©´, Node =\u0026gt; condition í•­ëª©ì— execute LaunchConfigurationì´ ì‚½ì…ëœ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆìœ¼ë©°, execute ê°’ì— ë”°ë¼ turtlesim_nodeì˜ ì‹¤í–‰ ì—¬ë¶€ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤. def generate_launch_description(): execute = LaunchConfiguration(\u0026#39;execute\u0026#39;) declare_execute_cmd = DeclareLaunchArgument( \u0026#39;execute\u0026#39;, default_value=\u0026#39;true\u0026#39;, description=\u0026#39;whether to use namespace or not\u0026#39; ) turtlesim_node = Node( package = \u0026#39;turtlesim\u0026#39;, executable = \u0026#39;turtlesim_node\u0026#39;, name = \u0026#39;turtlesim_node\u0026#39;, output=\u0026#39;screen\u0026#39;, condition=IfCondition(execute), ) return LaunchDescription( [ declare_execute_cmd, turtlesim_node, ] ) ì‹¤ì œ ì˜ˆì‹œë¥¼ í†µí•´ ì‹¤ìŠµí•´ë´…ì‹œë‹¤. $ ros2 launch advanced_tutorial ifcondition.launch.py execute:=false [INFO] [launch]: All log files can be found below /home/kimsooyoung/.ros/log/2023-04-25-15-14-32-373647-kimsooyoung-XPS-13-9370-6088 [INFO] [launch]: Default logging verbosity is set to INFO GroupAction ê´€ë ¨ëœ Node, launch fileë“¤ì„ í•œë° ë¬¶ì–´ ê³µí†µëœ ì†ì„±ì„ ë¶€ì—¬í•  ì‹œ GroupActionì„ ì‚¬ìš©í•˜ë©°, ì£¼ë¡œ namespaceë¥¼ ì§€ì •í•  ë•Œ ë§ì´ ì‚¬ìš©ë©ë‹ˆë‹¤. turtle_group = GroupAction([ PushRosNamespace( condition=IfCondition(use_namespace), namespace=namespace ), turtlesimì— namespaceë¥¼ ì ìš©í•˜ëŠ” ì‹¤ìŠµì„ í•´ë³´ê² ìŠµë‹ˆë‹¤. $ ros2 launch advanced_tutorial group_action.launch.py $ ros2 topic list /parameter_events /rosout /turtle1/cmd_vel /turtle1/color_sensor /turtle1/pose â‡’ ë³„ë„ namespace ì§€ì •ì´ ì—†ìœ¼ë©´ ìœ„ì™€ ê°™ì€ rqt_graphë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nlaunch argumentë¥¼ í†µí•´ namespaceë¥¼ ì ìš©ì‹œí‚¨ ë’¤, topic listì™€ rqt_graphë¥¼ ì‚´í´ë´…ì‹œë‹¤. $ ros2 launch advanced_tutorial group_action.launch.py use_namespace:=true namespace:=my_turtle $ ros2 topic list /my_turtle/turtle1/cmd_vel /my_turtle/turtle1/color_sensor /my_turtle/turtle1/pose /parameter_events /rosout /my_turtle namespaceê°€ ì ìš©ëœ ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸ‘\nExecutor and CallbackGroup ì‹¤ì œ ì„¼ì„œ, ì œì–´ê¸°ë¥¼ ê°œë°œ í•˜ë‹¤ë³´ë©´ ê¸°ì¡´ ì½”ë“œì™€ ROS 2 ì½”ë“œë¥¼ ì—°ë™í•´ì•¼ í•  ì¼ì´ ë§ìŠµë‹ˆë‹¤. ê¸°ì¡´ ì½”ë“œê°€ ë³‘ë ¬ ì—°ì‚° í˜•íƒœë¡œ ê°œë°œë˜ì—ˆë‹¤ë©´ ROS 2ì˜ Spinê³¼ ë§ë¬¼ë ¤ Dead Lockì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ê²½ìš°ë¥¼ ë‹¤ë£¨ê¸° ìœ„í•´ ROS 2ì˜ Executorì™€ CallbackGroupì— ëŒ€í•´ ì•Œì•„ë´…ì‹œë‹¤.\nì´ë²ˆ íŠœí† ë¦¬ì–¼ì€ ëª¨ë‘ c++ë¡œ ì§„í–‰ë©ë‹ˆë‹¤.\nì˜ˆì‹œ packageë¥¼ buildí•˜ê³  sourcing í•©ì‹œë‹¤. cbp cpp_multiproc_tutorial \u0026amp;\u0026amp; source install/local_setup.bash Dead Lock Example ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë³´ë©´ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œìƒí™©ì„ ê³ ë ¤í•´ë´…ì‹œë‹¤. $ ros2 run cpp_multiproc_tutorial dead_lock [INFO] [1682404393.717961395] [deadlock_example]: timer_cb_1 [INFO] [1682404398.718512552] [deadlock_example]: timer_cb_2 [INFO] [1682404400.719076263] [deadlock_example]: timer_cb_1 [INFO] [1682404405.719559218] [deadlock_example]: timer_cb_2 [INFO] [1682404407.719972272] [deadlock_example]: timer_cb_1 [INFO] [1682404412.720329962] [deadlock_example]: timer_cb_2 [INFO] [1682404414.720709183] [deadlock_example]: timer_cb_1 â‡’ timer_cb_1ì´ 5ì´ˆ ë™ì•ˆ sleepí•˜ëŠ” ë™ì•ˆ ì‹œìŠ¤í…œì„ ë…ì‹í•´ë²„ë¦½ë‹ˆë‹¤.\nì‹¤ì œ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ì´ 5ì´ˆë§ˆë‹¤ timer_cb_1ì„, 2ì´ˆë§ˆë‹¤ timer_cb_2ë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ëª©í‘œì˜€ìŠµë‹ˆë‹¤. void timer_cb_1(){ RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;timer_cb_1\u0026#34;); // assume that something logic happens here std::this_thread::sleep_for(5s); } void timer_cb_2(){ RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;timer_cb_2\u0026#34;); // assume that something logic happens here std::this_thread::sleep_for(2s); } ì—¬ê¸°ì—ì„œ, ì•„ë˜ì™€ ê°™ì´ timer ì£¼ê¸°ë¥¼ 5ì´ˆ, 2ì´ˆë¼ê³  ìˆ˜ì •í•˜ë©´ ë™ì‘ì€ ì˜ ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ, ì´ëŠ” ì§€ê¸ˆ ìš°ë¦¬ê°€ ì›í•˜ëŠ” ìƒí™©ì„ í‘œí˜„í•˜ì§€ ëª»í•©ë‹ˆë‹¤. ìš°ë¦¬ê°€ ê°€ì •í•˜ëŠ” ìƒí™©ì€, timer callbackì•ˆì—ì„œ, ROS 2ê°€ ì•„ë‹Œ ë‹¤ë¥¸ ë¬´ì–¸ê°€ì˜ ì½”ë“œê°€ ì‹œìŠ¤í…œì„ ì ìœ í•˜ëŠ” ìƒí™©ì…ë‹ˆë‹¤. DeadLockNode() : Node(\u0026#34;deadlock_example\u0026#34;){ timer_1 = this-\u0026gt;create_wall_timer( 5s, std::bind(\u0026amp;DeadLockNode::timer_cb_1, this) ); timer_2 = this-\u0026gt;create_wall_timer( 2s, std::bind(\u0026amp;DeadLockNode::timer_cb_2, this) ); } mainë¬¸ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. (rclcppì˜ Default Executorì¸ Single Threaded Executorê°€ ì‹¤í–‰ë  ê²ƒì…ë‹ˆë‹¤. int main(int argc, char **argv){ rclcpp::init(argc, argv); rclcpp::spin(std::make_shared\u0026lt;DeadLockNode\u0026gt;()); rclcpp::shutdown(); return 0; } MultiThreadedExecutor rclcppì˜ ExecutorëŠ” ê·¸ë¦¼ê³¼ ê°™ì´ í¬ê²Œ 3ì¢…ë¥˜ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ëŠ” ê¸°ë³¸ì¸ SingleThreadedë¥¼ ì‚¬ìš©í•˜ì˜€ì§€ë§Œ, MultThreadedë„ ì‚¬ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤. ê³¼ì—° ë¬¸ì œë¥¼ í•´ê²°í•´ ì¤„ ìˆ˜ ìˆì„ê¹Œìš”? main ë¬¸ì„ ìˆ˜ì •í•˜ê³  ë‹¤ì‹œ ì»´íŒŒì¼ =\u0026gt; ì‹¤í–‰í•´ë´…ì‹œë‹¤. int main(int argc, char * argv[]){ rclcpp::init(argc, argv); std::cout \u0026lt;\u0026lt; \u0026#34;Max CPU Core : \u0026#34; \u0026lt;\u0026lt; std::thread::hardware_concurrency() \u0026lt;\u0026lt; std::endl; rclcpp::executors::MultiThreadedExecutor executor(rclcpp::executor::ExecutorArgs(), 2); auto test_node = std::make_shared\u0026lt;DeadLockNode\u0026gt;(); executor.add_node(test_node); executor.spin(); rclcpp::shutdown(); return 0; } ì˜ˆì‹œ ì‹¤í–‰ (8ì½”ì–´ ë©íƒ‘ì—ì„œ ì‹¤í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.) $ ros2 run cpp_multiproc_tutorial multi_executor Max CPU Core : 8 [INFO] [1682404852.346859530] [deadlock_example]: timer_cb_1 [INFO] [1682404857.348183807] [deadlock_example]: timer_cb_1 [INFO] [1682404862.348802309] [deadlock_example]: timer_cb_1 [INFO] [1682404867.349427033] [deadlock_example]: timer_cb_1 [INFO] [1682404872.349906028] [deadlock_example]: timer_cb_1 [INFO] [1682404877.350774188] [deadlock_example]: timer_cb_1 [INFO] [1682404882.351478568] [deadlock_example]: timer_cb_1 [INFO] [1682404887.352284317] [deadlock_example]: timer_cb_1 [INFO] [1682404892.352806238] [deadlock_example]: timer_cb_1 â‡’ ì—¬ì „íˆ timer_cb_1ì´ ì‹œìŠ¤í…œì„ ë…ì‹í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nì´ë ‡ê²Œ ë˜ëŠ” ì´ìœ ê°€ ë¬´ì—‡ì¼ê¹Œìš”??\ní˜„ì¬ ìƒí™©ì„ ê·¸ë¦¼ìœ¼ë¡œ í‘œí˜„í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ë¹„ë¡ multi-threaded executorê°€ ì‹¤í–‰ë˜ì–´ ì‘ì—…ìê°€ 3ëª…ì´ ìˆë”ë¼ë„ ì‘ì—… ë¼ì¸ì´ 1ê°œë°–ì— ì—†ì–´ íš¨ìœ¨ì ì´ì§€ ëª»í•œ ê²ƒì´ì§€ìš”. Callback Group ì´ë¥¼ í•´ê²°í•˜ëŠ” ë°©ë²•ì€ ê°ê°ì˜ timer ë§ˆë‹¤ ë…ë¦½ì ì¸ ì‘ì—… ë¼ì¸ì„ êµ¬ì¶•í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ë¥¼ ìœ„í•´ rclcppì—ì„œëŠ” Callback Groupì´ë¼ëŠ” APIë¥¼ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. class DeadLockNode : public rclcpp::Node{ private: rclcpp::TimerBase::SharedPtr timer_1; rclcpp::TimerBase::SharedPtr timer_2; rclcpp::CallbackGroup::SharedPtr cb_group_1; rclcpp::CallbackGroup::SharedPtr cb_group_2; ê°ê°ì˜ Callbackì— ë…ë¦½ì ì¸(MutuallyExclusive) Groupì„ êµ¬ì¶•í•˜ì—¬ Executorë“¤ì´ ê°œë³„ Groupì„ ë‹¤ë£¨ë„ë¡ í•´ë´…ì‹œë‹¤. cb_group_1 = this-\u0026gt;create_callback_group( rclcpp::CallbackGroupType::MutuallyExclusive ); cb_group_2 = this-\u0026gt;create_callback_group( rclcpp::CallbackGroupType::MutuallyExclusive ); timer_1 = this-\u0026gt;create_wall_timer( 200ms, std::bind(\u0026amp;DeadLockNode::timer_cb_1, this), cb_group_1 ); timer_2 = this-\u0026gt;create_wall_timer( 200ms, std::bind(\u0026amp;DeadLockNode::timer_cb_2, this), cb_group_2 ); ì‚¬ìš©í•˜ëŠ” CPU ì½”ì–´ëŠ” 2ê°œë¡œ ë§ì¶°ì£¼ê² ìŠµë‹ˆë‹¤. ... rclcpp::executors::MultiThreadedExecutor executor( rclcpp::executor::ExecutorArgs(), 2 ); auto test_node = std::make_shared\u0026lt;DeadLockNode\u0026gt;(); ì‹¤í–‰ ê²°ê³¼, timer_cb_1ì€ 5ì´ˆë§ˆë‹¤, timer_cb_2ëŠ” 2ì´ˆë§ˆë‹¤ ì˜ ì‹¤í–‰ë˜ëŠ” ê²ƒì´ í™•ì¸ë©ë‹ˆë‹¤! ê³„ì† ì‹¤í–‰ë˜ë©´ì„œ ì•½ê°„ì˜ ì˜¤ì°¨ê°€ ìˆì§€ë§Œ ì´ëŠ” timer call ì£¼ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. $ ros2 run cpp_multiproc_tutorial callback_group Max CPU Core : 8 [INFO] [1682405209.687586816] [deadlock_example]: timer_cb_1 [INFO] [1682405209.687668485] [deadlock_example]: timer_cb_2 [INFO] [1682405211.688211586] [deadlock_example]: timer_cb_2 [INFO] [1682405213.688626203] [deadlock_example]: timer_cb_2 [INFO] [1682405214.689019990] [deadlock_example]: timer_cb_1 [INFO] [1682405215.690033260] [deadlock_example]: timer_cb_2 [INFO] [1682405217.690549333] [deadlock_example]: timer_cb_2 [INFO] [1682405219.689435329] [deadlock_example]: timer_cb_1 [INFO] [1682405219.691070145] [deadlock_example]: timer_cb_2 ... ì§€ê¸ˆ ìƒí™©ì„ ì•„ê¹Œì˜ ê·¸ë¦¼ì— ë‹¤ì‹œ ë¹„ìœ í•´ë´…ì‹œë‹¤. Taskë“¤ì´ ë…ìì ì¸ Callback Groupì—ì„œ ì‹¤í–‰ë˜ê³ , ê° Callback Groupì„ ë‹´ë‹¹í•˜ëŠ” Processê°€ ìˆê¸° ë•Œë¬¸ì— Delay ì—†ì´ ëª¨ë“  ì‘ì—…ì´ ìˆ˜ì›”í•˜ê²Œ ì‹¤í–‰ë©ë‹ˆë‹¤. ReentrantCallbackGroup rclcppì—ì„œ ì œê³µí•˜ëŠ” ë˜ë‹¤ë¥¸ Callback Group Option, Reentrantê°€ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì‚¬ìš©í•´ë´…ì‹œë‹¤.\nreference : https://docs.ros2.org/eloquent/api/rclcpp/namespacerclcpp_1_1callback__group.html\nReentrant CallbackGroupTypeì€ ì´ë¦„ê³¼ ê°™ì´ Processì™€ Callbackì„ ì¡°ìœ¨í•˜ì—¬ ê°€ì¥ íš¨ìœ¨ì ì¸ ì‹¤í–‰ì„ ì œê³µí•©ë‹ˆë‹¤. ë•Œë¬¸ì— ì—¬ëŸ¬ callbackì´ ê°™ì€ Group Optionì„ ê³µìœ í•´ë„ ë¬¸ì œ ì—†ìŠµë‹ˆë‹¤. public: DeadLockNode() : Node(\u0026#34;deadlock_example\u0026#34;){ cb_group_1 = this-\u0026gt;create_callback_group( rclcpp::CallbackGroupType::Reentrant ); cb_group_2 = cb_group_1; ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. ë³„ë„ Groupì´ ì•„ë‹ˆë”ë¼ë„ ëª¨ë“  Callbackì´ ì˜ ì‹¤í–‰ë©ë‹ˆë‹¤. $ ros2 run cpp_multiproc_tutorial reentrant_callback_group Max CPU Core : 8 [INFO] [1682405497.174734254] [deadlock_example]: timer_cb_1 [INFO] [1682405497.174845897] [deadlock_example]: timer_cb_2 [INFO] [1682405499.175241117] [deadlock_example]: timer_cb_2 [INFO] [1682405501.175422765] [deadlock_example]: timer_cb_2 [INFO] [1682405502.175086294] [deadlock_example]: timer_cb_1 [INFO] [1682405503.175637456] [deadlock_example]: timer_cb_2 [INFO] [1682405505.175894939] [deadlock_example]: timer_cb_2 ... í•˜ì§€ë§Œ, Reentrant CallbackGroupTypeë„ ì‚¬ìš©í•˜ëŠ” í”„ë¡œì„¸ì„œ ìì²´ê°€ ì ìœ¼ë©´ Dead lockì— ë¹ ì§‘ë‹ˆë‹¤. class ReentrantNode : public rclcpp::Node{ private: rclcpp::TimerBase::SharedPtr timer_1; rclcpp::TimerBase::SharedPtr timer_2; rclcpp::TimerBase::SharedPtr timer_3; rclcpp::CallbackGroup::SharedPtr cb_group_1; rclcpp::CallbackGroup::SharedPtr cb_group_2; rclcpp::CallbackGroup::SharedPtr cb_group_3; void timer_cb_3(){ RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;timer_cb_3\u0026#34;); // assume that something logic happens here std::this_thread::sleep_for(1s); } ... rclcpp::executors::MultiThreadedExecutor executor( rclcpp::executor::ExecutorArgs(), 1 ); ì˜ˆì‹œ ì‹¤í–‰ ê²°ê³¼ $ ros2 run cpp_multiproc_tutorial reentrant_limited Max CPU Core : 8 [INFO] [1682405732.583538668] [deadlock_example]: timer_cb_1 [INFO] [1682405737.584007252] [deadlock_example]: timer_cb_2 [INFO] [1682405739.584306750] [deadlock_example]: timer_cb_3 [INFO] [1682405740.585280574] [deadlock_example]: timer_cb_1 [INFO] [1682405745.585707617] [deadlock_example]: timer_cb_2 [INFO] [1682405747.586083455] [deadlock_example]: timer_cb_3 [INFO] [1682405748.586534268] [deadlock_example]: timer_cb_1 ... â‡’ ë³¸ë”” timer_cb_3ëŠ” 1ì´ˆë§ˆë‹¤ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ”ë° Dead Lockì— ë¹ ì§ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nCore 3ê°œë¡œ ëŠ˜ë ¤ì£¼ë©´ ì •ìƒ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•´ë´…ì‹œë‹¤. rclcpp::executors::MultiThreadedExecutor executor( rclcpp::executor::ExecutorArgs(), 3 ); ì˜ˆì‹œ ì‹¤í–‰ ê²°ê³¼ $ ros2 run cpp_multiproc_tutorial reentrant_limited Max CPU Core : 8 [INFO] [1682405809.551428499] [deadlock_example]: timer_cb_1 [INFO] [1682405809.551649918] [deadlock_example]: timer_cb_2 [INFO] [1682405809.551742931] [deadlock_example]: timer_cb_3 [INFO] [1682405810.552612691] [deadlock_example]: timer_cb_3 [INFO] [1682405811.552408971] [deadlock_example]: timer_cb_2 [INFO] [1682405811.552878292] [deadlock_example]: timer_cb_3 [INFO] [1682405812.553239899] [deadlock_example]: timer_cb_3 [INFO] [1682405813.552785030] [deadlock_example]: timer_cb_2 [INFO] [1682405813.553579643] [deadlock_example]: timer_cb_3 [INFO] [1682405814.552104332] [deadlock_example]: timer_cb_1 [INFO] [1682405814.553891457] [deadlock_example]: timer_cb_3 Intra-process communication and Node Composition ROS 2 ê°œë°œì„ ì¼ë°˜ì ìœ¼ë¡œ Nodeì˜ ê²°í•©ìœ¼ë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.ì´ë¥¼ í†µí•´ ëª¨ë“ˆí™”, ì½”ë“œ ì¬ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ì§€ë§Œ ì„±ëŠ¥ ì €í•˜ê°€ ì´ˆë˜ë˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤. ROS 1ì—ì„œëŠ” Nodeletì´ë¼ëŠ” ê²ƒìœ¼ë¡œ ì´ë¥¼ í•´ê²°í•˜ê³ ì í•˜ì˜€ëŠ”ë°, ì´ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ì—ì„œ ë‹¤ìˆ˜ì˜ Nodeë¥¼ êµ¬í˜„í•˜ê³ ì í•˜ëŠ” ì‘ì—…ì…ë‹ˆë‹¤.\nì´ëŸ¬í•œ ì‘ì—…ì„ í†µí•´ ë©”ëª¨ë¦¬ ìµœì í™”ì™€ ë™ì  Node load / unloadê°€ ê°€ëŠ¥í•œ ê²ƒì´ì§€ìš”. ê·¸ë¦¬ê³  ì´ë¥¼ ì´ì–´ë°›ì€ ROS 2ì—ì„œëŠ” Node Compositionì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ê°™ì€ ê¸°ëŠ¥ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.\nì˜ˆì‹œë¥¼ í†µí•´ Node Compositionì´ ì™œ í•„ìš”í•œì§€ ì‚´í´ë´…ì‹œë‹¤. ros2 run composition_tutorial image_pipeline_all_in_one â‡’ í˜„ì¬ 3ê°œì˜ Nodeê°€ ì‹¤í–‰ì¤‘ì— ìˆìŠµë‹ˆë‹¤. ê°ê°ì˜ Nodeë¡œ Image dataê°€ ì „ì†¡ë˜ê³  ìˆì§€ìš”.\nâ‡’ ì´ë¯¸ì§€ì— ì°íŒ ë°ì´í„° ì£¼ì†Œì— ì£¼ëª©í•©ì‹œë‹¤.\nì´ë²ˆì—ëŠ” ë‹¤ë¥¸ ìƒí™©ì„ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤. ros2 launch composition_tutorial image_pipeline_extra.launch.py Nodeë¥¼ ê±°ì¹˜ë©´ì„œ ë©”ëª¨ë¦¬ ìƒì„±, ë³µì‚¬ê°€ ë°˜ë³µë˜ê¸° ë•Œë¬¸ì— ì£¼ì†Œê°€ ëª¨ë‘ ë‹¤ë¥¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì‹¤ì œ topì„ í†µí•´ ë©”ëª¨ë¦¬ íš¨ìœ¨ì„ ë¹„êµí•´ë³´ê² ìŠµë‹ˆë‹¤. PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND 927 kimsooy+ 20 0 625328 86892 47116 S 17.9 0.5 1:18.92 Xorg 1217 kimsooy+ 20 0 4604400 269984 111132 S 13.6 1.7 1:45.35 gnome-shell 4095 kimsooy+ 20 0 1565920 102108 73140 S 11.9 0.6 0:01.13 image_pipeline_ PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND 927 kimsooy+ 20 0 607300 86892 47116 R 18.8 0.5 1:11.38 Xorg 2332 kimsooy+ 20 0 1130.9g 258892 126436 S 16.8 1.6 1:15.52 chrome 1217 kimsooy+ 20 0 4595376 269984 111132 R 15.2 1.7 1:36.03 gnome-shell 4030 kimsooy+ 20 0 1034768 77124 58520 S 8.3 0.5 0:01.99 camera_node 4034 kimsooy+ 20 0 1341172 98136 70164 S 5.6 0.6 0:01.71 image_view_node 4032 kimsooy+ 20 0 811272 74320 55924 S 4.6 0.5 0:01.21 watermark_node ì´ ë‘˜ì˜ ì°¨ì´ëŠ” Intra-process communicationì˜ ì‚¬ìš© ìœ ë¬´ì…ë‹ˆë‹¤. Node â‡’ Nodeë¡œ ë©”ëª¨ë¦¬ê°€ ì „ë‹¬ë˜ë©´ì„œ ë¶ˆí•„ìš”í•œ ë³µì‚¬ê°€ ë°˜ë³µë˜ë©´ ë©”ëª¨ë¦¬ íš¨ìœ¨ì´ ì €í•˜ë©ë‹ˆë‹¤.\nIntra-process communication Programming image_pipeline_all_in_one ì½”ë“œì™€ ì˜ˆì‹œë¥¼ í†µí•´ ì´ë¥¼ ì–´ë–»ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•´ë´…ì‹œë‹¤.\nìƒì„±ì Optionì—ì„œ use_intra_process_commsì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. CameraNode( const std::string \u0026amp; output, const std::string \u0026amp; node_name = \u0026#34;camera_node\u0026#34;, bool watermark = true, int device = 0, int width = 320, int height = 240) : Node(node_name, rclcpp::NodeOptions().use_intra_process_comms(true)), WatermarkNode( const std::string \u0026amp; input, const std::string \u0026amp; output, const std::string \u0026amp; text, const std::string \u0026amp; node_name = \u0026#34;watermark_node\u0026#34;) : Node(node_name, rclcpp::NodeOptions().use_intra_process_comms(true)){ // Node which receives sensor_msgs/Image messages and renders them using OpenCV. class ImageViewNode : public rclcpp::Node{ public: explicit ImageViewNode(const std::string \u0026amp; input, const std::string \u0026amp; node_name = \u0026#34;image_view_node\u0026#34;, bool watermark = true) : Node(node_name, rclcpp::NodeOptions().use_intra_process_comms(true)){ Topic data ìƒì„± ì‹œ unique_ptr, weak_ptr, SharedPtrì„ ì‚¬ìš©í•œ ëª¨ìŠµë„ ë³´ì…ë‹ˆë‹¤. // Create a new unique_ptr to an Image message for storage. sensor_msgs::msg::Image::UniquePtr msg(new sensor_msgs::msg::Image()); msg-\u0026gt;step = static_cast\u0026lt;sensor_msgs::msg::Image::_step_type\u0026gt;(frame_.step); // Create a publisher on the input topic. pub_ = this-\u0026gt;create_publisher\u0026lt;sensor_msgs::msg::Image\u0026gt;(output, qos); std::weak_ptr\u0026lt;std::remove_pointer\u0026lt;decltype(pub_.get())\u0026gt;::type\u0026gt; captured_pub = pub_; // Create a subscription on the input topic. sub_ = this-\u0026gt;create_subscription\u0026lt;sensor_msgs::msg::Image\u0026gt;( input, rclcpp::SensorDataQoS(),[node_name, watermark](const sensor_msgs::msg::Image::SharedPtr msg) { ë©”ëª¨ë¦¬ ë³µì‚¬ê°€ ì•„ë‹Œ ì†Œìœ ê¶Œ ì´ì „ìœ¼ë¡œ ìµœì í™”ë¥¼ êµ¬í˜„í•œ ê²ƒì…ë‹ˆë‹¤.\nì´ë²ˆ ì˜ˆì‹œì—ì„œëŠ” SingleThreadedExecutorë¥¼ ì‚¬ìš©í•˜ì—¬ Executorì— 3ê°œì˜ Nodeë¥¼ ì§ì ‘ ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤. int main(int argc, char * argv[]){ rclcpp::init(argc, argv); rclcpp::executors::SingleThreadedExecutor executor; ... executor.add_node(camera_node); executor.add_node(watermark_node); executor.add_node(image_view_node); executor.spin(); ì§€ê¸ˆ ì‹œì ì—ì„œ Intra-commì´ í•„ìš”í•œ ì´ìœ ëŠ” ëª¨ë‘ ì´í•´í•˜ì…¨ìœ¼ë¦¬ë¼ ìƒê°í•©ë‹ˆë‹¤. ë¹„ë¡ ì´ëŸ¬í•œ êµ¬í˜„ì´ ê°€ëŠ¥ì€ í•˜ì§€ë§Œ, ROS ê°œë°œìë“¤ì€ ì´ë¥¼ ì¢€ ë” ì‰½ê³  ë™ì ìœ¼ë¡œ í•  ìˆ˜ëŠ” ì—†ì„ì§€ ê³ ë¯¼í•˜ì˜€ìŠµë‹ˆë‹¤.\nROS 2 Node Composition Node Compositionì˜ ê¸°ë³¸ ê°œë…ì€ ê° Nodeë¥¼ ëŸ°íƒ€ì„ì— ë¡œë“œë˜ëŠ” ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ \u0026ldquo;Composition\u0026quot;ë¡œ ì‘ì„±í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ, ë‹¤ìŒê³¼ ê°™ì€ ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤\nê°ê°ì˜ Compositionì„ ê°œë³„ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì‹¤í–‰ ë‹¨ì¼ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì—¬ëŸ¬ ë…¸ë“œë¥¼ ì‹¤í–‰í•˜ì—¬ ì˜¤ë²„í—¤ë“œë¥¼ ë‚®ì¶”ê³  í†µì‹  íš¨ìœ¨ì„±ì„ ë†’ì´ê¸° Composition ì˜ˆì‹œ ì‹¤í–‰ì„ ìœ„í•œ ì¤€ë¹„ë¥¼ í•´ë´…ì‹œë‹¤. sudo apt install ros-foxy-ros2cli* -y sudo apt install ros-foxy-composition -y ë‹¤ìŒìœ¼ë¡œ, ê¸°ë³¸ ì˜ˆì‹œë¥¼ í†µí•´ Compositionì„ ë‹¤ë£¨ê¸° ìœ„í•œ CLIë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\ní˜„ì¬ ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  components ì¡°íšŒ $ ros2 component types (... components of other packages here) composition composition::Talker composition::Listener composition::NodeLikeListener composition::Server composition::Client composition cli example - ìˆœì„œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. component container ì‹¤í–‰ component load component unload # Terminal 1 - execute component_container ros2 run rclcpp_components component_container # Terminal 2 - check available container ros2 component list /ComponentManager componentë¥¼ load í•´ë´…ì‹œë‹¤. # Terminal 1 - load built-in publisher component ros2 component load /ComponentManager composition composition::Talker \u0026gt; Loaded component 1 into \u0026#39;/ComponentManager\u0026#39; container node as \u0026#39;/talker\u0026#39; # Container ì‹¤í–‰ terminal í™•ì¸ [INFO] [1682422159.067057665] [talker]: Publishing: \u0026#39;Hello World: 1\u0026#39; [INFO] [1682422160.066962102] [talker]: Publishing: \u0026#39;Hello World: 2\u0026#39; [INFO] [1682422161.066817081] [talker]: Publishing: \u0026#39;Hello World: 3\u0026#39; [INFO] [1682422162.066801139] [talker]: Publishing: \u0026#39;Hello World: 4\u0026#39; ... # Terminal 2 - load built-in subscriber component ros2 component load /ComponentManager composition composition::Listener \u0026gt; Loaded component 2 into \u0026#39;/ComponentManager\u0026#39; container node as \u0026#39;/listener\u0026#39; # Container ì‹¤í–‰ terminal í™•ì¸ [INFO] [1682422159.067057665] [talker]: Publishing: \u0026#39;Hello World: 1\u0026#39; [INFO] [1682422160.066962102] [talker]: Publishing: \u0026#39;Hello World: 2\u0026#39; [INFO] [1682422161.066817081] [talker]: Publishing: \u0026#39;Hello World: 3\u0026#39; [INFO] [1682422162.066801139] [talker]: Publishing: \u0026#39;Hello World: 4\u0026#39; ... ComponentManagerì˜ í•˜ìœ„ componentë¡œ talkerì™€ listenerê°€ ë“±ë¡ë˜ì–´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ros2 component list /ComponentManager 1 /talker 2 /listene componentì˜ unloadëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ì§€ê¸ˆì€ 1ê°œì˜ component ë°–ì— ì—†ê¸° ë•Œë¬¸ì— idëŠ” 1ì´ ë©ë‹ˆë‹¤. ros2 component unload /ComponentManager \u0026lt;id\u0026gt; Composition Programming Compositionì€ ë‚´ìš©ì´ ê¹Œë‹¤ë¡­ê³  ë””ë²„ê¹…ë„ ì‰½ì§€ ì•ŠìŠµë‹ˆë‹¤. ë•Œë¬¸ì— ì ˆì°¨ë¥¼ ë‚˜ëˆ„ì–´ ì°¨ê·¼ì°¨ê·¼ ì‘ì€ ë¶€ë¶„ë¶€í„° í•¨ê»˜ í”„ë¡œê·¸ë˜ë° ì‹¤ìŠµì„ í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.\nê¸°ë³¸ êµ¬ì¡°ì™€ Export Data Forwarding Composition Container ComposableNodeContainerë¥¼ í†µí•œ launch ì‹¤ ì‚¬ìš© ì‚¬ë¡€ â‡’ ZED Stereo Camera ê¸°ë³¸ êµ¬ì¡°ì™€ Export - ì•„ì£¼ ê°„ë‹¨í•œ ì½”ë“œë¥¼ í†µí•´ Node Compositionì˜ ê¸°ì´ˆë¶€í„° ìµí˜€ë´…ì‹œë‹¤. Node ìƒì„± CMakeLists.txt ìˆ˜ì • í›„ Export Component ìƒì„± ë° ì‹¤í–‰ í™•ì¸ basic_component.cpp - í•„ìˆ˜ë¡œ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ë¶€ë¶„ë“¤ì„ ì‚´í´ë´…ì‹œë‹¤. #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; #include \u0026#34;std_msgs/msg/string.hpp\u0026#34; using namespace std::chrono_literals; namespace composition_tutorial { class BasicComponent : public rclcpp::Node { public: explicit BasicComponent(const rclcpp::NodeOptions \u0026amp; options) : Node(\u0026#34;BasicComponent\u0026#34;, options), count_(0){ // Create a publisher of \u0026#34;std_mgs/String\u0026#34; messages on the \u0026#34;chatter\u0026#34; topic. pub_ = create_publisher\u0026lt;std_msgs::msg::String\u0026gt;(\u0026#34;chatter\u0026#34;, 10); // Use a timer to schedule periodic message publishing. timer_ = create_wall_timer(1s, std::bind(\u0026amp;BasicComponent::on_timer, this)); } protected: void on_timer(){ auto msg = std::make_unique\u0026lt;std_msgs::msg::String\u0026gt;(); msg-\u0026gt;data = \u0026#34;Hello World: \u0026#34; + std::to_string(++count_); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Publishing: \u0026#39;%s\u0026#39;\u0026#34;, msg-\u0026gt;data.c_str()); std::flush(std::cout); // Put the message into a queue to be processed by the middleware. // This call is non-blocking. pub_-\u0026gt;publish(std::move(msg)); } private: size_t count_; rclcpp::Publisher\u0026lt;std_msgs::msg::String\u0026gt;::SharedPtr pub_; rclcpp::TimerBase::SharedPtr timer_; }; } // namespace composition #include \u0026#34;rclcpp_components/register_node_macro.hpp\u0026#34; // Register the component with class_loader. // This acts as a sort of entry point, allowing the component to be discoverable when its library // is being loaded into a running process. RCLCPP_COMPONENTS_REGISTER_NODE(composition_tutorial::BasicComponent) ìš”ì ë“¤ì„ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. Description namespace ì§€ì • íŒ¨í‚¤ì§€ ì´ë¦„ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì…ë‹ˆë‹¤. explicit ìƒì„±ì ì¼ë°˜ Nodeê°€ ì•„ë‹Œ Componentë¡œì˜ ì‚¬ìš©ì„ ìœ„í•´ ìƒì„±ì explicit í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. smart_pointer on_timerì—ì„œ ì‚¬ìš©ë˜ëŠ” msg ë°ì´í„°ê°€ shared_ptr íƒ€ì…ì¸ ê²ƒì„ ë³¼ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ë©”ëª¨ë¦¬ ìµœì í™”ë¥¼ ìœ„í•´ ë‹¤ìŒ Componentì—ê²Œ pointerë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤. register_node_macro component register ë§¤í¬ë¡œë¥¼ í†µí•´ êµ¬í˜„í•œ Componentë¥¼ ROS 2 ì‹œìŠ¤í…œì— ë“±ë¡í•©ë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ Foxyê¸°ì¤€ C++ íŒ¨í‚¤ì§€ë§Œ ì§€ì›í•©ë‹ˆë‹¤. CMakeLists.txt ìˆ˜ì • í›„ Export - ì•„ë˜ì˜ templateì— ë§ì¶”ì–´ Componentë¥¼ ë¹Œë“œí•˜ê³  exportí•©ë‹ˆë‹¤. Component ìì²´ëŠ” shared libraryì´ë©° ë•Œë¬¸ì— Container ì‹¤í–‰ í›„ ëŸ°íƒ€ì„ì— load / unloadê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. add_library target_compile_definitions ament_target_dependencies rclcpp_components_register_nodes install add_library(basic_component SHARED src/basic_component.cpp) target_compile_definitions(basic_component PRIVATE \u0026#34;COMPOSITION_TUTORIAL_BUILDING_DLL\u0026#34;) ament_target_dependencies(basic_component \u0026#34;rclcpp\u0026#34; \u0026#34;rclcpp_components\u0026#34; \u0026#34;std_msgs\u0026#34; ) rclcpp_components_register_nodes(basic_component \u0026#34;composition_tutorial::BasicComponent\u0026#34;) set(node_plugins \u0026#34;${node_plugins}composition_tutorial::BasicComponent;$\u0026lt;TARGET_FILE:basic_component\u0026gt;\\n\u0026#34;) install(TARGETS basic_component ARCHIVE DESTINATION lib LIBRARY DESTINATION lib RUNTIME DESTINATION bin ) Description add_library í˜„ì¬ ì‹¤í–‰ íŒŒì¼ì„ ë§Œë“œëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì´ë¯€ë¡œ add_executableì´ ì•„ë‹Œ add_libraryë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. target_compile_definitions basic_componentëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë¯€ë¡œ íŠ¹ì • íƒ€ê²Ÿì—ë§Œ í•´ë‹¹í•˜ëŠ” ì»´íŒŒì¼ ì˜µì…˜ì„ ì •ì˜í•©ë‹ˆë‹¤. ament_target_dependencies ì¼ë°˜ì ì¸ ì¢…ì†ì„ linkingì…ë‹ˆë‹¤. rclcpp_components_register_nodes ì´ ë¶€ë¶„ì´ ìƒˆë¡­ê²Œ ë“±ì¥í•œ ë‚´ìš©ì¸ë°ìš”, ì‚¬ì‹¤ main í•¨ìˆ˜ê°€ ì—†ì–´ë„ ì‹¤í–‰ ê°€ëŠ¥í•œ Nodeë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì§€ê¸ˆì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¹Œë“œí•˜ê¸° ìœ„í•œ ì»¤ë©˜ë“œë¡œ ì‚¬ìš©ë˜ì—ˆì§€ë§Œ ì´ëŠ” ì´í›„ì— ë‹¤ì‹œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. set node_pluginsì— ìƒˆë¡­ê²Œ ì»´íŒŒì¼í•œ basic_componentë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. install build í´ë”ì— ìœ„ì¹˜ì‹œì¼œ ros2 component ì»¤ë©˜ë“œ ë¼ì¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. Component ìƒì„± ë° ì‹¤í–‰ í™•ì¸ - component clië¥¼ í†µí•´ ìƒì„±ëœ Componentë¥¼ í™•ì¸í•˜ê³  ì‹¤í–‰í•´ë´…ì‹œë‹¤. # Component ìƒì„± í™•ì¸ $ ros2 component types composition_tutorial composition_tutorial::BasicComponent # Container ì‹¤í–‰ $ ros2 run rclcpp_components component_container # ì‹¤í–‰ ì¤‘ì¸ Container í™•ì¸ í›„ component load $ ros2 component list /ComponentManager $ ros2 component load /ComponentManager composition_tutorial composition_tutorial::BasicComponent # Container ì‹¤í–‰ Terminalì—ì„œ ë¡œê·¸ í™•ì¸ \u0026gt; [INFO] [1682466495.013826879] [BasicComponent]: Publishing: \u0026#39;Hello World: 1\u0026#39; â‡’ ì§€ê¸ˆì€ cpp íŒŒì¼ì— ìµœì†Œí•œì˜ êµ¬í˜„ì„ í–ˆì§€ë§Œ ë³´í†µ í—¤ë”ë¥¼ ë¶„ë¦¬í•˜ê³  visibility controlì„ í†µí•´ ì™¸ë¶€ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë²”ìœ„ë¥¼ ì œí•œí•©ë‹ˆë‹¤.\nâ‡’ ì‹¤ì œ ì œí’ˆ ê°œë°œ ì‹œ ë³´ì•ˆì´ ì ìš©ë˜ì–´ì•¼ í•˜ëŠ” ë¶€ë¶„ì´ë¼ë©´ Nodeì½”ë“œ ëŒ€ì‹  Componentë¥¼ ì œê³µí•˜ëŠ” ë°©ë²•ë„ ìˆìŠµë‹ˆë‹¤.\nCompile-time composition componentë¡œ ë™ì  load / unloadê°€ ê°€ëŠ¥í•˜ì§€ë§Œ ì‹œìŠ¤í…œ í†µí•©ì„ ìœ„í•´ manual í†µí•© ì½”ë“œë¥¼ ì‘ì„±í•˜ê±°ë‚˜, launch fileì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì§ì ‘ componentë“¤ì„ ì‹¤í–‰ì‹œí‚¤ëŠ” main ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤. ì¼ì „ image_pipeline_all_in_oneì„ í†µí•´ ì˜ˆì‹œë¥¼ ì‚´í´ë´…ì‹œë‹¤. int main(int argc, char * argv[]) { rclcpp::init(argc, argv); rclcpp::executors::SingleThreadedExecutor executor; // Connect the nodes as a pipeline: camera_node -\u0026gt; watermark_node -\u0026gt; image_view_node std::shared_ptr\u0026lt;CameraNode\u0026gt; camera_node = nullptr; try { camera_node = std::make_shared\u0026lt;CameraNode\u0026gt;(\u0026#34;image\u0026#34;); } catch (const std::exception \u0026amp; e) { fprintf(stderr, \u0026#34;%s Exiting ..\\n\u0026#34;, e.what()); return 1; } auto watermark_node = std::make_shared\u0026lt;WatermarkNode\u0026gt;(\u0026#34;image\u0026#34;, \u0026#34;watermarked_image\u0026#34;, \u0026#34;Hello world!\u0026#34;); auto image_view_node = std::make_shared\u0026lt;ImageViewNode\u0026gt;(\u0026#34;watermarked_image\u0026#34;); executor.add_node(camera_node); executor.add_node(watermark_node); executor.add_node(image_view_node); Composition using launch actions composition containerì™€ ì‹¤í–‰ë  componentë“¤ì„ ëª…ì‹œí•˜ëŠ” launch actionë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (talkerì™€ listener, Component Managerë¥¼ í•¨ê»˜ ì‹¤í–‰í•˜ëŠ” launch fileì„ ì‘ì„±í•´ë³´ì•˜ìŠµë‹ˆë‹¤.) ros2 launch composition_tutorial talk_listen.launch.py import launch from launch_ros.actions import ComposableNodeContainer from launch_ros.descriptions import ComposableNode def generate_launch_description(): \u0026#34;\u0026#34;\u0026#34;Generate launch description with multiple components.\u0026#34;\u0026#34;\u0026#34; container = ComposableNodeContainer( name=\u0026#39;my_container\u0026#39;, namespace=\u0026#39;\u0026#39;, package=\u0026#39;rclcpp_components\u0026#39;, executable=\u0026#39;component_container\u0026#39;, composable_node_descriptions=[ ComposableNode( package=\u0026#39;composition\u0026#39;, plugin=\u0026#39;composition::Talker\u0026#39;, name=\u0026#39;talker\u0026#39;), ComposableNode( package=\u0026#39;composition\u0026#39;, plugin=\u0026#39;composition::Listener\u0026#39;, name=\u0026#39;listener\u0026#39;) ], output=\u0026#39;screen\u0026#39;, ) return launch.LaunchDescription([container]) Component ManagerëŠ” rqt_graphë¥¼ í†µí•´ êµ¬ë³„í•˜ê¸° ì‰½ì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì ì ˆí•œ ì´ë¦„ì„ ë¶€ì—¬í•˜ëŠ” ê²ƒì´ ë””ë²„ê¹…ì— ìš©ì´í•©ë‹ˆë‹¤. ê¸°ë³¸ Container ì´ë¦„ì€ /ComponentManager ì´ì§€ë§Œ, remappingì„ í†µí•´ namespaceë¥¼ ì§€ì •í•˜ê±°ë‚˜ ì´ ì´ë¦„ì„ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤. # container remapping ros2 run rclcpp_components component_container --ros-args -r __node:=MyContainer -r __ns:=/ns ros2 component list \u0026gt; /ns/MyContainer # Remap node name ros2 component load /ns/MyContainer composition composition::Talker --node-name talker3 --node-namespace /ns2 ros2 component list /ns/MyContainer 1 /ns2/talker3 componentì—ê²Œ ë§¤ê°œë³€ìˆ˜ë„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. use_intra_process_comms ì˜µì…˜ì„ ë§¤ê°œë³€ìˆ˜ë¡œ ì œì–´í•´ ë³´ê² ìŠµë‹ˆë‹¤. ros2 component load /ComponentManager composition composition::Talker -e use_intra_process_comms:=true êµ¬í˜„ê³¼ ì‚¬ìš©ì— ëŒ€í•´ì„œëŠ” ì´ì •ë„ ì„¤ëª…í•˜ê³ , ì¶”ê°€ ìë£ŒëŠ” ë§í¬ë¡œ ë‚¨ê¸°ê² ìŠµë‹ˆë‹¤.\nComponentë¥¼ shared libraryë¡œ exportí•˜ê³  ë‹¤ë¥¸ packageì—ì„œ importí•˜ì—¬ ì‚¬ìš©í•˜ê¸° - Ament best practice for sharing libraries\nì‹¤ ì‚¬ìš© ì‚¬ë¡€ - ZED ros2 composition compositionì˜ ì¤‘ìš”ì„±ê³¼ ì‚¬ìš©ì— ëŒ€í•´ ì¢€ ë” í™•ì‹¤íˆ ì•Œ ìˆ˜ ìˆëŠ” ì˜ˆì‹œë¥¼ ê°€ì ¸ì™€ ë³´ì•˜ìŠµë‹ˆë‹¤.\nStereo Labsì˜ ZED CameraëŠ” Compositionì„ ì‚¬ìš©í•˜ì—¬ ë³´ë‹¤ íš¨ìœ¨ì ì¸ rgb convert, format conversionì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì½”ë“œë¥¼ í†µí•´ í•¨ê»˜ ì‚´í´ë´…ì‹œë‹¤.â‡’ ì¶œì²˜ : https://www.stereolabs.com/docs/ros2/ros2-composition/\nzed_rgb_convert_component.hpp - compositionì¸ ZedRgbCvtComponentê°€ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. namespace stereolabs { class ZedRgbCvtComponent : public rclcpp::Node { public: ZED_CVT_COMPONENT_PUBLIC explicit ZedRgbCvtComponent(const rclcpp::NodeOptions \u0026amp; options); virtual ~ZedRgbCvtComponent() {} protected: void camera_callback( const sensor_msgs::msg::Image::ConstSharedPtr \u0026amp; img, const sensor_msgs::msg::CameraInfo::ConstSharedPtr \u0026amp; cam_info); private: // Publisher image_transport::CameraPublisher mPubBgr; // Subscriber image_transport::CameraSubscriber mSubBgra; // QoS parameters rclcpp::QoS mVideoQos; }; } // namespace stereolabs #endif // ZED_RGB_CONVERT_COMPONENT_HPP_ zed_rgb_convert_component.cpp - ë©”ëª¨ë¦¬ ìµœì í™”ë¥¼ ìœ„í•´ ConstSharedPtr íƒ€ì… input, outputì„ ì‚¬ìš©í•˜ê³  ìˆëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. void ZedRgbCvtComponent::camera_callback( const sensor_msgs::msg::Image::ConstSharedPtr \u0026amp; img, const sensor_msgs::msg::CameraInfo::ConstSharedPtr \u0026amp; cam_info) { // Check for correct input image encoding if (img-\u0026gt;encoding != sensor_msgs::image_encodings::BGRA8) { RCLCPP_ERROR(get_logger(), \u0026#34;The input topic image requires \u0026#39;BGRA8\u0026#39; encoding\u0026#34;); exit(EXIT_FAILURE); } // Convert BGRA to BGR using OpenCV void * data = const_cast\u0026lt;void *\u0026gt;(reinterpret_cast\u0026lt;const void *\u0026gt;(\u0026amp;img-\u0026gt;data[0])); cv::Mat bgra(img-\u0026gt;height, img-\u0026gt;width, CV_8UC4, data); cv::Mat bgr; cv::cvtColor(bgra, bgr, cv::COLOR_BGRA2BGR); // Create the output message and copy coverted data std::shared_ptr\u0026lt;sensor_msgs::msg::Image\u0026gt; out_bgr = std::make_shared\u0026lt;sensor_msgs::msg::Image\u0026gt;(); out_bgr-\u0026gt;header.stamp = img-\u0026gt;header.stamp; out_bgr-\u0026gt;header.frame_id = img-\u0026gt;header.frame_id; out_bgr-\u0026gt;height = bgr.rows; out_bgr-\u0026gt;width = bgr.cols; int num = 1; // for endianness detection out_bgr-\u0026gt;is_bigendian = !(*reinterpret_cast\u0026lt;char *\u0026gt;(\u0026amp;num) == 1); out_bgr-\u0026gt;step = bgr.step; size_t size = out_bgr-\u0026gt;step * out_bgr-\u0026gt;height; out_bgr-\u0026gt;data.resize(size); out_bgr-\u0026gt;encoding = sensor_msgs::image_encodings::BGR8; memcpy(reinterpret_cast\u0026lt;char *\u0026gt;((\u0026amp;out_bgr-\u0026gt;data[0])), \u0026amp;bgr.data[0], size); // Publish the new image message coupled with camera info from the original message mPubBgr.publish(out_bgr, cam_info); } camera_callbackì˜ ëª©í‘œëŠ” cv::cvtColorë¥¼ í†µí•´ BGRA (CV_8UC4)ì„ BGR (CV_8UC4) íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.\nZedCamera Compositionê³¼ ZedRgbCvtComponent Compositionì„ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ë³„ë„ Executorë¥¼ ë§Œë“¤ì–´ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. int main(int argc, char * argv[]){ setvbuf(stdout, NULL, _IONBF, BUFSIZ); rclcpp::init(argc, argv); rclcpp::executors::MultiThreadedExecutor exec; rclcpp::NodeOptions options; // Enable intraprocess communication options.use_intra_process_comms(true); // Add ZedCamera node auto zed_node = std::make_shared\u0026lt;stereolabs::ZedCamera\u0026gt;(options); exec.add_node(zed_node); // Add ZedRgbCvtComponent node auto zed_cvt_node = std::make_shared\u0026lt;stereolabs::ZedRgbCvtComponent\u0026gt;(options); exec.add_node(zed_cvt_node); exec.spin(); rclcpp::shutdown(); return 0; } ì´ëŠ” ë¬¼ë¡  launch fileë¡œë„ ê°€ëŠ¥í•  ê²ƒì…ë‹ˆë‹¤. ğŸ˜\n"
},
{
	"uri": "/kr/ros2_foxy/lecture16/",
	"title": "Lecture16. Useful ROS 2 Examples (Misc)",
	"tags": [],
	"description": "",
	"content": "ROS 1 Bridge ë‹¨ìˆœ ê°œë°œì„ ìœ„í•´ì„œëŠ” ìµœì‹  ìŠ¤íƒì„ ì‚¬ìš©í•˜ë©´ ì¢‹ì§€ë§Œ, ì œí’ˆ ê°œë°œì„ ìƒê°í•˜ë©´ ì´ì „ ë²„ì „ì˜ ì†ŒìŠ¤ë“¤ë„ ìœ ì§€ë³´ìˆ˜í•  ì¤„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤. ROS ê°œë°œì€ íŠ¹íˆ ì˜¤í”ˆì†ŒìŠ¤ì— ê¸°ë°˜í•˜ê¸° ë•Œë¬¸ì— ì–´ëŠ ì •ë„ ë ˆë²¨ì— ì˜¤ë¥´ë©´ ë ˆê±°ì‹œë¥¼ ì½ê³  ìƒˆë¡œìš´ ë²„ì „ìœ¼ë¡œ ê´€ë¦¬ë„ í•  ì¤„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤.\nâ‡’ ê·¸ëŸ° ì˜ë¯¸ì—ì„œ ì´ë²ˆ ì‹œê°„ì—ëŠ” ì½”ë“œ ì‘ì—…ì´ ì „í˜€ ì—†ì–´ë„ ROSì™€ ROS 2ë¥¼ ì—°ë™ì‹œí‚¬ ìˆ˜ ìˆëŠ” ROS bridgeë¼ëŠ” ê²ƒì„ ì‹¤ìŠµí•´ ë³´ê² ìŠµë‹ˆë‹¤.\nimage from : swri.org\nê°•ì˜ ì´ˆë°˜ ì €ì˜ ì„¤ì •ì„ ì˜ ë”°ë¼ì˜¤ì…¨ë‹¤ë©´ ì—¬ëŸ¬ë¶„ì˜ ì‹œìŠ¤í…œì—ëŠ” ì´ë¯¸ ROS noeticì´ ì„¤ì¹˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ****************************************************** * Usage: To set ROS env to be auto-loaded, please * * assign ros_option in ros_menu/config.yaml * ****************************************************** 0) Do nothing 1) ROS 1 noetic 2) ROS 2 foxy 3) ROS2/ROS1_bridge **Please choose an opt**ion: 2 ------------------------------------------------------ * ROS_DOMAIN_ID = 30 ------------------------------------------------------ ì‹¤ìŠµì„ ìœ„í•´ husky ROS packageë¥¼ ì‹¤í–‰í•˜ê³  topicì„ ì¡°íšŒí•´ë´…ì‹œë‹¤. sudo apt-get install ros-noetic-husky-desktop -y sudo apt-get install ros-noetic-husky-simulator -y sudo apt-get install ros-noetic-husky-gazebo -y # ìƒˆë¡œìš´ í„°ë¯¸ë„ì„ ì‹¤í–‰ì‹œí‚¨ ë’¤ 1ë²ˆì„ ì„ íƒí•˜ì—¬ ROS 1 noetic í„°ë¯¸ë„ë¡œ ì „í™˜í•©ë‹ˆë‹¤. 0) Do nothing 1) ROS 1 noetic 2) ROS 2 foxy 3) ROS 2 galactic 4) ROS2/ROS1_bridge h) Help Please choose an option: 1 # ë™ì¼ í„°ë¯¸ë„ì—ì„œ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤. roslaunch husky_gazebo empty_world.launch # ë‘ë²ˆì§¸ í„°ë¯¸ë„ë„ ROS 1 noetic í„°ë¯¸ë„ë¡œ ì „í™˜í•©ë‹ˆë‹¤. $ rostopic list # Terminal 2 $ rostopic list /clock /cmd_vel /diagnostics /e_stop /gazebo/link_states /gazebo/model_states /gazebo/parameter_descriptions /gazebo/parameter_updates /gazebo/performance_metrics /gazebo/set_link_state /gazebo/set_model_state ... ìš°ë¦¬ì˜ ëª©í‘œëŠ” ì§€ê¸ˆ ë³´ì´ëŠ” cmd_velì—ê²Œ topic publishë¥¼ í•˜ì—¬ ROS 2ê°€ ì•„ë‹Œ, ROS ìƒì˜ ë¡œë´‡ì„ ì œì–´í•´ë³´ëŠ” ê²ƒì…ë‹ˆë‹¤.\nhusky_gazeboë¥¼ ì¢…ë£Œí•œ ë’¤, ìƒˆë¡œìš´ í„°ë¯¸ë„ì„ ì—´ê³  ì´ˆê¸° ì˜µì…˜ ì„ íƒì—ì„œ (ROS2/ROS1_bridge)ë¥¼ ì„ íƒí•˜ë©´ ros1 bridgeê°€ ì‹¤í–‰ë©ë‹ˆë‹¤. (ì•„ë§ˆ ì‹¤í–‰ ì‹œ ì˜¤ë¥˜ê°€ ë“±ì¥í•  ê²ƒì…ë‹ˆë‹¤.) ****************************************************** * Usage: To set ROS env to be auto-loaded, please * * assign ros_option in ros_menu/config.yaml * ****************************************************** 0) Do nothing 1) ROS 1 noetic 2) ROS 2 foxy 3) ROS2/ROS1_bridge Please choose an option: 3 ------------------------------------------------------ * ROS_IP=172.24.55.124 * ROS_MASTER_URI 172.24.55.124 ------------------------------------------------------ * ROS_DOMAIN_ID = 30 ------------------------------------------------------ ROS_DISTRO was set to \u0026#39;noetic\u0026#39; before. Please make sure that the environment does not mix paths from different distributions. source /home/kimsooyoung/.ros_menu/plugins_bashrc/dds_bashrc 1 Source Eclipse Cyclone DDS successfully! [ERROR] [1682250552.661762864]: [registerPublisher] Failed to contact master at [172.24.55.124:11311]. Retrying... ROS1ì˜ Nodeë“¤ë¼ë¦¬ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ê¸° ìœ„í•´ì„œëŠ” ì–´ë–¤ ë…¸ë“œê°€ ì¡´ì¬í•˜ëŠ”ì§€, idëŠ” ëª‡ë²ˆì¸ì§€ ë“±ì˜ ì •ë³´ê°€ ê³µìœ ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ì•„ë˜ ê·¸ë¦¼ì˜ ROS Masterê°€ ì´ë¥¼ ê´€ë¦¬í•´ì£¼ëŠ” ê²ƒì´ë¼ê³  ì´í•´í•˜ì‹œë©´ ë˜ë©°, ROS 2ëŠ” DDSê°€ ì´ë¥¼ ì•Œì•„ì„œ í•´ì£¼ê¸° ë•Œë¬¸ì— í¸í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²ƒì…ë‹ˆë‹¤. ì°¸ê³ ë¡œ roslaunchë¥¼ ì‚¬ìš©í•˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ roscoreë„ í•¨ê»˜ ì‹¤í–‰ë©ë‹ˆë‹¤.\nimage from : clearpathrobotics\në‹¤ì‹œ í•œ ë²ˆ, rosmasterë¥¼ ì‹¤í–‰ì‹œí‚¨ ë’¤, cmd_vel ì œì–´ë¥¼ í•´ë´…ì‹œë‹¤. # Terminal 1 =\u0026gt; ROS 1 noetic ì„ íƒ í›„ roslaunch husky_gazebo empty_world.launch # Terminal 2 - ros bridge ì„ íƒ Created 2 to 1 bridge for service /ekf_localization/enable Created 2 to 1 bridge for service /gazebo/clear_body_wrenches Created 2 to 1 bridge for service /gazebo/clear_joint_forces ... # Terminal 3 - ROS 2 Foxy ì„ íƒ í›„ cmd_vel control ros2 run teleop_twist_keyboard teleop_twist_keyboard ROS 2ë¡œ ì„¤ì •ëœ í„°ë¯¸ë„ì—ì„œ ROS 1ìœ¼ë¡œ êµ¬ë™ë˜ê³  ìˆëŠ” ë¡œë´‡ì„ ì¡°ì¢…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ros bridgeê°€ ìˆìœ¼ë‹ˆ ROS 2 ê°œë°œì„ êµ³ì´ í•˜ì§€ ì•Šì•„ë„ ëœë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë³´ì•ˆ, ì§€ì—°ê³¼ ê°™ì€ ROS 1ì˜ ê³ ì§ˆì ì¸ ë¬¸ì œë“¤ì€ ì—¬ì „íˆ ë‚¨ì•„ìˆê²Œ ë˜ë¯€ë¡œ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•˜ëŠ” ë‹¨ê³„ë¼ë©´, ì²˜ìŒë¶€í„° ROS 2ë¡œ ëª¨ë“  ê°œë°œì„ ì§„í–‰í•˜ì‹œê¸¸ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.\nì°¸ê³ ë¡œ, /opt/ros/\u0026lt;ros-version\u0026gt;/setup.bashëŠ” ROS ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ í•„ìš”í•œ ì„¤ì •ì´ ë‹´ê¸´ íŒŒì¼ì…ë‹ˆë‹¤. í˜¹ì—¬ë‚˜ galactic, humbleê³¼ ê°™ì´ ìµœì‹  ë²„ì „ì„ ì‚¬ìš©í•˜ê³  ì‹¶ì„ ë•Œ ì°¸ê³ í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.\nAbout DDS ROS 1ê³¼ ëŒ€ë‘ë˜ëŠ” ê°€ì¥ í° ì°¨ì´ì ìœ¼ë¡œ, ROS 2ëŠ” DDSë¥¼ ë¯¸ë“¤ì›¨ì–´ë¡œ ê¸°ë°˜í•˜ì—¬ ê°œí¸ë˜ì—ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ DDSì— ëŒ€í•œ ê°œìš”ì™€ ê¸°ëŠ¥ì„ ì´í•´í•˜ëŠ” ê²ƒì€ ROS 2ì˜ ì„±ì§ˆì„ íŒŒì•…í•˜ëŠ” ë° ë§ì€ ë„ì›€ì´ ë©ë‹ˆë‹¤.\nWhat is DDS? DDS - Data Distribution ServiceëŠ” OMGì—ì„œ ì •ì˜í•œ Publish-Subscribe ë°©ì‹ì˜ ì‹¤ì‹œê°„ ë°ì´í„° ë¶„ë°° ì„œë¹„ìŠ¤ í‘œì¤€ì…ë‹ˆë‹¤. Pub-Subì´ë¼ëŠ” ìš©ì–´ëŠ” ROS ê°œë°œìì—ê²Œ ë¬´ì²™ ìµìˆ™í•œ ë‹¨ì–´ì´ì§€ìš”? DDSì˜ ê¸°ë³¸ í†µì‹  ê°œë…ì€ ROSì˜ Topicê³¼ ë§¤ìš° ìœ ì‚¬í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ê²°ë¡ ì„ ë¨¸ë¦¬ì†ì— ì˜ ë‹´ì•„ë‘ê³  ê³„ì†í•´ì„œ ì§„í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤.\nOMG(Object Management Group)ëŠ” ë¶„ì‚° ê°ì²´ ì»´í“¨íŒ…(Distributed Object Computing) ì˜ì—­ì˜ í‘œì¤€ì„ ì œì •í•˜ëŠ” êµ­ì œ ë¹„ì˜ë¦¬ ì»¨ì†Œì‹œì—„ìœ¼ë¡œ ì˜í–¥ë ¥ ìˆëŠ” ê°ì¢… ì„¸ê³„ í‘œì¤€ì„ ì •ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nimage from : ë¶„ì‚°ì´ë™ì»´í“¨íŒ… ì—°êµ¬ì‹¤\nOMG DDSëŠ” í†µì‹  í”„ë¡œí† ì½œì´ ì•„ë‹Œ ê¸°ëŠ¥ì  í‘œì¤€ìœ¼ë¡œ, ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ TCP/UDP ê°™ì€ í†µì‹  í”„ë¡œí† ì½œ ìœ„ì—ì„œ ì •ì˜ë˜ëŠ” ê°ì²´ì…ë‹ˆë‹¤. ê·¸ë¦¼ì˜ ì•„ë˜ì—ì„œë¶€í„° OMG DDSì˜ êµ¬ì¡°ë¥¼ ê°„ë‹¨íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nRTPS(Real-Time Publish-Subscribe Wire Protocol) Layer RTPS LayerëŠ” ë„¤íŠ¸ì›Œí¬ ë‚´, ì°¸ì—¬ì ì •ë³´ë¥¼ ìœ ì§€í•˜ê³ , ë„¤íŠ¸ì›Œí¬ ì°¸ì—¬ìì— ëŒ€í•œ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìë™ ê²€ìƒ‰ì„ í•´ì¤ë‹ˆë‹¤. (ê°™ì€ ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ROS 2 ì‹œìŠ¤í…œì€ ì„œë¡œ í†µì‹ ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.) ë”ë¶ˆì–´, ì°¸ì—¬ìì˜ ë™ì  ì¶”ê°€ì™€ ì´íƒˆì— ëŒ€ì‘í•˜ëŠ” ê¸°ëŠ¥ì„ í•©ë‹ˆë‹¤.\nRTPSëŠ” OMGì— ì˜í•´ í‘œì¤€í™”ëœ, ë°ì´í„° ë¶„ì‚° ì‹œìŠ¤í…œì„ ìœ„í•œ í”„ë¡œí† ì½œë¡œì¨ Pub-Sub êµ¬ì¡°ì˜ í†µì‹  ëª¨ë¸ì„ ì§€ì›í•©ë‹ˆë‹¤. UDPì™€ ê°™ì´ ì‹ ë¢°ì„± ì—†ëŠ” ê³„ì¸µ ìœ„ì—ì„œë„ ë™ì‘ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìœ¼ë©°, 4ê°€ì§€ ëª¨ë“ˆë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\nStructure Module : ë°ì´í„° êµí™˜ ì‹œ, í†µì‹ ì— ì°¸ì—¬í•˜ê²Œ ë˜ëŠ” ê°œì²´ë“¤ì— ëŒ€í•´ ì •ì˜í•©ë‹ˆë‹¤. Message Module : Writerì™€ Readerê°„ ì •ë³´ êµí™˜ì„ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ë©”ì‹œì§€ì— ëŒ€í•´ ì •ì˜í•©ë‹ˆë‹¤. Behavior Module : Writerì™€ Readerê°„ ìƒíƒœ, ì‹œê°„ ì¡°ê±´ì— ë”°ë¼ ìˆ˜í–‰ë˜ì–´ì•¼ í•  ë©”ì‹œì§€ ì „ì†¡ ì ˆì°¨ì— ëŒ€í•´ ì •ì˜í•©ë‹ˆë‹¤. Discovery Module : ê°™ì€ ë„ë©”ì¸ ìƒì— ì¡´ì¬í•˜ëŠ” ê°œì²´ì— ëŒ€í•œ ì •ë³´ë¥¼ íƒìƒ‰í•˜ëŠ” ê¸°ëŠ¥ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. Discovery Moduleì€ ë‹¤ìŒê³¼ ê°™ì´ ë‘ ê°€ì§€ì˜ RTPS í”„ë¡œí† ì½œì„ ì‚¬ìš©í•©ë‹ˆë‹¤. PDP(Participant Discovery Protocol) : ì„œë¡œ ë‹¤ë¥¸ ë„¤íŠ¸ì›Œí¬ ìƒì—ì„œì˜ Participantíƒìƒ‰ì„ ìœ„í•œ í”„ë¡œí† ì½œ EDP(Endpoint Discovery Protocol) : Writer, Readerì™€ ê°™ì´ ì„œë¡œ ë‹¤ë¥¸ ì¢…ë‹¨ì  ê°„ì˜ íƒìƒ‰ ì •ë³´ êµí™˜ì— ì‚¬ìš©ë˜ëŠ” í”„ë¡œí† ì½œ image from : OMG DDS(Data Distrubution Service) ê¸°ìˆ  ê°œìš”\nDDS Discovery ROS 2ë¥¼ ì‚¬ìš©í•˜ëŠ” ë‘ ë””ë°”ì´ìŠ¤ëŠ” ê°™ì€ ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ ìë™ìœ¼ë¡œ ì„œë¡œë¥¼ ì¸ì‹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì–´ë–»ê²Œ ì´ëŸ¬í•œ ë™ì‘ì´ ê°€ëŠ¥í•˜ë©°, ì´ë¥¼ ìœ„í•œ í•„ìš”ì¡°ê±´ì€ ë¬´ì—‡ì¸ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nDiscoveryë¥¼ ìœ„í•´ í•„ìš”í•œ ì •ë³´ë“¤ - DDSÂ ë¯¸ë“¤ì›¨ì–´ í†µì‹ ì„ ìœ„í•´ ì•„ë˜Â 4ê°€ì§€ ì •ë³´ë¥¼ ì‚¬ì „ì— êµí™˜í•´ì•¼ í•©ë‹ˆë‹¤.\nWho : Topic Publish í˜¹ì€ Subscribe ëŒ€ìƒ Where : DDSÂ í‘œì¤€ì—ì„œ ìƒì„±í•œÂ LocatorÂ ì •ë³´ What :Â Publishí•˜ê±°ë‚˜ Subscribeí•˜ë ¤ëŠ”Â Topic How : Topic Publisherì¸ì§€ Subscriberì¸ì§€ì— ëŒ€í•œ ì •ë³´ DDSÂ RTPSë„ ê²°êµ­Â UDPë‚˜Â TCP ë„¤íŠ¸ì›Œí¬ ë ˆì´ì–´ë¥¼ ì‚¬ìš©í•˜ë©°, ì´ë¥¼ ìœ„í•´ì„œ ì‹¤ì§ˆì ìœ¼ë¡œÂ IPì™€Â PORTë“±ì˜ ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.Â í•˜ì§€ë§Œ, DDSëŠ” ì‚¬ìš©ìê°€ ì£¼ì†Œë¥¼ ì§€ì •í•˜ì§€ ì•Šì•„ë„Â â€œTopicâ€ë§Œìœ¼ë¡œ í†µì‹ ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” ê²ƒì´ Locatorì´ë©°, ì´ëŠ” Middle Wareë‹¨ì—ì„œ ëŠ¥ë™ì ìœ¼ë¡œ í†µì‹ ì— í•„ìš”í•œ ì •ë³´ë¥¼ í¬í•¨í•˜ëŠ” ìƒˆë¡œìš´ ê°œë…ì„ ë³„ë„ë¡œ ìƒì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.\nDDSÂ í‘œì¤€ì—ì„œëŠ”Â Discoveryë¥¼ ìˆ˜í–‰í•˜ëŠ”Â ì ˆì°¨ë¥¼Â PDPÂ ì™€Â EDPë¡œ êµ¬ë¶„í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nPDP - Participant Discovery Protocol : ê°™ì€ ë„ë©”ì¸ì— ì¡´ì¬í•˜ëŠ” ì„œë¡œ ë‹¤ë¥¸Â Participantë¥¼ ê²€ìƒ‰í•˜ëŠ” ì ˆì°¨ë¡œ, Participantì— í¬í•¨ë˜ì–´ ìˆëŠ”Â endpointÂ ì˜ ì •ë³´ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤. EDP - Endpoint Discovery Protocol : PDPë¥¼ í†µí•´Â Participantê°€ ì„œë¡œë¥¼ íƒì§€í•˜ê³  ë‚˜ë©´, EDPê°€ ìˆ˜í–‰ë©ë‹ˆë‹¤.Â í‘œì¤€ì—ì„œëŠ” ê° í”„ë¡œí† ì½œì´ ì§€ì›í•´ì•¼í•  ìµœì†Œí•œì˜ ê¸°ëŠ¥ì„ ë§Œì¡±í•˜ëŠ”Â SPDPì™€Â SEDPì— ëŒ€í•´ ì„¤ëª…í•˜ê³  ìˆìŠµë‹ˆë‹¤. vendorì— ë”°ë¼ ë‹¤ì–‘í•œ PDPì™€ EDPë¥¼ ì§€ì›í•  ìˆ˜ ìˆì§€ë§Œ, í˜¸í™˜ì„±ì„ ìœ„í•´ ëª¨ë“  RTPSëŠ” SPDP(Simple Participant Discovery Protocol)ì™€ SEDP(Simple Endpoint Discovery Protocol)ë¥¼ í•„ìˆ˜ë¡œ ì§€ì›í•´ì•¼í•©ë‹ˆë‹¤. ì„œë¡œ ë‹¤ë¥¸ vendorë¥¼ ê°€ì§„ ë¨¸ì‹  ì‚¬ì´ì— í†µì‹ ì´ ê°€ëŠ¥í•œ ì´ìœ ì´ê¸°ë„ í•©ë‹ˆë‹¤.\nê·¸ë¦¼ì„ í†µí•´Â SPDPì™€Â SEDPë¥¼ í™œìš©í•œ Discovery ì ˆì°¨ì— ëŒ€í•´ ì•Œì•„ë´…ì‹œë‹¤.\nê°™ì€ Domainì„ ì‚¬ìš©í•˜ëŠ” ParticipantëŠ” ìƒì„± ì‹œ, Discoveryë¥¼ ìˆ˜í–‰í•˜ëŠ”Â 3ìŒì˜Â builtin Writerì™€Â builtin Reader, ê·¸ë¦¬ê³  pre-defined topicë¥¼ í¬í•¨í•˜ê²Œ ë©ë‹ˆë‹¤. DDSê°€ êµ¬ë™ë˜ë©´, ParticipantëŠ” Multicastë¡œ PDP(Participant Discovery Protocol) ë©”ì‹œì§€ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ ì „ì†¡í•˜ê¸° ì‹œì‘í•©ë‹ˆë‹¤.\nê°Â Participantì˜Â builtinParticipantWriterì™€Â builtinPariticpantReader ì‚¬ì´ SPDP êµí™˜ì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì „ë‹¬ë˜ëŠ” ì •ë³´ì—ëŠ”Â Participantì— í¬í•¨ëœÂ builtinPublicationWriterì™€Â builtinPublicationReaderì˜Â LocatorÂ ì •ë³´ê°€ ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤.\nSPDPÂ êµí™˜ ì´í›„, ìƒëŒ€ë°© Participantì˜ ì •ë³´ë¥¼ í†µí•´ ì–‘ì¸¡ Participantë“¤ì€ ì„œë¡œ ì—°ê²°ë©ë‹ˆë‹¤.\nì´í›„, Topic ìˆ˜í–‰ì„ ìœ„í•´ ê° Participantì— Endpointì— í•´ë‹¹í•˜ëŠ” Publisherì™€ Datawriterê°€ í•˜ë‚˜ì”© ìƒì„±ë©ë‹ˆë‹¤.\nSPDPì—ì„œ êµí™˜í–ˆë˜ Locatorì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ builtinPublicationWriterëŠ” builtiinPublicationReaderì—ê²Œ, builtinSubscriptionWriterëŠ” SubscriptionReaderì—ê²Œ Unicastë¥¼ í†µí•´ ì •ë³´ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.(SEDPë¥¼ êµí™˜í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.) ì „ë‹¬ë˜ëŠ” ì •ë³´ì—ëŠ” topic, data type, Qosë“±ì˜ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\nSEDPì˜ ê²°ê³¼ë¡œ Participantì— í¬í•¨ëœ Endpointë“¤ì´ ì—°ê²°ë˜ê³ , ì—°ê²°ëœ ë‘ EndpointëŠ” ë™ì¼ Topicìœ¼ë¡œ í†µì‹ ì„ ì‹œì‘í•©ë‹ˆë‹¤.\nDiscovery ê³¼ì •ì„ í•œë²ˆì— ì •ë¦¬í•œ ê·¸ë¦¼ì…ë‹ˆë‹¤. ë‹¤ì‹œ í•œ ë²ˆ ì˜ë¯¸ë¥¼ ì´í•´í•˜ë©´ì„œ ê³¼ì •ì„ ë³µê¸°í•´ë´…ì‹œë‹¤.\nDCPS(Data-Centric Publish-Subscribe) Layer DCPS LayerëŠ” RTPS Layerì™€ Application ì‚¬ì´ì˜ ì¸í„°í˜ì´ìŠ¤ ì—­í• ì„ í•©ë‹ˆë‹¤. ì´í›„ ë‹¤ë¤„ì§€ëŠ” Participant, Domain, Topic ë“±ì„ ì •ì˜í•˜ê³ , Publish-Subscribeë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤. ë”ë¶ˆì–´, DDSì˜ ì¤‘ìš”í•œ ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜ì¸ QoS(Quality of Service)ë„ ë‹´ë‹¹í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nêµ¬í˜„ ì¸¡ë©´ì—ì„œ, DCPSëŠ” Data read/write APIë¥¼ ì œê³µí•¨ìœ¼ë¡œ ì‘ìš© í”„ë¡œê·¸ë¨ë“¤ ì‚¬ì´ ë°ì´í„°ë¥¼ êµí™˜í•  ìƒëŒ€ì— ëŒ€í•œ ì¸ì§€ ì—†ì´ ì›í•˜ëŠ” ë°ì´í„°ì˜ ì†¡ìˆ˜ì‹ ì´ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.\nimage from : OMG DDS(Data Distrubution Service) ê¸°ìˆ  ê°œìš”\nDataWriter / DataReader DataWriterëŠ” ì†¡ì‹ ì, DataReaderëŠ” ìˆ˜ì‹ ìì˜ ì—­í• ì„ í•©ë‹ˆë‹¤. DataWriterëŠ” Sample(ì‹¤ì œ ë°ì´í„°)ì„ ìƒì„±í•˜ê³  ì „ì†¡í•˜ëŠ” ì—­í• ì„ í•˜ë©°, DataReaderëŠ” Sampleì„ ìˆ˜ì‹ í•˜ëŠ” ê¸°ëŠ¥ì„ í•©ë‹ˆë‹¤. ë‹¨ì¼ DataWriterì™€ DataReaderëŠ” ë‹¨ì¼ Topicë§Œì„ ë³´ìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nPublisher ë°ì´í„° Publishë¥¼ ë‹´ë‹¹í•˜ëŠ” ê°ì²´ë¡œ, í•˜ë‚˜ì˜ PublisherëŠ” ë‹¤ìˆ˜ì˜ DataWriterë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë•Œë¬¸ì—, ê° Publisherë“¤ì€ ì—¬ëŸ¬ Topic ë°ì´í„°ë¥¼ Publish í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Publishí•˜ê³ ì í•˜ëŠ” ë°ì´í„° ê°ì²´ì˜ ê°’ì´ Publisherì—ê²Œ ì „í•´ì§€ë©´ PublisherëŠ” ìì‹ ì—ê²Œ ì„¤ì •ëœ QoSê°’ì— ë”°ë¼ ì—°ê´€ëœ Subscriberì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤.\nSubscriber ë°ì´í„° Subscribeë¥¼ ë‹´ë‹¹í•˜ëŠ” ê°ì²´ë¡œ, Publisherì™€ ìœ ì‚¬í•˜ê²Œ ë‹¤ìˆ˜ì˜ DataReaderë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìœ¼ë©° ì—¬ëŸ¬ Topic ë°ì´í„°ë¥¼ ìˆ˜ì‹ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Subscriberê°€ ë°ì´í„°ë¥¼ ìˆ˜ì‹ í•œ ì´í›„, ì‘ìš© í”„ë¡œê·¸ë¨ì€ DataReaderë¥¼ í†µí•´ ì‹¤ì œ ë°ì´í„°ë¡œ ì ‘ê·¼í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.\nDDS Pub-Subì˜ ê¸°ë³¸ êµ¬ì„± ìš”ì†Œ image from : MDS í…Œí¬\nTopic Topicì€ Publish-Subscribeì˜ ê´€ê³„ë¥¼ ì •ì˜í•˜ëŠ” Keyì…ë‹ˆë‹¤. topicì€ ë°ì´í„° íƒ€ì…ê³¼ í•´ë‹¹ ë°ì´í„°ì˜ QoSì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. QoSë¥¼ Topic ë°ì´í„°ì— ì¶”ê°€í•˜ê³ , Topicê³¼ ì—°ê´€ëœ DataWriter, Datawriterì— ì—°ê´€ëœ QoSë¥¼ ì„¤ì •í•˜ëŠ” ì‹ìœ¼ë¡œ ì œì–´ë©ë‹ˆë‹¤. (Subscriber ì¸¡ë„ ë™ì¼í•©ë‹ˆë‹¤.)\nTopicì˜ ì´ë¦„ì€ Domain ë‚´ì—ì„œ ìœ ì¼í•´ì•¼ í•©ë‹ˆë‹¤.\nParticipant ParticipantëŠ” DDS Publisherì™€ Subscriberë¥¼ ë‹´ê²Œ ë˜ëŠ” ê°ì²´ì…ë‹ˆë‹¤. ROS 2ì˜ Nodeì•ˆì— ë‹¤ìˆ˜ì˜ Publisherì™€ Subscriberì™€ ê³µì¡´í•  ìˆ˜ ìˆëŠ” ê²ƒì²˜ëŸ¼, Participantë„ ë‹¤ìˆ˜ì˜ DataWriterì™€ DataReaderë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nDomain Domainì€ Participantë“¤ì´ í™œë™í•˜ëŠ” ì˜ì—­ìœ¼ë¡œ, ê°™ì€ Domainì„ ê°–ëŠ” Participantë‚´ì—ì„œë§Œ ì •ë³´ì „ë‹¬ì„ í• Â ìˆ˜ ìˆìŠµë‹ˆë‹¤. ROS 2 í„°ë¯¸ë„ì˜ ì‹¤í–‰ ì‹œ ROS_DOMAIN_IDë¼ëŠ” ì½˜ì†” ì¶œë ¥ì´ ë‚˜ì™”ë˜ ê²ƒì„ ê¸°ì–µí•˜ì‹œë‚˜ìš”?\n*************** Startup Menu for ROS *************** * Usage: To set ROS env to be auto-loaded, please * * assign ros_option in ros_menu/config.yaml * ****************************************************** 0) Do nothing 1) ROS 1 noetic 2) ROS 2 foxy 3) ROS2/ROS1_bridge Please choose an option: 2 ------------------------------------------------------ * ROS_DOMAIN_ID = 30 ------------------------------------------------------ ì´ë ‡ê²Œ DDSì˜ í†µì‹  êµ¬ì¡°ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. ìœ„ êµ¬ì¡°ì—ì„œ ì‹¤ì œ ì‚¬ìš©ìëŠ” Topic, Publisher, Subscriberë§Œ êµ¬í˜„í•˜ë©´ ë˜ë©°, DataWriter, DataReaderì™€ RTPS, DCPSëŠ” DDSê°€ ì•Œì•„ì„œ ì²˜ë¦¬í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ DDSì˜ ì¥ì ì— ê¸°ë°˜í•˜ì—¬ ROS 2 ì‹œìŠ¤í…œì´ ì˜¬ë¼ê°€ê²Œ ë˜ëŠ” ê²ƒì´ì§€ìš”.\nDDS QoS TCPROS/UDPROSë¼ëŠ” ìì²´ í”„ë¡œí† ì½œì„ ì‚¬ìš©í–ˆë˜ ê¸°ì¡´ ROS 1ê³¼ëŠ” ë‹¬ë¦¬, ROS 2ì—ì„œëŠ” QoS ì˜µì…˜ì„ í†µí•´ ì›í•˜ëŠ” ê¸°ëŠ¥ì„ ì„ íƒì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” DDSì˜ QoSë¥¼ ë„ì…í•˜ì˜€ê¸° ë•Œë¬¸ìœ¼ë¡œ, Publisher, Subscriberë¥¼ ì„ ì–¸í•  ë•Œ, QoSë¥¼ ë§¤ê°œë³€ìˆ˜í˜•íƒœë¡œ ì§€ì •í•˜ëŠ” ë°©ì‹ì´ ì‚¬ìš©ë©ë‹ˆë‹¤.\nìƒí™©ì— ë”°ë¼ ë°ì´í„°ì˜ ì‹ ë¢°ì„±ì´ ì¤‘ìš”í•  ìˆ˜ë„ ìˆê³ , ë²„í¼ì˜ í¬ê¸°ë¥¼ í¬ê²Œ í•˜ì—¬ Topicì˜ ì•ˆì •ì„±ì„ ë†’ì—¬ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ í†µì‹ ì˜ í’ˆì§ˆì„ ì˜µì…˜í™”í•˜ê¸° ìœ„í•´ì„œ, DDSì—ì„œëŠ” ì•„ë˜ì™€ ê°™ì€ 22ê°€ì§€ì˜ QoSë¥¼ ì •ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nê°ê°ì˜ QoS ì˜µì…˜ì€ ì—°ê´€ëœ ì¡°í•©ìœ¼ë¡œ Topic, DataWriter, DataReader, Publisher, Subscriber, Domain, Participantì— ì ìš©ë˜ë©°, ë³¸ ì„¸ì…˜ì—ì„œëŠ” ì£¼ë¡œ ì‚¬ìš©ë˜ëŠ” QoSë¥¼ ìœ„ì£¼ë¡œ ì‚´í´ë³´ê³ ì í•©ë‹ˆë‹¤.\nRELIABILITY: ë°ì´í„° í†µì‹ ì˜ ì‹ ë¢°ì„± ë ˆë²¨(ì¬ì „ì†¡ ì—¬ë¶€)ì„ ê²°ì •í•˜ë©° ë‘ ê°€ì§€ ì†ì„±ì„ ì„¤ì • í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. RELIABLE : DataWriter Historyì— ìˆëŠ” ëª¨ë“  ìƒ˜í”Œë“¤ì´ DataReaderì— ì „ë‹¬ë˜ëŠ” ê²ƒì„ ë³´ì¥í•©ë‹ˆë‹¤. BEST_EFFORT : í†µì‹  ì‹œ ì†ì‹¤ëœ ë°ì´í„° ìƒ˜í”Œì„ ì¬ì „ì†¡ í•˜ì§€ ì•Šê³ , ì „ë‹¬ëœ ë°ì´í„°ì˜ ìˆœì„œëŠ” ìœ ì§€ í•©ë‹ˆë‹¤. ì•ŒíŒŒë²³ì€ ë‹¤ìŒê³¼ ê°™ì€ ì˜ë¯¸ë¥¼ ê°–ìŠµë‹ˆë‹¤.Â T : TOPIC, DR : DataReader, DW : DataWriter, P : Publisher, S:Subscriber\nRxOëŠ”Â Requested/Offeredì˜ ì•½ìë¡œÂ QoSê°€ ì ìš©ë˜ëŠ” ëŒ€ìƒì„Â Publisher(ë°œê°„/ì†¡ì‹ )Â ì¸¡ê³¼Â Subscriber(êµ¬ë…/ìˆ˜ì‹ )Â ì¸¡ìœ¼ë¡œ êµ¬ë¶„í•´ì„œ ì„œë¡œì˜ ìƒê´€ê´€ê³„ë¥¼ í‘œí˜„í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.\nâ€˜YESâ€™ : PublisherÂ ì¸¡ê³¼Â SubscriberÂ ì¸¡ ëª¨ë‘Â QoSê°€ ì ìš©ë˜ì–´ì•¼ í•˜ê³ ,Â ì„¤ì •ëœÂ QoSÂ ê°’ì´ í˜¸í™˜ë˜ì–´ì•¼ í•œë‹¤. â€˜NOâ€™Â : PublisherÂ ì¸¡ê³¼Â SubscriberÂ ì¸¡ ëª¨ë‘Â QoSÂ ê°€ ì ìš©ë˜ì–´ì•¼ í•˜ì§€ë§Œ,Â ì„¤ì •ëœÂ QoSÂ ê°’ì€ ì„œë¡œ ë…ë¦½ì ì´ë‹¤. â€˜N/Aâ€™ : PublisherÂ ì¸¡ê³¼Â SubscriberÂ ì¸¡ ì¤‘ í•œ ì¸¡ì—ë§Œ ì ìš©ë˜ì–´ì•¼ í•œë‹¤. Changeableì´Â â€˜YESâ€™Â ì¼ ê²½ìš°ì—ëŠ”,Â ë™ì‘í•˜ë©´ì„œë„Â QoSÂ ì˜ ê°’ì´ ë³€ê²½ë  ìˆ˜ ìˆì§€ë§Œ, â€˜NOâ€™ì¼ ê²½ìš°ì—ëŠ” ì²˜ìŒ ìƒì„±ëœ ì´í›„ì—ëŠ” ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\nHISTORY : ë°ì´í„°ì˜ ì¬ì „ì†¡ì„ ìœ„í•´ HistoryCacheë‚´ ë°ì´í„° ë³´ê´€ ë°©ë²•ì„ ê²°ì •í•˜ë©° ë‘ ê°€ì§€ ì†ì„±ì„ ì„¤ì • í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. KEEP_LAST : Depth(History Cacheì•ˆì— ìœ ì§€í•˜ê³  ìˆì„ ë°ì´í„° ê°œìˆ˜) í¬ê¸° ë§Œí¼ ìµœì‹  ë°ì´í„°ë¥¼ ìœ ì§€ í•©ë‹ˆë‹¤. KEEP_ALL : DataReaderì—ê²Œ ì¸ìŠ¤í„´ìŠ¤ì˜ ëª¨ë“  ê°’ë“¤ì„ ìœ ì§€í•˜ê³  ì „ì†¡ í•©ë‹ˆë‹¤. DURABILITY : ë‚˜ì¤‘ì— ì°¸ì—¬í•œ DataReaderì—ê²Œ ì´ì „ ë°ì´í„°ë¥¼ ì „ì†¡í• ì§€ ì—¬ë¶€ë¥¼ ê²°ì • í•˜ë©° ë„¤ ê°€ì§€ ì†ì„±ì„ ì„¤ì • í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. VOLATILE : ì—°ê²°ì´ ì„¤ì • ëœ ì´í›„ì˜ ë°ì´í„°ë§Œ ì œê³µ í•©ë‹ˆë‹¤. TRANSIENT LOCAL : DataWriter ìƒëª…ì£¼ê¸°ì™€ ì¼ì¹˜ ì¼ì¹˜í•©ë‹ˆë‹¤. TRANSIENT : DataReaderì— ê³¼ê±° ë°ì´í„°ë¥¼ ì œê³µ í•©ë‹ˆë‹¤. PERSISTENT : Permanent-Storageì— ê³¼ê±° ë°ì´í„°ë¥¼ ì €ì¥í•˜ë©°, ë°ì´í„°ì˜ ìœ íš¨ì„±ì€ System ë³´ë‹¤ ì˜¤ë˜ ì§€ì† ë©ë‹ˆë‹¤. OWNERSHIP : ë‹¤ìˆ˜ì˜ DataWriterê°€ ë™ì¼í•œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°±ì‹ í•˜ê²Œ í—ˆìš©í• ì§€ë¥¼ ê²°ì •í•©ë‹ˆë‹¤. SHARED : ë‹¤ìˆ˜ì˜ DataWriterë“¤ì´ ë™ì¼í•œ ë°ì´í„° ì¸ìŠ¤í„´ìŠ¤ ì—…ë°ì´íŠ¸ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. EXCLUSIVE : ë°ì´í„° ê°ì²´ì˜ ê° ì¸ìŠ¤í„´ìŠ¤ëŠ” í•˜ë‚˜ì˜ DataWriterì— ì˜í•´ì„œë§Œ ìˆ˜ì • ê°€ëŠ¥í•©ë‹ˆë‹¤. PARTITION : Domain ë‚´ë¶€ì—ì„œ Nodeë“¤ì„ ë¶„ë¦¬í•˜ëŠ” ë°©ë²•ì„ ê²°ì • í•©ë‹ˆë‹¤. (Domain ë‚´ì—ì„œ ë³„ë„ì˜ ë…¼ë¦¬ì ì¸ í†µì‹  ì±„ë„ í˜•ì„±) - Partition Nameì´ ê°™ì€ DataWriter/DataReaderê°„ ë°ì´í„° ë°°í¬ ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. Partitionê³¼ Domainì˜ ì°¨ì´ - ë‹¤ë¥¸ Domainë“¤ì— ì†í•˜ëŠ” ê°œì²´ë“¤ì€ ì™„ì „íˆ ì„œë¡œ ë…ë¦½ ëœ ìƒíƒœì…ë‹ˆë‹¤. EntityëŠ” ë‹¤ìˆ˜ì˜ Partitionì— ìˆì„ ìˆ˜ ìˆì§€ë§Œ í•˜ë‚˜ì˜ Domainì—ë§Œ ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nDEADLINE : ë°ì´í„° ìƒ˜í”Œ ì‚¬ì´ì˜ ìµœëŒ€ ë„ì°© ì‹œê°„ì„ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. DataWriterëŠ” DEADLINE(period:Duration_t)ì´ ì„¤ì •ëœ ì‹œê°„ ì•ˆì— ì ì–´ë„ í•œë²ˆ ì´ìƒì˜ ë°ì´í„°ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤. DataReaderëŠ” DEADLINE(period:Duration_t) ì‹œê°„ ì•ˆì— DataWriterë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ì§€ ëª»í•˜ë©´ DDSë¡œë¶€í„° ìœ„ë°˜ í†µë³´ë¥¼ ë°›ìŠµë‹ˆë‹¤. TIME_BASED_FILTER : DataReader ê°€ ë°ì´í„°ë¥¼ í•„í„°ë§ í•˜ëŠ” ì‹œê°„ì„ ê²°ì • í•©ë‹ˆë‹¤. Minimum_separation: Duation_t ê°’ì„ ì„¤ì •í•˜ì—¬ DataReaderëŠ” ì´ ê°’ ì´ë‚´ì— ìˆ˜ì‹ í•œ ë°ì´í„°ëŠ” ì‚­ì œ í•©ë‹ˆë‹¤. ROS 2ì—ì„œëŠ” ìì£¼ ì‚¬ìš©ë˜ëŠ” QoS ì¡°í•©ì„ ë¬¶ì–´ RMW QoS Profileì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ ìš°ë¦¬ê°€ queue_sizeë§Œì„ ì „ë‹¬í•˜ê³  ìˆì—ˆì§€ë§Œ, ì‚¬ì‹¤ì€ ì•„ë˜ ì‚¬ì§„ì˜ Defaultì—ì„œ Depthë§Œ ë°”ê¿”ì£¼ê³  ìˆì—ˆë˜ ê²ƒì…ë‹ˆë‹¤.\nimage from : ì˜¤ë¡œì¹´\nQoS Programming ros2 í”„ë¡œê·¸ë˜ë°ì—ì„œ QoSë¥¼ ì„¤ì •í•˜ëŠ” ë°©ë²•ì€ ë§¤ìš° ê°„ë‹¨í•©ë‹ˆë‹¤. Publisher, Subscriber í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ë©´ì„œ QoS ì˜µì…˜ì„ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬í•˜ë©´ ë©ë‹ˆë‹¤.\npython example - RMW QoS Profile ì‚¬ìš© ì‹œ from rclpy.qos import qos_profile_sensor_data self.string_publisher = self.create_publisher(String, \u0026#39;qos_test_topic\u0026#39;, qos_profile_sensor_data) python example - ì§ì ‘ Profile ì„¤ì • ì‹œ from rclpy.qos import QoSDurabilityPolicy from rclpy.qos import QoSHistoryPolicy from rclpy.qos import QoSProfile from rclpy.qos import QoSReliabilityPolicy my_profile = QoSProfile( reliability=QoSReliabilityPolicy.BEST_EFFORT, history=QoSHistoryPolicy.KEEP_LAST, depth=10, durability=QoSDurabilityPolicy.VOLATILE ) self.string_publisher = self.create_publisher(String, \u0026#39;qos_test_topic\u0026#39;, my_profile) ì°¸ê³  ë§í¬ : rclpy/qos.py\ntopic í†µì‹ ì´ ì´ë£¨ì–´ì§€ê³  ìˆëŠ” ìƒí™©ì—ì„œ, QoS ì˜µì…˜ì„ ë³´ê³  ì‹¶ë‹¤ë©´ Topic ì»¤ë©˜ë“œì— verbose ì˜µì…˜ì„ ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤. # Terminal 1 - publisher $ ros2 run py_topic_tutorial qos_example_publisher # Terminal 2 - subscriber $ ros2 run py_topic_tutorial qos_example_subscriber # Terminal 3 - topic info $ ros2 topic info /qos_test_topic --verbose Type: std_msgs/msg/String Publisher count: 1 Node name: twist_pub_node Node namespace: / Topic type: std_msgs/msg/String Endpoint type: PUBLISHER GID: 60.77.10.01.f3.67.78.3d.6b.0c.cc.7b.00.00.14.03.00.00.00.00.00.00.00.00 QoS profile: Reliability: RMW_QOS_POLICY_RELIABILITY_BEST_EFFORT Durability: RMW_QOS_POLICY_DURABILITY_VOLATILE Lifespan: 9223372036854775807 nanoseconds Deadline: 9223372036854775807 nanoseconds Liveliness: RMW_QOS_POLICY_LIVELINESS_AUTOMATIC Liveliness lease duration: 9223372036854775807 nanoseconds Subscription count: 1 Node name: string_sub_node Node namespace: / Topic type: std_msgs/msg/String Endpoint type: SUBSCRIPTION GID: d2.03.10.01.d5.6b.69.e0.be.3f.b5.a2.00.00.14.04.00.00.00.00.00.00.00.00 QoS profile: Reliability: RMW_QOS_POLICY_RELIABILITY_BEST_EFFORT Durability: RMW_QOS_POLICY_DURABILITY_VOLATILE Lifespan: 9223372036854775807 nanoseconds Deadline: 9223372036854775807 nanoseconds Liveliness: RMW_QOS_POLICY_LIVELINESS_AUTOMATIC Liveliness lease duration: 9223372036854775807 nanoseconds DDS QoSëŠ” RxO (requested by offered) íŠ¹ì„±ì„ ê°–ê³  ìˆì–´ ì„œë¡œ ì–‘ë¦½í•  ìˆ˜ ì—†ëŠ” ì¡°í•©ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Publishì˜ Reliabilityê°€ BEST_EFFORTì¼ë•Œ, Subscriberì˜ Reliabilityê°€ RELIABLEë¼ë©´, Topic í†µì‹ ì´ ë°œìƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\nì½”ë“œ ìˆ˜ì •ì„ í†µí•´ ì„œë¡œ ë‹¤ë¥¸ QoS í†µì‹ ì´ ê°€ëŠ¥í•œì§€ ì§ì ‘ ì‹¤ìŠµí•´ë´…ì‹œë‹¤. ì½”ë“œ ë‚´ qos_profile_sensor_data / my_profileì„ ë³€ê²½í•œ ë’¤ ì‹¤í–‰í•´ë³´ê³  topic í†µì‹ ì´ ì˜ ì´ë£¨ì–´ì§€ëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”! # qos_example_publisher.py my_profile = QoSProfile( reliability=QoSReliabilityPolicy.BEST_EFFORT, history=QoSHistoryPolicy.KEEP_LAST, depth=10, durability=QoSDurabilityPolicy.VOLATILE ) ... self.string_publisher = self.create_publisher(String, \u0026#39;qos_test_topic\u0026#39;, qos_profile_sensor_data) # qos_example_subscriber.py my_profile = QoSProfile( reliability=QoSReliabilityPolicy.RELIABLE, history=QoSHistoryPolicy.KEEP_LAST, depth=10, durability=QoSDurabilityPolicy.VOLATILE ) ... self.pose_subscriber = self.create_subscription( String, \u0026#39;qos_test_topic\u0026#39;, self.sub_callback, my_profile ) ì½”ë“œ ë³€ê²½ í›„ ì‹¤í–‰ $ ros2 run py_topic_tutorial qos_example_publisher [WARN] [1673945160.449603592] [twist_pub_node]: New subscription discovered on this topic, requesting incompatible QoS. No messages will be sent to it. Last incompatible policy: RELIABILITY_QOS_POLICY $ ros2 run py_topic_tutorial qos_example_subscriber [WARN] [1673945160.455319911] [string_sub_node]: New publisher discovered on this topic, offering incompatible QoS. No messages will be received from it. Last incompatible policy: RELIABILITY_QOS_POLICY Warningê³¼ í•¨ê»˜ Subscriberê°€ ë™ì‘í•˜ì§€ ì•ŠìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nC++ì—ì„œëŠ” ì•„ë˜ì™€ ê°™ì´ í”„ë¡œê·¸ë˜ë° í•©ë‹ˆë‹¤.\ncpp example - RMW QoS Profile ì‚¬ìš© ì‹œ rclcpp::SensorDataQoS qos; twist_sub_ = this-\u0026gt;create_subscription\u0026lt;geometry_msgs::msg::Twist\u0026gt;(input, qos, callback); odom_sub_ = node-\u0026gt;create_subscription\u0026lt;nav_msgs::msg::Odometry\u0026gt;( odom_topic, rclcpp::SystemDefaultsQoS(), obom_callback ); cpp example - ì§ì ‘ Profile ì„¤ì • ì‹œ (ì‚¬ì‹¤ ì—¬ëŸ¬ ë°©ì‹ì´ êµ¬í˜„ ê°€ëŠ¥í•˜ì—¬ ì •ë‹µì´ ìˆëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤. ìì£¼ ì‚¬ìš©ë˜ëŠ” íŒ¨í„´ë“¤ì„ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤.) // Pattern 1 rclcpp::QoS map_qos(10); if (map_subscribe_transient_local_) { map_qos.transient_local(); map_qos.reliable(); map_qos.keep_last(1); } // Pattern 2 auto custom_qos = rclcpp::QoS(rclcpp::KeepLast(1)).transient_local().reliable(); costmap_pub_ = node-\u0026gt;create_publisher\u0026lt;nav_msgs::msg::OccupancyGrid\u0026gt;(topic_name, custom_qos); // Pattern 3 filter_info_sub_ = node-\u0026gt;create_subscription\u0026lt;nav2_msgs::msg::CostmapFilterInfo\u0026gt;( filter_info_topic_, rclcpp::QoS(rclcpp::KeepLast(1)).transient_local().reliable(), std::bind(\u0026amp;BinaryFilter::filterInfoCallback, this, std::placeholders::_1)); QoSë¥¼ í†µí•´ ì›í•˜ëŠ” ë„ë©”ì¸ì—ì„œì˜ ì„±ëŠ¥ì„ ëŒì–´ì˜¬ë¦¬ê³  ì•ˆì •ì„±ì„ ê°–ì¶˜ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•©ì‹œë‹¤.\nDDSì˜ IDL DDSì—ì„œëŠ” íŠ¹ì • ì–¸ì–´ì— ì˜ì¡´ì ì´ì§€ ì•ŠëŠ” ë°ì´í„° í†µì‹ ì„ ìœ„í•´ IDLì„ ì‚¬ìš©í•©ë‹ˆë‹¤.\nIDL(Interface Description Language ë˜ëŠ” Interface Definition Language)ëŠ” ì–´ëŠ í•œ ì–¸ì–´ì— êµ­í•œë˜ì§€ ì•ŠëŠ” ì–¸ì–´ì¤‘ë¦½ì ì¸ ë°©ë²•ìœ¼ë¡œ ì¸í„°í˜ì´ìŠ¤ë¥¼ í‘œí˜„í•¨ìœ¼ë¡œì¨, ê°™ì€ ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì»´í¬ë„ŒíŠ¸ ì‚¬ì´ì˜ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.\nOMGì˜ Interface Definition Language Version 3.5ì— ë”°ë¥¸ ì‚¬ìš© ê°€ëŠ¥í•œ í‚¤ì›Œë“œë“¤ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.\nimage from : MDS í…Œí¬\nROS 2ì—ì„œëŠ” interfaceë¼ëŠ” ì´ë¦„ìœ¼ë¡œ topic message, service srv, action actionì´ ì‚¬ìš©ë˜ì—ˆì§€ìš”. ì´ë“¤ì´ ëª¨ë‘ IDL íƒ€ì…ì„ ê°–ê¸° ë•Œë¬¸ì— rclpy, rclcpp, rcljava ëª¨ë‘ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²ƒì…ë‹ˆë‹¤.\ncustom interfaceë¥¼ ë¹Œë“œí•˜ê²Œ ë˜ë©´, í•´ë‹¹ íŒ¨í‚¤ì§€ ë‚´ë¶€ì— ìƒì„±ëœ IDLë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. build í´ë” ë‚´ë¶€ íŒ¨í‚¤ì§€ í´ë”ì— ì§„ì…í•˜ë©´ ì‚¬ì§„ê³¼ ê°™ì´ ë‹¤ì–‘í•œ ì–¸ì–´ë¥¼ ì§€ì›í•˜ê¸° ìœ„í•œ ì„¤ì • íŒŒì¼ë“¤ì´ ìœ„ì¹˜í•˜ëŠ” ê²ƒì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nrosidl_generator_py__arguments.json { \u0026#34;package_name\u0026#34;: \u0026#34;custom_interfaces\u0026#34;, \u0026#34;output_dir\u0026#34;: \u0026#34;/home/kimsooyoung/ros2_ws/build/custom_interfaces/rosidl_generator_py/custom_interfaces\u0026#34;, \u0026#34;template_dir\u0026#34;: \u0026#34;/opt/ros/foxy/share/rosidl_generator_py/cmake/../resource\u0026#34;, \u0026#34;idl_tuples\u0026#34;: [ \u0026#34;/home/kimsooyoung/ros2_ws/build/custom_interfaces/rosidl_adapter/custom_interfaces:action/Parking.idl\u0026#34;, \u0026#34;/home/kimsooyoung/ros2_ws/build/custom_interfaces/rosidl_adapter/custom_interfaces:srv/CircleTurtle.idl\u0026#34;, \u0026#34;/home/kimsooyoung/ros2_ws/build/custom_interfaces/rosidl_adapter/custom_interfaces:srv/TurtleJail.idl\u0026#34; ], \u0026#34;ros_interface_dependencies\u0026#34;: [ \u0026#34;action_msgs:/opt/ros/foxy/share/action_msgs/msg/GoalInfo.idl\u0026#34;, \u0026#34;action_msgs:/opt/ros/foxy/share/action_msgs/msg/GoalStatus.idl\u0026#34;, \u0026#34;action_msgs:/opt/ros/foxy/share/action_msgs/msg/GoalStatusArray.idl\u0026#34;, \u0026#34;action_msgs:/opt/ros/foxy/share/action_msgs/srv/CancelGoal.idl\u0026#34;, \u0026#34;builtin_interfaces:/opt/ros/foxy/share/builtin_interfaces/msg/Duration.idl\u0026#34;, \u0026#34;builtin_interfaces:/opt/ros/foxy/share/builtin_interfaces/msg/Time.idl\u0026#34;, \u0026#34;unique_identifier_msgs:/opt/ros/foxy/share/unique_identifier_msgs/msg/UUID.idl\u0026#34; ], ... ìƒì„±ëœ IDL íŒŒì¼ ë‚´ë¶€ë¥¼ í•¨ê»˜ ì‚´í´ë´…ì‹œë‹¤. custom_interfaces â‡’ rosidl_adapter â‡’ custom_interfaces â‡’ action í´ë” ë‚´ë¶€ì— ìœ„ì¹˜í•œ Parking.idlì€ ì•„ë˜ì™€ ê°™ì€ IDL í˜•íƒœë¥¼ ë„ê³  ìˆìŠµë‹ˆë‹¤.\nParking.idl // generated from rosidl_adapter/resource/action.idl.em // with input from custom_interfaces/action/Parking.action // generated code does not contain a copyright notice module custom_interfaces { module action { @verbatim (language=\u0026#34;comment\u0026#34;, text= \u0026#34;goal definition\u0026#34;) struct Parking_Goal { boolean start_flag; }; struct Parking_Result { @verbatim (language=\u0026#34;comment\u0026#34;, text= \u0026#34;result definition\u0026#34;) string message; }; struct Parking_Feedback { @verbatim (language=\u0026#34;comment\u0026#34;, text= \u0026#34;feedback definition\u0026#34;) float distance; }; }; }; ROS 2 Domain ID DDS ì‹œê°„ ì‚´í´ë³¸ ë°”ì™€ ê°™ì´ ê° DDS Participantë“¤ì€ íŠ¹ì • Domainì— ì†í•˜ê²Œ ë©ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ROS 2ì—ì„œëŠ” Domain ID 0ì„ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë©°, ê°™ì€ Domain IDë¥¼ ì‚¬ìš©í•˜ëŠ” Participantë“¤ ì‚¬ì´ì—ì„œë§Œ Discoveryì™€ í†µì‹ ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nì´ë²ˆ ì‹œê°„ì—ëŠ” ROS 2ì˜ Domain IDë¥¼ ìˆ˜ì •í•´ë³´ê³ , Domain IDë¥¼ ì„¤ì •í•  ì‹œ ì£¼ì˜í•´ì•¼ í•  ì ë“¤ì— ëŒ€í•´ì„œë„ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.\nìš°ì„ , ì˜ˆì‹œë¥¼ í†µí•´ ì„œë¡œ ë‹¤ë¥¸ Domain IDë¥¼ ê°–ëŠ” Participantë“¤ì„ ì‹¤í–‰í•´ë´…ì‹œë‹¤. # Ternimal 1 ros2 topic pub -r 1 /string_topic std_msgs/String \u0026#34;{data: \\\u0026#34;Hello from my 2ND domain\\\u0026#34;}\u0026#34; # Terminal 2 ROS_DOMAIN_ID=1 ros2 topic list # Terminal 3 ros2 topic list ì˜ˆì‹œ ê²°ê³¼ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯ì´ í†µì‹ ì„ ìœ„í•´ì„œëŠ” ê°™ì€ Domain IDë¥¼ ê°–ëŠ” ì¡°ê±´ì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤. $ ros2 topic list /parameter_events /rosout /string_topic Domain IDëŠ” í™˜ê²½ë³€ìˆ˜ë¥¼ í†µí•´ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í„°ë¯¸ë„ì˜ ì‹¤í–‰ ì‹œ Domain IDë¥¼ ìë™ ì ìš©í•˜ê¸° ìœ„í•´ ~/.bashrcë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜ config.yamlì„ ìˆ˜ì •í•˜ì‹œë©´ ë©ë‹ˆë‹¤. export ROS_DOMAIN_ID=\u0026lt;your_domain_id\u0026gt; or # edit ~/ros_menu/config.yaml Config: menu_enable: true ros_option: menu default_ros_domain_id: 30 Menu: ... ROS 2 foxy: option_num: 2 ROS_version: 2 distro_name: foxy ros2_path: /opt/ros/foxy domain_id: # set if you don\u0026#39;t want to use default domain id cmds: DDSëŠ” Domain IDë¥¼ ì‚¬ìš©í•˜ì—¬ Participantë“¤ì´ ì‚¬ìš©í•  UDP Portë¥¼ ì§€ì •í•©ë‹ˆë‹¤. Portê°€ ê³„ì‚°ë˜ëŠ” ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ìœ¼ë©°, ë§í¬ë¥¼ ì°¸ê³ í•©ë‹ˆë‹¤. - ì¶”ê°€ ë§í¬ ROS 2 ê³µì‹ ë¬¸ì„œì—ì„œëŠ” Domain IDì™€ Participant ìˆœì„œì— ë”°ë¼ ì‚¬ìš©ë˜ëŠ” í¬íŠ¸ ë²ˆí˜¸ë¥¼ ê³„ì‚°í•´ì£¼ëŠ” ê³„ì‚°ê¸°ë¥¼ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ìµœëŒ€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” Domain IDì™€ Participant ìˆ˜ë¥¼ í™•ì¸í•´ ë³´ê² ìŠµë‹ˆë‹¤. - ê³µì‹ ë¬¸ì„œ ë§í¬ Domain ID ì„¤ì • ì‹œ ê³ ë ¤í•´ì•¼ í•  ìš”ì†Œë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nê° OS ë³„ë¡œ ì¹¨ë²”í•˜ë©´ ì•ˆë˜ëŠ” í¬íŠ¸ ì˜ì—­ì´ ìˆìŠµë‹ˆë‹¤. (Linux - 32768-60999 / Windows \u0026amp; macOS - 49152-65535) ê° Participantë‹¹ 2ê°œì˜ Unicast Portë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë”°ë¼ì„œ, í•˜ë‚˜ì˜ Domain IDì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìµœëŒ€ Participantì˜ ìˆ˜ëŠ” 120ê°œ ì…ë‹ˆë‹¤. (ROS 2ëŠ” í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì—¬ëŸ¬ Nodeë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— Nodeë¥¼ 120ê°œê¹Œì§€ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤.) ì´ëŸ¬í•œ ì´ìœ ë¡œ ROS 2 ê³µì‹ ë¬¸ì„œì—ì„œëŠ” 0-101 ì‚¬ì´ì˜ Domain IDë¥¼ ì‚¬ìš©í•˜ê¸°ë¥¼ ê¶Œì¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nament_general (C++ \u0026amp; Python) ROS 2 ê°œë°œ ì‹œ C++ì™€ Pythonì„ ëª¨ë‘ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì€ í° ì¥ì ì´ì§€ë§Œ, íŒ¨í‚¤ì§€ ìƒì„± ì‹œ ì‚¬ìš©í•  ì–¸ì–´ë¥¼ ì •í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë¶ˆí¸í•œ ìƒí™©ë“¤ë„ ë§ì´ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ ì‹œê°„ì—ëŠ” í•˜ë‚˜ì˜ íŒ¨í‚¤ì§€ì—ì„œ C++ì™€ íŒŒì´ì¬ì„ ë™ì‹œì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì•Œì•„ë´…ì‹œë‹¤.\nì´ë²ˆ ì˜ˆì‹œëŠ” ì§ì ‘ íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•´ë³´ë©´ì„œ ë”°ë¼ì™€ë³´ì‹œê¸°ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤!\nC++ì™€ python ëª¨ë‘ë¥¼ ì‚¬ìš©í•˜ëŠ” ì˜ë¯¸ì—ì„œ ament_generalì´ë¼ëŠ” íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•˜ì˜€ìŠµë‹ˆë‹¤. ros2 pkg create --build-type ament_cmake ament_general ì¼ë°˜ì ì¸ C++ íŒ¨í‚¤ì§€ì˜€ë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì‘ì—…ë“¤ì´ ì´ì–´ì¡Œì„ ê²ƒì…ë‹ˆë‹¤.\nheader íŒŒì¼ ì¶”ê°€ - ament_general/include/ament_general/my_node.hpp #ifndef AMENT_GENERAL__MY_NODE_HPP_ #define AMENT_GENERAL__MY_NODE_HPP_ #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; using namespace std::chrono_literals; class MyNode: public rclcpp::Node { private: size_t count; rclcpp::TimerBase::SharedPtr timer; public: MyNode(); void timer_callback(); }; #endif headerì— ëŒ€í•œ êµ¬í˜„ì„ í¬í•¨í•˜ëŠ” cpp íŒŒì¼ ì¶”ê°€ - ament_general/src/my_node.hpp #include \u0026#34;ament_general/my_node.hpp\u0026#34; MyNode::MyNode() : Node(\u0026#34;example_node\u0026#34;) { timer = this-\u0026gt;create_wall_timer( 200ms, std::bind(\u0026amp;MyNode::timer_callback, this) ); } void MyNode::timer_callback() { RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); count++; } rclcpp main í•¨ìˆ˜ê°€ í¬í•¨ëœ main.cpp ì¶”ê°€ #include \u0026#34;ament_general/my_node.hpp\u0026#34; int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;MyNode\u0026gt;(); rclcpp::spin(node); rclcpp::shutdown(); return 0; } CMakeLists.txt ìˆ˜ì • include_directories(include) add_executable(my_node src/main.cpp src/my_node.cpp) ament_target_dependencies(my_node rclcpp) install( TARGETS my_node DESTINATION lib/${PROJECT_NAME} ) ë¹Œë“œ í›„ ì‹¤í–‰ # package build cbp ament_general \u0026amp;\u0026amp; source install/local_setup.bash # package run ros2 run ament_general my_node [INFO] [1682942433.465392502] [example_node]: ==== Hello ROS 2 : 0 ==== [INFO] [1682942433.665303331] [example_node]: ==== Hello ROS 2 : 1 ==== [INFO] [1682942433.865330372] [example_node]: ==== Hello ROS 2 : 2 ==== ... ì´ì œ ament_generalì— íŒŒì´ì¬ ì½”ë“œë¥¼ ì¶”ê°€í•˜ê³ , ros2 runì„ í†µí•´ íŒŒì´ì¬ ì½”ë“œë„ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ì‘ì—…ì„ ì§„í–‰í•´ë´…ì‹œë‹¤.\nAdd Python node ìš°ë¦¬ì˜ ê¶ê·¹ì ì¸ ëª©í‘œëŠ” ì•„ë˜ì™€ ê°™ì€ íŒŒì¼ êµ¬ì¡°ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì œì‹œë˜ëŠ” ê³¼ì •ì„ í•¨ê»˜ ë”°ë¼ì™€ì£¼ì„¸ìš”!\nament_general í´ë” ìƒì„± ament_general ë‚´ë¶€ init.py ìƒì„± ( ì´ íŒŒì¼ì€ ë¹ˆ íŒŒì¼ì…ë‹ˆë‹¤.) ament_general ë‚´ë¶€ì— moduleì´ ë˜ëŠ” helper.py íŒŒì¼ì„ ìƒì„± main í•¨ìˆ˜ë¥¼ í¬í•¨í•˜ëŠ” rclpy code ìƒì„± ì£¼ì˜í•  ì ì´ ìˆìŠµë‹ˆë‹¤. main rclpy ì½”ë“œëŠ” ë°˜ë“œì‹œ Shebang lineì„ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤!\nmy_py_node.py #!/usr/bin/env python3 import rclpy from rclpy.node import Node from ament_general.helper import * package.xmlì— ament_pythonì— ëŒ€í•œ ì¢…ì†ì„±ì„ í¬í•¨í•©ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;?xml-model href=\u0026#34;http://download.ros.org/schema/package_format3.xsd\u0026#34; schematypens=\u0026#34;http://www.w3.org/2001/XMLSchema\u0026#34;?\u0026gt; \u0026lt;package format=\u0026#34;3\u0026#34;\u0026gt; \u0026lt;name\u0026gt;ament_general\u0026lt;/name\u0026gt; \u0026lt;version\u0026gt;0.0.0\u0026lt;/version\u0026gt; \u0026lt;description\u0026gt;TODO: Package description\u0026lt;/description\u0026gt; \u0026lt;maintainer email=\u0026#34;tge1375@naver.com\u0026#34;\u0026gt;kimsooyoung\u0026lt;/maintainer\u0026gt; \u0026lt;license\u0026gt;TODO: License declaration\u0026lt;/license\u0026gt; \u0026lt;!-- python part --\u0026gt; \u0026lt;buildtool_depend\u0026gt;ament_cmake_python\u0026lt;/buildtool_depend\u0026gt; \u0026lt;depend\u0026gt;rclpy\u0026lt;/depend\u0026gt; \u0026lt;!-- python part --\u0026gt; ... CMakeLists.txtì— ì•„ë˜ì™€ ê°™ì€ ë¼ì¸ì„ ì¶”ê°€í•©ë‹ˆë‹¤. (python ì½”ë“œ ì´ë¦„ì€ ì—¬ëŸ¬ë¶„ì˜ ê²ƒìœ¼ë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.) ###### Python Part ##### # Install Python modules ament_python_install_package(${PROJECT_NAME}) # Install Python executables install(PROGRAMS ament_general/my_py_node.py DESTINATION lib/${PROJECT_NAME} ) ê¸°ì¡´ íŒŒì´ì¬ ì½”ë“œë“¤ì€ ìˆ˜ì • í›„ ë³„ë„ ë¹Œë“œê°€ ì—†ì–´ë„ ì‹¤í–‰ ì‹œ í•´ë‹¹ ë‚´ìš©ì´ ë°˜ì˜ë˜ì—ˆì§€ìš”? ì´ëŸ¬í•œ symlink install ë™ì‘ì„ ìœ„í•´ì„  íŒŒì´ì¬ íŒŒì¼ì— ê¶Œí•œì„ ì¶”ê°€í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. chmod +x my_py_node.py ìƒˆë¡œìš´ ì‚¬ìš©ìê°€ ì½”ë“œë¥¼ cloneí•˜ë©´ ë§¤ë²ˆ ì´ ì‘ì—…ì„ ë°˜ë³µí•´ì•¼ í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ì‹¤ì œ ê°œë°œì— ì´ëŸ¬í•œ ë°©ë²•ì´ ìì£¼ ì‚¬ìš©ë˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.\nìµœì¢… buildì™€ ì‹¤í–‰ì…ë‹ˆë‹¤. cbp ament_general \u0026amp;\u0026amp; source install/local_setup.bash ros2 run ament_general my_py_node.py "
},
{
	"uri": "/kr/ros2_foxy/lecture17/",
	"title": "Lecture17. Real Hardware Examples",
	"tags": [],
	"description": "",
	"content": " ì´ë²ˆ ì‹œê°„ì—ëŠ” ì‹¤ì œ ì„¼ì„œ í•˜ë“œì›¨ì–´ë¥¼ ì‹¤í–‰í•˜ëŠ” ROS 2 packageë“¤ì„ ì‹¤í–‰í•´ë³´ê³ , ì½”ë“œ ë¶„ì„ì„ ì§„í–‰í•´ë³´ë ¤í•©ë‹ˆë‹¤. ì¤€ë¹„ëœ ì˜ˆì‹œë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nIntel Realsense2 D455 Camera Velodyne VLP16 3D lidar Orbbec Astra+ Camera Intel realsense2 camera ROS 2 real hardware ê°•ì˜ì˜ ë‘ë²ˆì§¸ ì‹œê°„ìœ¼ë¡œ Intelì˜ realsense2 ì¹´ë©”ë¼ íŒ¨í‚¤ì§€ë¥¼ ì‹¤í–‰í•˜ê³ , ë¶„ì„í•´ ë³´ê² ìŠµë‹ˆë‹¤.\nì˜ˆì œ ì‹¤í–‰ì„ ìœ„í•´ í•„ìš”í•œ ì¢…ì†ì„±ë“¤ì„ ì„¤ì¹˜í•˜ê³  realsense sdkì¸ librealsenseë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤. sudo apt-get update \u0026amp;\u0026amp; sudo apt-get upgrade # Register the server\u0026#39;s public key sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-key F6E65AC044F831AC80A06380C8B3A55A6F3EFCDE || sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-key F6E65AC044F831AC80A06380C8B3A55A6F3EFCDE \u0026gt; gpg: Total number processed: 1 # Add the server to the list of repositories sudo add-apt-repository \u0026#34;deb https://librealsense.intel.com/Debian/apt-repo $(lsb_release -cs) main\u0026#34; -u # Install the libraries (see section below if upgrading packages) sudo apt-get install librealsense2-dkms -y sudo apt-get install librealsense2-utils -y ì‹¤ì œ ì¹´ë©”ë¼ ì—°ê²°ì„ í†µí•´ realsense2 íŒ¨í‚¤ì§€ ì„¤ì¹˜ë¥¼ ê²€ì¦í•´ë´…ì‹œë‹¤. # Reconnect the Intel RealSense depth camera and run realsense-viewer modinfo uvcvideo | grep \u0026#34;version:\u0026#34; # should include realsense string â‡’ ìœ„ì™€ ê°™ì€ ì´ë¯¸ì§€ ì¶œë ¥ì„ ì–»ì—ˆë‹¤ë©´ ì„±ê³µì…ë‹ˆë‹¤.\nì‚¬ì‹¤, realsense cameraëŠ” intelì´ ê°œë°œí•œ ë§Œí¼ ubuntu ë°°í¬íŒ íŒ¨í‚¤ì§€ë¡œ ros2ë¥¼ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì‚¬ìš©ë§Œ í•˜ê³  ì‹¶ë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì†ì‰½ê²Œ ì„¤ì¹˜ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. # Install Dependencies sudo apt-get install ros-foxy-cv-bridge ros-foxy-librealsense2 ros-foxy-message-filters ros-foxy-image-transport -y sudo apt install ros-foxy-diagnostic-updater -y sudo apt-get install -y libssl-dev libusb-1.0-0-dev pkg-config libgtk-3-dev sudo apt-get install -y libglfw3-dev libgl1-mesa-dev libglu1-mesa-dev â‡’ í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” íŒ¨í‚¤ì§€ ë¶„ì„ì´ ëª©ì ì´ë¯€ë¡œ ì§ì ‘ ì†ŒìŠ¤ì½”ë“œ ë¹Œë“œì™€ ë¶„ì„ì„ í•´ë³´ê² ìŠµë‹ˆë‹¤. ì•„ë˜ ë§í¬ë¥¼ í†µí•´ release versionì„ ë‹¤ìš´ë°›ê³  ros2 workspaceì— ì••ì¶•ì„ í•´ì œí•©ë‹ˆë‹¤.\nhttps://github.com/IntelRealSense/realsense-ros/releases\ní´ë” ì´ë™ í›„ ë¹Œë“œëŠ” ì•„ë˜ ìˆœì„œëŒ€ë¡œ í•´ì£¼ì„¸ìš”! cbp realsense2_camera_msgs \u0026amp;\u0026amp; source install/local_setup.bash cbp realsense2_description \u0026amp;\u0026amp; source install/local_setup.bash cbp realsense2_camera \u0026amp;\u0026amp; source install/local_setup.bash ìš°ì„  ë¹Œë“œê°€ ì˜ ë˜ì—ˆëŠ”ì§€ ì˜ˆì‹œë¶€í„° ì‹¤í–‰í•´ë´…ì‹œë‹¤. ros2 launch realsense2_camera rs_launch.py topic list, rviz2ë¥¼ í†µí•´ ì •ìƒ ë™ì‘ì„ í™•ì¸í•©ë‹ˆë‹¤. $ ros2 topic list /camera/color/camera_info /camera/color/image_raw /camera/color/metadata /camera/depth/camera_info /camera/depth/image_rect_raw /camera/depth/metadata /camera/extrinsics/depth_to_color /camera/extrinsics/depth_to_depth /camera/imu /parameter_events /rosout /tf_static point cloud topicì„ í™œì„±í™”í•˜ê¸° ìœ„í•´ì„  ì•„ë˜ì™€ ê°™ì€ launchê°€ í•„ìš”í•©ë‹ˆë‹¤. ros2 launch realsense2_camera rs_launch.py pointcloud.enable:=true rviz2ë¥¼ í†µí•´ pointcloudë¥¼ ì‹œê°í™”í•´ë´…ì‹œë‹¤. (ë©”ê°€ì»¤í”¼ì—ì„œ ê°•ì˜ë¥¼ ì œì‘í•´ì„œ ì†í¥ë¯¼ ì„ ìˆ˜ ì–¼êµ´ì´ ë³´ì´ë„¤ìš” ã…ã…) rviz2ì—ì„œ tf2 dataë„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. fixed frameì€ camera_linkë¡œ ë‘ì‹œë©´ ë©ë‹ˆë‹¤. tf2 treeë„ í™•ì¸í•´ë´…ì‹œë‹¤. Composition launch realsense ros2 packageëŠ” Intra-communicationì„ ì‚¬ìš©í•˜ì—¬ ë©”ëª¨ë¦¬ ìµœì í™”ë¥¼ ì ìš©í•œ composition launchë„ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” íŒ¨í‚¤ì§€ ë¹Œë“œë¥¼ ë‹¤ì‹œ í•´ì•¼ í•˜ë©°, ì´ëŸ¬í•œ ì´ìœ ë¡œ ì €ëŠ” realsense_wsë¼ëŠ” ë³„ë„ì˜ workspaceë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.\ncd ~/ mkdir -p realsense_ws/src cd realsense_ws # locate packages \u0026amp; build again colcon build --cmake-args \u0026#39;-DBUILD_TOOLS=ON\u0026#39; Composition ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤! $ ros2 launch realsense2_camera rs_intra_process_demo_launch.py ... [component_container-1] [INFO] [1682508794.621382739] [frame_latency]: Got msg with address 0x7fe51c6cb570 with latency of 0.0597926 [sec] [component_container-1] [INFO] [1682508794.689360200] [frame_latency]: Got msg with address 0x7fe51c6cb570 with latency of 0.0610729 [sec] [component_container-1] [INFO] [1682508794.755558725] [frame_latency]: Got msg with address 0x7fe51c6cb570 with latency of 0.0605604 [sec] [component_container-1] [INFO] [1682508794.822757399] [frame_latency]: Got msg with address 0x7fe51c6cb570 with latency of 0.0610629 [sec] [component_container-1] [INFO] [1682508794.889473916] [frame_latency]: Got msg with address 0x7fe51c6cb570 with latency of 0.0610784 [sec] [component_container-1] [INFO] [1682508794.955772739] [frame_latency]: Got msg with address 0x7fe51c6cb570 with latency of 0.0606767 [sec] [component_container-1] [INFO] [1682508795.022029595] [frame_latency]: Got msg with address 0x7fe51c6cb570 with latency of 0.0602304 [sec] [component_container-1] [INFO] [1682508795.088818104] [frame_latency]: Got msg with address 0x7fe51c6cb570 with latency of 0.0603308 [sec] [component_container-1] [INFO] [1682508795.156870084] [frame_latency]: Got msg with address 0x7fe51c6cb570 with latency of 0.0616579 [sec] [component_container-1] [INFO] [1682508795.223072425] [frame_latency]: rqt_image_viewë¥¼ í†µí•´ ì´ë¯¸ì§€ë„ í™•ì¸í•´ ë³´ê² ìŠµë‹ˆë‹¤. $ ros2 run rqt_image_view rqt_image_view ì‹¤ì œ ì¼ë°˜ node ì‹¤í–‰ê³¼ composition ì‚¬ìš© ì‹œ ì ìœ í•˜ëŠ” ë©”ëª¨ë¦¬ë¥¼ ë¹„êµí•´ ë³´ì•˜ìŠµë‹ˆë‹¤. PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND 2530 kimsooy+ 20 0 897252 82312 50300 R 12.3 0.5 1:09.80 x-terminal-emul 1247 kimsooy+ 20 0 6284836 344712 109988 S 11.3 2.1 7:17.14 gnome-shell 41892 kimsooy+ 20 0 1183960 85788 57140 S 5.3 0.5 0:03.28 component_conta PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND 1247 kimsooy+ 20 0 6333092 344816 109988 S 11.6 2.1 8:00.07 gnome-shell 2530 kimsooy+ 20 0 897252 82664 50300 S 10.9 0.5 1:33.14 x-terminal-emul 42240 kimsooy+ 20 0 1457552 92104 57096 S 8.9 0.6 0:03.88 realsense2_came ë…¸íŠ¸ë¶ í™˜ê²½ì´ì–´ ê²‰ë³´ê¸°ì— í° ì°¨ì´ëŠ” ì—†ì§€ë§Œ, ì‹¤ì œ edge deviceì—ì„œ ì‹¤í–‰ + ë‹¤ì¤‘ Nodeë“¤ì´ ê²°í•©ë˜ëŠ” ê²½ìš° Composition ì‚¬ìš© ì—¬ë¶€ê°€ í° ì°¨ì´ë¥¼ ê°€ì§ˆ ê²ƒì…ë‹ˆë‹¤.\nrealsense2 Launch file ë¶„ì„ launch fileê³¼ ì†ŒìŠ¤ì½”ë“œ ì¼ë¶€ ë¶„ì„ì„ í†µí•´ ì„¼ì„œ íŒ¨í‚¤ì§€ ê°œë°œì˜ íë¦„ì„ ì´í•´í•´ë´…ì‹œë‹¤.\nrs_launch.pyì˜ ì‹œì‘ì€ ìˆ˜ë§ì€ launch configurationë“¤ë¡œ ì‹œì‘ë©ë‹ˆë‹¤. (DeclareLaunchArgument, LaunchConfigurationì„ ë³„ë„ì˜ í•¨ìˆ˜ë¡œ êµ¬í˜„í•´ ë‘ê³  ì¬ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.) configurable_parameters = [{\u0026#39;name\u0026#39;: \u0026#39;camera_name\u0026#39;, \u0026#39;default\u0026#39;: \u0026#39;camera\u0026#39;, \u0026#39;description\u0026#39;: \u0026#39;camera unique name\u0026#39;}, {\u0026#39;name\u0026#39;: \u0026#39;serial_no\u0026#39;, \u0026#39;default\u0026#39;: \u0026#34;\u0026#39;\u0026#39;\u0026#34;, \u0026#39;description\u0026#39;: \u0026#39;choose device by serial number\u0026#39;}, {\u0026#39;name\u0026#39;: \u0026#39;usb_port_id\u0026#39;, \u0026#39;default\u0026#39;: \u0026#34;\u0026#39;\u0026#39;\u0026#34;, \u0026#39;description\u0026#39;: \u0026#39;choose device by usb port id\u0026#39;}, {\u0026#39;name\u0026#39;: \u0026#39;device_type\u0026#39;, \u0026#39;default\u0026#39;: \u0026#34;\u0026#39;\u0026#39;\u0026#34;, \u0026#39;description\u0026#39;: \u0026#39;choose device by type\u0026#39;}, ... def declare_configurable_parameters(parameters): return [DeclareLaunchArgument(param[\u0026#39;name\u0026#39;], default_value=param[\u0026#39;default\u0026#39;], description=param[\u0026#39;description\u0026#39;]) for param in parameters] def set_configurable_parameters(parameters): return dict([(param[\u0026#39;name\u0026#39;], LaunchConfiguration(param[\u0026#39;name\u0026#39;])) for param in parameters]) ROS 2 dashing, eloquent, foxy / ë³„ë„ user config fileì´ ìˆëŠ”ì§€ ë“± ê°ì¢… ì¡°ê±´ì— ë”°ë¥¸ ì¡°ê±´ ë¶„ë¦¬ë„ ì„¤ì •í•´ ë‘ì—ˆìŠµë‹ˆë‹¤. def generate_launch_description(): log_level = \u0026#39;info\u0026#39; if (os.getenv(\u0026#39;ROS_DISTRO\u0026#39;) == \u0026#34;dashing\u0026#34;) or (os.getenv(\u0026#39;ROS_DISTRO\u0026#39;) == \u0026#34;eloquent\u0026#34;): ... else: return LaunchDescription(declare_configurable_parameters(configurable_parameters) + [ # Realsense launch_ros.actions.Node( condition=IfCondition(PythonExpression([LaunchConfiguration(\u0026#39;config_file\u0026#39;), \u0026#34; == \u0026#39;\u0026#39;\u0026#34;])), ... launch_ros.actions.Node( condition=IfCondition(PythonExpression([LaunchConfiguration(\u0026#39;config_file\u0026#39;), \u0026#34; != \u0026#39;\u0026#39;\u0026#34;])), ì‹¤ì œ ì‹¤í–‰ë˜ëŠ” ê²ƒì€ realsense2_camera_nodeì´ë©°, ë‹¤ìŒìœ¼ë¡œ ì´ nodeì— ëŒ€í•´ì„œ íŒŒí—¤ì³ë³´ê² ìŠµë‹ˆë‹¤. launch_ros.actions.Node( package=\u0026#39;realsense2_camera\u0026#39;, namespace=LaunchConfiguration(\u0026#34;camera_name\u0026#34;), name=LaunchConfiguration(\u0026#34;camera_name\u0026#34;), executable=\u0026#39;realsense2_camera_node\u0026#39;, parameters=[set_configurable_parameters(configurable_parameters) , PythonExpression([LaunchConfiguration(\u0026#34;config_file\u0026#34;)]) ], output=\u0026#39;screen\u0026#39;, arguments=[\u0026#39;--ros-args\u0026#39;, \u0026#39;--log-level\u0026#39;, LaunchConfiguration(\u0026#39;log_level\u0026#39;)], emulate_tty=True, ) ì½”ë“œ ë¶„ì„ CMakeLists.txtë¥¼ ì‚´í´ë³´ë©´ realsense2_camera_nodeì´ ì–´ë–»ê²Œ ë¹Œë“œëœ ê²°ê³¼ë¬¼ì¸ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. rclcpp_components_register_node(${PROJECT_NAME} PLUGIN \u0026#34;realsense2_camera::RealSenseNodeFactory\u0026#34; EXECUTABLE realsense2_camera_node ) ê·¸ëŸ°ë°, ì¼ë°˜ì ìœ¼ë¡œ executableì„ ë¹Œë“œí•˜ëŠ” ë°©ì‹ì´ ì•„ë‹Œ rclcpp_components_register_nodeë¼ëŠ” ì˜µì…˜ì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. rclcpp_components_register_nodeì€ ë¼ì´ë¸ŒëŸ¬ë¦¬, ì‹¤í–‰ íŒŒì¼ì„ ëª¨ë‘ ìƒì„±í•  ìˆ˜ ìˆëŠ” rclcppì˜ CMake toolsì…ë‹ˆë‹¤. https://docs.ros2.org/latest/api/rclcpp_components/\nrealsense2 ROS 2 packageëŠ” ROS 1 ë•Œë¶€í„°ì˜ ë ˆê±°ì‹œê°€ ì”ì¡´í•˜ê³  êµ¬ì¡°ìƒìœ¼ë¡œ ê¹”ë”í•˜ë‹¤ê³  ë§í•˜ê¸°ëŠ” ì–´ë ¤ìš´ ì½”ë“œì…ë‹ˆë‹¤. ë¶„ì„ì€ í•˜ê² ì§€ë§Œ ì´ëŸ¬í•œ í˜•íƒœê°€ ì¼ë°˜ì ì´ë¼ê³  í•  ìˆ˜ ì—†ìŒì„ ì¸ì§€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤! (ì €ë¼ë©´ ì‹¹ë‹¤ ì²˜ìŒë¶€í„° ì§¤ ê²ƒ ê°™ìŠµë‹ˆë‹¤.)\nrealsense2_camera_nodeë¥¼ êµ¬ì„±í•˜ëŠ” compositionì¸ RealSenseNodeFactoryëŠ” realsense_node_factory.hì— êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë””ìì¸ íŒ¨í„´ì„ ë”°ëë‹¤ê³  ë§í•  ìˆ˜ëŠ” ì—†ì§€ë§Œ, ì¼ì¢…ì˜ íŒ©í† ë¦¬ì´ë©° _realSenseNodeê°€ Nodeì— í•´ë‹¹í•©ë‹ˆë‹¤. namespace realsense2_camera { class RealSenseNodeFactory : public rclcpp::Node { public: explicit RealSenseNodeFactory(const rclcpp::NodeOptions \u0026amp; node_options = rclcpp::NodeOptions()); RealSenseNodeFactory( const std::string \u0026amp; node_name, const std::string \u0026amp; ns, const rclcpp::NodeOptions \u0026amp; node_options = rclcpp::NodeOptions()); virtual ~RealSenseNodeFactory(); private: void init(); void closeDevice(); void startDevice(); void changeDeviceCallback(rs2::event_information\u0026amp; info); void getDevice(rs2::device_list list); void tryGetLogSeverity(rs2_log_severity\u0026amp; severity) const; static std::string parseUsbPort(std::string line); rclcpp::Node::SharedPtr _node; rs2::device _device; std::unique_ptr\u0026lt;BaseRealSenseNode\u0026gt; _realSenseNode; rs2::context _ctx; std::string _serial_no; std::string _usb_port_id; std::string _device_type; double _wait_for_device_timeout; double _reconnect_timeout; bool _initial_reset; std::thread _query_thread; bool _is_alive; rclcpp::Logger _logger; std::shared_ptr\u0026lt;Parameters\u0026gt; _parameters; }; }//end namespace ìš°ì„  ì—¬ê¸°ì„œ ëª‡ê°€ì§€ ì£¼ìš” í•¨ìˆ˜ë“¤ì„ ë¶„ì„í•˜ê³  ë” ê¹Šì´ ë“¤ì–´ê°€ë³´ê² ìŠµë‹ˆë‹¤.\nrealsense_node_factory.cpp - startDevice() void RealSenseNodeFactory::startDevice() { if (_realSenseNode) _realSenseNode.reset(); std::string pid_str(_device.get_info(RS2_CAMERA_INFO_PRODUCT_ID)); uint16_t pid = std::stoi(pid_str, 0, 16); try { switch(pid) { case SR300_PID: case SR300v2_PID: case RS400_PID: case RS405_PID: case RS410_PID: case RS460_PID: case RS415_PID: case RS420_PID: case RS420_MM_PID: case RS430_PID: case RS430_MM_PID: case RS430_MM_RGB_PID: case RS435_RGB_PID: case RS435i_RGB_PID: case RS455_PID: case RS465_PID: case RS_USB2_PID: case RS_L515_PID_PRE_PRQ: case RS_L515_PID: case RS_L535_PID: _realSenseNode = std::unique_ptr\u0026lt;BaseRealSenseNode\u0026gt;(new BaseRealSenseNode(*this, _device, _parameters, this-\u0026gt;get_node_options().use_intra_process_comms())); break; case RS_T265_PID: _realSenseNode = std::unique_ptr\u0026lt;T265RealsenseNode\u0026gt;(new T265RealsenseNode(*this, _device, _parameters, this-\u0026gt;get_node_options().use_intra_process_comms())); break; default: ROS_FATAL_STREAM(\u0026#34;Unsupported device!\u0026#34; \u0026lt;\u0026lt; \u0026#34; Product ID: 0x\u0026#34; \u0026lt;\u0026lt; pid_str); rclcpp::shutdown(); exit(1); } _realSenseNode-\u0026gt;publishTopics(); } catch(const rs2::backend_error\u0026amp; e) { std::cerr \u0026lt;\u0026lt; \u0026#34;Failed to start device: \u0026#34; \u0026lt;\u0026lt; e.what() \u0026lt;\u0026lt; \u0026#39;\\n\u0026#39;; _device.hardware_reset(); _device = rs2::device(); } } main Nodeì¸ _realSenseNodeë¥¼ ì •ì˜í•˜ê³  ìˆìœ¼ë©°, ì´ëŠ” ì‚¬ìš©í•˜ëŠ” ì¹´ë©”ë¼ ëª¨ë¸ì— ë”°ë¼ ì°¨ì´ë¥¼ ê°–ìŠµë‹ˆë‹¤.\n_realSenseNodeë¥¼ ìƒì„±í•œ ì´í›„, publishTopics ë©”ì†Œë“œê°€ í˜¸ì¶œë©ë‹ˆë‹¤. base_realsense_node.cpp - publishTopics() void BaseRealSenseNode::publishTopics() { getParameters(); setup(); ROS_INFO_STREAM(\u0026#34;RealSense Node Is Up!\u0026#34;); } â‡’ getParameters()ì—ì„œëŠ” ë§ ê·¸ëŒ€ë¡œ ê°ì¢… ROS 2 ë§¤ê°œë³€ìˆ˜ë“¤ì˜ íŒŒì‹±ì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.\nsetup() ë©”ì†Œë“œì—ì„œ ì£¼ìš” ê¸°ëŠ¥ë“¤ì´ ì‹¤í–‰ë˜ë©° ì—¬ê¸°ë¡œ í•œë‹¨ê³„ ë” ì§„ì…í•´ë³´ê² ìŠµë‹ˆë‹¤. BaseRealSenseNode::setup() void BaseRealSenseNode::setup() { setDynamicParams(); startDiagnosticsUpdater(); setAvailableSensors(); SetBaseStream(); setupFilters(); setupFiltersPublishers(); setCallbackFunctions(); monitoringProfileChanges(); updateSensors(); publishServices(); } ì´ë ‡ê²Œ ë³µì¡í•œ êµ¬ì¡°ë¥¼ ê°–ê²Œ ëœ ê¹Œë‹­ì€ ìœ ì¶”í•˜ê±´ë° ROS 1ì˜ ë ˆê±°ì‹œì—ì„œ ì‹œì‘í–ˆê¸° ë•Œë¬¸ì¼ê²ë‹ˆë‹¤. â‡’ ROS 1 ì½”ë“œì—ì„œ ì£¼ìš” ê¸°ëŠ¥ë“¤ì„ ëª¨ë‘ ëª¨ë“ˆí™”í•˜ê³  ROS 2ì—ì„œëŠ” setup()ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ëª¨ì¡°ë¦¬ ë•Œë ¤ë„£ì€ ê²ƒì´ì§€ìš”. ë‹¤ì‹œ ë§í•˜ì§€ë§Œ, êµ¬ì¡°ì ìœ¼ë¡œ ì˜ êµ¬í˜„ëœ ì½”ë“œëŠ” ì•„ë‹™ë‹ˆë‹¤.\nìœ„ í•¨ìˆ˜ë“¤ ëŒ€ë¶€ë¶„ì€ ì´ë¦„ì„ í†µí•´ ê¸°ëŠ¥ì„ ìœ ì¶”í•  ìˆ˜ ìˆìœ¼ë©° ì¤‘ìš”í•œ í•¨ìˆ˜ë“¤ë§Œ ëª‡ê°€ì§€ íŒŒí—¤ì³ë³´ê² ìŠµë‹ˆë‹¤.\nsetAvailableSensors std::function\u0026lt;void(rs2::frame)\u0026gt; frame_callback_function = [this](rs2::frame frame){ bool is_filter(_filters.end() != find_if(_filters.begin(), _filters.end(), [](std::shared_ptr\u0026lt;NamedFilter\u0026gt; f){return (f-\u0026gt;is_enabled()); })); if (_sync_frames || is_filter) this-\u0026gt;_asyncer.invoke(frame); else frame_callback(frame); }; std::function\u0026lt;void(rs2::frame)\u0026gt; imu_callback_function = [this](rs2::frame frame){ imu_callback(frame); if (_imu_sync_method != imu_sync_method::NONE) imu_callback_sync(frame); }; std::function\u0026lt;void(rs2::frame)\u0026gt; multiple_message_callback_function = [this](rs2::frame frame){multiple_message_callback(frame, _imu_sync_method);}; std::function\u0026lt;void()\u0026gt; update_sensor_func = [this](){ { std::lock_guard\u0026lt;std::mutex\u0026gt; lock_guard(_profile_changes_mutex); _is_profile_changed = true; } _cv_mpc.notify_one(); }; ê°ì¢… callbackë“¤ì´ êµ¬í˜„ë©ë‹ˆë‹¤. í˜„ì¬ callbackì•ˆì—ì„œ ë‹¤ì‹œ callbackì´ ì‹¤í–‰ë˜ê¸°ë„ í•˜ê³ , lock guardê°€ í˜¸ì¶œë˜ê³ ë„ ìˆì§€ë§Œ, ê²°êµ­ í•´ë‹¹ callbackë“¤ì´ subscriber, service serverì˜ callbackìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.\në”ë¶ˆì–´, setAvailableSensorsì—ì„œ librealsenseì™€, ROS 2ì˜ ì—°ë™ì´ ë™ì‘í•©ë‹ˆë‹¤. ì´ë¥¼ RosSensorë¼ëŠ” íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„í•˜ì—¬ ì•ì„œ êµ¬í˜„í•œ callbackë“¤ê³¼ bindingí•©ë‹ˆë‹¤. for(auto\u0026amp;\u0026amp; sensor : _dev_sensors) { const std::string module_name(sensor.get_info(RS2_CAMERA_INFO_NAME)); std::unique_ptr\u0026lt;RosSensor\u0026gt; rosSensor; if (sensor.is\u0026lt;rs2::depth_sensor\u0026gt;() || sensor.is\u0026lt;rs2::color_sensor\u0026gt;() || sensor.is\u0026lt;rs2::fisheye_sensor\u0026gt;()) { ROS_DEBUG_STREAM(\u0026#34;Set \u0026#34; \u0026lt;\u0026lt; module_name \u0026lt;\u0026lt; \u0026#34; as VideoSensor.\u0026#34;); rosSensor = std::make_unique\u0026lt;RosSensor\u0026gt;(sensor, _parameters, frame_callback_function, update_sensor_func, hardware_reset_func, _diagnostics_updater, _logger, _use_intra_process, _dev.is\u0026lt;playback\u0026gt;()); } else if (sensor.is\u0026lt;rs2::motion_sensor\u0026gt;()) { ROS_DEBUG_STREAM(\u0026#34;Set \u0026#34; \u0026lt;\u0026lt; module_name \u0026lt;\u0026lt; \u0026#34; as ImuSensor.\u0026#34;); rosSensor = std::make_unique\u0026lt;RosSensor\u0026gt;(sensor, _parameters, imu_callback_function, update_sensor_func, hardware_reset_func, _diagnostics_updater, _logger, false, _dev.is\u0026lt;playback\u0026gt;()); } else if (sensor.is\u0026lt;rs2::pose_sensor\u0026gt;()) { ROS_DEBUG_STREAM(\u0026#34;Set \u0026#34; \u0026lt;\u0026lt; module_name \u0026lt;\u0026lt; \u0026#34; as PoseSensor.\u0026#34;); rosSensor = std::make_unique\u0026lt;RosSensor\u0026gt;(sensor, _parameters, multiple_message_callback_function, update_sensor_func, hardware_reset_func, _diagnostics_updater, _logger, false, _dev.is\u0026lt;playback\u0026gt;()); } else { ROS_ERROR_STREAM(\u0026#34;Module Name \\\u0026#34;\u0026#34; \u0026lt;\u0026lt; module_name \u0026lt;\u0026lt; \u0026#34;\\\u0026#34; does not define a callback.\u0026#34;); throw(\u0026#34;Error: Module not supported\u0026#34;); } _available_ros_sensors.push_back(std::move(rosSensor)); } ìƒì„±ëœ rosSensorë“¤ì€ _available_ros_sensorsì— push_backëœ í›„, updateSensorsì—ì„œ ì†Œë¹„ë©ë‹ˆë‹¤. void BaseRealSenseNode::updateSensors() { std::lock_guard\u0026lt;std::mutex\u0026gt; lock_guard(_update_sensor_mutex); try{ for(auto\u0026amp;\u0026amp; sensor : _available_ros_sensors) { if(is_profile_changed) { // Start/stop sensors only if profile was changed // No need to start/stop sensors if align_depth was changed ROS_INFO_STREAM(\u0026#34;Stopping Sensor: \u0026#34; \u0026lt;\u0026lt; module_name); sensor-\u0026gt;stop(); } stopPublishers(active_profiles); if (!wanted_profiles.empty()) { if(is_profile_changed) { ROS_INFO_STREAM(\u0026#34;Starting Sensor: \u0026#34; \u0026lt;\u0026lt; module_name); sensor-\u0026gt;start(wanted_profiles); } ... RosSensorì˜ start ë©”ì†Œë“œì—ì„œ ë“œë””ì–´ realsense sdkì™€ì˜ ì—°ë™ì´ ë™ì‘í•˜ë©°, \\_frame_callbackì´ë¼ëŠ” ë©”ëª¨ë¦¬ ì „ë‹¬ì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. // base_realsense_node.h std::vector\u0026lt;std::unique_ptr\u0026lt;RosSensor\u0026gt;\u0026gt; _available_ros_sensors; bool RosSensor::start(const std::vector\u0026lt;stream_profile\u0026gt;\u0026amp; profiles) { if (get_active_streams().size() \u0026gt; 0) return false; setupErrorCallback(); rs2::sensor::open(profiles); for (auto\u0026amp; profile : profiles) ROS_INFO_STREAM(\u0026#34;Open profile: \u0026#34; \u0026lt;\u0026lt; ProfilesManager::profile_string(profile)); rs2::sensor::start(_frame_callback); ... return true; } ... _frame_callback = [this](rs2::frame frame) { runFirstFrameInitialization(); auto stream_type = frame.get_profile().stream_type(); auto stream_index = frame.get_profile().stream_index(); stream_index_pair sip{stream_type, stream_index}; try { _origin_frame_callback(frame); if (_frequency_diagnostics.find(sip) != _frequency_diagnostics.end()) _frequency_diagnostics.at(sip).Tick(); } catch(const std::exception\u0026amp; ex) ... }; Publish ë¶„ì„ ì‹¤ì œ image topicì´ publish ë˜ëŠ” ë¶€ë¶„ì„ ì¶”ê°€ë¡œ ë¶„ì„í•´ ë³´ê² ìŠµë‹ˆë‹¤.\nstartPublishers ë‚´ë¶€ì—ì„œ image_rcl_publisher íƒ€ì…ì˜ í´ë˜ìŠ¤ í¬ì¸í„°ê°€ í• ë‹¹ë©ë‹ˆë‹¤. void BaseRealSenseNode::startPublishers(const std::vector\u0026lt;stream_profile\u0026gt;\u0026amp; profiles, const RosSensor\u0026amp; sensor) { const std::string module_name(create_graph_resource_name(rs2_to_ros(sensor.get_info(RS2_CAMERA_INFO_NAME)))); for (auto\u0026amp; profile : profiles) { ... // We can use 2 types of publishers: // Native RCL publisher that support intra-process zero-copy comunication // image-transport package publisher that adds a commpressed image topic if package is found installed if (_use_intra_process) { _image_publishers[sip] = std::make_shared\u0026lt;image_rcl_publisher\u0026gt;(_node, image_raw.str(), qos); } else { _image_publishers[sip] = std::make_shared\u0026lt;image_transport_publisher\u0026gt;(_node, image_raw.str(), qos); ROS_DEBUG_STREAM(\u0026#34;image transport publisher was created for topic\u0026#34; \u0026lt;\u0026lt; image_raw.str()); } ... if (_use_intra_process) { _depth_aligned_image_publishers[sip] = std::make_shared\u0026lt;image_rcl_publisher\u0026gt;(_node, aligned_image_raw.str(), qos); } else { _depth_aligned_image_publishers[sip] = std::make_shared\u0026lt;image_transport_publisher\u0026gt;(_node, aligned_image_raw.str(), qos); ROS_DEBUG_STREAM(\u0026#34;image transport publisher was created for topic\u0026#34; \u0026lt;\u0026lt; image_raw.str()); } _depth_aligned_info_publisher[sip] = _node.create_publisher\u0026lt;sensor_msgs::msg::CameraInfo\u0026gt;(aligned_camera_info.str(), rclcpp::QoS(rclcpp::QoSInitialization::from_rmw(info_qos), info_qos)); } ì°¸ê³ ë¡œ, _image_publishersëŠ” ì•„ë˜ì™€ ê°™ì´ std::map íƒ€ì…ì˜ í´ë˜ìŠ¤ ë³€ìˆ˜ì´ë©° index_pairì™€ image_publisher í¬ì¸í„°ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. std::map\u0026lt;stream_index_pair, std::shared_ptr\u0026lt;image_publisher\u0026gt;\u0026gt; _image_publishers; image_publisher.cpp - image_rcl_publisher image_rcl_publisherì˜ publish ë©”ì†Œë“œì—ì„œ ë“œë””ì–´ ì‹¤ì§ˆì ì¸ publishê°€ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ë”ë¶ˆì–´ std::moveë¥¼ í†µí•´ ì†Œìœ ê¶Œì„ ì´ì „í•˜ê³  ìˆìŠµë‹ˆë‹¤. (intra-processingì— ëŒ€ë¹„í•œ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.) image_rcl_publisher::image_rcl_publisher( rclcpp::Node \u0026amp; node, const std::string \u0026amp; topic_name, const rmw_qos_profile_t \u0026amp; qos ) { image_publisher_impl = node.create_publisher\u0026lt; sensor_msgs::msg::Image \u0026gt;( topic_name, rclcpp::QoS( rclcpp::QoSInitialization::from_rmw( qos ), qos ) ); } void image_rcl_publisher::publish( sensor_msgs::msg::Image::UniquePtr image_ptr ) { image_publisher_impl-\u0026gt;publish( std::move( image_ptr ) ); } ... image_transport_publisher::image_transport_publisher( rclcpp::Node \u0026amp; node, const std::string \u0026amp; topic_name, const rmw_qos_profile_t \u0026amp; qos ) { image_publisher_impl = std::make_shared\u0026lt; image_transport::Publisher \u0026gt;( image_transport::create_publisher( \u0026amp;node, topic_name, qos ) ); } void image_transport_publisher::publish( sensor_msgs::msg::Image::UniquePtr image_ptr ) { image_publisher_impl-\u0026gt;publish( *image_ptr ); } image_rcl_publisherê°€ ì‚¬ìš©ë˜ëŠ” ë¶€ë¶„ì„ ì¶”ì í•´ ë³´ê² ìŠµë‹ˆë‹¤. BaseRealSenseNodeì˜ frame_callbackì—ì„œ ë‹¤ì‹œ publishFrame callbackì„ í˜¸ì¶œí•˜ì—¬ _image_publishersë¥¼ ì „ë‹¬í•˜ê³  ìˆìŠµë‹ˆë‹¤. void BaseRealSenseNode::frame_callback(rs2::frame frame) { ... publishFrame(f, t, sip, _image, _info_publisher, _image_publishers); ... publishFrame(frame_to_send, t, DEPTH, _image, _info_publisher, _image_publishers); ì „ë‹¬ëœ _image_publishersëŠ” std::map typeì´ê¸° ë•Œë¬¸ì— rgb, depth, infra camera ì¤‘ì—ì„œ indexingí•˜ì—¬ ìµœì¢… publishê°€ ì§„í–‰ë©ë‹ˆë‹¤. void BaseRealSenseNode::publishFrame(rs2::frame f, const rclcpp::Time\u0026amp; t, const stream_index_pair\u0026amp; stream, std::map\u0026lt;stream_index_pair, cv::Mat\u0026gt;\u0026amp; images, const std::map\u0026lt;stream_index_pair, rclcpp::Publisher\u0026lt;sensor_msgs::msg::CameraInfo\u0026gt;::SharedPtr\u0026gt;\u0026amp; info_publishers, const std::map\u0026lt;stream_index_pair, std::shared_ptr\u0026lt;image_publisher\u0026gt;\u0026gt;\u0026amp; image_publishers, const bool is_publishMetadata){ auto\u0026amp; image_publisher = image_publishers.at(stream); ... image_publisher-\u0026gt;publish(std::move(img)); ë‹¤ì‹œ ë§í•˜ì§€ë§Œ, realsense2 ros2 ì½”ë“œê°€ ì™„ì„±ë„ê°€ ë†’ì€ ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤. í•˜ì§€ë§Œ, ì ì–´ë„ ROS 2ì‹œìŠ¤í…œ ì°¨ì›ì—ì„œ ì½”ë“œë¥¼ ë¶„ì„í•  ìˆ˜ ìˆëŠ” ì˜ˆì‹œê°€ ë˜ê¸°ì— ê°™ì´ íŒŒí—¤ì³ ë³´ì•˜ìŠµë‹ˆë‹¤.\nrs_intra_process_demo_launch.py Composition ì˜ˆì‹œì—ì„œ ì‚´í´ë³¸ ë°”ì™€ ê°™ì´ launch fileì—ì„œ ComposableNodeContainerë¥¼ í†µí•´ composition containerë¥¼ ì‹¤í–‰í•˜ê³ , RealSenseNodeFactory/FrameLatencyNode compositionì„ loadí•˜ê³  ìˆìŠµë‹ˆë‹¤. rs_node_class= \u0026#39;RealSenseNodeFactory\u0026#39; rs_latency_tool_class = \u0026#39;FrameLatencyNode\u0026#39; ... def generate_launch_description(): return LaunchDescription(declare_configurable_parameters(configurable_parameters) + [ ComposableNodeContainer( name=\u0026#39;my_container\u0026#39;, namespace=\u0026#39;\u0026#39;, package=\u0026#39;rclcpp_components\u0026#39;, executable=\u0026#39;component_container\u0026#39;, composable_node_descriptions=[ ComposableNode( package=\u0026#39;realsense2_camera\u0026#39;, namespace=\u0026#39;\u0026#39;, plugin=\u0026#39;realsense2_camera::\u0026#39; + rs_node_class, name=\u0026#34;camera\u0026#34;, parameters=[set_configurable_parameters(configurable_parameters)], extra_arguments=[{\u0026#39;use_intra_process_comms\u0026#39;: LaunchConfiguration(\u0026#34;intra_process_comms\u0026#34;)}]) , ComposableNode( package=\u0026#39;realsense2_camera\u0026#39;, namespace=\u0026#39;\u0026#39;, plugin=\u0026#39;rs2_ros::tools::frame_latency::\u0026#39; + rs_latency_tool_class, name=\u0026#39;frame_latency\u0026#39;, parameters=[set_configurable_parameters(configurable_parameters)], extra_arguments=[{\u0026#39;use_intra_process_comms\u0026#39;: LaunchConfiguration(\u0026#34;intra_process_comms\u0026#34;)}]) , ], output=\u0026#39;screen\u0026#39;, emulate_tty=True, # needed for display of logs arguments=[\u0026#39;--ros-args\u0026#39;, \u0026#39;--log-level\u0026#39;, LaunchConfiguration(\u0026#39;log_level\u0026#39;)], )]) RealSenseNodeFactoryëŠ” ì• ì´ˆì— composition í˜•íƒœë¡œ ê°œë°œë˜ì—ˆìœ¼ë¯€ë¡œ ì‹¤ì œ ì½”ë“œë¥¼ ì‚´í´ë³´ì•„ë„ ë¡œê·¸ë¥¼ ë‚¨ê¸°ëŠ” ê²ƒì™¸ì— ì¶”ê°€ ì‘ì—…ì€ ì—†ìŠµë‹ˆë‹¤. BaseRealSenseNode::BaseRealSenseNode(rclcpp::Node\u0026amp; node, rs2::device dev, std::shared_ptr\u0026lt;Parameters\u0026gt; parameters, bool use_intra_process) : ... _use_intra_process(use_intra_process), ... { if ( use_intra_process ) { ROS_INFO(\u0026#34;Intra-Process communication enabled\u0026#34;); } FrameLatencyNodeëŠ” tools â‡’ frame_latencyì— êµ¬í˜„ë˜ì–´ ìˆìœ¼ë©°, ë‹¨ìˆœíˆ topic publishì˜ ì§€ì—° ì‹œê°„ì„ ê³„ì‚°í•˜ì—¬ ì½˜ì†” ì¶œë ¥í•©ë‹ˆë‹¤. FrameLatencyNode::FrameLatencyNode( const rclcpp::NodeOptions \u0026amp; node_options ) : Node( \u0026#34;frame_latency\u0026#34;, \u0026#34;/\u0026#34;, node_options ) , _logger( this-\u0026gt;get_logger() ) { ROS_INFO_STREAM( \u0026#34;frame_latency node is UP!\u0026#34; ); ROS_INFO_STREAM( \u0026#34;Intra-Process is \u0026#34; \u0026lt;\u0026lt; ( this-\u0026gt;get_node_options().use_intra_process_comms() ? \u0026#34;ON\u0026#34; : \u0026#34;OFF\u0026#34; ) ); // Create a subscription on the input topic. _sub = this-\u0026gt;create_subscription\u0026lt; sensor_msgs::msg::Image \u0026gt;( \u0026#34;/color/image_raw\u0026#34;, // TODO Currently color only, we can declare and accept the required // streams as ros parameters rclcpp::QoS( rclcpp::QoSInitialization::from_rmw( rmw_qos_profile_default ), rmw_qos_profile_default ), [\u0026amp;, this]( const sensor_msgs::msg::Image::SharedPtr msg ) { rclcpp::Time curr_time = this-\u0026gt;get_clock()-\u0026gt;now(); auto latency = ( curr_time - msg-\u0026gt;header.stamp ).seconds(); ROS_INFO_STREAM( \u0026#34;Got msg with address 0x\u0026#34; \u0026lt;\u0026lt; std::hex \u0026lt;\u0026lt; reinterpret_cast\u0026lt; std::uintptr_t \u0026gt;( msg.get() ) \u0026lt;\u0026lt; std::dec \u0026lt;\u0026lt; \u0026#34; with latency of \u0026#34; \u0026lt;\u0026lt; latency \u0026lt;\u0026lt; \u0026#34; [sec]\u0026#34; ); } ); } rs_multi_camera_launch.py rs_multi_camera_launchì—ì„œëŠ” namespaceê°€ ì§€ì •ëœ rs_launch.py 2ê°œê°€ ì‹¤í–‰ë˜ë©°, rviz2 ì‹œê°í™”ë¥¼ ìœ„í•´ ë³„ë„ë¡œ static_transform_publisherê°€ ì‹¤í–‰ë©ë‹ˆë‹¤. local_parameters = [{\u0026#39;name\u0026#39;: \u0026#39;camera_name1\u0026#39;, \u0026#39;default\u0026#39;: \u0026#39;camera1\u0026#39;, \u0026#39;description\u0026#39;: \u0026#39;camera unique name\u0026#39;}, {\u0026#39;name\u0026#39;: \u0026#39;camera_name2\u0026#39;, \u0026#39;default\u0026#39;: \u0026#39;camera2\u0026#39;, \u0026#39;description\u0026#39;: \u0026#39;camera unique name\u0026#39;}, ] ... def generate_launch_description(): params1 = duplicate_params(rs_launch.configurable_parameters, \u0026#39;1\u0026#39;) params2 = duplicate_params(rs_launch.configurable_parameters, \u0026#39;2\u0026#39;) return LaunchDescription( rs_launch.declare_configurable_parameters(local_parameters) + rs_launch.declare_configurable_parameters(params1) + rs_launch.declare_configurable_parameters(params2) + [ IncludeLaunchDescription( PythonLaunchDescriptionSource([ThisLaunchFileDir(), \u0026#39;/rs_launch.py\u0026#39;]), launch_arguments=set_configurable_parameters(params1).items(), ), IncludeLaunchDescription( PythonLaunchDescriptionSource([ThisLaunchFileDir(), \u0026#39;/rs_launch.py\u0026#39;]), launch_arguments=set_configurable_parameters(params2).items(), ), # dummy static transformation from camera1 to camera2 launch_ros.actions.Node( package = \u0026#34;tf2_ros\u0026#34;, executable = \u0026#34;static_transform_publisher\u0026#34;, arguments = [\u0026#34;0\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;camera1_link\u0026#34;, \u0026#34;camera2_link\u0026#34;] ), ]) rs_multi_camera_launch.pyì—ì„œ ì„ ì–¸ëœ camera_name launch argumentëŠ” rs_launch.pyë¡œ ì „ë‹¬ë˜ì–´ namespace ì˜µì…˜ì— ì¶”ê°€ë¨ê³¼ ë”ë¶ˆì–´ Composotionì—ê²Œ ì „ë‹¬ë©ë‹ˆë‹¤. return LaunchDescription(declare_configurable_parameters(configurable_parameters) + [ # Realsense launch_ros.actions.Node( condition=IfCondition(PythonExpression([LaunchConfiguration(\u0026#39;config_file\u0026#39;), \u0026#34; == \u0026#39;\u0026#39;\u0026#34;])), package=\u0026#39;realsense2_camera\u0026#39;, namespace=LaunchConfiguration(\u0026#34;camera_name\u0026#34;), name=LaunchConfiguration(\u0026#34;camera_name\u0026#34;), executable=\u0026#39;realsense2_camera_node\u0026#39;, parameters=[set_configurable_parameters(configurable_parameters)], output=\u0026#39;screen\u0026#39;, arguments=[\u0026#39;--ros-args\u0026#39;, \u0026#39;--log-level\u0026#39;, LaunchConfiguration(\u0026#39;log_level\u0026#39;)], emulate_tty=True, ), parameterë¥¼ ëª¨ë‘ ê´€ë¦¬í•˜ëŠ” parameters.cppì—ì„œ camera_nameì˜ íŒŒì‹±ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. void BaseRealSenseNode::getParameters() { ROS_INFO(\u0026#34;getParameters...\u0026#34;); std::string param_name; param_name = std::string(\u0026#34;camera_name\u0026#34;); _camera_name = _parameters-\u0026gt;setParam\u0026lt;std::string\u0026gt;(param_name, \u0026#34;camera\u0026#34;); _parameters_names.push_back(param_name); realsense2 Description descriptionì´ë¼ëŠ” ì´ë¦„ì„ ê°€ì§„ íŒ¨í‚¤ì§€ëŠ” CAD, URDF íŒŒì¼ê³¼ ê°™ì€ ë¬¼ì„±ì¹˜, ì™¸ê´€ì— ëŒ€í•œ ë°ì´í„°ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. realsenseì˜ description packageë¥¼ ë¶„ì„í•´ë´…ì‹œë‹¤.\nê¸°ë³¸ launch fileì„ ì‹¤í–‰í•´ ë³´ê² ìœ¼ë©°, d455 ì˜µì…˜ìœ¼ë¡œ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤. ros2 launch realsense2_description view_model.launch.py model:=\u0026lt;sth\u0026gt; ros2 launch realsense2_description view_model.launch.py model:=test_d455_camera.urdf.xacro â‡’ ì„¼ì„œ ì™¸ê´€ì„ ë¹„ë¡¯í•˜ì—¬ ë‹¤ì–‘í•œ ë‚´ì¥ ì„¼ì„œë“¤ì— ëŒ€í•œ tf2ë„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\ntf2 treeë¥¼ í†µí•´ ì´ì— ëŒ€í•œ ìì„¸í•œ êµ¬ì¡°ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆìœ¼ë©°, d455ëŠ” ì¹´ë©”ë¼ ë¿ë§Œ ì•„ë‹ˆë¼ ê°€ì†ë„ ì„¼ì„œ, ìì´ë¡œ ì„¼ì„œë¥¼ í¬í•¨í•˜ê³  ìˆì–´ ì•„ë˜ì™€ ê°™ì´ ë³µì¡í•œ êµ¬ì¡°ë¥¼ ê°–ê²Œ ë©ë‹ˆë‹¤. ì§€ê¸ˆ tf2 treeì—ì„œëŠ” base_linkê°€ ìµœìƒìœ„ Nodeì¸ë°ìš”. ì‹¤ì œ ë¡œë´‡ ì‹œìŠ¤í…œì— ì¥ì°© ì‹œ ë¡œë´‡ì˜ base_linkê°€ ì´ë¯¸ ì¡´ì¬í•œë‹¤ë©´ ì˜ë„ì¹˜ ì•Šì€ tf2 errorê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì‹¤ì œ test_d455_camera.urdf.xacro íŒŒì¼ì—ì„œë„ ì´ë¥¼ ì†ì‰½ê²Œ ì œê±°í•  ìˆ˜ ìˆë„ë¡ ì•„ë˜ì™€ ê°™ì´ base_linkë¥¼ ë³„ë„ ë¶„ë¦¬í•´ë‘” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;robot name=\u0026#34;realsense2_camera\u0026#34; xmlns:xacro=\u0026#34;http://ros.org/wiki/xacro\u0026#34;\u0026gt; \u0026lt;xacro:arg name=\u0026#34;use_nominal_extrinsics\u0026#34; default=\u0026#34;false\u0026#34;/\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find realsense2_description)/urdf/_d455.urdf.xacro\u0026#34; /\u0026gt; \u0026lt;link name=\u0026#34;base_link\u0026#34; /\u0026gt; \u0026lt;xacro:sensor_d455 parent=\u0026#34;base_link\u0026#34; use_nominal_extrinsics=\u0026#34;$(arg use_nominal_extrinsics)\u0026#34;\u0026gt; \u0026lt;origin xyz=\u0026#34;0 0 0\u0026#34; rpy=\u0026#34;0 0 0\u0026#34;/\u0026gt; \u0026lt;/xacro:sensor_d455\u0026gt; \u0026lt;/robot\u0026gt; Description Launch file ë¶„ì„ view_model.launch.py - ì‹¤ì œ ì‹¤í–‰ë˜ëŠ” NodeëŠ” robot_state_publisherì™€ rviz2 ì…ë‹ˆë‹¤. (ì„¼ì„œëŠ” ì›€ì§ì´ëŠ” íŒŒì¸ ê°€ ì—†ìœ¼ë‹ˆ joint_state_publisherëŠ” êµ³ì´ í•„ìš” ì—†ê² ì§€ìš”?) rviz_node = Node( package=\u0026#39;rviz2\u0026#39;, executable=\u0026#39;rviz2\u0026#39;, node_name=\u0026#39;rviz2\u0026#39;, output = \u0026#39;screen\u0026#39;, arguments=[\u0026#39;-d\u0026#39;, rviz_config_dir], parameters=[{\u0026#39;use_sim_time\u0026#39;: False}] ) model_node = Node( node_name=\u0026#39;model_node\u0026#39;, package=\u0026#39;robot_state_publisher\u0026#39;, executable=\u0026#39;robot_state_publisher\u0026#39;, namespace=\u0026#39;\u0026#39;, output=\u0026#39;screen\u0026#39;, arguments = [urdf] ) return launch.LaunchDescription([rviz_node, model_node]) robot_state_publisherì˜ argumentë¡œ urdf íŒŒì¼ë“¤ì´ ì „ë‹¬ë˜ë©°, ì‚¬ìš©ìë¡œë¶€í„° mode:= ê°’ì„ ë°›ì•„ í•´ë‹¹ urdf fileì´ ì‹¤í–‰ë˜ëŠ” í˜•ì‹ì…ë‹ˆë‹¤. (ì €ë¼ë©´ Launch Argumentë¥¼ ì‚¬ìš©í–ˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.)\nurdf í´ë”ë¥¼ ì‚´í´ë³´ë©´, ëª¨ë“  ëª¨ë¸ì— ëŒ€í•œ ê¸°ë³¸ urdf fileê³¼, description launchë¥¼ ìœ„í•´ base_linkê°€ ê²°í•©ëœ test urdfë“¤ì´ ìë™ìƒì„±ë˜ì–´ìˆëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ ì¹´ë©”ë¼ ì„¼ì„œì˜ tf2 ì‚¬ìš© ì‹œ ì£¼ì˜í•  ì ì´ ìˆëŠ”ë°ìš”. ì¼ë°˜ì ìœ¼ë¡œ ì»´í“¨í„° ë¹„ì „ ë„ë©”ì¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì¢Œí‘œê³„ì™€, ROS 2ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì¢Œí‘œê³„ëŠ” ì•„ë˜ì™€ ê°™ì´ ì°¨ì´ë¥¼ ê°–ìŠµë‹ˆë‹¤. gazebo plugin ì‹œê°„ì— ì‚´í´ë³´ì•˜ë˜ ê²ƒì²˜ëŸ¼ rviz2ë¥¼ í†µí•´ ê²€ì¦ì„ í•œ ë’¤ ì‚¬ìš©í•˜ê¸°ë¥¼ ì¶”ì²œë“œë¦½ë‹ˆë‹¤. Custom Message ëŒ€ë¶€ë¶„ ì„¼ì„œ íŒ¨í‚¤ì§€ë“¤ì€ sdkì—ì„œ ì •ì˜ëœ ìë£Œêµ¬ì¡°ì™€ ROS 2ì˜ ì—°ë™ì„ ìœ„í•´ custom interfaceë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤. realsense2ì—ì„œë„ IMUInfoë¥¼ ë¹„ë¡¯í•œ Custom Interfaceë“¤ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. $ ros2 interface show realsense2_camera_msgs/msg/IMUInfo # header.frame_id is either set to \u0026#34;imu_accel\u0026#34; or \u0026#34;imu_gyro\u0026#34; # to distinguish between \u0026#34;accel\u0026#34; and \u0026#34;gyro\u0026#34; info. std_msgs/Header header float64[12] data float64[3] noise_variances float64[3] bias_variances â‡’ ì´ë ‡ê²Œ custom interfaceê°€ ìˆë‹¤ë©´, ë‹¤ë¥¸ íŒ¨í‚¤ì§€ì˜ ì¢…ì†ì„±ì´ ë  í™•ë¥ ì´ ë†’ì´ ë•Œë¬¸ì— ë¨¼ì € ë¹Œë“œí•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.\nâ‡’ ë”ë¶ˆì–´ custom interfaceëŠ” í•´ë‹¹ workspaceì—ë§Œ ì ìš©ë˜ê¸° ë•Œë¬¸ì— workspaceê°€ ë°”ë€Œë©´ ì ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\nCMakeLists.txtë¥¼ í†µí•´ ë¹Œë“œë˜ëŠ” ëª¨ë“  IDLë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. set(msg_files \u0026#34;msg/IMUInfo.msg\u0026#34; \u0026#34;msg/Extrinsics.msg\u0026#34; \u0026#34;msg/Metadata.msg\u0026#34; ) rosidl_generate_interfaces(${PROJECT_NAME} ${msg_files} \u0026#34;srv/DeviceInfo.srv\u0026#34; DEPENDENCIES builtin_interfaces std_msgs ADD_LINTER_TESTS ) ì¼ì „ ì´ì•¼ê¸°í•œ ê²ƒê³¼ ê°™ì´ ë‹¤ë¥¸ ì†ŒìŠ¤ì½”ë“œì—ì„œ custom interfaceë¥¼ ì‚¬ìš©í•˜ê³  ìˆì–´ ì„ í–‰ ë¹Œë“œ í›„ ì†Œì‹±ì´ ê¼­ í•„ìš”í•©ë‹ˆë‹¤. #pragma once #include \u0026lt;librealsense2/rs.hpp\u0026gt; #include \u0026lt;librealsense2/rsutil.h\u0026gt; #include \u0026#34;constants.h\u0026#34; #include \u0026lt;cv_bridge/cv_bridge.h\u0026gt; #include \u0026lt;diagnostic_updater/diagnostic_updater.hpp\u0026gt; #include \u0026lt;diagnostic_updater/publisher.hpp\u0026gt; #include \u0026#34;realsense2_camera_msgs/msg/imu_info.hpp\u0026#34; #include \u0026#34;realsense2_camera_msgs/msg/extrinsics.hpp\u0026#34; #include \u0026#34;realsense2_camera_msgs/msg/metadata.hpp\u0026#34; #include \u0026#34;realsense2_camera_msgs/srv/device_info.hpp\u0026#34; velodyne Lidar ROS 2 ì‹¤í–‰ ì´ë²ˆì—ëŠ” point cloud ë°ì´í„°ë¥¼ ì„¼ì‹±í•  ìˆ˜ ìˆëŠ” 3D Lidar ì¤‘ ê°€ì¥ ë³´í¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” VLP-16ì˜ ROS 2 íŒ¨í‚¤ì§€ë¥¼ ë¶„ì„í•´ë³´ê² ìŠµë‹ˆë‹¤.\nvelodyne lidar ë˜í•œ ubuntu packageë¥¼ ì œê³µí•˜ê³  ìˆìœ¼ë©° ìì²´ì ì¸ Gazebo packageì™€ driver íŒ¨í‚¤ì§€ë¥¼ ëª¨ë‘ ì œê³µí•©ë‹ˆë‹¤. $ sudo apt install ros-foxy-velodyne- ros-foxy-velodyne-description ros-foxy-velodyne-laserscan-dbgsym ros-foxy-velodyne-driver ros-foxy-velodyne-msgs ros-foxy-velodyne-driver-dbgsym ros-foxy-velodyne-msgs-dbgsym ros-foxy-velodyne-gazebo-plugins ros-foxy-velodyne-pointcloud ros-foxy-velodyne-gazebo-plugins-dbgsym ros-foxy-velodyne-pointcloud-dbgsym ros-foxy-velodyne-laserscan ros-foxy-velodyne-simulator ì´ë²ˆì—ë„ ìš°ë¦¬ëŠ” í•™ìŠµì„ ìœ„í•´ ì†ŒìŠ¤ì½”ë“œ ë¹Œë“œë¥¼ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤. cd ~/ros2_ws/src # package clone git clone -b foxy-devel https://github.com/ros-drivers/velodyne.git # dependencies install sudo apt-get update \u0026amp;\u0026amp; sudo apt-get install libpcap-dev # source code build cbp velodyne_msgs \u0026amp;\u0026amp; source install/local_setup.bash cbp velodyne_laserscan \u0026amp;\u0026amp; source install/local_setup.bash cbp velodyne_pointcloud \u0026amp;\u0026amp; source install/local_setup.bash cbp velodyne_driver \u0026amp;\u0026amp; source install/local_setup.bash cbp velodyne \u0026amp;\u0026amp; source install/local_setup.bash velodyne lidarëŠ” Ethernet ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ë”°ë¼ì„œ Ubuntuì˜ ë„¤íŠ¸ì›Œí¬ ì„¤ì •ì—ì„œ ê³ ì • IP ì„¤ì •ì„ í•´ì£¼ë©°, VLP-16ì˜ ê¸°ë³¸ IPëŠ” 192.168.1.100ì…ë‹ˆë‹¤. ì„¤ì • ì´í›„ launchëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ros2 launch velodyne velodyne-all-nodes-VLP16-launch.py launch rviz2ë¥¼ í†µí•œ ì‹œê°í™”ë¥¼ í•´ë´…ì‹œë‹¤. fixed frameì„ velodyneìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤. tf2 treeë¥¼ ì‚´í´ë³´ë©´ ì•„ë¬´ê²ƒë„ ì¡°íšŒë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. velodyne tf2ë§Œ broadcastë˜ê³  ìˆê¸° ë•Œë¬¸ì— í™•ì¸í•  ìˆ˜ ì—†ëŠ” ê²ƒì…ë‹ˆë‹¤. ì €ì˜€ë‹¤ë©´ stasic transform broadcasterë¥¼ í†µí•´ world \u0026gt; velodyne tf2ë¥¼ í•˜ë‚˜ ìƒì„±í–ˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.\nvelodyne lidar ë˜í•œ composed-launchë¼ëŠ” comspoition ê¸°ë°˜ ì‹¤í–‰ì„ ì§€ì›í•©ë‹ˆë‹¤. $ ros2 launch velodyne velodyne-all-nodes-VLP16-composed-launch.py [INFO] [launch_ros.actions.load_composable_nodes]: Loaded node \u0026#39;/velodyne_driver_node\u0026#39; in container \u0026#39;/velodyne_container\u0026#39; [component_container-1] [INFO] [1682566114.537928654] [velodyne_container]: Load Library: /home/kimsooyoung/ros2_ws/install/velodyne_pointcloud/lib/libconvert.so [component_container-1] [INFO] [1682566114.540579179] [velodyne_container]: Found class: rclcpp_components::NodeFactoryTemplate\u0026lt;velodyne_pointcloud::Convert\u0026gt; [component_container-1] [INFO] [1682566114.540601962] [velodyne_container]: Instantiate class: rclcpp_components::NodeFactoryTemplate\u0026lt;velodyne_pointcloud::Convert\u0026gt; [component_container-1] [INFO] [1682566114.542606795] [velodyne_convert_node]: correction angles: /home/kimsooyoung/ros2_ws/install/velodyne_pointcloud/share/velodyne_pointcloud/params/VLP16db.yaml [INFO] [launch_ros.actions.load_composable_nodes]: Loaded node \u0026#39;/velodyne_convert_node\u0026#39; in container \u0026#39;/velodyne_container\u0026#39; [component_container-1] [INFO] [1682566114.548422161] [velodyne_container]: Load Library: /home/kimsooyoung/ros2_ws/install/velodyne_laserscan/lib/libvelodyne_laserscan.so [component_container-1] [INFO] [1682566114.549147973] [velodyne_container]: Found class: rclcpp_components::NodeFactoryTemplate\u0026lt;velodyne_laserscan::VelodyneLaserScan\u0026gt; [component_container-1] [INFO] [1682566114.549171818] [velodyne_container]: Instantiate class: rclcpp_components::NodeFactoryTemplate\u0026lt;velodyne_laserscan::VelodyneLaserScan\u0026gt; [INFO] [launch_ros.actions.load_composable_nodes]: Loaded node \u0026#39;/velodyne_laserscan_node\u0026#39; in container \u0026#39;/velodyne_container\u0026#39; [component_container-1] [INFO] [1682566114.597621115] [velodyne_laserscan_node]: Latched ring count of 16 [component_container-1] [WARN] [1682566114.597755427] [velodyne_laserscan_node]: PointCloud2 fields in unexpected order. Using slower generic method. composed-launchì™€ ì¼ë°˜ launch ì‹œ ì°¨ì´ì ì„ rqt_graphë¡œ í™•ì¸í•´ë´…ì‹œë‹¤. Launch file ë¶„ì„ velodyne-all-nodes-VLP16-launch.pyë¥¼ ë¶„ì„í•´ë´…ì‹œë‹¤. velodyne_driver_node, velodyne_convert_node, velodyne_laserscan_nodeì´ ì‹¤í–‰ë˜ë©° velodyne_driver_nodeì˜ ì¢…ë£Œ ì‹œ launch ìì²´ê°€ ì¢…ë£Œë˜ë„ë¡ Eventë¥¼ ê±¸ì–´ì£¼ì—ˆìŠµë‹ˆë‹¤. return launch.LaunchDescription([ velodyne_driver_node, velodyne_convert_node, velodyne_laserscan_node, launch.actions.RegisterEventHandler( event_handler=launch.event_handlers.OnProcessExit( target_action=velodyne_driver_node, on_exit=[launch.actions.EmitEvent( event=launch.events.Shutdown())], )), ]) velodyne-all-nodes-VLP16-composed-launch.pyì—ì„œëŠ” component_containerì™€ velodyne_driver::VelodyneDriver, velodyne_pointcloud::Convert, velodyne_laserscan::VelodyneLaserScan 3ê°œì˜ compositionì´ ë™ì‘í•©ë‹ˆë‹¤. container = ComposableNodeContainer( name=\u0026#39;velodyne_container\u0026#39;, namespace=\u0026#39;\u0026#39;, package=\u0026#39;rclcpp_components\u0026#39;, executable=\u0026#39;component_container\u0026#39;, composable_node_descriptions=[ ComposableNode( package=\u0026#39;velodyne_driver\u0026#39;, plugin=\u0026#39;velodyne_driver::VelodyneDriver\u0026#39;, name=\u0026#39;velodyne_driver_node\u0026#39;, parameters=[driver_params]), ComposableNode( package=\u0026#39;velodyne_pointcloud\u0026#39;, plugin=\u0026#39;velodyne_pointcloud::Convert\u0026#39;, name=\u0026#39;velodyne_convert_node\u0026#39;, parameters=[convert_params]), ComposableNode( package=\u0026#39;velodyne_laserscan\u0026#39;, plugin=\u0026#39;velodyne_laserscan::VelodyneLaserScan\u0026#39;, name=\u0026#39;velodyne_laserscan_node\u0026#39;, parameters=[laserscan_params]), ], output=\u0026#39;both\u0026#39;, ) return LaunchDescription([container]) ì´ì œ ë°©ê¸ˆ ì „ì˜ ì‹¤í–‰ ì½”ë“œë“¤(velodyne_driver_node, velodyne_convert_node, velodyne_laserscan_node)ì„ ë¶„ì„í•´ ë´…ì‹œë‹¤.\nvelodyne_driver_node velodyne packageì˜ CMakeLists.txtì—ì„œ velodyne_driver_nodeì˜ ì½”ë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. add_executable(velodyne_driver_node src/driver/velodyne_node.cpp) ament_target_dependencies(velodyne_driver_node rclcpp) target_link_libraries(velodyne_driver_node velodyne_driver) install(TARGETS velodyne_driver_node DESTINATION lib/${PROJECT_NAME}) velodyne_node.cpp ìì²´ëŠ” ì¼ë°˜ì ì¸ rclcpp node programmingì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. (ëŒ€ì‹  NodeOptionsì„ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬í•˜ëŠ”ë° ì´ëŠ” VelodyneDriverê°€ Compositioní˜•íƒœë¡œ êµ¬í˜„ë˜ì–´ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.) #include \u0026lt;rclcpp/rclcpp.hpp\u0026gt; #include \u0026lt;memory\u0026gt; #include \u0026#34;velodyne_driver/driver.hpp\u0026#34; int main(int argc, char ** argv) { // Force flush of the stdout buffer. setvbuf(stdout, nullptr, _IONBF, BUFSIZ); rclcpp::init(argc, argv); rclcpp::spin(std::make_shared\u0026lt;velodyne_driver::VelodyneDriver\u0026gt;(rclcpp::NodeOptions())); rclcpp::shutdown(); return 0; } VelodyneDriver::VelodyneDriverì—ì„œëŠ” velodyne sdk =\u0026gt; ROS 2ë¡œì˜ í˜•íƒœ ë³€í™˜ì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. Compositionì„ ê³ ë ¤í•œ í˜•íƒœë¡œ Node í”„ë¡œê·¸ë˜ë° ë˜ì–´ìˆìŠµë‹ˆë‹¤. namespace velodyne_driver { class VelodyneDriver final : public rclcpp::Node { public: explicit VelodyneDriver(const rclcpp::NodeOptions \u0026amp; options); ~VelodyneDriver() override; ... private: bool poll(); void pollThread(); // configuration parameters struct config_; ... std::unique_ptr\u0026lt;Input\u0026gt; input_; rclcpp::Publisher\u0026lt;velodyne_msgs::msg::VelodyneScan\u0026gt;::SharedPtr output_; int last_azimuth_; ... }; } // namespace velodyne_driver #endif // VELODYNE_DRIVER__DRIVER_HPP_ velodyne sdk =\u0026gt; ROS 2ë¡œì˜ ë°ì´í„° í˜•íƒœ ë³€í™˜ì€ std::thread í†µí•´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ROS 2ì™€ì˜ ì¶©ëŒì„ ë§‰ê¸° ìœ„í•´ ì†Œë©¸ìì—ì„œ joiní•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. ì‚¬ì‹¤ ì´ë ‡ê²Œ í•˜ë©´ ì´ë²¤íŠ¸ ë°œìƒ ì‹œ ë‹¤ì‹œ deadlock ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤. ì €ë¼ë©´ ì¼ì „ì˜ callback group \u0026amp; executorë¥¼ ì‚¬ìš©í–ˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.\nstd::thread poll_thread_; // node ìƒì„±ìì—ì„œ thread ì‹œì‘ VelodyneDriver::VelodyneDriver(const rclcpp::NodeOptions \u0026amp; options) : rclcpp::Node(\u0026#34;velodyne_driver_node\u0026#34;, options), diagnostics_(this, 0.2) { poll_thread_ = std::thread(\u0026amp;VelodyneDriver::pollThread, this); } // thread í•¨ìˆ˜ì—ì„œ ë¬´í•œ poll í˜¸ì¶œ void VelodyneDriver::pollThread() { std::future_status status; do { poll(); status = future_.wait_for(std::chrono::seconds(0)); } while (status == std::future_status::timeout); } // poll í•¨ìˆ˜ê°€ ë§ˆì¹˜ ROS 2 callback ì²˜ëŸ¼ ë™ì‘ bool VelodyneDriver::poll() velodyne_driver =\u0026gt; ROS 2ë¡œì˜ ë°ì´í„° ë³€í™˜ì„ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤. (poll í•¨ìˆ˜ì˜ ë‚´ìš©ì…ë‹ˆë‹¤.) velodyne driver ë°ì´í„°ë¥¼ std::unique_ptr inputìœ¼ë¡œ íŒŒì‹± inputì—ì„œ configìœ¼ë¡œ ë°ì´í„° ë³€í™˜ config_ì—ì„œ std::unique_ptr\u0026lt;velodyne_msgs::msg::VelodyneScan\u0026gt; scanìœ¼ë¡œ ë°ì´í„° ë³€í™˜ output_-\u0026gt;publish(std::move(scan)); â‡’ ìƒë‹¹íˆ ë©”ëª¨ë¦¬ í˜•ë³€í™˜ì´ ì¦ì€ë° ì´ì „ ì½”ë“œì—ì„œì˜ ë ˆê±°ì‹œê°€ ìˆëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.\ndiagnostic_updater â‡’ ì¤‘ê°„ì¤‘ê°„ ë³´ì´ëŠ” diagnostic ê´€ë ¨ ì½”ë“œë“¤ì€ ROS 2ì˜ diagnostic_updater APIë¡œ device driversì˜ ì—¬ëŸ¬ ìƒíƒœë¥¼ topic í˜•íƒœë¡œ publishí•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. diagnostic_updater::Updater diagnostics_; std::unique_ptr\u0026lt;diagnostic_updater::TopicDiagnostic\u0026gt; diag_topic_; velodyne_convert_node rviz2ì—ì„œ ë³´ì•˜ë˜ ê²ƒì²˜ëŸ¼ ì œëŒ€ë¡œ ëœ Pointcloud topicì„ ìœ„í•´ì„œ velodyne_driverì—ì„œì˜ raw dataë“¤ì„ ëˆ„ì í•˜ê³ , ë‹¤ì‹œ sensor_msgs/msg/PointCloud2ë¡œ ë³€í™˜í•˜ëŠ” ì‘ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤. velodyne_convert_nodeì—ì„œ ì´ ë‚´ìš©ì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\nvelodyne_pointcloud packageì˜ CMakeLists.txtì—ì„œ velodyne_convert_nodeì˜ ì½”ë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. add_executable(velodyne_convert_node src/conversions/convert_node.cpp) ament_target_dependencies(velodyne_convert_node rclcpp) target_link_libraries(velodyne_convert_node convert) install(TARGETS velodyne_convert_node DESTINATION lib/${PROJECT_NAME} ) convert_node.cpp ìì²´ëŠ” ë‹¨ìˆœ Node ìƒì„± í›„ spinì„ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. int main(int argc, char ** argv) { // Force flush of the stdout buffer. setvbuf(stdout, nullptr, _IONBF, BUFSIZ); rclcpp::init(argc, argv); // handle callbacks until shut down rclcpp::spin( std::make_shared\u0026lt;velodyne_pointcloud::Convert\u0026gt;( rclcpp::NodeOptions())); rclcpp::shutdown(); return 0; } Convert í´ë˜ìŠ¤ëŠ” velodyne_msgs::msg::VelodyneScan topicì„ subscribeí•˜ì—¬ ëˆ„ì í•˜ê³ , sensor_msgs::msg::PointCloud2 topicìœ¼ë¡œ ë‹¤ì‹œ publishí•©ë‹ˆë‹¤. namespace velodyne_pointcloud { class Convert final : public rclcpp::Node { public: explicit Convert(const rclcpp::NodeOptions \u0026amp; options); ... private: void processScan(const velodyne_msgs::msg::VelodyneScan::SharedPtr scanMsg); std::unique_ptr\u0026lt;velodyne_rawdata::RawData\u0026gt; data_; rclcpp::Subscription\u0026lt;velodyne_msgs::msg::VelodyneScan\u0026gt;::SharedPtr velodyne_scan_; rclcpp::Publisher\u0026lt;sensor_msgs::msg::PointCloud2\u0026gt;::SharedPtr output_; tf2_ros::Buffer tf_buffer_; std::unique_ptr\u0026lt;velodyne_rawdata::DataContainerBase\u0026gt; container_ptr_; ... }; } // namespace velodyne_pointcloud velodyne_packetsì˜ subscribe callbackìœ¼ë¡œ processScanì´ ë°”ì¸ë”©ë˜ì–´ìˆìœ¼ë©°, processScanì—ì„œëŠ” ì¼ì „ ì–¸ê¸‰í•œ ë°ì´í„° ëˆ„ì ê³¼ publishê°€ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. // subscribe to VelodyneScan packets velodyne_scan_ = this-\u0026gt;create_subscription\u0026lt;velodyne_msgs::msg::VelodyneScan\u0026gt;( \u0026#34;velodyne_packets\u0026#34;, rclcpp::QoS(10), std::bind(\u0026amp;Convert::processScan, this, std::placeholders::_1)); void Convert::processScan(const velodyne_msgs::msg::VelodyneScan::SharedPtr scanMsg) { ... // allocate a point cloud with same time and frame ID as raw data container_ptr_-\u0026gt;setup(scanMsg); // process each packet provided by the driver for (size_t i = 0; i \u0026lt; scanMsg-\u0026gt;packets.size(); ++i) { data_-\u0026gt;unpack(scanMsg-\u0026gt;packets[i], *container_ptr_); } // publish the accumulated cloud message diag_topic_-\u0026gt;tick(scanMsg-\u0026gt;header.stamp); output_-\u0026gt;publish(container_ptr_-\u0026gt;finishCloud()); } velodyne_convert_nodeì—ì„œ tf2 ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ë¶€ë¶„ì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ í¸ì˜ë¥¼ ìœ„í•´ ë³„ë„ì˜ ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“¤ê³  êµ¬í˜„ì€ ì¶”ìƒí™”í•´ë‘” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. tf2_ros::Buffer tf_buffer_; if (organize_cloud) { container_ptr_ = std::make_unique\u0026lt;OrganizedCloudXYZIR\u0026gt;( min_range, max_range, target_frame, fixed_frame, data_-\u0026gt;numLasers(), data_-\u0026gt;scansPerPacket(), tf_buffer_); } else { container_ptr_ = std::make_unique\u0026lt;PointcloudXYZIR\u0026gt;( min_range, max_range, target_frame, fixed_frame, data_-\u0026gt;scansPerPacket(), tf_buffer_); } DataContainerBase í´ë˜ìŠ¤ì—ì„œëŠ” tf2 lookupTransformì„ í†µí•´ scan dataì˜ ì¢Œí‘œë¥¼ ë¯¸ë¦¬ ê³„ì‚°í•´ë‘¡ë‹ˆë‹¤. std::unique_ptr\u0026lt;velodyne_rawdata::DataContainerBase\u0026gt; container_ptr_; class DataContainerBase { public: ... void computeTransformation(const rclcpp::Time \u0026amp; time) { geometry_msgs::msg::TransformStamped transform; try { const std::chrono::nanoseconds dur(time.nanoseconds()); std::chrono::time_point\u0026lt;std::chrono::system_clock, std::chrono::nanoseconds\u0026gt; time(dur); transform = tf_buffer_.lookupTransform(config_.target_frame, cloud.header.frame_id, time); } catch (tf2::LookupException \u0026amp; e) { return; } catch (tf2::ExtrapolationException \u0026amp; e) { return; } tf2::Quaternion quaternion( transform.transform.rotation.x, transform.transform.rotation.y, transform.transform.rotation.z, transform.transform.rotation.w); Eigen::Quaternionf rotation(quaternion.w(), quaternion.x(), quaternion.y(), quaternion.z()); Eigen::Vector3f eigen_origin; tf2::Vector3 origin( transform.transform.translation.x, transform.transform.translation.y, transform.transform.translation.z); vectorTfToEigen(origin, eigen_origin); Eigen::Translation3f translation(eigen_origin); transformation = translation * rotation; } velodyne_laserscan_node velodyne_laserscan_nodeëŠ” sensor_msgs::msg::PointCloud2 dataë¥¼ sensor_msgs::msg::LaserScanë¡œ ë³€í™˜ í›„ /scan topicìœ¼ë¡œ publish í•˜ëŠ” nodeì…ë‹ˆë‹¤. 3D pointcloudë§Œ ì‚¬ìš©í•œë‹¤ë©´ ì¼ë°˜ì ìœ¼ë¡œ í•„ìš” ì—†ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.\ní´ë˜ìŠ¤ header fileì„ í†µí•´ ê°„ë‹¨íˆ ê¸°ëŠ¥ë§Œ ë¦¬ë·°í•´ë´…ì‹œë‹¤. namespace velodyne_laserscan { class VelodyneLaserScan final : public rclcpp::Node { public: explicit VelodyneLaserScan(const rclcpp::NodeOptions \u0026amp; options); ... private: void recvCallback(const sensor_msgs::msg::PointCloud2::SharedPtr msg); rclcpp::Subscription\u0026lt;sensor_msgs::msg::PointCloud2\u0026gt;::SharedPtr sub_; rclcpp::Publisher\u0026lt;sensor_msgs::msg::LaserScan\u0026gt;::SharedPtr pub_; uint16_t ring_count_{0}; int ring_; double resolution_; }; } // namespace velodyne_laserscan PointCloud2 topicì„ subscribe ë°›ê³  ì´ ë°ì´í„°ë¥¼ LaserScanìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. (subscribe callback) ë§ˆì§€ë§‰ìœ¼ë¡œ ë³€í™˜ëœ ë°ì´í„°ë¥¼ scan topicìœ¼ë¡œ ë‹¤ì‹œ publishí•©ë‹ˆë‹¤. ì½”ë“œë¥¼ ë¶„ì„í•˜ë©´ì„œ ë³´ì‹œë‹¤ì‹œí”¼ ëª¨ë“  Node êµ¬í˜„ì€ Compositionì„ ê³ ë ¤í•˜ì—¬ ë§Œë“¤ì–´ì¡ŒìŠµë‹ˆë‹¤. ë”°ë¼ì„œ CMakeLists.txtë¥¼ ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ rclcpp_components_register_nodes í‚¤ì›Œë“œë“¤ì„ í†µí•´ ê°™ì€ ì½”ë“œë¡œ Compositionì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. target_link_libraries(velodyne_driver velodyne_input) # install runtime and library files install(TARGETS velodyne_driver ARCHIVE DESTINATION lib LIBRARY DESTINATION lib RUNTIME DESTINATION bin ) rclcpp_components_register_nodes(velodyne_driver \u0026#34;velodyne_driver::VelodyneDriver\u0026#34;) velodyne_msgs velodyne_msgs íŒ¨í‚¤ì§€ì—ëŠ” VelodynePacket, VelodyneScanë¼ëŠ” ë‘ ì¢…ë¥˜ì˜ custom messageë¥¼ ì •ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì£¼ë¡œ velodyne ìì²´ì˜ í”„ë¡œí† ì½œ íŒ¨í‚·ì„ ë‹¤ë£¨ê¸° ìœ„í•œ ê²ƒìœ¼ë¡œ ROS 2 ë°ì´í„° ë³€í™˜ ì‹œ ì¤‘ê°„ ë°ì´í„° êµ¬ì¡°ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.\n\u0026gt; VelodynePacket.msg # Raw Velodyne LIDAR packet. builtin_interfaces/Time stamp # packet timestamp uint8[1206] data # packet contents \u0026gt; VelodyneScan.msg # Velodyne LIDAR scan packets. std_msgs/Header header # standard ROS message header VelodynePacket[] packets # vector of raw packets orbbec astra camera ROS 2 íŒ¨í‚¤ì§€ ë¶„ì„ ì´ë²ˆ ì‹œê°„ì—ëŠ” Orbbec Astra+ Development Kitì˜ ROS 2 ì‹¤í–‰ê³¼ ë¶„ì„ì„ ì§„í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤. ì‹¤ì œ ì‚¬ìš©ë  ì¹´ë©”ë¼ì™€ ì½”ë“œì´ë¯€ë¡œ ì¢€ ë” ìì„¸í•˜ê²Œ ë¶„ì„í•´ë³´ë ¤ í•©ë‹ˆë‹¤. ì´ì „ ì„¼ì„œ íŒ¨í‚¤ì§€ë“¤ê³¼ ë¹„êµí•˜ë©´ì„œ ë”°ë¼ì™€ ì£¼ì„¸ìš”!\nê°œë°œí™˜ê²½ ì„¤ì • í•„ìš”í•œ apt packageë“¤ê³¼ ROS 2 packageë“¤ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤. sudo apt install libgflags-dev nlohmann-json3-dev sudo apt install ros-foxy-image-transport ros-foxy-image-publisher ë¹Œë“œ ì¢…ì†ì„±ì¸ glogì„ ì„¤ì¹˜í•©ë‹ˆë‹¤. wget -c https://github.com/google/glog/archive/refs/tags/v0.6.0.tar.gz -O glog-0.6.0.tar.gz tar -xzvf glog-0.6.0.tar.gz cd glog-0.6.0 mkdir build \u0026amp;\u0026amp; cd build cmake .. \u0026amp;\u0026amp; make -j4 sudo make install sudo ldconfig # Refreshing the link library ë‹¤ìŒìœ¼ë¡œ, ë¹Œë“œ ì¢…ì†ì„±ì¸ magic_enumì„ ì„¤ì¹˜í•©ë‹ˆë‹¤. wget -c https://github.com/Neargye/magic_enum/archive/refs/tags/v0.8.0.tar.gz -O magic_enum-0.8.0.tar.gz tar -xzvf magic_enum-0.8.0.tar.gz cd magic_enum-0.8.0 mkdir build \u0026amp;\u0026amp; cd build cmake .. \u0026amp;\u0026amp; make -j4 sudo make install sudo ldconfig # Refreshing the link library ì´ë²ˆ ì‹¤ìŠµì„ ìœ„í•´ ì‚¬ìš©ëœ ì½”ë“œëŠ” 2022-07-15 ë²„ì „ Orbbec SDK Beta for ROSì…ë‹ˆë‹¤. ( ì´í›„ ì—…ë°ì´íŠ¸ ì‹œ ì½”ë“œ ë³€ê²½ì´ ìˆì„ ìˆ˜ ìˆì–´ ëª…í™•íˆ ëª…ì‹œí•˜ê² ìŠµë‹ˆë‹¤. â‡’ download link)\në‹¤ìš´ë¡œë“œ ë°›ì€ source codeë¥¼ ì›í•˜ëŠ” workspaceì— ìœ„ì¹˜ì‹œí‚¨ ë’¤, ê°œë°œë¬¸ì„œì—ì„œ ìš”êµ¬í•˜ëŠ” usb rule ì¶”ê°€ ì‘ì—…ì„ ì§„í–‰í•©ë‹ˆë‹¤. cd orbbec_camera/scripts sudo bash install.sh sudo udevadm control --reload-rules \u0026amp;\u0026amp; sudo udevadm trigger í•´ë‹¹ ì‘ì—… í›„ í˜¹ì‹œ ëª¨ë¥¼ ì˜¤ë¥˜ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ì¬ë¶€íŒ…ì„ ê¶Œì¥ë“œë¦¬ë©°, ì¹´ë©”ë¼ë¥¼ ì—°ê²°í•œ ë’¤ ì¥ì¹˜ ì¸ì‹ì´ ë˜ëŠ”ì§€ í™•ì¸í•´ë´…ì‹œë‹¤. $ ls /dev | grep Astra Astra+ Astra+_rgb ì†ŒìŠ¤ì½”ë“œë¥¼ ë¹Œë“œí•˜ë©°, ê³µì‹ ë¬¸ì„œì—ì„œëŠ” Release buildë¥¼ ì œì‹œí•˜ê³  ìˆì–´ ê·¸ëŒ€ë¡œ ì§„í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤. cd ~/ros2_ws/src colcon build --event-handlers console_direct+ --cmake-args -DCMAKE_BUILD_TYPE=Release ë¹Œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆë‹¤ë©´ íŒ¨í‚¤ì§€ë¥¼ í•˜ë‚˜í•˜ë‚˜ì”© ë¹Œë“œí•˜ë©° ì›ì¸ì„ ë¶„ì„í•´ë´…ë‹ˆë‹¤.\ncolcon build --packages-select orbbec_camera_msgs --event-handlers console_direct+ --cmake-args -DCMAKE_BUILD_TYPE=Release source install/local_setup.bash colcon build --packages-select orbbec_camera --event-handlers console_direct+ --cmake-args -DCMAKE_BUILD_TYPE=Release source install/local_setup.bash Getting started ë¹Œë“œê°€ ì™„ë£Œë˜ì—ˆë‹¤ë©´ ê¸°ë³¸ ì˜ˆì‹œë¥¼ ì‚¬ìš©í•´ë´…ì‹œë‹¤.\nì œê³µë˜ëŠ” ì´ˆê¸° ì½”ë“œ parameterê°€ ì•„ë‹Œ, default parameterë¥¼ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤. launch fileì—ì„œ ì•„ë˜ì™€ ê°™ì´ parameterë¥¼ ì„¤ì •ì„ ì œê±°í•˜ê³  ì‹¤í–‰í•©ì‹œë‹¤. from launch import LaunchDescription from launch_ros.actions import Node from ament_index_python import get_package_share_directory def generate_launch_description(): ob_params_file = ( get_package_share_directory(\u0026#34;orbbec_camera\u0026#34;) + \u0026#34;/params/astra_plus_params.yaml\u0026#34; ) return LaunchDescription( [ Node( package=\u0026#34;orbbec_camera\u0026#34;, namespace=\u0026#34;camera\u0026#34;, name=\u0026#34;camera\u0026#34;, executable=\u0026#34;orbbec_camera_node\u0026#34;, output=\u0026#34;screen\u0026#34;, # parameters=[ob_params_file], ), ] ) astra_plus.launch ì˜ˆì œë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. cd \u0026lt;my_ws\u0026gt; source install/local_setup.bash ros2 launch orbbec_camera astra_plus.launch.py ... [orbbec_camera_node-1] [WARN] [1683197732.405664220] [camera.camera]: Using default profile instead. [orbbec_camera_node-1] [WARN] [1683197732.405680938] [camera.camera]: default FPS 15 [orbbec_camera_node-1] [INFO] [1683197732.413525012] [camera.camera]: stream color is enabled - width: 2048, height: 1536, fps: 30, Format: OB_FORMAT_MJPG [orbbec_camera_node-1] [WARN] [1683197732.427355527] [camera.camera]: Publishing dynamic camera transforms (/tf) at 10 Hz custom interfaceë“¤ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— workspace sourcingì´ ë°˜ë“œì‹œ í•„ìš”í•©ë‹ˆë‹¤.\npublishë˜ê³  ìˆëŠ” topicë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. $ ros2 topic list /camera/color/camera_info /camera/color/image_raw /camera/depth/camera_info /camera/depth/color/points /camera/depth/image_raw /camera/depth/points /camera/extrinsic/depth_to_color /camera/ir/camera_info /camera/ir/image_raw /clicked_point /goal_pose /initialpose /parameter_events /rosout /tf /tf_static íŠ¹ì´í•œ ì ìœ¼ë¡œ, ì¹´ë©”ë¼ ì‚¬ì´ ì¢Œí‘œê³„ ê°’ì„ depth_to_colorë¼ëŠ” ì´ë¦„ì˜ topicìœ¼ë¡œ publishí•˜ê³  ìˆìŠµë‹ˆë‹¤. $ ros2 topic echo --qos-durability=transient_local /camera/extrinsic/depth_to_color --qos-profile=services_default header: stamp: sec: 0 nanosec: 0 frame_id: depth_to_color_extrinsics rotation: - 0.9999811053276062 - -0.006122155115008354 - -0.0005165112670511007 - 0.006124507170170546 - 0.9999702572822571 - 0.004682439845055342 - 0.0004878292966168374 - -0.004685514606535435 - 0.9999889135360718 translation: - -25.19551658630371 - -0.30450138449668884 - 1.0939441919326782 --- rviz2ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì‹œê°í™”í•´ë´…ì‹œë‹¤. ì£¼ì˜í•´ì•¼ í•  ì ìœ¼ë¡œ, pointcloud2 topicì˜ DDS QoSë¥¼ ì•„ë˜ì™€ ê°™ì´ ì˜ ë§ì¶°ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.\në”ë¶ˆì–´, color pointcloud2 topicì˜ ìƒ‰ìƒì„ í™•ì¸í•˜ê¸° ìœ„í•´ì„œëŠ” rviz2 ì˜µì…˜ì„ ì•„ë˜ì™€ ê°™ì´ ë§ì¶°ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.\ní˜¹ì€, ì œê°€ ì œê³µë“œë¦¬ëŠ” rvizíŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ configuration í•˜ì…”ë„ ì¢‹ìŠµë‹ˆë‹¤. â‡’ astra rviz download\nì¹´ë©”ë¼ ì„¼ì„œì¸ ë§Œí¼ tf2ë¥¼ ë‹¤ë£° ì‹œ ì¡°ì‹¬í•´ì•¼ í•  ë¶€ë¶„ì´ ìˆìŠµë‹ˆë‹¤. tf2 treeëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. rviz2ë¥¼ í†µí•´ í™•ì¸í•´ë³´ë©´, optical frameë“¤ì€ íšŒì „ëœ camera ì¢Œí‘œ ì²´ê³„ë¥¼ ê°–ëŠ” ê²ƒì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ, astra nodeì˜ parameterë“¤ì„ ì¡°íšŒí•´ë´…ì‹œë‹¤. $ ros2 param list /camera/camera: camera_link_frame_id color_format color_fps color_frame_id color_height color_optical_frame_id color_width d2c_mode ... $ ros2 param get /camera/camera color_format String value is: YUYV í•´ë‹¹ parameterë“¤ì— ë”°ë¼ ì½”ë“œ ì‹¤í–‰ì— ì–´ë–¤ ë³€í™”ê°€ ìˆëŠ”ì§€ ë¶„ì„ì„ í†µí•´ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nì½”ë“œ ë¶„ì„ launch fileì„ í†µí•´ í™•ì¸í–ˆë˜ orbbec_camera_nodeê°€ ì–´ë–»ê²Œ ìƒì„±ë˜ì—ˆëŠ”ì§€ ì¶”ì í•´ë´…ì‹œë‹¤. Node( package=\u0026#34;orbbec_camera\u0026#34;, namespace=\u0026#34;camera\u0026#34;, name=\u0026#34;camera\u0026#34;, executable=\u0026#34;orbbec_camera_node\u0026#34;, output=\u0026#34;screen\u0026#34;, # parameters=[ob_params_file], ), CMakeLists.txtë¥¼ ì‚´í´ë³´ë©´ rclcpp_components_register_nodeë¥¼ í†µí•´ ìƒì„±ë˜ëŠ” orbbec_camera_nodeë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (componentì™€ executableì„ ëª¨ë‘ ë¹Œë“œí•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.) ament_target_dependencies(${PROJECT_NAME} ${dependencies} ) rclcpp_components_register_node(${PROJECT_NAME} PLUGIN \u0026#34;orbbec_camera::OBCameraNodeFactory\u0026#34; EXECUTABLE orbbec_camera_node ) orbbec_camera_nodeì„ êµ¬ì„±í•˜ëŠ” ì½”ë“œë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. add_library(${PROJECT_NAME} SHARED src/dynamic_params.cpp src/ob_camera_node_factory.cpp src/ob_camera_node.cpp src/ros_param_backend.cpp src/ros_service.cpp src/utils.cpp ) Fileë³„ ê¸°ëŠ¥ì„ ë¶„ì„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. Code Description ros_param_backend parameter ë³€ê²½ ì‹œ íŠ¹ì • callbackì´ ì‹¤í–‰ë˜ë„ë¡ binding í•´ì£¼ëŠ” decoratorì…ë‹ˆë‹¤. dynamic_params ROS 2ì—ì„œ ì œê³µë˜ëŠ” ê¸°ë³¸ì ì¸ set_parameterì™€ ìœ ì‚¬í•œ ì—­í• ì„ ìˆ˜í–‰í•˜ëŠ” ê°ì¢… setParameter APIë“¤ì„ êµ¬í˜„í•œ ë¶€ë¶„ì…ë‹ˆë‹¤. (ì•„ë§ˆë„ ë³„ë„ì˜ parameter ë³€ê²½ reject ë¡œì§ì„ êµ¬í˜„í•˜ê³  ì‹¶ì—ˆë˜ ê²ƒ ê°™ìŠµë‹ˆë‹¤.) ob_camera_node ì¼ë°˜ì ì¸ ROS 2 Nodeì˜ ë¡œì§ê³¼, orbbec sdkì˜ pipelineì„ ìœµí•©í•˜ì—¬ êµ¬í˜„í•œ ì½”ë“œì…ë‹ˆë‹¤. ì‹¤ì§ˆì ì¸ topic publish, service serverë“¤ì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ros_service service serverë“¤ì— ëŒ€í•œ cpp êµ¬í˜„ì„ ë³„ë„ë¡œ ë¶„ë¦¬í•œ ì½”ë“œì…ë‹ˆë‹¤. ob_camera_node_factory ob_camera_nodeì—ì„œ êµ¬í˜„í•œ OBCameraNode nodeë¥¼ í¬ì¸í„°ë¡œ ê°–ëŠ” ë³„ë„ì˜ Componentë¥¼ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤. (ì´ ë¶€ë¶„ì€ ROS 2 êµ¬í˜„ ì¸¡ë©´ì—ì„œ ë‹¤ì†Œ ë¯¸ìˆ™í•œ ë¶€ë¶„ì´ë¼ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.) ì£¼ìš” êµ¬í˜„ì€ ob_camera_nodeì— ì‘ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ íŒŒì¼ ë‚´ ë©”ì†Œë“œë“¤ì„ í˜¸ì¶œ ê³„ì¸µ êµ¬ì¡°ì— ë”°ë¼ ì •ë¦¬í•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.\nob_camera_node\nConstructor setupTopics getParameters setupDevices setupProfiles setupDefaultStreamCalibData findDefaultCameraParam updateStreamCalibData setupCameraCtrlServices setupPublishers publishStaticTransforms startPipeline ob::Pipeline ì‹¤í–‰ frameSetCallback publishColorFrame publishDepthFrame publishIRFrame publishPointCloud publishColorPointCloud publishDepthPointCloud setupTopicsì—ì„œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ë“¤ì€ ë‹¤ìŒê³¼ ê°™ì€ ì—­í• ì„ ê°–ìŠµë‹ˆë‹¤.\nFunction Description getParameters dynamic_paramsì— êµ¬í˜„ëœ setParamë¥¼ ì‚¬ìš©í•˜ì—¬ ê°ì¢… ë§¤ê°œë³€ìˆ˜ë“¤ì„ íŒŒì‹±í•˜ê³ , ì„¸íŒ…í•©ë‹ˆë‹¤. setupDevices orbbec sdkë¥¼ ì‚¬ìš©í•˜ì—¬ camera profile, stream dataë“±ì— ëŒ€í•œ ì •ë³´ë¥¼ ì¡°íšŒí•˜ê³  ì €ì¥í•©ë‹ˆë‹¤. setupProfiles getParametersì™€ setupDevicesì—ì„œ ì–»ì€ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ orbbec ì¹´ë©”ë¼ë¥¼ ì…‹ì—…í•©ë‹ˆë‹¤. d2c_modeë“± orbbecë§Œì˜ ê³ ìœ  ì„¤ì •ë“¤ì„ ì…‹ì—…í•˜ëŠ” ì½”ë“œê°€ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. setupDefaultStreamCalibData ë‚´ë¶€ì ìœ¼ë¡œ findDefaultCameraParam / updateStreamCalibDataë¼ëŠ” ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ë©°, ì¹´ë©”ë¼ calibration dataë¥¼ ë°›ì•„ ì…‹ì—…í•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. setupCameraCtrlServices topicì´ ì•„ë‹Œ service serverë“¤ì— ëŒ€í•œ ì„ ì–¸ê³¼ callback mappingë“¤ì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. setupPublishers depth/color/points, depth/points, camera_info, extrinsic/depth_to_color, image_raw ë“±ì˜ topic publisherë“¤ì´ ì„ ì–¸ë˜ê³  ì„¸íŒ…ë©ë‹ˆë‹¤. publishStaticTransforms dynamictf_broadcasterì™€ statictf_broadcasterë¼ëŠ” ë‘ê°œì˜ tf2 broadcastê°€ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. dynamictf_broadcasterì˜ ê²½ìš° publishDynamicTransformsë¼ëŠ” ë©”ì†Œë“œë¥¼ ë³„ë„ threadë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤. (í•˜ì§€ë§Œ ì‹¤ì œ ì¹´ë©”ë¼ ë‚´ë¶€ì—ì„œ ë™ì ìœ¼ë¡œ ë³€í™”í•˜ëŠ” tf2ëŠ” ì—†ìŠµë‹ˆë‹¤.) ëŒ€ë¶€ë¶„ ì„¤ì •ê³¼ ê´€ë ¨ëœ êµ¬í˜„ì´ì§€ë§Œ, ROS 2 êµ¬í˜„ ì¸¡ë©´ì—ì„œ setupPublishersë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. QoS profileì„ ì ìš©í•œ topic publisherë“¤ê³¼ tf broadcasterê°€ ìƒì„±ë˜ê³  ìˆìŠµë‹ˆë‹¤.\nvoid OBCameraNode::setupPublishers() { static_tf_broadcaster_ = std::make_shared\u0026lt;tf2_ros::StaticTransformBroadcaster\u0026gt;(node_); using PointCloud2 = sensor_msgs::msg::PointCloud2; using CameraInfo = sensor_msgs::msg::CameraInfo; point_cloud_publisher_ = node_-\u0026gt;create_publisher\u0026lt;PointCloud2\u0026gt;( \u0026#34;depth/color/points\u0026#34;, rclcpp::QoS{1}.best_effort().keep_last(1)); depth_point_cloud_publisher_ = node_-\u0026gt;create_publisher\u0026lt;PointCloud2\u0026gt;( \u0026#34;depth/points\u0026#34;, rclcpp::QoS{1}.best_effort().keep_last(1)); for (const auto\u0026amp; stream_index : IMAGE_STREAMS) { std::string name = stream_name_[stream_index.first]; std::string topic = name + \u0026#34;/image_raw\u0026#34;; image_publishers_[stream_index] = image_transport::create_publisher(node_, topic); topic = name + \u0026#34;/camera_info\u0026#34;; camera_info_publishers_[stream_index] = node_-\u0026gt;create_publisher\u0026lt;CameraInfo\u0026gt;(topic, rclcpp::QoS{1}.best_effort()); } extrinsics_publisher_ = node_-\u0026gt;create_publisher\u0026lt;orbbec_camera_msgs::msg::Extrinsics\u0026gt;( \u0026#34;extrinsic/depth_to_color\u0026#34;, rclcpp::QoS{1}.transient_local()); } publishStaticTransforms ë©”ì†Œë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. dynamic transformì´ë¼ëŠ” êµ¬í˜„ì´ ë³´ì´ëŠ”ë°, ì‚¬ì‹¤ ì¹´ë©”ë¼ ë‚´ë¶€ì ìœ¼ë¡œëŠ” ì›€ì§ì´ëŠ” ë¶€ë¶„ì´ ì—†ìŠµë‹ˆë‹¤. void OBCameraNode::publishStaticTransforms() { calcAndPublishStaticTransform(); if (tf_publish_rate_ \u0026gt; 0) { tf_thread_ = std::make_shared\u0026lt;std::thread\u0026gt;([this]() { publishDynamicTransforms(); }); } else { static_tf_broadcaster_-\u0026gt;sendTransform(static_tf_msgs_); } } ì½”ë“œ í™•ì¸ ê²°ê³¼, transformì˜ ì˜ë¯¸ë³´ë‹¤ ì‹œê°„ ë™ê¸°í™”ë¥¼ ìœ„í•´ êµ¬í˜„í•´ë‘” ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤. void OBCameraNode::publishDynamicTransforms() { RCLCPP_WARN(logger_, \u0026#34;Publishing dynamic camera transforms (/tf) at %g Hz\u0026#34;, tf_publish_rate_); std::mutex mu; std::unique_lock\u0026lt;std::mutex\u0026gt; lock(mu); while (rclcpp::ok() \u0026amp;\u0026amp; is_running_) { tf_cv_.wait_for(lock, std::chrono::milliseconds((int)(1000.0 / tf_publish_rate_)), [this] { return (!(is_running_)); }); { rclcpp::Time t = node_-\u0026gt;now(); for (auto\u0026amp; msg : static_tf_msgs_) { msg.header.stamp = t; } dynamic_tf_broadcaster_-\u0026gt;sendTransform(static_tf_msgs_); } } } startPipelineì—ì„œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ë“¤ì€ ë‹¤ìŒê³¼ ê°™ì€ ì—­í• ì„ ê°–ìŠµë‹ˆë‹¤. Function Description ob::Pipeline ì‹¤í–‰ orbbec sdkë¡œë¶€í„° pipelineì„ ë‹¤ë£¨ëŠ” í•¸ë“¤ëŸ¬ë¥¼ ë°›ì•„ image streamì„ ì‹œì‘í•©ë‹ˆë‹¤. frameSetCallback setupPublishersì—ì„œ ì„¤ì •í•œ ê°ì¢… topic publisherë“¤ì´ ì‹¤ì§ˆì ì¸ topic publishë¥¼ ìˆ˜í–‰í•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. ì½”ë“œë¥¼ í™•ì¸í•´ë³´ë©´, orbbec SDKì˜ pipelineì„ ì‹¤í–‰í•œ ë’¤, frame callbackê³¼ bindingí•˜ê³  ìˆëŠ” ëª¨ìŠµì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. void OBCameraNode::startPipeline() { if (pipeline_ != nullptr) { pipeline_.reset(); } pipeline_ = std::make_unique\u0026lt;ob::Pipeline\u0026gt;(device_); pipeline_-\u0026gt;start(config_, [this](std::shared_ptr\u0026lt;ob::FrameSet\u0026gt; frame_set) { frameSetCallback(std::move(frame_set)); }); } frameì´ ê°±ì‹ ë  ë–„ë§ˆë‹¤ ì‹¤í–‰ë˜ëŠ” frameSetCallbackì—ì„œëŠ” ê°±ì‹ ëœ ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°ì¢… topic publishë¥¼ ì§„í–‰í•©ë‹ˆë‹¤. void OBCameraNode::frameSetCallback(std::shared_ptr\u0026lt;ob::FrameSet\u0026gt; frame_set) { auto color_frame = frame_set-\u0026gt;colorFrame(); auto depth_frame = frame_set-\u0026gt;depthFrame(); auto ir_frame = frame_set-\u0026gt;irFrame(); if (color_frame \u0026amp;\u0026amp; enable_[COLOR]) { publishColorFrame(color_frame); } if (depth_frame \u0026amp;\u0026amp; enable_[DEPTH]) { publishDepthFrame(depth_frame); } if (ir_frame \u0026amp;\u0026amp; enable_[INFRA0]) { publishIRFrame(ir_frame); } publishPointCloud(frame_set); } publishColorFrame / publishDepthFrame / publishIRFrameì—ì„œëŠ” cv::Mat í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ROS 2 Image msgë¡œ ë³€í™˜í•˜ì—¬ publishí•˜ê³  ìˆìŠµë‹ˆë‹¤. void OBCameraNode::publishColorFrame(std::shared_ptr\u0026lt;ob::ColorFrame\u0026gt; frame) { ... sensor_msgs::msg::Image::SharedPtr img; img = cv_bridge::CvImage(std_msgs::msg::Header(), encoding_.at(stream), image).toImageMsg(); img-\u0026gt;width = width; img-\u0026gt;height = height; img-\u0026gt;is_bigendian = false; img-\u0026gt;step = width * unit_step_size_[stream]; img-\u0026gt;header.frame_id = optical_frame_id_[COLOR]; img-\u0026gt;header.stamp = timestamp; auto\u0026amp; image_publisher = image_publishers_.at(stream); image_publisher.publish(img); } publishPointCloudì—ì„œëŠ” íŠ¹ì • ì¡°ê±´ì— ë”°ë¼ color pointcloud, depth point cloudë¥¼ ì¤€ë¹„ì‹œí‚µë‹ˆë‹¤. ì´ ë¶€ë¶„ ë•Œë¬¸ì— parameterì„¤ì •ì´ ì¤‘ìš”í•©ë‹ˆë‹¤. void OBCameraNode::publishPointCloud(std::shared_ptr\u0026lt;ob::FrameSet\u0026gt; frame_set) { try { if (align_depth_ \u0026amp;\u0026amp; (format_[COLOR] == OB_FORMAT_YUYV || format_[COLOR] == OB_FORMAT_I420)) { if (frame_set-\u0026gt;depthFrame() != nullptr \u0026amp;\u0026amp; frame_set-\u0026gt;colorFrame() != nullptr) { publishColorPointCloud(frame_set); } } if (frame_set-\u0026gt;depthFrame() != nullptr) { publishDepthPointCloud(frame_set); } pointcloudë¥¼ publishí•˜ëŠ” ë¡œì§ì„ ì‚´í´ë³´ë©´ ê³µí†µì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì€ iterator êµ¬í˜„ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ROS 2ì˜ PointCloud2 typeì—ì„œ ì œê³µí•˜ëŠ” APIë¡œ ì†ì‰½ê²Œ ê° point dataë¥¼ append í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ... sensor_msgs::PointCloud2Iterator\u0026lt;float\u0026gt; iter_x(point_cloud_msg_, \u0026#34;x\u0026#34;); sensor_msgs::PointCloud2Iterator\u0026lt;float\u0026gt; iter_y(point_cloud_msg_, \u0026#34;y\u0026#34;); sensor_msgs::PointCloud2Iterator\u0026lt;float\u0026gt; iter_z(point_cloud_msg_, \u0026#34;z\u0026#34;); size_t valid_count = 0; for (size_t point_idx = 0; point_idx \u0026lt; point_size; point_idx++, points++) { bool valid_pixel(points-\u0026gt;z \u0026gt; 0); if (valid_pixel) { *iter_x = static_cast\u0026lt;float\u0026gt;(points-\u0026gt;x / 1000.0); *iter_y = -static_cast\u0026lt;float\u0026gt;(points-\u0026gt;y / 1000.0); *iter_z = static_cast\u0026lt;float\u0026gt;(points-\u0026gt;z / 1000.0); ++iter_x; ++iter_y; ++iter_z; ++valid_count; } } ë§ˆì§€ë§‰ìœ¼ë¡œ ros_service.cpp ì½”ë“œì—ëŠ” ê°ì¢… ì„¤ì •ì„ serviceë¡œ ì œì–´í•  ìˆ˜ ìˆëŠ” ë¡œì§ì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì„ ì‚´í´ë³´ì§€ëŠ” ì•Šê² ì§€ë§Œ, service serverë¥¼ ì„¤ì •í•˜ê³  bindingë˜ëŠ” callbackì„ êµ¬í˜„í•˜ëŠ” ë¶€ë¶„ì´ ë°˜ë³µë©ë‹ˆë‹¤. service_name = \u0026#34;set_\u0026#34; + stream_name + \u0026#34;_exposure\u0026#34;; set_exposure_srv_[stream_index] = node_-\u0026gt;create_service\u0026lt;SetInt32\u0026gt;( service_name, [this, stream_index = stream_index](const std::shared_ptr\u0026lt;SetInt32::Request\u0026gt; request, std::shared_ptr\u0026lt;SetInt32::Response\u0026gt; response) { setExposureCallback(request, response, stream_index); }); ... void OBCameraNode::setExposureCallback(const std::shared_ptr\u0026lt;SetInt32::Request\u0026gt;\u0026amp; request, std::shared_ptr\u0026lt;SetInt32::Response\u0026gt;\u0026amp; response, const stream_index_pair\u0026amp; stream_index) { auto stream = stream_index.first; ... OBCameraNodeFactoryëŠ” OBCameraNode, ob::Device, ob::DeviceInfo ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìŠ¤ë§ˆíŠ¸ í¬ì¸í„°ë¡œ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ êµ¬í˜„ë“¤ë„ í•´ë‹¹ ìŠ¤ë§ˆíŠ¸ í¬ì¸í„° ë‚´ë¶€ì˜ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ì‹ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. void init(); void startDevice(); void getDevice(const std::shared_ptr\u0026lt;ob::DeviceList\u0026gt;\u0026amp; list); void updateDeviceInfo(); void deviceConnectCallback(const std::shared_ptr\u0026lt;ob::DeviceList\u0026gt;\u0026amp; device_list); void deviceDisconnectCallback(const std::shared_ptr\u0026lt;ob::DeviceList\u0026gt;\u0026amp; device_list); void printDeviceInfo(const std::shared_ptr\u0026lt;ob::DeviceInfo\u0026gt;\u0026amp; device_info); std::unique_ptr\u0026lt;OBCameraNode\u0026gt; ob_camera_node_; std::shared_ptr\u0026lt;ob::Device\u0026gt; device_; std::shared_ptr\u0026lt;ob::DeviceInfo\u0026gt; device_info_; ì´ ë¶€ë¶„ì€ êµ¬ì¡°ì ìœ¼ë¡œ ë‹¤ì†Œ ë¹„íš¨ìœ¨ì ì´ë¼ê³  ìƒê°í•©ë‹ˆë‹¤. orbbec ê´€ë ¨ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í´ë˜ìŠ¤ ë³€ìˆ˜ë¡œ ê°–ëŠ” ê²ƒì€ ì´í•´ê°€ ë˜ì§€ë§Œ, ì €ë¼ë©´ Nodeë¥¼ ìŠ¤ë§ˆíŠ¸ í¬ì¸í„°ë¡œ ê°–ì§€ ì•Šê³ , Composition í˜•íƒœë¡œ ë°”ë¡œ êµ¬í˜„í–ˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.\norbbec astra plus modelì˜ ROS 2 íŒ¨í‚¤ì§€ ë¶„ì„ì„ ëìœ¼ë¡œ ëª¨ë“  ì˜ˆì‹œ ë¶„ì„ì„ ë§ˆì³¤ìŠµë‹ˆë‹¤. ì‹¤ì œ ROS 2 package ê°œë°œì— ëŒ€í•œ ì•ˆëª©ì´ ìƒê¸°ì…¨ìœ¼ë¦¬ë¼ ìƒê°í•©ë‹ˆë‹¤.\norbbec gemini 2 ROS 2 íŒ¨í‚¤ì§€ ë¶„ì„ ì´ë²ˆì—ëŠ” Orbbecì˜ ë˜ë‹¤ë¥¸ rgbd cameraì¸ Gemini 2ë¥¼ ROS 2 ì—°ë™í•´ë³´ê² ìŠµë‹ˆë‹¤.\nì¼ì „ Astra Plusë¥¼ ë¶„ì„í•˜ë©° ì¢…ì†ì„± ì„¤ì¹˜ ë“± ë§ì€ ë¶€ë¶„ì„ ì´ë¯¸ í•´ë‘ì—ˆìœ¼ë¯€ë¡œ ì¤‘ë³µë˜ëŠ” ì„¤ì •ì€ ì œì™¸í•˜ì˜€ìŠµë‹ˆë‹¤.\nAstra Plus packageì™€ Gemini 2 packageì˜ ì´ë¦„ì´ ë™ì¼í•©ë‹ˆë‹¤! ë”°ë¼ì„œ ìƒˆë¡œìš´ Workspaceë¥¼ ìƒì„±í•œ ë’¤ ë³„ë„ ë¹Œë“œë¥¼ í•´ì£¼ê² ìŠµë‹ˆë‹¤. cd ~/ mkdir -p gemini_ws/src cd ~/gemini_ws colon build ë§Œì•½ ë‘ packageë¥¼ ê°™ì€ workspaceì—ì„œ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ ì†ŒìŠ¤ì½”ë“œì—ì„œ íŒ¨í‚¤ì§€ ì´ë¦„ì„ ëª¨ì¡°ë¦¬ ì°¾ì•„ë‚´ ë³€ê²½í•˜ë©´ ë©ë‹ˆë‹¤.\nGemini2ì˜ ì¸ì‹ì„ ìœ„í•´ udev-rulesë¥¼ ë‹¤ì‹œ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤. udev-rulesì— ëŒ€í•œ ì„¤ëª…ì€ ë§í¬ë¡œ ëŒ€ì²´í•˜ê² ìœ¼ë©°, ì—¬ëŸ¬ë¶„ë“¤ê»˜ì„œëŠ” í•˜ë‹¨ í„°ë¯¸ë„ ëª…ë ¹ì–´ë¥¼ ë”°ë¼í•˜ì‹œê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤. cd /etc/udev/rules.d sudo rm -rf 99-obsensor-libusb.rules ì´ì œ ìƒˆë¡œìš´ udev-rulesë¥¼ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ Orbbecì—ì„œ ì œê³µí•˜ëŠ” ruleì´ ì ì ˆì¹˜ ì•Šì•„ ì´ë²ˆ ì˜ˆì‹œë¥¼ ìœ„í•´ ì¼ë¶€ ì œê°€ ìˆ˜ì •í•˜ì˜€ìŠµë‹ˆë‹¤. â‡’ OrbbecSDK_ROS2/orbbec_camera/scripts99-obsensor-libusb.rules ìˆ˜ì • # UVC Modules ... SUBSYSTEMS==\u0026#34;usb\u0026#34;, ATTRS{idVendor}==\u0026#34;2bc5\u0026#34;, ATTRS{idProduct}==\u0026#34;0670\u0026#34;, MODE:=\u0026#34;0666\u0026#34;, OWNER:=\u0026#34;root\u0026#34;, GROUP:=\u0026#34;video\u0026#34;, SYMLINK+=\u0026#34;orbbec_gemini_2\u0026#34; ìƒˆë¡œìš´ ruleì„ ë¡œì»¬ í™˜ê²½ì— ì ìš©í•©ì‹œë‹¤. cd \u0026lt;your-ws\u0026gt;/OrbbecSDK_ROS2/orbbec_camera/scripts sudo bash install.sh sudo udevadm control --reload-rules \u0026amp;\u0026amp; sudo udevadm trigger ì´ì œ Gemini2ë¥¼ ì—°ê²°í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì¸ì‹ë˜ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. cd /dev ls | grep gem \u0026gt;\u0026gt; result orbbec_gemini_2 ì˜ˆì‹œ ì‹¤í–‰ ì „, color point cloudë¥¼ ë³´ê³  ì‹¶ë‹¤ë©´ gemini2.launch.xml íŒŒì¼ì˜ parameterë¥¼ ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤. \u0026lt;launch\u0026gt; \u0026lt;!-- unique camera name--\u0026gt; \u0026lt;arg name=\u0026#34;camera_name\u0026#34; default=\u0026#34;camera\u0026#34;/\u0026gt; \u0026lt;!-- Hardware depth registration --\u0026gt; \u0026lt;arg name=\u0026#34;depth_registration\u0026#34; default=\u0026#34;false\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;serial_number\u0026#34; default=\u0026#34;\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;device_num\u0026#34; default=\u0026#34;1\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;vendor_id\u0026#34; default=\u0026#34;0x2bc5\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;product_id\u0026#34; default=\u0026#34;\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;enable_point_cloud\u0026#34; default=\u0026#34;true\u0026#34;/\u0026gt; \u0026lt;!-- from --\u0026gt; \u0026lt;!-- \u0026lt;arg name=\u0026#34;enable_colored_point_cloud\u0026#34; default=\u0026#34;false\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;!-- to --\u0026gt; \u0026lt;arg name=\u0026#34;enable_colored_point_cloud\u0026#34; default=\u0026#34;True\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;point_cloud_qos\u0026#34; default=\u0026#34;default\u0026#34;/\u0026gt; íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œí•˜ê³  ì†Œì‹±í•©ì‹œë‹¤. colcon build --event-handlers console_direct+ --cmake-args -DCMAKE_BUILD_TYPE=Release source install/local_setup.bash gemini2 launchë¥¼ ì‹¤í–‰í•˜ê³ , rviz2ë¡œ ì‹œê°í™”í•´ë´…ì‹œë‹¤. # Terminal 1 ros2 launch orbbec_camera gemini2.launch.xml # Terminal 2 rviz2 ì—¬ëŸ¬ë¶„ë“¤ì´ ì§ì ‘ rviz2 êµ¬ì„±ì„ í•´ë³´ì…”ë„ ì¢‹ê³ , ì œê°€ ì œê³µë“œë¦¬ëŠ” íŒŒì¼ì„ ì‚¬ìš©í•˜ì…”ë„ ë©ë‹ˆë‹¤!\nğŸ“gemini2.rviz\në…¸íŠ¸ë¶, Edge Device ì‚¬ìš© ì‹œ, color point cloud ì‹œê°í™”ë¥¼ ì‹¤í–‰í•˜ë©´ ê¸‰ê²©íˆ ì„±ëŠ¥ì´ ì €í•˜ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ìš°ì¸¡ í•˜ë‹¨ frame rateë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!)\nì˜ˆì œ ì‹¤í–‰ ì‹œ ë™ì‘í•˜ëŠ” topic list, tf2 treeëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. $ ros2 topic list /color/camera_info /color/image_raw /depth/camera_info /depth/color/points /depth/image_raw /depth/points /ir/camera_info /ir/image_raw /parameter_events /rosout /tf /tf_static IMUì— ëŒ€í•œ tf2ì™€ topicì´ ì—†ëŠ” ì ì€ ë§ì´ ì•„ì‰½ìŠµë‹ˆë‹¤.\ní˜¹ì‹œë‚˜ parameterë¡œ IMU on/offë¥¼ ì œì–´í•˜ëŠ”ê°€ ì‹¶ì—ˆì§€ë§Œ param list ê²°ê³¼ ì—†ì—ˆìŠµë‹ˆë‹¤. $ ros2 param list /camera: camera_link_frame_id color_camera_info_qos color_format color_fps color_frame_id color_height color_info_url color_optical_frame_id color_qos color_width depth_camera_info_qos depth_format depth_fps depth_frame_id depth_height depth_optical_frame_id depth_qos depth_registration depth_width device_num enable_color enable_colored_point_cloud enable_depth enable_ir enable_point_cloud enable_publish_extrinsic ir_camera_info_qos ir_format ir_fps ir_frame_id ir_height ir_info_url ir_optical_frame_id ir_qos ir_width log_level point_cloud_qos publish_tf serial_number tf_publish_rate use_sim_time ì½”ë“œ ë¶„ì„ ì½”ë“œ ë¶„ì„ì— ì•ì„œ, launch fileì„ ë¨¼ì € ì–¸ê¸‰í•˜ìë©´, ì¼ì „ astra plus packageì™€ ë‘ë“œëŸ¬ì§„ ì°¨ì´ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ xml ë¬¸ë²•ì€ ROS 1 ì‹œì ˆ ì‚¬ìš©ë˜ì—ˆë˜ ë¬¸ë²•ìœ¼ë¡œ ì‚¬ì‹¤ ìì£¼ ì‚¬ìš©ë˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.\n\u0026lt;launch\u0026gt; \u0026lt;!-- unique camera name--\u0026gt; \u0026lt;arg name=\u0026#34;camera_name\u0026#34; default=\u0026#34;camera\u0026#34;/\u0026gt; ... \u0026lt;group\u0026gt; \u0026lt;node name=\u0026#34;camera\u0026#34; pkg=\u0026#34;orbbec_camera\u0026#34; exec=\u0026#34;orbbec_camera_node\u0026#34; output=\u0026#34;screen\u0026#34;\u0026gt; \u0026lt;param name=\u0026#34;camera_name\u0026#34; value=\u0026#34;$(var camera_name)\u0026#34;/\u0026gt; ... \u0026lt;remap from=\u0026#34;/$(var camera_name)/depth/color/points\u0026#34; to=\u0026#34;/$(var camera_name)/depth_registered/points\u0026#34;/\u0026gt; \u0026lt;/node\u0026gt; \u0026lt;/group\u0026gt; \u0026lt;/launch\u0026gt; ë”ë¶ˆì–´ í•œëˆˆì— ë³´ì•„ë„ parameterë“¤ì´ ì§€ì €ë¶„í•˜ê²Œ ë‚˜ì—´ë˜ì–´ ìˆëŠ” ëª¨ìŠµì´ í™•ì¸ë©ë‹ˆë‹¤. ì €ë¼ë©´ yaml fileë¡œ ë¶„ë¦¬í–ˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤!\nëŒ€ë¶€ë¶„ì˜ ì½”ë“œë“¤ì€ ì´ë¯¸ ë¶„ì„í•˜ì˜€ê¸° ë•Œë¬¸ì— ì´ë²ˆì—ëŠ” ìƒˆë¡­ê²Œ ì¶”ê°€ë˜ê±°ë‚˜ ë³€ê²½ëœ ë‚´ìš©ì„ ìœ„ì£¼ë¡œ ë¶„ì„í•´ë³´ê² ìŠµë‹ˆë‹¤.\nê° Fileë³„ ê¸°ëŠ¥ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. Code Description list_devices_node.cpp ì‹¤í–‰ì¤‘ì¸ ëª¨ë“  ë””ë°”ì´ìŠ¤ë“¤ì„ ì¡°íšŒí•©ë‹ˆë‹¤. multi cameraë¥¼ ìœ„í•œ ë””ë²„ê¹… íˆ´ë¡œ ìœ ì¶”ë©ë‹ˆë‹¤. main.cpp ì¼ë°˜ì ì¸ Node / Spin êµ¬ì¡°ì˜ mainë¬¸ìœ¼ë¡œ ì‚¬ì‹¤ ob_camera_node_factoryë¥¼ í†µí•´ Compositionìœ¼ë¡œ êµ¬í˜„í•´ë‘ì—ˆê¸° ë•Œë¬¸ì— ë¶ˆí•„ìš”í•˜ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤. ob_cleanup_shm.cpp Astraì—ì„œ Node / SDK ì‚¬ì´ í”„ë¡œì„¸ì‹±ì„ threadë¡œ ì²˜ë¦¬í•œ ê²ƒê³¼ ë‹¬ë¦¬ Geminiì—ì„œëŠ” ì„¸ë§ˆí¬ì–´ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ì— ë”°ë¥¸ ìœ í‹¸ë¦¬í‹° ì½”ë“œì…ë‹ˆë‹¤. ob_camera_node.cpp ì‹¤ì§ˆì ì¸ topic publish, service serverë“¤ì´ êµ¬í˜„ë˜ì–´ ìˆë˜ ì½”ë“œì…ë‹ˆë‹¤. ê¸°ëŠ¥ì€ ë™ì¼í•˜ì§€ë§Œ êµ¬ì¡°ì—ì„œ ì°¨ì´ê°€ ë°œìƒí•˜ì˜€ìŠµë‹ˆë‹¤. ob_camera_node_factory.cpp ì„¸ë§ˆí¬ì–´ë¥¼ ì‚¬ìš©í•¨ì— ë”°ë¥¸ êµ¬í˜„ìƒì˜ ì‘ì€ ë³€í™”ê°€ ë°œìƒí•˜ì˜€ìŠµë‹ˆë‹¤. list_devices_node.cppì˜ ë¹Œë“œ ê²°ê³¼ë¬¼ì¸ list_devices_nodeì˜ ì‹¤í–‰ ê²°ê³¼ì…ë‹ˆë‹¤.\nros2 run orbbec_camera list_devices_node ... [I20230510 19:48:22.675072 28664 DeviceManager.cpp:375] Orbbec Gemini 2 Depth Camera [I20230510 19:48:22.675125 28664 DeviceManager.cpp:375] Orbbec Gemini 2 IR Camera [I20230510 19:48:22.675169 28664 DeviceManager.cpp:375] Orbbec Gemini 2 RGB Camera [I20230510 19:48:22.675212 28664 DeviceManager.cpp:375] Orbbec Gemini Data Channel [I20230510 19:48:22.675287 28664 DeviceManager.cpp:375] Orbbec Gemini 2 IMU ob_camera_node.cppì˜ êµ¬ì¡°ë¥¼ ë¶„ì„í•´ë³´ê² ìŠµë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ êµ¬ì¡°ëŠ” ë™ì¼í•˜ë©° ì´ë¦„ì˜ ë³€ê²½ê³¼ êµ¬í˜„ìƒì˜ ì°¨ì´ë§Œ ìˆì„ ë¿ Astra plusì™€ ì¼ë§¥ìƒí†µí•©ë‹ˆë‹¤.\nOBCameraNode\nsetupDefaultImageFormat setupTopics getParameters (ëª‡ê°€ì§€ parameterê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.) setupDevices setupProfiles setupDefaultStreamCalibData setupCameraCtrlServices setupPublishers publishStaticTransforms startPipeline â‡’ startStreams setupPipelineConfig onNewFrameSetCallback color_frame depth_frame ir_frame publishPointCloud onNewFrameSetCallbackì—ì„œ êµ¬í˜„ìƒ ë³€ê²½ì´ ë°œìƒí•˜ì˜€ìœ¼ë©°, Orbbec SDKì™€ ROS 2 Topicì„ ì—°ë™í•˜ëŠ” onNewFrameCallback ë§¤í•‘ì´ ì´ë£¨ì–´ì¡ŒìŠµë‹ˆë‹¤.\nauto color_frame = std::dynamic_pointer_cast\u0026lt;ob::Frame\u0026gt;(frame_set-\u0026gt;colorFrame()); auto depth_frame = std::dynamic_pointer_cast\u0026lt;ob::Frame\u0026gt;(frame_set-\u0026gt;depthFrame()); auto ir_frame = std::dynamic_pointer_cast\u0026lt;ob::Frame\u0026gt;(frame_set-\u0026gt;irFrame()); onNewFrameCallback(color_frame, COLOR); onNewFrameCallback(depth_frame, DEPTH); onNewFrameCallback(ir_frame, INFRA0); publishPointCloud(frame_set); "
},
{
	"uri": "/kr/ros2_foxy/lecture18/",
	"title": "Lecture18. Point Cloud Deep Learning Example (PointNet)",
	"tags": [],
	"description": "",
	"content": "Special Part - Point Cloud Deep Learning Example (PointNet) ì´ë²ˆ ì‹œê°„ì—ëŠ” ROS 2ì™€ ë”¥ëŸ¬ë‹ ëª¨ë¸ì„ ê²°í•©í•˜ì—¬ Applicationì„ êµ¬í˜„í•´ë³´ëŠ” ì˜ˆì‹œë¥¼ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤. ì‚¬ì‹¤ ì œê°€ ë”¥ëŸ¬ë‹ ë¶„ì•¼ì— ì§€ì‹ì€ ë§¤ìš° ì–•ì€ì§€ë¼ ëª¨ë¸ì— ëŒ€í•œ ì„¤ëª…ì€ ë¶ˆê°€í•©ë‹ˆë‹¤. PyTorchë¥¼ í†µí•´ êµ¬í˜„ëœ ì˜¤í”ˆì†ŒìŠ¤ì— ê¸°ë°˜í•˜ì—¬ ë™ì‘í•˜ëŠ” ROS 2 ì½”ë“œë¥¼ ê°œë°œí•˜ëŠ” ë§¥ë½ì— ì§‘ì¤‘í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤!\nì´ë²ˆ ì‹œê°„ ì‚¬ìš©í•  ëª¨ë¸ì€ ìŠ¤íƒ í¬ë“œì˜ PointNetìœ¼ë¡œ, 3D PointCloudì˜ featureë¥¼ ì¶”ì¶œí•˜ëŠ” ê°€ì¥ ëŒ€í‘œì ì¸ ë„¤íŠ¸ì›Œí¬ì…ë‹ˆë‹¤. reference : PointNet: Deep Learning on Point Sets for 3D Classification and Segmentation\npointnet ì˜¤í”ˆì†ŒìŠ¤ì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì€ classificationê³¼ segmentationìœ¼ë¡œ ì´ë²ˆ ì˜ˆì‹œì—ì„œëŠ” classificationì— ì§‘ì¤‘í•´ ë³´ê² ìŠµë‹ˆë‹¤. Model Training ì°¸ê³ ë¡œ, Anacondaì™€ ê°™ì´ íŒŒì´ì¬ ê°€ìƒí™˜ê²½ì„ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ ROS 2 python ì‹œìŠ¤í…œê³¼ í˜¸í™˜ì´ ë¶ˆê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŒŒì´ì¬ ê°€ìƒí™˜ê²½ì— ROS 2 ê´€ë ¨ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ì‹œê±°ë‚˜, ROS 2 python í™˜ê²½ì— torch ë“± í•„ìš” íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.\nModel ì½”ë“œë¥¼ cloneí•˜ê³  í•™ìŠµì„ ìœ„í•´ í•„ìš”í•œ datasetì„ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤. shapenet datasetì˜ ì¼ë¶€ê°€ ë‹¤ìš´ë¡œë“œë©ë‹ˆë‹¤. git clone https://github.com/fxia22/pointnet.pytorch cd pointnet.pytorch pip install -e . cd scripts # build C++ code for visualization bash build.sh # download dataset bash download.sh í˜„ì¬ ë°ëª¨ì—ì„œ ì‚¬ìš©í•˜ëŠ” datasetì€ ì•½ 1.1GBë¡œ ë§¤ìš° ì ì€ ì¢…ë¥˜ì˜ ë¬¼ì²´ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. ë‹¨ì§€ ë¹ ë¥¸ ë°ëª¨ë¥¼ ìœ„í•´ ì´ë ‡ê²Œ ì ìš©í•˜ëŠ” ì ì— ìœ ì˜í•˜ì„¸ìš”!\nPointNetì„ í•™ìŠµ ì‹œì¼œë´…ì‹œë‹¤. segmentationê³¼ classification ì¤‘ ì›í•˜ëŠ” ìƒí™©ì— ë§ì¶”ì–´ trainingì„ ì§„í–‰í•©ë‹ˆë‹¤. datasetì´ ì•½ 1GBì´ê¸° ë•Œë¬¸ì— epochì„ 25ë¡œ í•˜ì—¬ë„ ì‹œê°„ì€ ì˜¤ë˜ ê±¸ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤. cd utils python train_classification.py --dataset \u0026lt;dataset path\u0026gt; --nepoch=\u0026lt;number epochs\u0026gt; --dataset_type \u0026lt;modelnet40 | shapenet\u0026gt; python train_segmentation.py --dataset \u0026lt;dataset path\u0026gt; --nepoch=\u0026lt;number epochs\u0026gt; # example python3 train_segmentation.py --dataset /home/kimsooyoung/Downloads/pointnet.pytorch/shapenetcore_partanno_segmentation_benchmark_v0 --nepoch=24 python3 train_classification.py --dataset /home/kimsooyoung/Downloads/pointnet.pytorch/shapenetcore_partanno_segmentation_benchmark_v0 --nepoch=24 --dataset_type shapenet Training ê²°ê³¼ë¡œ cls, seg í´ë” ë‚´ pth íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤. Confirm Trained Parameters ROS 2 ì—°ë™ ì „ í•™ìŠµëœ pth ëª¨ë¸ì„ ê²€ì¦í•´ë´…ì‹œë‹¤. ë³„ë„ì˜ cloneì€ í•„ìš” ì—†ìœ¼ë©° ì˜¤í”ˆ ì†ŒìŠ¤ì˜ ìˆ˜ì •ìœ¼ë¡œ ì œê°€ ë¯¸ë¦¬ ì¤€ë¹„í•œ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.\ní•´ë‹¹ ì½”ë“œëŠ” isl-orgì˜ ì˜¤í”ˆì†ŒìŠ¤ì— ê¸°ë°˜í•˜ì˜€ìŠµë‹ˆë‹¤. â‡’ https://github.com/isl-org/Open3D-PointNet\nê²€ì¦ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ì¶”ê°€ íŒ¨í‚¤ì§€ë¥¼ ë‹¤ìš´ë¡œë“œ ë°›ìŠµë‹ˆë‹¤. pip install torchvision pip install open3d pip install --upgrade numpy ì œê³µëœ ê²€ì¦ ì½”ë“œ ë‚´ë¶€ ëª¨ë¸ ê²½ë¡œì™€ dataset ê²½ë¡œë¥¼ ìˆ˜ì •í•œ ë’¤, ì˜ˆì‹œ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. cd Open3D-PointNet pip install -r requirements.txt # ì½”ë“œ ì¤‘ ì•„ë˜ ë‚´ìš© ìˆ˜ì • NUM_POINTS = 10000 MODEL_PATH = \u0026#39;/home/kimsooyoung/Downloads/pointnet.pytorch/utils/cls/cls_model_23.pth\u0026#39; DATA_FOLDER = \u0026#39;/home/kimsooyoung/Downloads/pointnet.pytorch/shapenetcore_partanno_segmentation_benchmark_v0\u0026#39; # ë°ëª¨ ì‹¤í–‰ python3 pointnet_test.py prediction ê²°ê³¼ vectorì™€ pointcloud ë°ì´í„°ë¥¼ ì‹œê°í™”í•´ì„œ ë³´ì—¬ì¤ë‹ˆë‹¤.\ní˜„ì¬ datasetìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆëŠ” í•­ëª©ë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ê³„ì†í•´ì„œ ì´ì•¼ê¸°í•˜ì§€ë§Œ dataset ìì²´ì˜ í•œê³„ë¡œ ê²€ì¶œí•  ìˆ˜ ìˆëŠ” ê°ì²´ê°€ ë§ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤. ğŸ˜… # Problem ontology classes_dict = {\u0026#39;Airplane\u0026#39;: 0, \u0026#39;Bag\u0026#39;: 1, \u0026#39;Cap\u0026#39;: 2, \u0026#39;Car\u0026#39;: 3, \u0026#39;Chair\u0026#39;: 4, \u0026#39;Earphone\u0026#39;: 5, \u0026#39;Guitar\u0026#39;: 6, \u0026#39;Knife\u0026#39;: 7, \u0026#39;Lamp\u0026#39;: 8, \u0026#39;Laptop\u0026#39;: 9, \u0026#39;Motorbike\u0026#39;: 10, \u0026#39;Mug\u0026#39;: 11, \u0026#39;Pistol\u0026#39;: 12, \u0026#39;Rocket\u0026#39;: 13, \u0026#39;Skateboard\u0026#39;: 14, \u0026#39;Table\u0026#39;: 15} PointNet ROS 2 ì—°ë™ ë“œë””ì–´ ROS 2ì™€ PointNetì„ ì—°ë™ì‹œì¼œë³´ë ¤ í•©ë‹ˆë‹¤. ê°œë°œì˜ ì‹œì‘ ì „, í•­ìƒ ì–´ë– í•œ ê¸°ëŠ¥ì„ êµ¬í˜„í•´ì•¼ í•˜ëŠ”ì§€, ì´ë¯¸ ê°œë°œ ê°€ëŠ¥í•œ ê²ƒì„ ë¬´ì—‡ì´ê³  ìƒˆë¡­ê²Œ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ê²ƒì€ ë¬´ì—‡ì¸ì§€ ìŠµê´€ì ìœ¼ë¡œ êµ¬ì²´í™”ì‹œí‚¤ì‹œê¸¸ ë°”ëë‹ˆë‹¤.\nshapenet datasetì´ ì•„ë‹Œ, Gazeboë¡œë¶€í„°ì˜ Raw PointCloudë¥¼ subscribeí•˜ì—¬ ë¬¼ì²´ ì¸ì‹ì„ í•˜ê³ ì í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•œ Gazebo í™˜ê²½ì€ ì¼ì „ì˜ rgbd worldë¥¼ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤. ì„¼ì„œë¡œë¶€í„°ì˜ raw Point Cloudì—ì„œ ë°”ë‹¥ì„ ì œê±°í•˜ê³  ë¬¼ì²´ë³„ë¡œ clusteringì„ í•˜ëŠ” ì‘ì—… ë˜í•œ ì¼ì „ êµ¬í˜„í•œ ë°” ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ìš°ë¦¬ëŠ” ì•½ê°„ì˜ ìˆ˜ì •ê³¼ ë§ˆì§€ë§‰ Node, Clusteringëœ pointcloudë¥¼ ë°›ì•„ ì–´ë–¤ ë¬¼ì²´ì¸ì§€ íŒë‹¨í•˜ëŠ” ê¸°ëŠ¥ë§Œ êµ¬í˜„í•˜ë©´ ë©ë‹ˆë‹¤. ì•ì„  ë‚´ìš©ë“¤ì„ ì˜ ìƒê°í•˜ë©´ì„œ, ì˜ˆì‹œë¶€í„° ì‹¤í–‰í•´ë´…ì‹œë‹¤. # Terminal 1 - gazebo launch ros2 launch rgbd_world pointnet_world.launch.py # Terminal 2 - object spawn ros2 run py_service_tutorial pointnet_object_wo_gravity # Terminal 3 - clustering ros2 run py_pcl_tutorial pointnet_cluster_pub # Terminal 4 - torch classification ros2 run pointnet_torch pointnet_torch ë§ˆì§€ë§‰ í„°ë¯¸ë„ì—ì„œ ê²€ì¶œëœ ë¬¼ì²´ì™€ ì •í™•ë„ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì˜ˆì œ ì‹¤í–‰ ì‹œ gpu ë©”ëª¨ë¦¬ ì œí•œì— ë”°ë¥¸ ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ gpu ì ìœ ìœ¨ì„ í™•ì¸í•˜ë©° ì‹¤í–‰ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤. nvidia-smi -l 1 ì½”ë“œ ë¶„ì„ í•™ìŠµëœ datasetê³¼ 3DGEMSë¥¼ í†µí•´ í™•ë³´í•œ gazebo model ì¤‘ ê²¹ì¹˜ëŠ” ê²ƒë“¤ì„ ë¨¼ì € í™•ì¸í•´ë³´ì•˜ìŠµë‹ˆë‹¤. í™•ì¸ëœ ëª¨ë¸ë“¤ì´ ë“±ì¥í•˜ë„ë¡ Model spawn service clientì˜ ì½”ë“œë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤ def send_spawn_req(self): # model_name = \u0026#34;beer\u0026#34; model_id = input(\u0026#34;\u0026#34;\u0026#34;Enter Model name Among Below List 1.chair_1 \\t2.chair_2 \\t3.chair_3 4.labtop_mac_1 \\t5.labtop_mac_2 \\t6.labtop_mac_3 7.cup_green \\t8.cup_blue \\t9.cup_yellow 10.cup_paper \\t11.lamp_table_large \\t12.lamp_table_small 13.side_table_1 \\t14.side_table_3 \\t15.side_table_set_1 16.side_table_set_2 \\t17.table_dining \\t18.cafe_table [Type your choice]: \u0026#34;\u0026#34;\u0026#34;) ë‹¤ìŒìœ¼ë¡œ Clustering ì½”ë“œë¥¼ ìˆ˜ì •í•´ë³´ê² ìŠµë‹ˆë‹¤. Topic ì´ë¦„ ë³€ê²½ê³¼ ë”ë¶ˆì–´ ì „ì²˜ë¦¬ ê³¼ì • ì¤‘ Voxel gridì™€ RANSACë§Œ ì ìš©í•˜ë„ë¡ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤. # RANSAC plane segmentation # Create the segmentation object seg = cloud_voxed.make_segmenter() ... # Extract inliers extracted_inliers = cloud_voxed.extract(inliers, negative=True) # inliers into list for ROS 2 Conversion color_cluster_point_list = [] # cloud size color generator color = size_color_gen(extracted_inliers) for i, indices in enumerate(extracted_inliers): color_cluster_point_list.append([extracted_inliers[i][0], extracted_inliers[i][1], extracted_inliers[i][2], rgb_to_float(color)]) ì¹´ë©”ë¼ê°€ í•œìª½ ë°©í–¥ë§Œì„ ì¸ì§€í•˜ì—¬ ì•„ë˜ì™€ ê°™ì´ ê°ì²´ê°€ ë¶„ë¦¬ë˜ëŠ” ìƒí™©ì´ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— ì•Œê³ ë¦¬ì¦˜ì„ ê°„ì†Œí™”í•˜ì˜€ìŠµë‹ˆë‹¤.\në§ˆì§€ë§‰ìœ¼ë¡œ PointCloud2 topicì„ í†µí•´ Inferenceë¥¼ ì‹¤í–‰í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.\nìƒì„±ìì—ì„œ Tuningëœ parameterë¥¼ uploadí•˜ì—¬ classifierë¥¼ ìƒì„±í•©ë‹ˆë‹¤. class PointNetNode(Node): def __init__(self): super().__init__(\u0026#39;pointnet_cls_node\u0026#39;) self.declare_parameter(\u0026#39;model_path\u0026#39;, \u0026#39;/home/kimsooyoung/Downloads/pointnet/pointnet.pytorch/utils/cls/cls_model_23.pth\u0026#39;) self.declare_parameter(\u0026#39;num_points\u0026#39;, 10000) MODEL_PATH = self.get_parameter(\u0026#39;model_path\u0026#39;).value NUM_POINTS = self.get_parameter(\u0026#39;num_points\u0026#39;).value # Create the classification network from pre-trained model self.classifier = PointNetCls(k=len(classes_dict.items()), num_points=NUM_POINTS) if torch.cuda.is_available(): self.classifier.cuda() self.classifier.load_state_dict(torch.load(MODEL_PATH)) else: self.classifier.load_state_dict(torch.load(MODEL_PATH, map_location=\u0026#39;cpu\u0026#39;)) self.classifier.eval() callbackì—ì„œëŠ” PointCloud2 í˜•ì‹ì˜ ë°ì´í„°ë¥¼ subscribe í•œ ë’¤ numpy.asarrayë¡œ ë³€í˜•í•˜ì—¬ pytorchì—ê²Œ ë„˜ê¸¸ ì¤€ë¹„ë¥¼ í•©ë‹ˆë‹¤. def obj_callback(self, msg): # 1. Convert PointCloud2 message to numpy array points_list = [] for data in pc2.read_points(msg, skip_nans=True): points_list.append([data[0], data[1], data[2]]) points = np.asarray(points_list, dtype=np.float32) # 2. numpy resample m, n = points.shape choice = np.random.choice(m, 10000, replace=True) point_set = points[choice, :] # 3. numpy to torch point_set = torch.from_numpy(point_set) classifierë¥¼ í†µí•œ Interenceí›„ ê²€ì¶œ ê²°ê³¼ëŠ” ë‹¤ì‹œ cpuë¡œ ë„˜ì–´ì˜¨ ë’¤ ì½˜ì†” ì¶œë ¥ë©ë‹ˆë‹¤. # 4. perform inference in GPU if self.cb_flag == True: points = Variable(point_set.unsqueeze(0)) points = points.transpose(2, 1) if torch.cuda.is_available(): points = points.cuda() pred_logsoft, _ = self.classifier(points) # move data back to cpu pred_logsoft_cpu = pred_logsoft.data.cpu().numpy().squeeze() pred_soft_cpu = np.exp(pred_logsoft_cpu) pred_class = np.argmax(pred_soft_cpu) self.get_logger().info(f\u0026#39;Your object is a [{list(classes_dict.keys())[pred_class]}]\u0026#39;) self.get_logger().info(\u0026#39;Probability is a [{:0.3}]\u0026#39;.format(pred_soft_cpu[pred_class])) ì „ì²´ ì‹œìŠ¤í…œì„ rqt graphë¡œ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ì•ì„œ ê°œìš”ë¡œ ì„¤ëª…í–ˆë˜ Nodeë“¤ì— ìœ ì˜í•˜ë©° ì°¨ê·¼ì°¨ê·¼ ë¶„ì„í•´ë³´ì„¸ìš”!! "
},
{
	"uri": "/kr/ros2_foxy/lecture19/",
	"title": "Lecture19. Orbbec ROS 2 Package - Final",
	"tags": [],
	"description": "",
	"content": " ê°•ì˜ ë„ì¤‘ (2022ë…„ 5ì›”) Orbbec ROS 2 SDKê°€ ì—…ë°ì´íŠ¸ë¨ì— ë”°ë¼ ìƒˆë¡­ê²Œ ë¶„ì„ì„ ì§„í–‰í•´ë³´ì•˜ìŠµë‹ˆë‹¤.\nê°•ì˜ì—ì„œ ì‚¬ìš©ë˜ëŠ” íŒ¨í‚¤ì§€ ë²„ì „ì€ ì•„ë˜ ì‚¬ì§„ê³¼ ê°™ì´ 2023-05-15 ë²„ì „ì…ë‹ˆë‹¤.\nìƒˆë¡­ê²Œ ë¶„ì„í•œë‹¤ëŠ” ë§ˆìŒìœ¼ë¡œ launch fileë¶€í„° ì°¨ê·¼ì°¨ê·¼ ë¶„ì„í•´ë‚˜ê°€ê² ìŠµë‹ˆë‹¤. ğŸ˜‚\ngemini2.launch.xml - xml ë¬¸ë²•ìœ¼ë¡œ êµ¬ì„±ëœ launch fileë¡œ ì‹¤ì§ˆì ìœ¼ë¡œ ì‹¤í–‰ì‹œí‚¤ëŠ” ê²ƒì€ orbbec_camera_nodeë¼ëŠ” ì´ë¦„ì˜ ë‹¨ì¼ Nodeì…ë‹ˆë‹¤. \u0026lt;node name=\u0026#34;camera\u0026#34; pkg=\u0026#34;orbbec_camera\u0026#34; exec=\u0026#34;orbbec_camera_node\u0026#34; output=\u0026#34;screen\u0026#34;\u0026gt; orbbec_camera_nodeê°€ ìƒì„±ë˜ëŠ” ì½”ë“œë¥¼ ë¶„ì„í•˜ê¸° ìœ„í•´ CMakeLists.txtë¥¼ ì‚´í´ë´…ì‹œë‹¤. main.cppë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŒì´ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. add_executable(${PROJECT_NAME}_node src/main.cpp ) main.cppì—ì„œëŠ” SingleThreaded Executorì™€ OBCameraNodeDriverë¼ëŠ” Nodeë¥¼ spiní•˜ê³  ìˆìŠµë‹ˆë‹¤. #include \u0026lt;rclcpp/rclcpp.hpp\u0026gt; #include \u0026lt;orbbec_camera/ob_camera_node_driver.h\u0026gt; int main(int argc, char** argv) { rclcpp::init(argc, argv); rclcpp::NodeOptions options; using namespace orbbec_camera; auto node = std::make_shared\u0026lt;OBCameraNodeDriver\u0026gt;(options); rclcpp::spin(node); rclcpp::shutdown(); return 0; } OBCameraNodeDriverë¥¼ ë¶„ì„í•´ë³´ê¸° ìœ„í•´ í•´ë‹¹ êµ¬í˜„ì„ ë‹´ê³  ìˆëŠ” ob_camera_node_driver.cpp íŒŒì¼ì„ ì‚´í´ë´…ì‹œë‹¤. config fileì„ Nodeë‚´ì—ì„œ ì§ì ‘ ë¶ˆëŸ¬ì˜¤ëŠ” ëª¨ìŠµê³¼, init() ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ê³  ìˆìŒì´ í™•ì¸ë©ë‹ˆë‹¤.\nnamespace orbbec_camera { OBCameraNodeDriver::OBCameraNodeDriver(const rclcpp::NodeOptions \u0026amp;node_options) : Node(\u0026#34;orbbec_camera_node\u0026#34;, \u0026#34;/\u0026#34;, node_options), config_path_(ament_index_cpp::get_package_share_directory(\u0026#34;orbbec_camera\u0026#34;) + \u0026#34;/config/OrbbecSDKConfig_v1.0.xml\u0026#34;), ctx_(std::make_unique\u0026lt;ob::Context\u0026gt;(config_path_.c_str())), logger_(this-\u0026gt;get_logger()) { init(); } OrbbecSDKConfig_v1.0.xmlì€ ì¤‘êµ­ì–´ë¡œ ì£¼ì„ì´ ë˜ì–´ìˆì–´ ì •í™•íˆ ë¶„ì„í•  ìˆ˜ëŠ” ì—†ì—ˆì§€ë§Œ, ê°ì¢… ì¹´ë©”ë¼ë“¤ì˜ ê¸°ë³¸ ì„¤ì •ê°’ì„ ë‹´ê³  ìˆëŠ” íŒŒì¼ë¡œ ì¶”ì¸¡ë©ë‹ˆë‹¤. \u0026lt;Gemini\u0026gt; \u0026lt;Depth\u0026gt; \u0026lt;!--é»˜è®¤åˆ†è¾¨ç‡çš„å®½ï¼Œintç±»å‹--\u0026gt; \u0026lt;Width\u0026gt;640\u0026lt;/Width\u0026gt; \u0026lt;!--é»˜è®¤åˆ†è¾¨ç‡çš„é«˜ï¼Œintç±»å‹--\u0026gt; \u0026lt;Height\u0026gt;400\u0026lt;/Height\u0026gt; \u0026lt;!--é»˜è®¤å¸§ç‡ï¼Œintç±»å‹--\u0026gt; \u0026lt;FPS\u0026gt;30\u0026lt;/FPS\u0026gt; \u0026lt;!--é»˜è®¤å¸§æ ¼å¼--\u0026gt; \u0026lt;Format\u0026gt;Y11\u0026lt;/Format\u0026gt; \u0026lt;!--å¼€æµå¤±è´¥åæ˜¯å¦éœ€è¦è¿›è¡Œé‡è¯•ï¼Œ0-ä¸é‡è¯•ï¼Œ\u0026gt;=1-é‡è¯•å¹¶é‡è¯•å¤šå°‘æ¬¡--\u0026gt; \u0026lt;StreamFailedRetry\u0026gt;0\u0026lt;/StreamFailedRetry\u0026gt; \u0026lt;/Depth\u0026gt; \u0026lt;Color\u0026gt; \u0026lt;!--é»˜è®¤åˆ†è¾¨ç‡çš„å®½ï¼Œintç±»å‹--\u0026gt; \u0026lt;Width\u0026gt;640\u0026lt;/Width\u0026gt; \u0026lt;!--é»˜è®¤åˆ†è¾¨ç‡çš„é«˜ï¼Œintç±»å‹--\u0026gt; \u0026lt;Height\u0026gt;480\u0026lt;/Height\u0026gt; \u0026lt;!--é»˜è®¤å¸§ç‡ï¼Œintç±»å‹--\u0026gt; \u0026lt;FPS\u0026gt;30\u0026lt;/FPS\u0026gt; \u0026lt;!--é»˜è®¤å¸§æ ¼å¼--\u0026gt; \u0026lt;Format\u0026gt;MJPG\u0026lt;/Format\u0026gt; \u0026lt;!--å¼€æµå¤±è´¥åæ˜¯å¦éœ€è¦è¿›è¡Œé‡è¯•ï¼Œ0-ä¸é‡è¯•ï¼Œ\u0026gt;=1-é‡è¯•å¹¶é‡è¯•å¤šå°‘æ¬¡--\u0026gt; \u0026lt;StreamFailedRetry\u0026gt;0\u0026lt;/StreamFailedRetry\u0026gt; \u0026lt;/Color\u0026gt; \u0026lt;IR\u0026gt; \u0026lt;!--é»˜è®¤åˆ†è¾¨ç‡çš„å®½ï¼Œintç±»å‹--\u0026gt; \u0026lt;Width\u0026gt;640\u0026lt;/Width\u0026gt; \u0026lt;!--é»˜è®¤åˆ†è¾¨ç‡çš„é«˜ï¼Œintç±»å‹--\u0026gt; \u0026lt;Height\u0026gt;400\u0026lt;/Height\u0026gt; \u0026lt;!--é»˜è®¤å¸§ç‡ï¼Œintç±»å‹--\u0026gt; \u0026lt;FPS\u0026gt;30\u0026lt;/FPS\u0026gt; \u0026lt;!--é»˜è®¤å¸§æ ¼å¼--\u0026gt; \u0026lt;Format\u0026gt;Y10\u0026lt;/Format\u0026gt; \u0026lt;!--å¼€æµå¤±è´¥åæ˜¯å¦éœ€è¦è¿›è¡Œé‡è¯•ï¼Œ0-ä¸é‡è¯•ï¼Œ\u0026gt;=1-é‡è¯•å¹¶é‡è¯•å¤šå°‘æ¬¡--\u0026gt; \u0026lt;StreamFailedRetry\u0026gt;0\u0026lt;/StreamFailedRetry\u0026gt; \u0026lt;/IR\u0026gt; \u0026lt;/Gemini\u0026gt; init()ìœ¼ë¡œ ë¶€í„° ì‹œì‘ë˜ëŠ” OBCameraNodeDriverì˜ ë¡œì§ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.\nOBCameraNodeDriver init()\nsetDeviceChangedCallback - orbbec ë””ë°”ì´ìŠ¤ì˜ ì—°ê²°, í•´ì œ ì‹œ ì‹¤í–‰ë˜ëŠ” callbackì„ bindingí•©ë‹ˆë‹¤. ë””ë°”ì´ìŠ¤ì˜ ì—°ê²°ì„ ì§€ì† íƒì§€í•˜ëŠ” checkconnect_timerë¥¼ ìƒì„±í•˜ê³  checkConnectTimer callbackì„ bindingí•©ë‹ˆë‹¤. ë‹¤ìŒìœ¼ë¡œ, ë””ë°”ì´ìŠ¤ì˜ ì—°ê²° í™•ì¸ ì‹œ ì‹¤í–‰ë˜ëŠ” ë‘ê°œì˜ callbackì„ ì¶”ê°€ë¡œ ì‹¤í–‰í•˜ëŠ”ë°ìš”. ì´ëŠ” ROS 2ê°€ ì•„ë‹Œ threadë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nqueryDevice thread - theadë¥¼ í†µí•´ ë””ë°”ì´ìŠ¤ ì—°ê²° ìƒíƒœì™€ ROS 2 ì‹¤í–‰ ìƒíƒœë¥¼ ì§€ì† í™•ì¸í•©ë‹ˆë‹¤. ë””ë°”ì´ìŠ¤ ì—°ê²° ì‹œ onDeviceConnected ë©”ì†Œë“œê°€ ì‹¤í–‰ë˜ë©° ë‚´ë¶€ì—ì„œëŠ” try-catchë¡œ ì˜ˆì™¸ì²˜ë¦¬ë¥¼ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤. startDevice - ì–´ë– í•œ ë””ë°”ì´ìŠ¤ê°€ ì—°ê²°ë˜ì—ˆëŠ”ì§€, ì¸ì‹í•œ ìˆ«ìì™€ ì¼ì¹˜í•˜ëŠ” ë””ë°”ì´ìŠ¤ê°€ ì¡´ì¬í•˜ëŠ”ì§€ë¥¼ ê²€ì‚¬í•œ ë’¤, ë””ë°”ì´ìŠ¤ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤. initializeDevice - ê°ì¢… ë””ë°”ì´ìŠ¤ì˜ ì •ë³´ë¥¼ ì¡°íšŒí•˜ê³  ì‚¬ìš©ìì—ê²Œ ì½˜ì†” ì¶œë ¥ìœ¼ë¡œ ì•Œë ¤ì¤Œê³¼ ë™ì‹œì— OBCameraNodeë¥¼ ìƒì„±í•©ë‹ˆë‹¤. â‡’ OBCameraNodeëŠ” ë‹¤ìŒ ë¶„ì„í•  íŒŒì¼ì¸ ob_camera_nodeì—ì„œ ì‚´í´ë´…ì‹œë‹¤. deviceCountUpdate thread updateConnectedDeviceCount - ì—°ê²°ë˜ì–´ ìˆëŠ” ë””ë°”ì´ìŠ¤ì˜ ê°œìˆ˜ë¥¼ ê°±ì‹ í•˜ê³  ì´ ê°’ì€ ì¼ì „ ë¶„ì„í–ˆë˜ ì˜ˆì™¸ì²˜ë¦¬ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. init() ë©”ì†Œë“œë¶€í„° ìƒì„¸í•˜ê²Œ ì‚´í´ë´…ì‹œë‹¤.\nstd::unique_ptr\u0026lt;ob::Context\u0026gt; ctx_ = nullptr; ... ctx_-\u0026gt;setDeviceChangedCallback([this](std::shared_ptr\u0026lt;ob::DeviceList\u0026gt; removed_list, std::shared_ptr\u0026lt;ob::DeviceList\u0026gt; added_list) { (void)added_list; onDeviceDisconnected(removed_list); }); check_connect_timer_ = this-\u0026gt;create_wall_timer(std::chrono::milliseconds(1000), [this]() { checkConnectTimer(); }); CHECK_NOTNULL(check_connect_timer_); query_thread_ = std::make_shared\u0026lt;std::thread\u0026gt;([this]() { queryDevice(); }); device_count_update_thread_ = std::make_shared\u0026lt;std::thread\u0026gt;([this]() { deviceCountUpdate(); }); CHECK_NOTNULL(device_count_update_thread_); checkConnectTimer void OBCameraNodeDriver::checkConnectTimer() { if (!device_connected_.load()) { RCLCPP_ERROR_STREAM(logger_, \u0026#34;checkConnectTimer: device \u0026#34; \u0026lt;\u0026lt; serial_number_ \u0026lt;\u0026lt; \u0026#34; not connected\u0026#34;); return; } else if (!ob_camera_node_) { device_connected_.store(false); } } queryDevice void OBCameraNodeDriver::queryDevice() { while (is_alive_ \u0026amp;\u0026amp; rclcpp::ok()) { if (!device_connected_.load()) { RCLCPP_INFO_STREAM_THROTTLE(logger_, *get_clock(), 1000, \u0026#34;Waiting for device connection...\u0026#34;); auto device_list = ctx_-\u0026gt;queryDeviceList(); if (device_list-\u0026gt;deviceCount() == 0) { std::this_thread::sleep_for(std::chrono::milliseconds(10)); continue; } onDeviceConnected(device_list); } else { std::this_thread::sleep_for(std::chrono::milliseconds(1000)); } } } onDeviceConnected void OBCameraNodeDriver::onDeviceConnected(const std::shared_ptr\u0026lt;ob::DeviceList\u0026gt; \u0026amp;device_list) { CHECK_NOTNULL(device_list); if (device_list-\u0026gt;deviceCount() == 0) { return; } RCLCPP_INFO_STREAM_THROTTLE(logger_, *get_clock(), 1000, \u0026#34;onDeviceConnected\u0026#34;); if (!device_) { try { startDevice(device_list); } catch (ob::Error \u0026amp;e) { RCLCPP_ERROR_STREAM(logger_, \u0026#34;startDevice failed: \u0026#34; \u0026lt;\u0026lt; e.getMessage()); } catch (const std::exception \u0026amp;e) { RCLCPP_ERROR_STREAM(logger_, \u0026#34;startDevice failed: \u0026#34; \u0026lt;\u0026lt; e.what()); } catch (...) { RCLCPP_ERROR_STREAM(logger_, \u0026#34;startDevice failed\u0026#34;); } } } startDevice void OBCameraNodeDriver::startDevice(const std::shared_ptr\u0026lt;ob::DeviceList\u0026gt; \u0026amp;list) { std::scoped_lock\u0026lt;decltype(device_lock_)\u0026gt; lock(device_lock_); if (device_connected_) { return; } if (list-\u0026gt;deviceCount() == 0) { RCLCPP_WARN(logger_, \u0026#34;No device found\u0026#34;); return; } if (device_) { device_.reset(); } auto device = selectDevice(list); if (device == nullptr) { RCLCPP_WARN_THROTTLE(logger_, *get_clock(), 1000, \u0026#34;Device with serial number %s not found\u0026#34;, serial_number_.c_str()); device_connected_ = false; return; } initializeDevice(device); } initializeDevice void OBCameraNodeDriver::initializeDevice(const std::shared_ptr\u0026lt;ob::Device\u0026gt; \u0026amp;device) { device_ = device; CHECK_NOTNULL(device_); CHECK_NOTNULL(device_.get()); if (ob_camera_node_) { ob_camera_node_.reset(); } ob_camera_node_ = std::make_unique\u0026lt;OBCameraNode\u0026gt;(this, device_, parameters_); device_connected_ = true; device_info_ = device_-\u0026gt;getDeviceInfo(); CHECK_NOTNULL(device_info_.get()); device_unique_id_ = device_info_-\u0026gt;uid(); RCLCPP_INFO_STREAM(logger_, \u0026#34;Device \u0026#34; \u0026lt;\u0026lt; device_info_-\u0026gt;name() \u0026lt;\u0026lt; \u0026#34; connected\u0026#34;); RCLCPP_INFO_STREAM(logger_, \u0026#34;Serial number: \u0026#34; \u0026lt;\u0026lt; device_info_-\u0026gt;serialNumber()); RCLCPP_INFO_STREAM(logger_, \u0026#34;Firmware version: \u0026#34; \u0026lt;\u0026lt; device_info_-\u0026gt;firmwareVersion()); RCLCPP_INFO_STREAM(logger_, \u0026#34;Hardware version: \u0026#34; \u0026lt;\u0026lt; device_info_-\u0026gt;hardwareVersion()); RCLCPP_INFO_STREAM(logger_, \u0026#34;device type: \u0026#34; \u0026lt;\u0026lt; ObDeviceTypeToString(device_info_-\u0026gt;deviceType())); RCLCPP_INFO_STREAM(logger_, \u0026#34;device unique id: \u0026#34; \u0026lt;\u0026lt; device_unique_id_); } ë‹¤ìŒìœ¼ë¡œ, initializeDeviceì—ì„œ ìƒì„±ë˜ì—ˆë˜ OBCameraNodeì— ëŒ€í•´ ë¶„ì„í•´ë³´ì•˜ìŠµë‹ˆë‹¤.\nOBCameraNode OBCameraNode\nsetupDefaultImageFormat setupTopics getParameters - ê°ì¢… ë§¤ê°œë³€ìˆ˜ë“¤ì´ ì”ëœ© ì„ ì–¸, ì´ˆê¸°í™”ë˜ê³  ìˆìŠµë‹ˆë‹¤. setupDevices - getParametersì—ì„œ ì„¤ì •í•œ parameterì— ë”°ë¼ Orbbec deviceë¥¼ ì…‹ì—…í•˜ë©´ì„œ ë‹¤ì‹œê¸ˆ ì˜¤ë¥˜ ìƒí™©ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤. setupProfiles - data streamì˜ êµ¬ì²´ì ì¸ profileì„ ì¡°íšŒí•˜ë©´ì„œ ì˜¬ë°”ë¥¸ ì„¤ì •ì„ í™•ì¸í•©ë‹ˆë‹¤. setupCameraCtrlServices - ros_service.cpp íŒŒì¼ì— ê°ì¢… serviceë“¤ì´ êµ¬í˜„ë˜ì–´ ìˆëŠ”ë°ìš”. ì´ì— ëŒ€í•œ ì´ˆê¸°í™”ë¥¼ ë‹´ë‹¹í•©ë‹ˆë‹¤. setupPublishers - color image, depth image, imu, ir ë“± ê°ì¢… publisherë“¤ì— ëŒ€í•œ ì´ˆê¸°í™”ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤. publishStaticTransforms - static_tf_broadcaster_ì™€ dynamic_tf_broadcaster_ ì„¤ì •í•©ë‹ˆë‹¤. calcAndPublishStaticTransform - imu, camera, optical frame ë“± orbbec camera ë‚´ë¶€ì˜ ì„¼ì„œë“¤ê°„ ìœ„ì¹˜ offsetë¥¼ ê³ ë ¤í•˜ì—¬ ê°ì¢… tf frameì„ ê³„ì‚°í•©ë‹ˆë‹¤. publishStaticTF - std::vector íƒ€ì…ì˜ í´ë˜ìŠ¤ ë³€ìˆ˜ì¸ static_tf_msgs_ì— tf dataë“¤ì„ push_back í•©ë‹ˆë‹¤. publishDynamicTransforms - ì‹¤ì œ sendTransformì´ ë™ì‘í•˜ëŠ” ë¶€ë¶„ì¸ë°ìš”. ê·¸ë ‡ì§€ë§Œ ì‚¬ì‹¤ìƒ static broadcastê°€ ì‹¤í–‰ë©ë‹ˆë‹¤. startStreams - ob::Pipeline íƒ€ì…ì˜ í´ë˜ìŠ¤ ë³€ìˆ˜ë¥¼ ì´ˆê¸°í™”í•œ ë’¤, pipelineì„ ì‹œì‘ì‹œí‚¤ê³  onNewFrameSetCallbackë¥¼ callbackìœ¼ë¡œ binding í•©ë‹ˆë‹¤. setupPipelineConfig - ì‚¬ì „ ì •ì˜ëœ parameterë“¤ì— ë”°ë¼ orbbec SDKì— êµ¬í˜„ëœ setAlignMode, enableStream ë“±ì˜ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. onNewFrameSetCallback - pipelineìœ¼ë¡œë¶€í„° ìƒˆë¡œìš´ dataê°€ ìœ ì…ë  ë•Œë§ˆë‹¤ ì‹¤í–‰ë˜ëŠ” callbackì…ë‹ˆë‹¤. publishPointCloud - depth_frameê³¼ color_frame dataë¥¼ ë°›ì•„ ob::PointCloudFilterë¥¼ í†µí•´ í•„í„°ë§í•˜ê³  ìƒí™©ì— ë§ëŠ” topic dataë¥¼ ì¤€ë¹„í•œ ë’¤, ìµœì¢… publishí•©ë‹ˆë‹¤. publishColoredPointCloud publishDepthPointCloud onNewFrameCallback - pointcloudê°€ ì•„ë‹Œ rgb, depth, ir ì¹´ë©”ë¼ publisherë“¤ì— ëŒ€í•´ ROS 2 Conversionì„ ì ìš©í•œ ë’¤ publishí•©ë‹ˆë‹¤. startIMU onNewIMUFrameCallback setDefaultIMUMessage publish OBCameraNode ìƒì„±ìë¶€í„° ìƒì„¸ ë¶„ì„ì„ í•´ë´…ì‹œë‹¤.\nì´ ë¶€ë¶„ì—ì„œ ì‚¬ìš©ëœ is_running_ê³¼ ê°™ì€ í´ë˜ìŠ¤ ë³€ìˆ˜ëŠ” atomic typeì¸ë°ìš”. ì•„ë§ˆ Threadê°„ ìƒíƒœ ë³€í™˜ ë¡œì§ì— ì‚¬ìš©ë˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì €ì˜€ë‹¤ë©´ Threadê°€ ì•„ë‹Œ, Compositionì„ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ì½”ë“œë¡œ ë‚˜ëˆ„ê³ , ì´ëŸ° ë³µì¡í•œ êµ¬í˜„ì„ í”¼í•˜ë ¤ê³  í•˜ì§€ ì•Šì•˜ì„ê¹Œ ìƒê°í•´ë´…ë‹ˆë‹¤.\nOBCameraNode::OBCameraNode(rclcpp::Node* node, std::shared_ptr\u0026lt;ob::Device\u0026gt; device, std::shared_ptr\u0026lt;Parameters\u0026gt; parameters) : node_(node), device_(std::move(device)), parameters_(std::move(parameters)), logger_(node-\u0026gt;get_logger()) { is_running_.store(true); stream_name_[COLOR] = \u0026#34;color\u0026#34;; stream_name_[DEPTH] = \u0026#34;depth\u0026#34;; stream_name_[INFRA0] = \u0026#34;ir\u0026#34;; stream_name_[INFRA1] = \u0026#34;ir2\u0026#34;; stream_name_[ACCEL] = \u0026#34;accel\u0026#34;; stream_name_[GYRO] = \u0026#34;gyro\u0026#34;; compression_params_.push_back(cv::IMWRITE_PNG_COMPRESSION); compression_params_.push_back(0); compression_params_.push_back(cv::IMWRITE_PNG_STRATEGY); compression_params_.push_back(cv::IMWRITE_PNG_STRATEGY_DEFAULT); setupDefaultImageFormat(); setupTopics(); startStreams(); if (enable_d2c_viewer_) { auto rgb_qos = getRMWQosProfileFromString(image_qos_[COLOR]); auto depth_qos = getRMWQosProfileFromString(image_qos_[DEPTH]); d2c_viewer_ = std::make_unique\u0026lt;D2CViewer\u0026gt;(node_, rgb_qos, depth_qos); } } OBCameraNodeì—ì„œ ì •ì˜ëœ ROS 2 ë©”ì»¤ë‹ˆì¦˜ë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. // Topic publisher std::map\u0026lt;stream_index_pair, image_transport::Publisher\u0026gt; image_publishers_; std::map\u0026lt;stream_index_pair, rclcpp::Publisher\u0026lt;sensor_msgs::msg::CameraInfo\u0026gt;::SharedPtr\u0026gt; camera_info_publishers_; ... rclcpp::Publisher\u0026lt;sensor_msgs::msg::PointCloud2\u0026gt;::SharedPtr depth_registration_cloud_pub_; rclcpp::Publisher\u0026lt;sensor_msgs::msg::PointCloud2\u0026gt;::SharedPtr depth_cloud_pub_; ... rclcpp::Publisher\u0026lt;Extrinsics\u0026gt;::SharedPtr extrinsics_publisher_; ... std::map\u0026lt;stream_index_pair, rclcpp::Publisher\u0026lt;sensor_msgs::msg::Imu\u0026gt;::SharedPtr\u0026gt; imu_publishers_; ... // TF broadcaster std::shared_ptr\u0026lt;tf2_ros::StaticTransformBroadcaster\u0026gt; static_tf_broadcaster_ = nullptr; std::shared_ptr\u0026lt;tf2_ros::TransformBroadcaster\u0026gt; dynamic_tf_broadcaster_ = nullptr; setupDefaultImageFormat void OBCameraNode::setupDefaultImageFormat() { format_[DEPTH] = OB_FORMAT_Y16; format_str_[DEPTH] = \u0026#34;Y16\u0026#34;; image_format_[DEPTH] = CV_16UC1; encoding_[DEPTH] = sensor_msgs::image_encodings::TYPE_16UC1; unit_step_size_[DEPTH] = sizeof(uint16_t); format_[INFRA0] = OB_FORMAT_Y16; format_str_[INFRA0] = \u0026#34;Y16\u0026#34;; image_format_[INFRA0] = CV_16UC1; encoding_[INFRA0] = sensor_msgs::image_encodings::MONO16; unit_step_size_[INFRA0] = sizeof(uint8_t); image_format_[COLOR] = CV_8UC3; encoding_[COLOR] = sensor_msgs::image_encodings::RGB8; unit_step_size_[COLOR] = 3 * sizeof(uint8_t); } setupTopics void OBCameraNode::setupTopics() { getParameters(); setupDevices(); setupProfiles(); setupCameraCtrlServices(); setupPublishers(); publishStaticTransforms(); } getParameters void OBCameraNode::getParameters() { setAndGetNodeParameter\u0026lt;std::string\u0026gt;(camera_name_, \u0026#34;camera_name\u0026#34;, \u0026#34;camera\u0026#34;); for (auto stream_index : IMAGE_STREAMS) { std::string param_name = stream_name_[stream_index] + \u0026#34;_width\u0026#34;; setAndGetNodeParameter(width_[stream_index], param_name, IMAGE_WIDTH); param_name = stream_name_[stream_index] + \u0026#34;_height\u0026#34;; setAndGetNodeParameter(height_[stream_index], param_name, IMAGE_HEIGHT); param_name = stream_name_[stream_index] + \u0026#34;_fps\u0026#34;; ... setAndGetNodeParameter(publish_tf_, \u0026#34;publish_tf\u0026#34;, true); setAndGetNodeParameter(tf_publish_rate_, \u0026#34;tf_publish_rate\u0026#34;, 10.0); setAndGetNodeParameter(depth_registration_, \u0026#34;depth_registration\u0026#34;, false); setAndGetNodeParameter(enable_point_cloud_, \u0026#34;enable_point_cloud\u0026#34;, true); setAndGetNodeParameter\u0026lt;std::string\u0026gt;(ir_info_url_, \u0026#34;ir_info_url\u0026#34;, \u0026#34;\u0026#34;); setAndGetNodeParameter\u0026lt;std::string\u0026gt;(color_info_url_, \u0026#34;color_info_url\u0026#34;, \u0026#34;\u0026#34;); ... setupDevices void OBCameraNode::setupDevices() { auto sensor_list = device_-\u0026gt;getSensorList(); for (size_t i = 0; i \u0026lt; sensor_list-\u0026gt;count(); i++) { auto sensor = sensor_list-\u0026gt;getSensor(i); auto profiles = sensor-\u0026gt;getStreamProfileList(); for (size_t j = 0; j \u0026lt; profiles-\u0026gt;count(); j++) { auto profile = profiles-\u0026gt;getProfile(j); stream_index_pair sip{profile-\u0026gt;type(), 0}; if (sensors_.find(sip) != sensors_.end()) { continue; } sensors_[sip] = sensor; } } ... device_-\u0026gt;setBoolProperty(OB_PROP_DEPTH_SOFT_FILTER_BOOL, enable_soft_filter_); device_-\u0026gt;setBoolProperty(OB_PROP_COLOR_AUTO_EXPOSURE_BOOL, enable_color_auto_exposure_); device_-\u0026gt;setBoolProperty(OB_PROP_IR_AUTO_EXPOSURE_BOOL, enable_ir_auto_exposure_); auto default_soft_filter_max_diff = device_-\u0026gt;getIntProperty(OB_PROP_DEPTH_MAX_DIFF_INT); if (soft_filter_max_diff_ != -1 \u0026amp;\u0026amp; default_soft_filter_max_diff != soft_filter_max_diff_) { device_-\u0026gt;setIntProperty(OB_PROP_DEPTH_MAX_DIFF_INT, soft_filter_max_diff_); } auto default_soft_filter_speckle_size = device_-\u0026gt;getIntProperty(OB_PROP_DEPTH_MAX_SPECKLE_SIZE_INT); if (soft_filter_speckle_size_ != -1 \u0026amp;\u0026amp; default_soft_filter_speckle_size != soft_filter_speckle_size_) { device_-\u0026gt;setIntProperty(OB_PROP_DEPTH_MAX_SPECKLE_SIZE_INT, soft_filter_speckle_size_); } } catch (const ob::Error\u0026amp; e) { RCLCPP_ERROR_STREAM(logger_, \u0026#34;Failed to setup devices: \u0026#34; \u0026lt;\u0026lt; e.getMessage()); } catch (const std::exception\u0026amp; e) { RCLCPP_ERROR_STREAM(logger_, \u0026#34;Failed to setup devices: \u0026#34; \u0026lt;\u0026lt; e.what()); } setupProfiles void OBCameraNode::setupProfiles() { for (const auto\u0026amp; elem : IMAGE_STREAMS) { if (enable_stream_[elem]) { const auto\u0026amp; sensor = sensors_[elem]; CHECK_NOTNULL(sensor.get()); auto profiles = sensor-\u0026gt;getStreamProfileList(); CHECK_NOTNULL(profiles.get()); CHECK(profiles-\u0026gt;count() \u0026gt; 0); for (size_t i = 0; i \u0026lt; profiles-\u0026gt;count(); i++) { auto profile = profiles-\u0026gt;getProfile(i)-\u0026gt;as\u0026lt;ob::VideoStreamProfile\u0026gt;(); RCLCPP_DEBUG_STREAM( logger_, \u0026#34;Sensor profile: \u0026#34; \u0026lt;\u0026lt; \u0026#34;stream_type: \u0026#34; \u0026lt;\u0026lt; magic_enum::enum_name(profile-\u0026gt;type()) \u0026lt;\u0026lt; \u0026#34;Format: \u0026#34; \u0026lt;\u0026lt; profile-\u0026gt;format() \u0026lt;\u0026lt; \u0026#34;, Width: \u0026#34; \u0026lt;\u0026lt; profile-\u0026gt;width() \u0026lt;\u0026lt; \u0026#34;, Height: \u0026#34; \u0026lt;\u0026lt; profile-\u0026gt;height() \u0026lt;\u0026lt; \u0026#34;, FPS: \u0026#34; \u0026lt;\u0026lt; profile-\u0026gt;fps()); supported_profiles_[elem].emplace_back(profile); } setupPublisher void OBCameraNode::setupPublishers() { using PointCloud2 = sensor_msgs::msg::PointCloud2; using CameraInfo = sensor_msgs::msg::CameraInfo; auto point_cloud_qos_profile = getRMWQosProfileFromString(point_cloud_qos_); if (enable_colored_point_cloud_) { depth_registration_cloud_pub_ = node_-\u0026gt;create_publisher\u0026lt;PointCloud2\u0026gt;( \u0026#34;depth/color/points\u0026#34;, rclcpp::QoS(rclcpp::QoSInitialization::from_rmw(point_cloud_qos_profile), point_cloud_qos_profile)); } if (enable_point_cloud_) { depth_cloud_pub_ = node_-\u0026gt;create_publisher\u0026lt;PointCloud2\u0026gt;( \u0026#34;depth/points\u0026#34;, rclcpp::QoS(rclcpp::QoSInitialization::from_rmw(point_cloud_qos_profile), point_cloud_qos_profile)); } for (const auto\u0026amp; stream_index : IMAGE_STREAMS) { if (!enable_stream_[stream_index]) { continue; } std::string name = stream_name_[stream_index]; std::string topic = name + \u0026#34;/image_raw\u0026#34;; auto image_qos = image_qos_[stream_index]; auto image_qos_profile = getRMWQosProfileFromString(image_qos); image_publishers_[stream_index] = image_transport::create_publisher(node_, topic, image_qos_profile); topic = name + \u0026#34;/camera_info\u0026#34;; auto camera_info_qos = camera_info_qos_[stream_index]; auto camera_info_qos_profile = getRMWQosProfileFromString(camera_info_qos); camera_info_publishers_[stream_index] = node_-\u0026gt;create_publisher\u0026lt;CameraInfo\u0026gt;( topic, rclcpp::QoS(rclcpp::QoSInitialization::from_rmw(camera_info_qos_profile), camera_info_qos_profile)); } if (enable_publish_extrinsic_) { extrinsics_publisher_ = node_-\u0026gt;create_publisher\u0026lt;orbbec_camera_msgs::msg::Extrinsics\u0026gt;( \u0026#34;extrinsic/depth_to_color\u0026#34;, rclcpp::QoS{1}.transient_local()); } } publishStaticTransforms void OBCameraNode::publishStaticTransforms() { if (!publish_tf_) { return; } static_tf_broadcaster_ = std::make_shared\u0026lt;tf2_ros::StaticTransformBroadcaster\u0026gt;(node_); dynamic_tf_broadcaster_ = std::make_shared\u0026lt;tf2_ros::TransformBroadcaster\u0026gt;(node_); calcAndPublishStaticTransform(); if (tf_publish_rate_ \u0026gt; 0) { tf_thread_ = std::make_shared\u0026lt;std::thread\u0026gt;([this]() { publishDynamicTransforms(); }); } else { static_tf_broadcaster_-\u0026gt;sendTransform(static_tf_msgs_); } } calcAndPublishStaticTransform void OBCameraNode::calcAndPublishStaticTransform() { tf2::Quaternion quaternion_optical, zero_rot, Q; std::vector\u0026lt;float\u0026gt; trans(3, 0); zero_rot.setRPY(0.0, 0.0, 0.0); quaternion_optical.setRPY(-M_PI / 2, 0.0, -M_PI / 2); std::vector\u0026lt;float\u0026gt; zero_trans = {0, 0, 0}; auto camera_param = findDefaultCameraParam(); if (enable_publish_extrinsic_ \u0026amp;\u0026amp; extrinsics_publisher_ \u0026amp;\u0026amp; camera_param.has_value()) { auto ex = camera_param-\u0026gt;transform; Q = rotationMatrixToQuaternion(ex.rot); Q = quaternion_optical * Q * quaternion_optical.inverse(); extrinsics_publisher_-\u0026gt;publish(obExtrinsicsToMsg(ex, \u0026#34;depth_to_color_extrinsics\u0026#34;)); } else { Q.setRPY(0, 0, 0); } rclcpp::Time tf_timestamp = node_-\u0026gt;now(); publishStaticTF(tf_timestamp, trans, Q, frame_id_[DEPTH], frame_id_[COLOR]); publishStaticTF(tf_timestamp, trans, Q, camera_link_frame_id_, frame_id_[COLOR]); publishStaticTF(tf_timestamp, zero_trans, quaternion_optical, frame_id_[COLOR], optical_frame_id_[COLOR]); publishStaticTF(tf_timestamp, zero_trans, quaternion_optical, frame_id_[DEPTH], optical_frame_id_[DEPTH]); publishStaticTF(tf_timestamp, zero_trans, zero_rot, camera_link_frame_id_, frame_id_[DEPTH]); publishStaticTF(tf_timestamp, zero_trans, zero_rot, camera_link_frame_id_, frame_id_[ACCEL]); publishStaticTF(tf_timestamp, zero_trans, zero_rot, camera_link_frame_id_, frame_id_[GYRO]); } publishStaticTF void OBCameraNode::publishStaticTF(const rclcpp::Time\u0026amp; t, const std::vector\u0026lt;float\u0026gt;\u0026amp; trans, const tf2::Quaternion\u0026amp; q, const std::string\u0026amp; from, const std::string\u0026amp; to) { CHECK_EQ(trans.size(), 3u); geometry_msgs::msg::TransformStamped msg; msg.header.stamp = t; msg.header.frame_id = from; msg.child_frame_id = to; msg.transform.translation.x = trans.at(2) / 1000.0; msg.transform.translation.y = -trans.at(0) / 1000.0; msg.transform.translation.z = -trans.at(1) / 1000.0; msg.transform.rotation.x = q.getX(); msg.transform.rotation.y = q.getY(); msg.transform.rotation.z = q.getZ(); msg.transform.rotation.w = q.getW(); static_tf_msgs_.push_back(msg); } publishDynamicTransforms void OBCameraNode::publishDynamicTransforms() { RCLCPP_WARN(logger_, \u0026#34;Publishing dynamic camera transforms (/tf) at %g Hz\u0026#34;, tf_publish_rate_); std::mutex mu; std::unique_lock\u0026lt;std::mutex\u0026gt; lock(mu); while (rclcpp::ok() \u0026amp;\u0026amp; is_running_) { tf_cv_.wait_for(lock, std::chrono::milliseconds((int)(1000.0 / tf_publish_rate_)), [this] { return (!(is_running_)); }); { rclcpp::Time t = node_-\u0026gt;now(); for (auto\u0026amp; msg : static_tf_msgs_) { msg.header.stamp = t; } dynamic_tf_broadcaster_-\u0026gt;sendTransform(static_tf_msgs_); } } } startStreams void OBCameraNode::startStreams() { if (pipeline_ != nullptr) { pipeline_.reset(); } pipeline_ = std::make_unique\u0026lt;ob::Pipeline\u0026gt;(device_); try { setupPipelineConfig(); pipeline_-\u0026gt;start(pipeline_config_, [this](std::shared_ptr\u0026lt;ob::FrameSet\u0026gt; frame_set) { onNewFrameSetCallback(frame_set); }); } catch (const ob::Error\u0026amp; e) { RCLCPP_ERROR_STREAM(logger_, \u0026#34;Failed to start pipeline: \u0026#34; \u0026lt;\u0026lt; e.getMessage()); RCLCPP_INFO_STREAM(logger_, \u0026#34;try to disable ir stream and try again\u0026#34;); enable_stream_[INFRA0] = false; setupPipelineConfig(); pipeline_-\u0026gt;start(pipeline_config_, [this](std::shared_ptr\u0026lt;ob::FrameSet\u0026gt; frame_set) { onNewFrameSetCallback(frame_set); }); } pipeline_started_.store(true); // startIMU(); } setupPipelineConfig void OBCameraNode::setupPipelineConfig() { if (pipeline_config_) { pipeline_config_.reset(); } pipeline_config_ = std::make_shared\u0026lt;ob::Config\u0026gt;(); if (depth_registration_ \u0026amp;\u0026amp; enable_stream_[COLOR] \u0026amp;\u0026amp; enable_stream_[DEPTH]) { pipeline_config_-\u0026gt;setAlignMode(ALIGN_D2C_HW_MODE); } for (const auto\u0026amp; stream_index : IMAGE_STREAMS) { if (enable_stream_[stream_index]) { RCLCPP_INFO_STREAM(logger_, \u0026#34;Enable \u0026#34; \u0026lt;\u0026lt; stream_name_[stream_index] \u0026lt;\u0026lt; \u0026#34; stream\u0026#34;); RCLCPP_INFO_STREAM( logger_, \u0026#34;Stream \u0026#34; \u0026lt;\u0026lt; stream_name_[stream_index] \u0026lt;\u0026lt; \u0026#34; width: \u0026#34; \u0026lt;\u0026lt; width_[stream_index] \u0026lt;\u0026lt; \u0026#34; height: \u0026#34; \u0026lt;\u0026lt; height_[stream_index] \u0026lt;\u0026lt; \u0026#34; fps: \u0026#34; \u0026lt;\u0026lt; fps_[stream_index] \u0026lt;\u0026lt; \u0026#34; format: \u0026#34; \u0026lt;\u0026lt; format_str_[stream_index]); pipeline_config_-\u0026gt;enableStream(stream_profile_[stream_index]); } } } onNewFrameSetCallback void OBCameraNode::onNewFrameSetCallback(const std::shared_ptr\u0026lt;ob::FrameSet\u0026gt;\u0026amp; frame_set) { if (frame_set == nullptr) { return; } try { publishPointCloud(frame_set); auto color_frame = std::dynamic_pointer_cast\u0026lt;ob::Frame\u0026gt;(frame_set-\u0026gt;colorFrame()); auto depth_frame = std::dynamic_pointer_cast\u0026lt;ob::Frame\u0026gt;(frame_set-\u0026gt;depthFrame()); auto ir_frame = std::dynamic_pointer_cast\u0026lt;ob::Frame\u0026gt;(frame_set-\u0026gt;irFrame()); onNewFrameCallback(color_frame, COLOR); onNewFrameCallback(depth_frame, DEPTH); onNewFrameCallback(ir_frame, INFRA0); } catch (const ob::Error\u0026amp; e) { RCLCPP_ERROR_STREAM(logger_, \u0026#34;onNewFrameSetCallback error: \u0026#34; \u0026lt;\u0026lt; e.getMessage()); } catch (const std::exception\u0026amp; e) { RCLCPP_ERROR_STREAM(logger_, \u0026#34;onNewFrameSetCallback error: \u0026#34; \u0026lt;\u0026lt; e.what()); } catch (...) { RCLCPP_ERROR_STREAM(logger_, \u0026#34;onNewFrameSetCallback error: unknown error\u0026#34;); } } startIMU void OBCameraNode::startIMU() { for (const auto\u0026amp; stream_index : HID_STREAMS) { if (enable_stream_[stream_index]) { CHECK(sensors_.count(stream_index)); auto profile_list = sensors_[stream_index]-\u0026gt;getStreamProfileList(); for (size_t i = 0; i \u0026lt; profile_list-\u0026gt;count(); i++) { auto item = profile_list-\u0026gt;getProfile(i); if (stream_index == ACCEL) { auto profile = item-\u0026gt;as\u0026lt;ob::AccelStreamProfile\u0026gt;(); auto accel_rate = sampleRateFromString(imu_rate_[stream_index]); auto accel_range = fullAccelScaleRangeFromString(imu_range_[stream_index]); if (profile-\u0026gt;fullScaleRange() == accel_range \u0026amp;\u0026amp; profile-\u0026gt;sampleRate() == accel_rate) { sensors_[stream_index]-\u0026gt;start(profile, [this, stream_index](std::shared_ptr\u0026lt;ob::Frame\u0026gt; frame) { onNewIMUFrameCallback(frame, stream_index); }); imu_started_[stream_index] = true; RCLCPP_INFO_STREAM(logger_, \u0026#34;start accel stream with \u0026#34; \u0026lt;\u0026lt; magic_enum::enum_name(accel_range) \u0026lt;\u0026lt; \u0026#34; range and \u0026#34; \u0026lt;\u0026lt; magic_enum::enum_name(accel_rate) \u0026lt;\u0026lt; \u0026#34; rate\u0026#34;); } IMU Test?! ì†ŒìŠ¤ ì½”ë“œ í™•ì¸ ì‹œ, ì£¼ì„ë˜ì–´ ìˆëŠ” IMU publisherì™€ ê´€ë ¨ëœ ë¶€ë¶„ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë°ìš”. ê³¼ì—° IMU dataë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.\nì£¼ì„ í•´ì œ - ob_camera_node.cpp void OBCameraNode::startStreams() { ... // ì£¼ì„ í•´ì œ pipeline_started_.store(true); startIMU(); } void OBCameraNode::setupPublishers() { ... // ì£¼ì„ í•´ì œ for (const auto\u0026amp; stream_index : HID_STREAMS) { if (!enable_stream_[stream_index]) { continue; } std::string data_topic_name = stream_name_[stream_index] + \u0026#34;/sample\u0026#34;; auto data_qos = getRMWQosProfileFromString(imu_qos_[stream_index]); imu_publishers_[stream_index] = node_-\u0026gt;create_publisher\u0026lt;sensor_msgs::msg::Imu\u0026gt;( data_topic_name, rclcpp::QoS(rclcpp::QoSInitialization::from_rmw(data_qos), data_qos)); RCLCPP_INFO_STREAM(logger_, \u0026#34;IMU Publisher created\u0026#34;); } if (enable_publish_extrinsic_) { extrinsics_publisher_ = node_-\u0026gt;create_publisher\u0026lt;orbbec_camera_msgs::msg::Extrinsics\u0026gt;( \u0026#34;extrinsic/depth_to_color\u0026#34;, rclcpp::QoS{1}.transient_local()); } } ì£¼ì„ í•´ì œ - gemini2.launch.xml \u0026lt;!-- imu --\u0026gt; \u0026lt;arg name=\u0026#34;enable_accel\u0026#34; default=\u0026#34;true\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;accel_rate\u0026#34; default=\u0026#34;100hz\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;accel_range\u0026#34; default=\u0026#34;4g\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;enable_gyro\u0026#34; default=\u0026#34;true\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;gyro_rate\u0026#34; default=\u0026#34;100hz\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;gyro_range\u0026#34; default=\u0026#34;1000dps\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;liner_accel_cov\u0026#34; default=\u0026#34;0.01\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;angular_vel_cov\u0026#34; default=\u0026#34;0.01\u0026#34;/\u0026gt; \u0026lt;group\u0026gt; \u0026lt;push-ros-namespace namespace=\u0026#34;$(var camera_name)\u0026#34;/\u0026gt; \u0026lt;node name=\u0026#34;camera\u0026#34; pkg=\u0026#34;orbbec_camera\u0026#34; exec=\u0026#34;orbbec_camera_node\u0026#34; output=\u0026#34;screen\u0026#34;\u0026gt; ... \u0026lt;!-- imu --\u0026gt; \u0026lt;param name=\u0026#34;enable_accel\u0026#34; value=\u0026#34;$(var enable_accel)\u0026#34; /\u0026gt; \u0026lt;param name=\u0026#34;accel_rate\u0026#34; value=\u0026#34;$(var accel_rate)\u0026#34; /\u0026gt; \u0026lt;param name=\u0026#34;accel_range\u0026#34; value=\u0026#34;$(var accel_range)\u0026#34; /\u0026gt; \u0026lt;param name=\u0026#34;enable_gyro\u0026#34; value=\u0026#34;$(var enable_gyro)\u0026#34; /\u0026gt; \u0026lt;param name=\u0026#34;gyro_rate\u0026#34; value=\u0026#34;$(var gyro_rate)\u0026#34; /\u0026gt; \u0026lt;param name=\u0026#34;gyro_range\u0026#34; value=\u0026#34;$(var gyro_range)\u0026#34; /\u0026gt; \u0026lt;param name=\u0026#34;liner_accel_cov\u0026#34; value=\u0026#34;$(var liner_accel_cov)\u0026#34;/\u0026gt; \u0026lt;param name=\u0026#34;angular_vel_cov\u0026#34; value=\u0026#34;$(var angular_vel_cov)\u0026#34;/\u0026gt; ë§ˆì§€ë§‰ìœ¼ë¡œ imu dataì˜ ì‹œê°í™”ë¥¼ ìœ„í•´ rviz2 pluginì„ ì„¤ì¹˜í•©ë‹ˆë‹¤. sudo apt install ros-foxy-rviz-imu-plugin -y launch fileì„ ë‹¤ì‹œ ì‹¤í–‰ì‹œí‚¨ ë’¤ rviz2ë¥¼ í™•ì¸í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ /gyro/sample/imuë¼ëŠ” ë°ì´í„°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ Topic ì‹œê°í™”ë¥¼ ì¶”ê°€í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ tf2ê´€ë ¨ ì—ëŸ¬ë“¤ì´ í™•ì¸ë©ë‹ˆë‹¤. topicì€ ë§Œë“¤ì–´ë‘ê³ , tf2ëŠ” broadcastí•˜ê³  ìˆì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. [INFO] [1685265445.144163057] [rviz]: Message Filter dropping message: frame \u0026#39;camera_gyro_optical_frame\u0026#39; at time 1685265444.622 for reason \u0026#39;Unknown\u0026#39; [INFO] [1685265445.179582316] [rviz]: Message Filter dropping message: frame \u0026#39;camera_gyro_optical_frame\u0026#39; at time 1685265444.652 for reason \u0026#39;Unknown\u0026#39; [INFO] [1685265445.214360819] [rviz]: Message Filter dropping message: frame \u0026#39;camera_gyro_optical_frame\u0026#39; at time 1685265444.712 for reason \u0026#39;Unknown\u0026#39; [INFO] [1685265445.244405298] [rviz]: Message Filter dropping message: frame \u0026#39;camera_gyro_optical_frame\u0026#39; at time 1685265444.751 for reason \u0026#39;Unknown\u0026#39; ì‹¤ì œ topic dataë¥¼ ì‚´í´ë³´ì•„ë„ frame*idëŠ” camera_gyro_optical_frameë¡œ ë˜ì–´ìˆëŠ” ë°˜ë©´, tf2 treeì—ì„œ í•´ë‹¹ tf2ëŠ” í™•ì¸ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë”ë¶ˆì–´ angular_velocityë§Œ ê°±ì‹ ë  ë¿ ì œì¼ ì¤‘ìš”í•œ orientation dataë¥¼ ì–»ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. *(orbbecì¸¡ì˜ ë¹ ë¥¸ ì—…ë°ì´íŠ¸ë¥¼ ê¸°ëŒ€í•´ë´…ì‹œë‹¤.)_ --- header: stamp: sec: 1685265428 nanosec: 750000128 frame_id: camera_gyro_optical_frame orientation: x: 0.0 y: 0.0 z: 0.0 w: 0.0 orientation_covariance: - -1.0 - 0.0 - 0.0 - 0.0 - 0.0 - 0.0 - 0.0 - 0.0 - 0.0 angular_velocity: x: 0.002128450432792306 y: -0.006385351065546274 z: 0.0026605629827827215 angular_velocity_covariance: "
},
{
	"uri": "/kr/ros2_foxy/lecture20/",
	"title": "Lecture20. NVIDIA Jetson Platform",
	"tags": [],
	"description": "",
	"content": "ë°ëª¨ ì‹œì—° ì´ë²ˆ ì‹œê°„ì—ëŠ” ì§€ê¸ˆê¹Œì§€ í•™ìŠµí•œ ë‚´ìš©ë“¤ì„ ë‹¤ì‹œ í•œ ë²ˆ ë˜ì§šì–´ë³´ë©´ì„œ ROS 2ë¥¼ ì‚¬ìš©í•˜ê³ ì í•˜ëŠ” ê³ ê°ë“¤ ì¸¡ë©´ì—ì„œì˜ ê°œë°œ, ê¸°ëŠ¥ë“¤ì„ ì´ì•¼ê¸°í•´ë³´ê² ìŠµë‹ˆë‹¤.\nGazebo ì‹œë®¬ë ˆì´ì…˜ ë°ëª¨ Real Worldì™€ ì‹œë®¬ë ˆì´ì…˜ ì—°ë™ ì‹¤ë¬¼ ì„¼ì„œì˜ ROS 2 ì—°ë™ ì†Œí˜• ë¡œë´‡ ë°ëª¨ë¥¼ í†µí•´ ì‚´í´ë³´ëŠ” ë¡œë´‡ ì‹œìŠ¤í…œ Gazebo ì‹œë®¬ë ˆì´ì…˜ ë°ëª¨ - Fusionbot SLAM ì§€ê¸ˆê¹Œì§€ í•™ìŠµí•œ ë‚´ìš©ë“¤ì„ í†µí•´ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” Applicationì„ ë°ëª¨í•´ë³´ê³ ì í•©ë‹ˆë‹¤.\nGazebo World ìƒì„± URDFë¥¼ í†µí•œ ë¡œë´‡ Structure êµ¬ì„± Gazebo Control Pluginê³¼ Sensor Plugin ì²˜ìŒ ë§ˆì£¼ì¹œ í™˜ê²½ì—ì„œ, ìš°ë¦¬ëŠ” í˜„ì¬ ìì‹ ì˜ ìœ„ì¹˜ì™€ ì£¼ë³€ í™˜ê²½ì˜ Mappingì„ ë™ì‹œì— ì§„í–‰í•©ë‹ˆë‹¤. ì´ì™€ ê°™ì´ SLAMì´ë€, Localizationê³¼ Mappingì„ Simultaneously ì‹¤í–‰í•˜ëŠ” ê²ƒìœ¼ë¡œ ë¡œë´‡ì˜ ììœ¨ì£¼í–‰ì— ì‚¬ìš©ë˜ëŠ” ì§€ë„ ìƒì„±ì— ì£¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.\n2D Lidarë¥¼ í†µí•´ Gazebo ìƒì˜ Fusionbotì„ í†µí•´ í™˜ê²½ì˜ ì§€ë„ë¥¼ ìƒì„±í•´ë³´ëŠ” ì‹¤ìŠµì„ ì§„í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.\nSLAMì€ ì‚¬ìš©í•˜ëŠ” ì„¼ì„œ, ë°©ì‹ì— ë”°ë¼ ì—¬ëŸ¬ ì¢…ë¥˜ì˜ êµ¬í˜„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë°˜ë“œì‹œ 2D Lidar SLAMë§Œ ì¡´ì¬í•˜ëŠ” ê²ƒì´ ì•„ë‹˜ì„ ë°í™ë‹ˆë‹¤.\nFusionbot SLAM # Terminal 1 - gazebo world launch ros2 launch fusionbot_description office_construction.launch.py # Terminal 2 - slam toolbox launch cbp fusionbot_slam \u0026amp;\u0026amp; source install/local_setup.bash ros2 launch fusionbot_slam online_async_launch.py # Terminal 2 - control node rqt_robot_steering â‡’ rqt_robot_steeringì„ í†µí•´ ë¡œë´‡ì„ ì›€ì§ì„ì— ë”°ë¼ rviz2 ìƒì—ì„œ ì™„ì„±ë˜ëŠ” ì§€ë„ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nìƒì„±ëœ ì§€ë„ë¥¼ ì €ì¥í•˜ê³  ì‹¶ë‹¤ë©´ rviz2ì—ì„œ ê²½ë¡œë¥¼ ì…ë ¥í•œ ë’¤, Save Map ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤. â‡’ ì´ë ‡ê²Œ ìƒì„±ëœ ì§€ë„ëŠ” ì´í›„ ììœ¨ì£¼í–‰, world ìƒì„±, 3D reconstructionë“± ë‹¤ì–‘í•œ Applicationì— ì‚¬ìš©ë©ë‹ˆë‹¤.\nReal Worldì™€ ì‹œë®¬ë ˆì´ì…˜ ì—°ë™ ì´ë²ˆ ë°ëª¨ëŠ” SLAMTECì˜ Rplidarë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ë¬´ì‹¤ì„ Mappingí•˜ê³ , ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ Gazebo Worldë¥¼ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.\nrplidar a3 2D ë¼ì´ë‹¤ ì œí’ˆêµ° ì¤‘ ë¹„êµì  ì €ë ´í•œ ê°€ê²©ì— ìµœëŒ€ 25më¼ëŠ” í•©ë¦¬ì ì¸ íƒì§€ê±°ë¦¬ì™€ í•´ìƒë„ë¥¼ ê°–ê³  ìˆì–´ ë¡œë´‡ í”„ë¡œì íŠ¸ì—ì„œ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ì œí’ˆ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.\nì‹¤ì œ ì‹¤ì™¸ ë°°ì†¡ë¡œë´‡ì— ì´ëŸ¬í•œ í˜•íƒœì˜ ë¼ì´ë‹¤ê°€ ì‚¬ìš©ëœ ë°” ìˆìŠµë‹ˆë‹¤. rplidar a3ë¥¼ í†µí•´ ì‹¤ì œ ì‚¬ë¬´ì‹¤ì„ SLAM í•´ë³´ê² ìŠµë‹ˆë‹¤. (í•˜ë‹¨ ë¡œê·¸ëŠ” ì œê°€ ë°ëª¨í•˜ê¸° ìœ„í•œ ëª…ë ¹ì–´ì…ë‹ˆë‹¤.) # rplidar a3 cd /dev sudo chmod 777 ttyUSB0 ros2 launch rplidar_ros view_rplidar_a3_launch.py # Terminal 2 ros2 launch demo_pkg rf2o_odom.launch.py # Terminal 3 ros2 launch demo_pkg online_async_launch_real.py ì‹¤ì‹œê°„ìœ¼ë¡œ ê·¸ë ¤ì§€ëŠ” ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì§€ë„ ì‘ì„±ì„ ë§ˆì³¤ë‹¤ë©´, ì´ì œ Gazeboì—ì„œ ì´ ì§€ë„ë¥¼ í™œìš©í•´ Buildingì„ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤. SLAM mapì€ pgm í¬ë§·ì„ ê°€ì§€ë¯€ë¡œ pngë¡œ ë³€í™˜ì´ í•„ìš”í•©ë‹ˆë‹¤. https://convertio.co/pgm-png/\nì´ì œ Gazeboì˜ building Editorë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ë¬´ì‹¤ê³¼ ë™ì¼í•œ í¬ê¸°ì˜ ì‹œë®¬ë ˆì´ì…˜ í™˜ê²½ì„ ì œì‘í•©ë‹ˆë‹¤. â‡’ ì§€ê¸ˆê¹Œì§€ í•™ìŠµí•œ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì´ì œ ì—¬ëŸ¬ë¶„ë§Œì˜ ë¡œë´‡, Objectë¥¼ ì¶”ê°€í•˜ì—¬ í’ì„±í•œ ì‹œë®¬ë ˆì´ì…˜ì„ ë§Œë“¤ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.\nì‹¤ë¬¼ ì„¼ì„œì˜ ROS 2 ì—°ë™ ì•„ë¬´ë¦¬ ì‹œë®¬ë ˆì´ì…˜ì—ì„œ ì™„ë²½í•˜ê²Œ ë™ì‘í•˜ë”ë¼ë„ ì‹¤ì œ ì„¼ì„œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ëŠ” í° ì°¨ì´ë¥¼ ê°–ìŠµë‹ˆë‹¤. ì´ë²ˆ ë°ëª¨ì—ì„œëŠ” ë‹¤ì–‘í•œ ì„¼ì„œë“¤ì„ ROS 2 ì—°ë™í•˜ì—¬ ì‹¤í–‰í•´ë³´ê³ , ì„±ëŠ¥ì„ ë¹„êµí•´ë³´ê² ìŠµë‹ˆë‹¤. (í•˜ë‹¨ ë¡œê·¸ëŠ” ì œê°€ ë°ëª¨í•˜ê¸° ìœ„í•œ ëª…ë ¹ì–´ì…ë‹ˆë‹¤.)\nOrbbec Astra+ cd ~/gemini_ws/ source install/local_setup.bash ros2 launch orbbec_camera astra_pro_plus.launch.xml rviz2 \u0026amp; rqt top Orbbec Gemini2 ros2 launch orbbec_camera gemini2.launch.xml Intel Realsense2 D455 cd ~/realsense_ws/ source install/local_setup.bash ros2 launch realsense2_camera rs_launch.py pointcloud.enable:=true ì†Œí˜• ë¡œë´‡ ë°ëª¨ë¥¼ í†µí•´ ì‚´í´ë³´ëŠ” ë¡œë´‡ ì‹œìŠ¤í…œ nanosaur ì†Œê°œ NanosaurëŠ” íƒ±í¬ íƒ€ì…ì˜ ë¡œë´‡ìœ¼ë¡œ NVIDIAì˜ ê°œë°œì Raffaello Bonghiê°€ ë°°í¬í•œ ì˜¤í”ˆì†ŒìŠ¤ì— ê¸°ë°˜í•˜ì—¬ Road Balanceê°€ êµìœ¡ìš© í‚¤íŠ¸ë¡œ ì¬ì„¤ê³„í•œ ë¡œë´‡ì…ë‹ˆë‹¤. ìì„¸í•œ ìŠ¤í™ê³¼ ê¸°ëŠ¥ì€ ë§í¬ë¥¼ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. - link\nnanosaur ì œì–´ ROS_DOMAIN_ID=30 ros2 run nanosaur_hardware nanosaur rqt_robot_steering nanosaur ì¹´ë©”ë¼ ROS_DOMAIN_ID=30 ros2 run nanosaur_camera nanosaur_camera ros2 run rqt_image_view rqt_image_view ì´ë²ˆ ë°ëª¨ë¥¼ í†µí•´ ROS 2ì˜ ì¥ì ì„ ì—¿ë³¼ ìˆ˜ ìˆëŠ”ë°ìš”. ROS 2ëŠ” DDSë¼ëŠ” í‘œì¤€ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë™ì¼í•œ ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ì‹œìŠ¤í…œ ë‚´ë¶€ì—ì„œ ë™ì‘í•˜ëŠ” ì‹œìŠ¤í…œë“¤ë¼ë¦¬ëŠ” ìë™ìœ¼ë¡œ ìƒí˜¸ ì¸ì§€ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì¥ì ì„ ê°€ì§„ ROS 2ëŠ” ë¡œë´‡ ë¿ë§Œ ì•„ë‹ˆë¼ ììœ¨ì£¼í–‰ ë¶„ì•¼ë¡œ í™•ëŒ€ë˜ì–´ í˜„ì¬ ë‹¤ì–‘í•œ ë„ë©”ì¸ì—ì„œ ìˆ˜ìš”ê°€ ë§ì€ ìƒí™©ì…ë‹ˆë‹¤. ë¹„ë¡¯ ì§€ê¸ˆì€ ë§¤ìš° ì‘ì€ Nanosaurë¥¼ ì‚´í´ë³´ì•˜ì§€ë§Œ ì‹¤ì œ ë¡œë´‡ì„ ë§Œë“¤ê¸°ê¹Œì§€ ë¡œë´‡ ê³µí•™ìë“¤ì€ ë‹¤ì–‘í•œ ê³¼ì •ì„ ê±°ì¹˜ê³  ìˆ˜ì •, ê²€ì¦ì„ ë°˜ë³µí•©ë‹ˆë‹¤. ì„¤ê³„ì™€ ê²€ì¦ê¹Œì§€ êµ¬í˜„í•˜ê¸°ë„ ë²…ì°¬ ì™€ì¤‘, ì„¼ì„œ ì—°ë™ê¹Œì§€ ê°œë°œí•˜ëŠ” ê²ƒì€ ë§¤ìš° í˜ë“¤ê¸°ì— ëŒ€ë¶€ë¶„ ROS ê°œë°œìë“¤ì€ ê²€ì¦ëœ ì½”ë“œì™€ ì˜ˆì‹œë¥¼ ì œê³µí•˜ëŠ” ì œí’ˆë“¤ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.\nIntel Realsense ZED Stereo Camera Oak-D AI Camera Livox 3D Lidar ë‹¨ìˆœ ROS 2 íŒ¨í‚¤ì§€ê°€ ì¡´ì¬í•˜ëŠ” ê²ƒ ë¿ë§Œ ì•„ë‹ˆë¼, ì¹´ë©”ë¼ì™€ ê°™ì´ ë©”ëª¨ë¦¬ì™€ ì²˜ë¦¬ ì†ë„ì— ë¯¼ê°í•œ ì„¼ì„œëŠ” íš¨ìœ¨ì ì¸ ì½”ë“œë¥¼ ì œê³µí•˜ëŠ”ì§€ ì—¬ë¶€ê°€ ë¬´ì²™ ì¤‘ìš”í•©ë‹ˆë‹¤.\nNVIDIAì—ì„œ ì œê³µí•˜ëŠ” ROS 2 ì¹´ë©”ë¼ ì½”ë“œ í˜ì´ì§€ë¥¼ ì‚´í´ë³´ë©´ ì˜ˆì‹œì™€ í•¨ê»˜ ì‚¬ìš©ëœ í™˜ê²½, í•´ìƒë„ ë³„ ì„±ëŠ¥ì„ ì œì‹œí•˜ê³  ìˆìŠµë‹ˆë‹¤.\në”°ë¼ì„œ ì„¼ì„œë¥¼ ê°œë°œí•˜ê±°ë‚˜, ë¡œë´‡ì„ ê°œë°œí•˜ëŠ” ì…ì¥ ëª¨ë‘ ì‚¬ìš©ì í˜¸í™˜ì„±ì„ ê³ ë ¤í•˜ì—¬ ì„¤ê³„í•˜ê³ , ìˆ˜ë§ì€ ì‹œí–‰ì°©ì˜¤ë¥¼ í†µí•´ ì˜¬ë°”ë¥¸ ì œí’ˆì— ëŒ€í•œ ì²™ë„ë¥¼ ê¹¨ìš°ì³ì•¼ í•©ë‹ˆë‹¤.\n"
},
{
	"uri": "/kr/ros2_basic_foxy/lecture1/",
	"title": "Lecture1 - Introduction to ROS 2",
	"tags": [],
	"description": "",
	"content": "About ROS 2 image from : foxglove.dev ROSì˜ ì‹œì‘ì€ ì—°êµ¬ì‹¤ì´ì—ˆìŠµë‹ˆë‹¤. êµ¬ê¸€ì˜ í•µì‹¬ ê°œë°œìì˜€ë˜ Scott Hassanì€ 2006ë…„ Willow Garageë¥¼ ì„¤ë¦½í•˜ì˜€ê³ , ì—¬ê¸°ì„œ ì²˜ìŒìœ¼ë¡œ ROSê°€ íƒ„ìƒí•˜ì˜€ìŠµë‹ˆë‹¤. ì´í›„ Willow GarageëŠ” ì—¬ëŸ¬ Spin-offë¥¼ ê±°ì¹œ ë’¤ OSRFì™€ OSRCë“±ìœ¼ë¡œ ë‚˜ë‰˜ê²Œ ë˜ì—ˆê³ , í˜„ì¬ Gazeboì™€ ROSëŠ” ì´ë“¤ì— ì˜í•´ ê´€ë¦¬ë˜ê³  ìˆìŠµë‹ˆë‹¤.\n2022ë…„ 12ì›” ê¸°ì¤€ êµ¬ê¸€ì˜ ìíšŒì‚¬ì¸ Alphabetì˜ Intrinsicì´ OSRFë¥¼ í’ˆê²Œ ë˜ì—ˆìœ¼ë©°, Ubuntu Linuxë¥¼ ê´€ë¦¬í•˜ëŠ” Canonicalì—ì„œ ROSì˜ ê³µì‹ ì„œí¬íŠ¸ë¥¼ ì•½ì†í•˜ê³ , Jetson ë³´ë“œì™€ Issac Simë“¤ì„ ê°œë°œí•˜ê³  ìˆëŠ” Nvidiaì—ì„œë„ ROSë¥¼ ê³µì‹ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nì´ë ‡ê²Œ ë§ì€ ê¸°ì—…ë“¤ì´ ROSì— ê±°ëŠ” ê¸°ëŒ€ê°€ í° ë§Œí¼ ë¡œë´‡ ì‹œì¥ì˜ ì„±ì¥ì„±ë„ ê¸°ëŒ€ê°€ ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ, ë¡œë´‡ì´ ìƒìš©í™”ë˜ê¸° ìœ„í•´ì„œëŠ” ì—¬ëŸ¬ ë‚œê´€ì´ ìˆìŠµë‹ˆë‹¤.\në³´ì•ˆ ì•ˆì •ì„± ì‹¤ì‹œê°„ì„± ê°œë°œ ìš©ì´ì„± ê¸°ìˆ  ì§€ì› í•˜ë“œì›¨ì–´ ì—°ë™ etcâ€¦ ì—°êµ¬ìš©ìœ¼ë¡œ ì„¤ê³„ëœ ê¸°ì¡´ ROSë¥¼ í†µí•´ì„œëŠ” ì´ëŸ¬í•œ ëª¨ë“  ì¡°ê±´ì„ ì¶©ì¡±í•  ìˆ˜ ì—†ë‹¤ëŠ” ê²°ë¡ ì„ ë‚´ë ¸ê³ , Open RoboticsëŠ” ROS 2ë¥¼ ìƒˆë¡­ê²Œ ì„ ë³´ì´ê²Œ ë©ë‹ˆë‹¤.\nROS 1 vs ROS 2 ê¸°ì¡´ ì–¸ê¸‰ë˜ì—ˆë˜ ROS 1ì˜ ëª¨ë“  ë¬¸ì œë“¤ì´ ROS 2ì—ì„œ í•´ê²°ë˜ì—ˆë‹¤ê³  í•  ìˆ˜ëŠ” ì—†ì§€ë§Œ ì ì–´ë„ í•´ê²°ì„ ê³ ë ¤í•˜ì—¬ ì„¤ê³„ë˜ì—ˆë‹¤ê³  ë§í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤.\nROS 1ê³¼ ë¹„êµí•˜ì—¬ ROS 2ì˜ ì¥ì ë“¤ì„ ê°„ë‹¨íˆ ì‚´í´ë´…ì‹œë‹¤.\nimage from : maker.pro ìƒìš©í™”ë¥¼ ê³ ë ¤í•œ ê°€ì¥ í° ë³€í™”ë¡œ íŒ¨í‚· í†µì‹ ì— TCPROS/UPDROSê°€ ì•„ë‹Œ DDS(Data Distribution Service)ë¥¼ ë„ì…í•˜ì˜€ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.\nimage from : omg.org ë¿ë§Œ ì•„ë‹ˆë¼, ì„ë² ë””ë“œ ì‹œìŠ¤í…œì„ ìœ„í•œ micro-rosì™€ ê°™ì€ ë©‹ì§„ í”„ë¡œì íŠ¸ë“¤ë„ ROS 2ì—ì„œ ìƒˆë¡­ê²Œ ë“±ì¥í•˜ì˜€ìŠµë‹ˆë‹¤.\nimage from : freertos ì´ë ‡ê²Œ ë©‹ì§„ ROS 2ë¥¼ ì§€ê¸ˆë¶€í„° í•¨ê»˜ ë°°ì›Œë³´ê² ìŠµë‹ˆë‹¤.\nAbout this lecture ROS 1 ê°•ì˜ì—ì„œëŠ” ROS Noetic ë²„ì „ì„ ì‚¬ìš©í•˜ì˜€ìœ¼ë©°, ë™ì¼í•œ Ubuntu 20.04 ë²„ì „ì—ì„œ êµ¬ë™ë˜ëŠ” ROS 2 Foxyë¥¼ ì‚¬ìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤.\nROS ì„¤ì •ì„ ì˜ ë”°ë¼ì˜¤ì…¨ë‹¤ë©´ ë³„ë„ì˜ ì„¤ì¹˜ ê³¼ì •ì€ í•„ìš” ì—†ìœ¼ë©°, ë¦¬ëˆ…ìŠ¤ ì»¤ë©˜ë“œ ì‚¬ìš©ë²•, íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë“± ê¸°ë³¸ì ì¸ ë‚´ìš©ì€ ì•Œê³  ìˆë‹¤ëŠ” ê°€ì • í•˜ì— ê°•ì˜ë¥¼ ì§„í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.\nimage from : docs.ros.org ROS 1ê°•ì˜ë¥¼ í†µí•´ íƒ„íƒ„í•˜ê²Œ ë‹¤ì§„ ê¸°ë³¸ê¸°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì€ ë‚´ìš©ë“¤ì„ ë‹¤ë¤„ë´…ë‹ˆë‹¤.\nROS 2 ê¸°ë³¸ ì»¤ë©˜ë“œ C++ ROS í”„ë¡œê·¸ë˜ë° Nav 2ë¥¼ ì‚¬ìš©í•œ ììœ¨ì£¼í–‰ ì‹¤ì œ ë¡œë´‡ ë°ì´í„° í™œìš©í•´ë³´ê¸° ê³¼ì œë¥¼ í†µí•œ ROS 2 ì‘ìš© í”„ë¡œê·¸ë˜ë° ë”ë¶ˆì–´, ì´ë²ˆ ê°•ì˜ë¥¼ í†µí•´ ì‹¤ì œ ë¡œë´‡ì´ ì–´ë–»ê²Œ ê°œë°œë˜ëŠ”ì§€ ë°”ë‹¥ë¶€í„° ì‚´í´ë³´ê³ ì í•©ë‹ˆë‹¤.\në¡œë´‡ ì„¤ê³„ ì‹œë®¬ë ˆì´ì…˜ ì œì‘ê³¼ ì‹¤ìŠµ ì‹¤ì œ ë¡œë´‡ì„ ë§Œë“¤ê¸° ìœ„í•´ í•„ìš”í•œ ìš”ì†Œë“¤ ìœ ì§€ ë³´ìˆ˜ì™€ ë¡œë´‡ ì œí’ˆ ê°œë°œ Road Balanceì˜ ì°¨ëŸ‰í˜• êµìœ¡ ë¡œë´‡, SRCë¥¼ í†µí•´ ì‹¤ìŠµí•´ë³´ê² ìŠµë‹ˆë‹¤.\nê°•ì˜ë¥¼ ìˆ˜ê°•í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì„ ìˆ˜ì§€ì‹ ROS 2ëŠ” Python 3ì™€ C++ 11ì´ìƒì˜ ë²„ì „ì„ ì§€ì›í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ìµœì†Œí•œì˜ í”„ë¡œê·¸ë˜ë° ì§€ì‹ì´ ìˆë‹¤ëŠ” ê°€ì • í•˜ì— ê°•ì˜ê°€ ì§„í–‰ë˜ë©°, í™˜ê²½ ì„¤ì •, ROS ê°œë… ë“± ROS 1 ê°•ì˜ë¥¼ ëª¨ë‘ ìˆ˜ê°•í–ˆë‹¤ëŠ” ì „ì œ í•˜ì— ì§„í–‰ë©ë‹ˆë‹¤.\nimage from : docs.ros.org ì´ë²ˆ ê°•ì˜ì—ì„œëŠ” ì¢€ ë” ì‹¤ì§ˆì ì¸ ROS 2 ê°œë°œì„ ë§›ë³´ê³ ì C++ë¥¼ í™œìš©í•œ í”„ë¡œê·¸ë˜ë°ë„ ì¤€ë¹„í•´ ë³´ì•˜ìœ¼ë‹ˆ ì´ë²ˆ ê¸°íšŒì— C++ë¥¼ ê³µë¶€í•´ ë³´ëŠ” ê²ƒë„ ì¢‹ì€ ê¸°íšŒê°€ ë˜ì‹¤ ê²ë‹ˆë‹¤.\nROS 2 Workspace ìƒì„± ROS 1ì—ì„œ catkin build systemì„ ì‚¬ìš©í•œ ê²ƒê³¼ ìœ ì‚¬í•˜ê²Œ, ROS 2ì—ì„œëŠ” colconì´ë¼ëŠ” ë¹Œë“œ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. colconì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ Workspaceê°€ í•„ìš”í•˜ë©°, ROS 1ê³¼ ROS 2ë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ëŠ” í˜„ì¬ ì‹œìŠ¤í…œ ê°™ì€ ê²½ìš°, í˜¼ë€ìŠ¤ëŸ½ì§€ ì•Šë„ë¡ ì´ë¦„ì„ ë‹¬ë¦¬ ì„¤ì •í•˜ê² ìŠµë‹ˆë‹¤.\ncd ~/ mkdir -p ros2_ws/src cd ros2_ws colcon build ì•„ë˜ì™€ ê°™ì€ í´ë” êµ¬ì¡°ê°€ ìƒì„±ë˜ì—ˆì„ ê²ƒì…ë‹ˆë‹¤. build : ì»´íŒŒì¼ ëœ C++ í”„ë¡œê·¸ë¨, custom interface ë“±ì´ ìœ„ì¹˜í•˜ê²Œ ë©ë‹ˆë‹¤. install : ros2 launchì™€ ros2 run ë“±ì˜ ëª…ë ¹ì–´ëŠ” í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ ì‹œ ì´ install í´ë” ë‚´ íŒŒì¼ë“¤ì„ ì¡°íšŒí•©ë‹ˆë‹¤. ì¼ì¢…ì˜ ë°”ë¡œê°€ê¸°ë“¤ì˜ ëª¨ì„ì´ë¼ê³  ìƒê°í•˜ë©´ ë©ë‹ˆë‹¤. log : colcon build ì‹œ ë°œìƒí•˜ëŠ” ë¡œë“œë“¤ì´ ìœ„ì¹˜í•˜ê²Œ ë©ë‹ˆë‹¤. src : ëª¨ë“  ì†ŒìŠ¤ ì½”ë“œë“¤ì´ ìœ„ì¹˜í•˜ê²Œ ë©ë‹ˆë‹¤. Packageë¥¼ ì§€ìš°ê³  ì‹¶ì€ ê²½ìš° â‡’ buildì™€ install í´ë”ì—ì„œ í•´ë‹¹ packageì— í•´ë‹¹í•˜ëŠ” ë‚´ìš©ë“¤ì„ ì‚­ì œí•©ë‹ˆë‹¤.\ncolconì„ ì‚¬ìš©í•˜ì—¬ packageë¥¼ ë¹Œë“œí•˜ëŠ” ë°©ë²•ë“¤ì„ ê°„ë‹¨íˆ ì†Œê°œí•©ë‹ˆë‹¤.\ncolcon build : src í´ë” ë‚´ë¶€ì— ì¡´ì¬í•˜ëŠ” ëª¨ë“  packageë“¤ì„ ë¹Œë“œí•©ë‹ˆë‹¤. colcon build \u0026ndash;packages-up-to : í•´ë‹¹ packageì˜ ì¢…ì†ì„±ì´ ì¡´ì¬í•  ì‹œ, ì´ë“¤ì„ ë¨¼ì € ë¹Œë“œí•˜ê³  pkg-nameì„ ë¹Œë“œí•©ë‹ˆë‹¤. colcon build \u0026ndash;packages-select : í•´ë‹¹ packageë§Œì„ ë¹Œë“œí•©ë‹ˆë‹¤. ìƒˆë¡œìš´ Packageë¥¼ ë¹Œë“œí•œ ë‹¤ìŒ ROS 2ì—ì„œë„ setup.bashë¥¼ source í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ ì‘ì—…ì—ëŠ” í¬ê²Œ ë‘ê°€ì§€ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.\nsource install/setup.bash â‡’ workspaceë¥¼ sourceí•˜ê³  ROS 2ì‹œìŠ¤í…œ ì „ì²´ë¥¼ ê°±ì‹ í•©ë‹ˆë‹¤. source install/local_setup.bash â‡’ workspaceë§Œì„ sourcesí•©ë‹ˆë‹¤. (ì—¬ëŸ¬ ROS 2 workspaceê°€ ìˆëŠ” ê²½ìš° local_setup.bashë¥¼ ì‚¬ìš©í•©ì‹œë‹¤.) # source chained prefixes # setting COLCON_CURRENT_PREFIX avoids determining the prefix in the sourced script COLCON_CURRENT_PREFIX=\u0026#34;/opt/ros/foxy\u0026#34; _colcon_prefix_chain_bash_source_script \u0026#34;$COLCON_CURRENT_PREFIX/local_setup.bash\u0026#34; # source this prefix # setting COLCON_CURRENT_PREFIX avoids determining the prefix in the sourced script COLCON_CURRENT_PREFIX=\u0026#34;$(builtin cd \u0026#34;`dirname \u0026#34;${BASH_SOURCE[0]}\u0026#34;`\u0026#34; \u0026gt; /dev/null \u0026amp;\u0026amp; pwd)\u0026#34; _colcon_prefix_chain_bash_source_script \u0026#34;$COLCON_CURRENT_PREFIX/local_setup.bash\u0026#34; unset COLCON_CURRENT_PREFIX unset _colcon_prefix_chain_bash_source_script ë§ˆì§€ë§‰ìœ¼ë¡œ, ì´ë²ˆ ì‹¤ìŠµì— í•„ìš”í•œ ì†ŒìŠ¤ ì½”ë“œë¥¼ clone í•˜ê³ , apt íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ë©´ì„œ, ê°•ì˜ë¥¼ ë§ˆì¹˜ê² ìŠµë‹ˆë‹¤.\ncd ~/ros2_ws/src git clone https://github.com/RB2023ROS/du2023-ros2.git cd du2023-ros2 ./setup_scripts.sh ì°¸ê³ ìë£Œ\nhttps://www.theconstructsim.com/infographic-ros-1-vs-ros-2-one-better-2/ https://rsl.ethz.ch/education-students/lectures/ros.html https://velog.io/@hwang-chaewon/ROS2006 "
},
{
	"uri": "/kr/ros2_basic_foxy/lecture2/",
	"title": "Lecture2 - ROS 2 Node, Package",
	"tags": [],
	"description": "",
	"content": " ROS Noetic ê°•ì˜ë¥¼ ì´ë¯¸ í•™ìŠµí•˜ì˜€ê¸° ë•Œë¬¸ì—, Node, Package, launch file, Topic, Message, Serviceì™€ ê°™ì€ ê°œë…ì€ ì´ë¯¸ ì•Œê³  ê³„ì‹¤ ê²ƒì´ë¼ ìƒê°í•©ë‹ˆë‹¤. (ë§ì£ ?)\ní˜¹ì‹œë‚˜ ìŠì–´ë²„ë¦¬ì…¨ì„ ìˆ˜ ìˆìœ¼ë‹ˆ ê°•ì˜ ì¤‘ê°„ì¤‘ê°„ ì œê°€ ê°„ë‹¨íˆ ë¦¬ë·°ë¥¼ í•˜ë©´ì„œ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.\nROS 2 Node image from : docs.rog.org ROSì—ì„œì˜ NodeëŠ” í•˜ë‚˜ì˜ ì‹¤í–‰ ê°€ëŠ¥í•œ í”„ë¡œê·¸ë¨ì„ ì´ì•¼ê¸°í•˜ë©°, ê°ê°ì˜ NodeëŠ” ë³¸ì¸ ê³ ìœ ì˜ ê¸°ëŠ¥ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.\nì„œë¡œ ë‹¤ë¥¸ ì—­í• ì„ ë‹´ë‹¹í•˜ëŠ” Nodeë“¤ì´ ê°ìì˜ ë™ì‘ì„ ìˆ˜í–‰í•˜ê³  ì„œë¡œ ê°„ì˜ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ê²Œ ë¨ìœ¼ë¡œ ì‹œìŠ¤í…œì„ í˜•ì„±í•˜ê²Œ ë˜ê³ , ë”°ë¼ì„œ, ROSë¥¼ í†µí•œ ë¡œë´‡ ê°œë°œì€ ê³§, ì ì ˆí•œ Nodeë“¤ì˜ ê°œë°œì´ë¼ê³ ë„ ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nROS 2 Node ì‹¤í–‰ - ROS 2ì—ì„œ Nodeì˜ ì‹¤í–‰ì€ ros2 run \u0026lt;pkg-name\u0026gt; \u0026lt;executable-name\u0026gt;ì…ë‹ˆë‹¤. sudo apt install ros-foxy-turtlesim -y ros2 run turtlesim turtlesim_node ROS 2ì˜ Nodeë¥¼ ë‹¤ë£¨ëŠ” ëª…ë ¹ì–´ëŠ” ROS 1ê³¼ í¬ê²Œ ë‹¤ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. $ ros2 node list /teleop_turtle /turtlesim $ ros2 node info /turtlesim /turtlesim Subscribers: /parameter_events: rcl_interfaces/msg/ParameterEvent /turtle1/cmd_vel: geometry_msgs/msg/Twist Publishers: /parameter_events: rcl_interfaces/msg/ParameterEvent /rosout: rcl_interfaces/msg/Log /turtle1/color_sensor: turtlesim/msg/Color /turtle1/pose: turtlesim/msg/Pose Service Servers: /clear: std_srvs/srv/Empty â€¦ rqt_graphë„ ë™ì¼í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. $ rqt_graph ROS 2 Package ROSì˜ PackageëŠ” íŒŒì¼ ê´€ì ì—ì„œ ê´€ë ¨ëœ ì†ŒìŠ¤ì½”ë“œ, ë¼ì´ë¸ŒëŸ¬ë¦¬, ëª¨ë¸ë§ íŒŒì¼ë“¤, ì„¤ì • íŒŒì¼ë“¤ì„ í•œë° ëª¨ì•„ë‘” í´ë”ë¡œ ìƒê°í•  ìˆ˜ ìˆìœ¼ë©°, ê¸°ëŠ¥ ê´€ì ì—ì„œ ì‹œë®¬ë ˆì´ì…˜, í•˜ë“œì›¨ì–´ ì œì–´, ì„¼ì„œ ë‹¤ë£¨ê¸° ë“±ìœ¼ë¡œ ë¶„ë¦¬ì‹œí‚¨ ëª¨ë“ˆë¡œ ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nimage from : packthub ìƒˆë¡œìš´ íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•˜ëŠ” ê³¼ì •ì—ì„œ, ROS 2ëŠ” ROS 1ê³¼ ì°¨ì´ì ì´ ìˆìŠµë‹ˆë‹¤.\nROS 1ì—ì„œ catkin_create_packageë¥¼ ì‚¬ìš©í–ˆë˜ ê²ƒì²˜ëŸ¼, ROS 2ì—ì„œëŠ” colconì„ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ packageë¥¼ ìƒì„±í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ, ROS 2ì—ì„œëŠ” ì‚¬ìš©í•˜ëŠ” í”„ë¡œê·¸ë˜ë° ì–¸ì–´(python/c++)ì— ë”°ë¼ ë‹¤ë¥¸ build typeì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nROS 2 Python Package íŒŒì´ì¬ íŒ¨í‚¤ì§€ì˜ ìƒì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. $ ros2 pkg create --build-type ament_python \u0026lt;package_name\u0026gt; $ ros2 pkg create --build-type ament_python my_first_pkg going to create a new package package name: my_first_pkg destination directory: /home/kimsooyoung/ros2_ws/src package format: 3 version: 0.0.0 ... ê·¸ë¦¬ê³ , ë‹¤ìŒê³¼ ê°™ì€ í´ë” êµ¬ì¡°ê°€ ìë™ ìƒì„±ë©ë‹ˆë‹¤. my_first_pkg/ â”œâ”€â”€ my_first_pkg â”‚Â â””â”€â”€ __init__.py â”œâ”€â”€ package.xml â”œâ”€â”€ resource â”‚Â â””â”€â”€ my_first_pkg â”œâ”€â”€ setup.cfg â”œâ”€â”€ setup.py â””â”€â”€ test â”œâ”€â”€ test_copyright.py â”œâ”€â”€ test_flake8.py â””â”€â”€ test_pep257.py ìƒˆë¡­ê²Œ ë§Œë“  íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œí•´ë´…ì‹œë‹¤. $ cd ~/ros2_ws $ colcon build --packages-select my_first_pkg Starting \u0026gt;\u0026gt;\u0026gt; my_first_pkg Finished \u0026lt;\u0026lt;\u0026lt; my_first_pkg [1.56s] Summary: 1 package finished [1.96s] $ source install/local_setup.bash ìƒì„±í•œ íŒŒì´ì¬ ì½”ë“œ íŒ¨í‚¤ì§€ì—ì„œ, ì‹¤ì œ íŒŒì´ì¬ ì½”ë“œëŠ” ì–´ë””ì— ìœ„ì¹˜í• ê¹Œìš”?\nìƒˆë¡œìš´ íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•˜ë©´ í•´ë‹¹ íŒ¨í‚¤ì§€ í´ë” ì•ˆì— íŒ¨í‚¤ì§€ ì´ë¦„ê³¼ ë™ì¼í•œ í´ë”ê°€ í•˜ë‚˜ ìœ„ì¹˜í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ í´ë” ì•ˆì—ëŠ” init.py íŒŒì¼ì´ ê¸°ë³¸ì ìœ¼ë¡œ ìœ„ì¹˜í•©ë‹ˆë‹¤. ì°¸ê³ ë¡œ, wslì—ì„œ íŒŒì¼ íƒìƒ‰ê¸°ë¥¼ ì—´ê¸° ìœ„í•´ì„œëŠ” explorer.exe . ë¥¼ ì…ë ¥í•˜ì‹œë©´ ë©ë‹ˆë‹¤.\nê°•ì˜ ì˜ˆì‹œ ì†ŒìŠ¤ì½”ë“œë¥¼ í•˜ë‚˜ ëŒì–´ì™€ ë¹Œë“œí•´ë³´ê² ìŠµë‹ˆë‹¤. ì•„ì£¼ ê°„ë‹¨í•œ íŒŒì´ì¬ ì˜ˆì‹œê°€ ì‹¤í–‰ë  ê²ƒì…ë‹ˆë‹¤. $ cd ~/ros2_sw $ colcon build --packages-select py_node_tutorial Starting \u0026gt;\u0026gt;\u0026gt; py_node_tutorial Finished \u0026lt;\u0026lt;\u0026lt; py_node_tutorial [1.85s] Summary: 1 package finished [2.14s] $ source install/local_setup.bash $ ros2 run py_node_tutorial example_node_1 [INFO] [1672462290.252773294] [example_node_1]: ==== Hello ROS 2 ==== ì—¬ê¸°ì„œ ì£¼ëª©í•  ì ì€, nodeì˜ ì‹¤í–‰ ì‹œ roscoreê°€ ì—†ì–´ë„ ëœë‹¤ëŠ” ì ì…ë‹ˆë‹¤. DDSë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œ ê°ê°ì˜ nodeê°€ ë¶„ì‚° ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ê°€ëŠ¥í•œ ê²ƒì…ë‹ˆë‹¤.\nimage from : design.ros2.org ROS 2 C++ Package ëŒ€ë¶€ë¶„ì˜ ì˜¤í”ˆì†ŒìŠ¤ íŒ¨í‚¤ì§€ë“¤ì€ C++ë¡œ ê°œë°œë˜ì–´ ìˆëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤. turtlesimì˜ ì†ŒìŠ¤ì½”ë“œë¥¼ í™•ì¸í•´ë´…ì‹œë‹¤.\nhttps://github.com/ros/ros_tutorials\nëª¨ë‘ C++ë¡œ ê°œë°œë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, ì‹¤ì œ ì‘ì—… ì‹œ íŒŒì´ì¬ì„ ìœ„ì£¼ë¡œ ì‚¬ìš©í•˜ë”ë¼ë„ ì ì–´ë„ C++ íŒ¨í‚¤ì§€ì˜ êµ¬ì¡°ëŠ” íŒŒì•…í•˜ê³  ìˆì–´ì•¼ ì˜¤ë¥˜ ìƒí™©ì— ëŒ€ì²˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nC++ íŒ¨í‚¤ì§€ì˜ ìƒì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. $ ros2 pkg create --build-type ament_cmake \u0026lt;package_name\u0026gt; $ ros2 pkg create --build-type ament_cmake my_first_cpp_pkg going to create a new package package name: my_first_cpp_pkg destination directory: /home/kimsooyoung/ros2_ws/src package format: 3 version: 0.0.0 ... C++ íŒ¨í‚¤ì§€ëŠ” ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¥¼ ê°–ìŠµë‹ˆë‹¤. íŒŒì´ì¬ê³¼ ë‹¬ë¦¬, C++ëŠ” ì»´íŒŒì¼ ì–¸ì–´ì´ê¸° ë•Œë¬¸ì— CMakeë¥¼ ìœ„í•œ CMakeLists.txt íŒŒì¼ì´ ì¶”ê°€ë˜ì–´ ìˆìŠµë‹ˆë‹¤. my_first_cpp_pkg â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ include â”‚Â â””â”€â”€ my_first_cpp_pkg â”œâ”€â”€ package.xml â””â”€â”€ src ì¼ë°˜ì ìœ¼ë¡œ C++ ê°œë°œì„ í•˜ë‹¤ë³´ë©´ headerì™€ sourceì˜ ë¶„ë¦¬ë¥¼ ì‹œí‚¤ê³¤ í•©ë‹ˆë‹¤.\nì´ë¥¼ ìœ„í•´ ë³´í†µ include í´ë” ì•ˆì— í—¤ë” íŒŒì¼ì„ ìœ„ì¹˜ì‹œí‚¤ê³ , src í´ë” ì•ˆì— ì†ŒìŠ¤ ì½”ë“œë¥¼ ìœ„ì¹˜ì‹œí‚µë‹ˆë‹¤.\në¹Œë“œì™€ ì‹¤í–‰ì€ C++ íŒ¨í‚¤ì§€ë„ ë™ì¼í•œ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. $ colcon build --packages-select cpp_node_tutorial $ source install/local_setup.bash Starting \u0026gt;\u0026gt;\u0026gt; cpp_node_tutorial Finished \u0026lt;\u0026lt;\u0026lt; cpp_node_tutorial [0.42s] Summary: 1 package finished [0.64s] $ ros2 run cpp_node_tutorial example_node_1 [INFO] [1672462275.581606122] [example_node_1]: ==== Hello ROS 2 ==== aptë¥¼ í†µí•œ íŒ¨í‚¤ì§€ ì‚¬ìš©í•˜ê¸° ë„ë¦¬ ì‚¬ìš©ë˜ê³  ê²€ì¦ëœ íŒ¨í‚¤ì§€ë“¤ì€ ì†ŒìŠ¤ ì½”ë“œ ë¹Œë“œ ì—†ì´ ëª…ë ¹ì–´ í•˜ë‚˜ë§Œìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ, ROS 1ê³¼ ROS 2, ê·¸ë¦¬ê³  ê°™ì€ ROS 2ì¼ì§€ë¼ë„ ë²„ì „ì— ë”°ë¼ ì¬ì„¤ì¹˜ë¥¼ í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.\n$ sudo apt install ros-\u0026lt;DISTRO\u0026gt;-\u0026lt;pkg-name\u0026gt; $ sudo apt install ros-foxy-turtlesim ì§€ê¸ˆê¹Œì§€ ìš°ë¦¬ê°€ ì‚¬ìš©í–ˆë˜ turtlesim, turtle_teleop_keyëŠ” ëª¨ë‘ apt install turtlesimì„ í†µí•´ ì„¤ì¹˜ê°€ ê°€ëŠ¥í•˜ì˜€ê¸°ì— ì½”ë“œì— ëŒ€í•œ ê³ ë ¤ ì—†ì´ ë°”ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë˜ ê²ƒì…ë‹ˆë‹¤.\nì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ROS ê°œë°œ ì´ˆê¸°ì—ëŠ” ë°”ë¡œ ì„¤ì¹˜ ê°€ëŠ¥í•œ íŒ¨í‚¤ì§€ë“¤ì„ ì¡°í•©í•˜ì—¬ ë¹ ë¥´ê²Œ ê²€ì¦ì„ í•˜ê³ , ì´í›„ ì§ì ‘ Customizingí•´ì•¼ í•˜ëŠ” ë¶€ë¶„ì€ ë³„ë„ ì†ŒìŠ¤ì½”ë“œ ë¹Œë“œë¥¼ í†µí•´ ì—…ê·¸ë ˆì´ë“œë¥¼ í•˜ê³¤ í•©ë‹ˆë‹¤.\nROS 2 Launch ROS 2ì˜ launchíŒŒì¼ì€ ê¸°ë³¸ì ìœ¼ë¡œ Python ë¬¸ë²•ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ê¸°ì¡´ ROS 1ì—ì„œ xml ë¬¸ë²•ì„ ì‚¬ìš©í•˜ë˜ ê²ƒì—ì„œ ë¹„êµí•˜ë©´, ë³´ë‹¤ ì†ì‰½ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆì–´ì¡ŒìŠµë‹ˆë‹¤.\nì˜ˆì œë¥¼ í†µí•´ ê¸°ë³¸ êµ¬ì¡°ì— ëŒ€í•´ ì§šê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤. $ cd ~/ros2_ws $ colcon build --packages-select src_description $ source install/local_setup.bash $ ros2 launch src_description src_description.launch.py ì‚¬ì§„ê³¼ ê°™ì´ RViz2ì™€ joint state publisher guiê°€ ë“±ì¥í•  ê²ƒì…ë‹ˆë‹¤. joint state publisher guiì˜ ìŠ¬ë¼ì´ë“œë°”ë¥¼ ì´ë¦¬ì €ë¦¬ ì˜®ê²¨ë³´ì„¸ìš”.\nROS 1 ê°•ì˜ì—ì„œ ë°°ì›Œë³´ì•˜ë˜ tfì— ëŒ€í•´ì„œë„ ë³µìŠµí•  ìˆ˜ ìˆëŠ” ê¸°íšŒì…ë‹ˆë‹¤.\nros2ì˜ launch ëª…ë ¹ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. $ ros2 launch \u0026lt;package-name\u0026gt; \u0026lt;launch-file-name\u0026gt; íŒ¨í‚¤ì§€ ë‚´ì— ì¡´ì¬í•˜ëŠ” íŠ¹ì • launch íŒŒì¼ì„ ì‹¤í–‰í•´ë¼, ë¼ëŠ” ëœ»ì´ ë©ë‹ˆë‹¤.\nì˜ˆì œ launch fileì„ ì‚´í´ë´…ì‹œë‹¤. ros2ì˜ launch fileì€ pythonê³¼ xmlì„ ì§€ì›í•©ë‹ˆë‹¤. python íŒŒì¼ì˜ ê²½ìš° .launch.pyë¡œ ì´ë¦„ì§“ëŠ” ê²ƒì´ ì¼ë°˜ì ì…ë‹ˆë‹¤.\ní•­ìƒ launch fileì˜ ë¶„ì„ì€ ê°€ì¥ í•˜ë‹¨ë¶€í„° ì‹œì‘í•©ë‹ˆë‹¤. return LaunchDescription([ TimerAction( period=3.0, actions=[rviz2] ), robot_state_publisher, joint_state_publisher_gui, ]) LaunchDescription[] ì•ˆì— ìœ„ì¹˜í•œ í”„ë¡œê·¸ë¨ë“¤ì„ ë™ì‹œì— ì‹¤í–‰í•˜ëŠ” ê²ƒì´ launch fileì„ ì‘ì„±í•˜ëŠ” ì´ìœ ì…ë‹ˆë‹¤.\nìƒë‹¨ ì˜µì…˜ì„ í•˜ë‚˜ì”© ì‚´í”¼ê² ìŠµë‹ˆë‹¤. launch fileì—ì„œ íŠ¹ì • í´ë”, íŒŒì¼ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ packageì— ê¸°ë°˜í•˜ì—¬ ê²½ë¡œë¥¼ íƒìƒ‰í•©ë‹ˆë‹¤. def generate_launch_description(): pkg_path = os.path.join(get_package_share_directory(\u0026#34;src_description\u0026#34;)) rviz_config_file = os.path.join(pkg_path, \u0026#34;rviz\u0026#34;, \u0026#34;description.rviz\u0026#34;) urdf_file = os.path.join(pkg_path, \u0026#34;urdf\u0026#34;, \u0026#34;src_body.urdf\u0026#34;) urdf - Unified Robotics Description Formatë€ ë¡œë´‡ì˜ í˜•ìƒì„ íŒŒì¼ë¡œ í‘œí˜„í•˜ëŠ” ì¼ì¢…ì˜ í¬ë©§ì…ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;!-- =================================================================================== --\u0026gt; \u0026lt;!-- | This document was autogenerated by xacro from /home/kimsooyoung/ros2_ws/src/du2023-ros2/src_gazebo/urdf/src_body.urdf.xacro | --\u0026gt; \u0026lt;!-- | EDITING THIS FILE BY HAND IS NOT RECOMMENDED | --\u0026gt; \u0026lt;!-- =================================================================================== --\u0026gt; \u0026lt;robot name=\u0026#34;src_body\u0026#34;\u0026gt; \u0026lt;material name=\u0026#34;silver\u0026#34;\u0026gt; \u0026lt;color rgba=\u0026#34;0.700 0.700 0.700 1.000\u0026#34;/\u0026gt; \u0026lt;/material\u0026gt; \u0026lt;material name=\u0026#34;black\u0026#34;\u0026gt; \u0026lt;color rgba=\u0026#34;1.000 1.000 1.000 1.000\u0026#34;/\u0026gt; \u0026lt;/material\u0026gt; \u0026lt;material name=\u0026#34;blue\u0026#34;\u0026gt; \u0026lt;color rgba=\u0026#34;0.0 0.0 0.8 1.0\u0026#34;/\u0026gt; \u0026lt;/material\u0026gt; \u0026lt;material name=\u0026#34;green\u0026#34;\u0026gt; \u0026lt;color rgba=\u0026#34;0.0 0.8 0.0 1.0\u0026#34;/\u0026gt; \u0026lt;/material\u0026gt; \u0026lt;material name=\u0026#34;grey\u0026#34;\u0026gt; \u0026lt;color rgba=\u0026#34;0.2 0.2 0.2 1.0\u0026#34;/\u0026gt; \u0026lt;/material\u0026gt; ... image from : http://library.isr.ist.utl.pt/ srcì˜ urdfì™€ description ê²°ê³¼ë¥¼ í•¨ê»˜ ì‚´í´ë³´ë©´ì„œ urdfì— ëŒ€í•œ ê°œë…ì„ ìµí˜€ë´…ì‹œë‹¤.\nurdfë¥¼ ìƒì„±í•˜ëŠ” ì—¬ëŸ¬ ë°©ë²•ë“¤ì´ ìˆìŠµë‹ˆë‹¤.\nxacroì™€ í•¨ê»˜ ì§ì ‘ í…ìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ê¸° CAD í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ê¸° SOLIDWORKS Fusion 360 blender ì‹œë®¬ë ˆì´ì…˜ í”„ë¡œê·¸ë¨ ë‚´ model builder ì‚¬ìš©í•˜ê¸° Gazebo Colleliasim ì €ì˜ ê²½ìš°, Fusion 360ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì˜¤í”ˆì†ŒìŠ¤ urdf exporterë¥¼ í†µí•´ ì‹œë®¬ë ˆì´ì…˜ì„ ê°œë°œí•˜ì˜€ìŠµë‹ˆë‹¤.\nhttps://github.com/syuntoku14/fusion2urdf\nurdfë¥¼ ì‚¬ìš©í•˜ì—¬ ROSì—ê²Œ ë¡œë´‡ì— ëŒ€í•œ ì •ë³´ë¥¼ ì „ë‹¬í•˜ê³  ì§€ì† ì£¼ì‹œí•˜ëŠ” ê²ƒì´ ì•„ë˜ ë‘ Nodeì˜ ì—­í• ì…ë‹ˆë‹¤. joint_state_publisher_gui = Node( package=\u0026#34;joint_state_publisher_gui\u0026#34;, executable=\u0026#34;joint_state_publisher_gui\u0026#34;, name=\u0026#34;joint_state_publisher_gui\u0026#34;, ) robot_state_publisher = Node( package=\u0026#39;robot_state_publisher\u0026#39;, executable=\u0026#39;robot_state_publisher\u0026#39;, name=\u0026#39;robot_state_publisher\u0026#39;, output=\u0026#39;screen\u0026#39;, parameters=[{\u0026#39;use_sim_time\u0026#39;: True}], arguments=[urdf_file], ) launch file ë¶„ì„ì˜ ë§ˆì§€ë§‰ìœ¼ë¡œ Rviz2 ì‹¤í–‰ì…ë‹ˆë‹¤. Rvizì™€ ë™ì¼í•˜ê²Œ launch fileì—ì„œ config optionì„ ì¤„ ìˆ˜ ìˆìœ¼ë©°, TimerActionì„ í†µí•´ 3ì´ˆì˜ ì—¬ìœ ë¥¼ ê°–ê³  ì‹¤í–‰í•˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤. # Launch RViz rviz2 = Node( package=\u0026#34;rviz2\u0026#34;, executable=\u0026#34;rviz2\u0026#34;, name=\u0026#34;rviz2\u0026#34;, output=\u0026#34;screen\u0026#34;, arguments=[\u0026#34;-d\u0026#34;, rviz_config_file], ) return LaunchDescription([ TimerAction( period=3.0, actions=[rviz2] ), ROS 2ì˜ launch file ì‘ì„±ë²•ì„ ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•˜ê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤. robot_state_publisher = Node( package=\u0026#39;robot_state_publisher\u0026#39;, executable=\u0026#39;robot_state_publisher\u0026#39;, output=\u0026#39;screen\u0026#39;, parameters=[robot_description] ) Node : Node í•˜ë‚˜ë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆëŠ” ì˜µì…˜ì…ë‹ˆë‹¤. package : ì‹¤í–‰ì‹œí‚¬ Nodeê°€ í¬í•¨ëœ packageë¥¼ ì„ íƒí•´ì¤ë‹ˆë‹¤. executable : c++ Nodeì˜ ê²½ìš°, colcon buildë¥¼ í•˜ë©´ ì‹¤í–‰ ê°€ëŠ¥í•œ í”„ë¡œê·¸ë¨ì´ ìƒì„±ë©ë‹ˆë‹¤. pythonì˜ ê²½ìš°ë„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰ ì‹œí‚¤ê²Œ ë˜ë©°, ì¶”í›„ ì½”ë”© ì‹¤ìŠµì„ ê±°ì¹˜ë©´ ì™„ë²½íˆ ì´í•´í•˜ì‹¤ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤. parameters : ì‹¤í–‰ì‹œí‚¬ Nodeì˜ ì¶”ê°€ ë§¤ê°œë³€ìˆ˜ê°€ ìˆë‹¤ë©´ ì´ ë¶€ë¶„ì— ì¶”ê°€ë©ë‹ˆë‹¤. ì´ë ‡ê²Œ launch file í•˜ë‚˜ë¥¼ ë¶„ì„í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, ì œê°€ ë³´ì—¬ë“œë¦° ê²ƒì€ í•˜ë‚˜ì˜ ì˜ˆì‹œì¼ ë¿ì´ë©°, launch fileì€ ì—¬ëŸ¬ í˜•ì‹ìœ¼ë¡œ ì‚¬ìš©ë˜ê³  ìˆìŠµë‹ˆë‹¤.\nì¼ë¡€ë¡œ, ììœ¨ ì£¼í–‰ ì‹œ ì‚¬ìš©ë˜ëŠ” nav2 íŒ¨í‚¤ì§€ì˜ lanuch fileì€ ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœë¥¼ ê°–ìŠµë‹ˆë‹¤.\ndeclare_namespace_cmd = DeclareLaunchArgument( \u0026#39;namespace\u0026#39;, default_value=\u0026#39;\u0026#39;, description=\u0026#39;Top-level namespace\u0026#39;) ... # Create the launch description and populate ld = LaunchDescription() # Set environment variables ld.add_action(stdout_linebuf_envvar) # Declare the launch options ld.add_action(declare_namespace_cmd) ld.add_action(declare_use_namespace_cmd) ld.add_action(declare_slam_cmd) ld.add_action(declare_map_yaml_cmd) ld.add_action(declare_use_sim_time_cmd) ld.add_action(declare_params_file_cmd) ld.add_action(declare_autostart_cmd) ld.add_action(declare_bt_xml_cmd) # Add the actions to launch all of the navigation nodes ld.add_action(bringup_cmd_group) return ld ì•„ì§ í”„ë¡œê·¸ë˜ë°ì„ ì‹œì‘í•˜ì§€ë„ ì•Šì•˜ê¸° ë•Œë¬¸ì—, launch fileì— ëŒ€í•´ì„œ ëª¨ë‘ ì´í•´í•˜ë ¤ í•˜ì§€ëŠ” ì•Šìœ¼ì…”ë„ ë©ë‹ˆë‹¤. ë‚¨ì€ ê°•ì˜ë“¤ì—ì„œ ê³„ì†í•´ì„œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\n"
},
{
	"uri": "/kr/ros2_basic_foxy/lecture3/",
	"title": "Lecture3 - ROS 2 Node Programming, ROS 2 parameter",
	"tags": [],
	"description": "",
	"content": " Pythonì„ ì‚¬ìš©í•˜ì—¬ Node Programmingì„ ì‹¤ìŠµí•´ë´…ì‹œë‹¤. ê°•ì˜ ë§ˆì§€ë§‰ì—ëŠ” ê°„ë‹¨íˆ C++ ì½”ë”©ì— ëŒ€í•´ì„œë„ ë‹¤ë¤„ë³´ê² ìŠµë‹ˆë‹¤.\nexample 1 - Hello ROS 2 ê°•ì˜ë¥¼ ìœ„í•´ ì¤€ë¹„ëœ ì˜ˆì œ ì½”ë“œ íŒ¨í‚¤ì§€ë¥¼ ì‹¤ìŠµí•˜ê³  ë¶„ì„í•˜ê² ìŠµë‹ˆë‹¤.\n$ colcon build --packages-select cbp py_node_tutorial $ source install/local_setup.bash $ ros2 run py_node_tutorial example_node_1 [INFO] [1672463872.778216198] [example_node_1]: ==== Hello ROS 2 ==== ëª¨ë“  ì˜ˆì œ ì½”ë“œëŠ” ì•„ë˜ ë§í¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. https://github.com/RB2023ROS/du2023-ros2/tree/main/py_node_tutorial/py_node_tutorial\nì½”ë“œ ë¶„ì„ì„ ì°¨ê·¼ì°¨ê·¼ í•¨ê»˜ í•´ë³´ê² ìŠµë‹ˆë‹¤.\nrclì€ ROS Client Librariesì˜ ì•½ìë¡œ ROS 2ì—ì„œëŠ” rclc, rclcpp, rclpy, rcljsì™€ ê°™ì€ ë‹¤ì–‘í•œ ì–¸ì–´ë¥¼ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤. íŒŒì´ì¬ì—ì„œ ROS 2 ê°œë°œì„ í•˜ê¸° ìœ„í•´ì„œëŠ” í•„ìˆ˜ì ìœ¼ë¡œ rclpyì˜ importê°€ í•„ìš”í•˜ë©° Nodeì˜ ì‚¬ìš©ì„ ìœ„í•´ì„œëŠ” Node classë¥¼ import í•´ì•¼ í•©ë‹ˆë‹¤.\n# !/usr/bin/env python3 import rclpy from rclpy.node import Node rclpy ì½”ë”© ê·œì¹™ ROS 2ì—ì„œ íŒŒì´ì¬ íŒŒì¼ì„ ì¡°íšŒí•˜ê³  ì‹¤í–‰í•˜ëŠ” ê³¼ì •ì´ ìˆì–´ ì•„ë˜ì™€ ê°™ì´ main()ë¶€ë¶„ì„ í•­ìƒ ë”°ë¡œ ë¶„ë¦¬í•˜ì—¬ ì‘ì„±í•˜ë„ë¡ í•©ë‹ˆë‹¤.\nif __name__ == \u0026#39;__main__\u0026#39;: \u0026#34;\u0026#34;\u0026#34;main function\u0026#34;\u0026#34;\u0026#34; main() Node ìƒì„± def main(args=None): \u0026#34;\u0026#34;\u0026#34;Do enter into this main function first.\u0026#34;\u0026#34;\u0026#34; rclpy.init(args=args) node = Node(\u0026#39;node_name\u0026#39;) node.get_logger().info(\u0026#39;\\n==== Hello ROS 2 ====\u0026#39;) node.destroy_node() rclpy.shutdown() ì‹¤ì œ ë™ì‘ì„ ìˆ˜í–‰í•˜ëŠ” main í•¨ìˆ˜ë¥¼ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê³¼ì •ì„ ê±°ì¹˜ê³  ìˆìŠµë‹ˆë‹¤.\nrclpy.initì„ í†µí•´ initialization, ì¦‰ ì´ˆê¸°í™”ë¥¼ í•˜ê³  ìˆìŠµë‹ˆë‹¤. node = Node(\u0026rsquo;node_name\u0026rsquo;) : Nodeë¥¼ ìƒì„±í•˜ëŠ” ë¶€ë¶„ìœ¼ë¡œ ì•ì„œ importí•œ Node classë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë§¤ê°œë³€ìˆ˜ë¡œ nodeì˜ ì´ë¦„ì´ ë“¤ì–´ê°‘ë‹ˆë‹¤. node.destroy_node() : Nodeë¥¼ ìƒì„±í•˜ê³  ì›í•˜ëŠ” ì‘ì—…ì„ ëª¨ë‘ ìˆ˜í–‰í–ˆë‹¤ë©´, ì´ì œ ì‚¬ìš©í–ˆë˜ Nodeë¥¼ ì œê±°í•´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤. ê·¸ë˜ì•¼ ë¶ˆí•„ìš”í•œ ìì›ì˜ ë‚­ë¹„ë¥¼ ì¤„ì¼ ìˆ˜ ìˆê² ì§€ìš”. rclpy.shutdown() : ì´ë²ˆ ì˜ˆì œì˜ ì œì¼ ì²« ë¶€ë¶„ì— rclpy.initì„ í†µí•˜ì—¬ ì´ˆê¸°í™”ë¥¼ í•´ì£¼ì—ˆìŠµë‹ˆë‹¤. ì´ì œ rclpyë¥¼ í†µí•œ ì‘ì—…ì´ ëª¨ë‘ ëë‚¬ìœ¼ë¯€ë¡œ ì•ˆì „í•˜ê²Œ ì¢…ë£Œì‹œì¼œì¤ë‹ˆë‹¤. ìœ„ ê³¼ì •ì´ Pythonì—ì„œ rclpyë¥¼ í†µí•´ Nodeë¥¼ ë‹¤ë£¨ëŠ” ê¸°ë³¸ ì ˆì°¨ì…ë‹ˆë‹¤.\n1ê³¼ 4, 2ì™€ 3ì´ ì§ê¿ì²˜ëŸ¼ ë³´ì´ì§€ìš”?\nsetup.py ìˆ˜ì • íŒŒì´ì¬ íŒŒì¼ì„ ros2 run ìœ¼ë¡œ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œ íŒ¨í‚¤ì§€ ë‚´ setup.py íŒŒì¼ì— entry_pointsë¥¼ ì¶”ê°€í•´ ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.\nentry_points={ \u0026#39;console_scripts\u0026#39;: [ \u0026#39;example_node_1 = py_node_tutorial.node_example_1:main\u0026#39;, \u0026#39;example_node_2 = py_node_tutorial.node_example_2:main\u0026#39;, \u0026#39;example_node_3 = py_node_tutorial.node_example_3:main\u0026#39;, \u0026#39;example_node_4 = py_node_tutorial.node_example_4:main\u0026#39;, \u0026#39;example_node_5 = py_node_tutorial.node_example_5:main\u0026#39;, ], }, ì‘ì„±í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. â‡’ ì‹¤í–‰ ì‹œ ì‚¬ìš©ë  ì´ë¦„ = \u0026lt;íŒ¨í‚¤ì§€ ì´ë¦„\u0026gt;.\u0026lt;íŒŒì¼ ì´ë¦„\u0026gt;.main\nexample 2 - timer ë¡œë´‡ì€ ì‹¤í–‰ëœ ì´í›„ ê³„ì†í•´ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•´ì•¼ í•˜ê¸°ì— ì£¼ê¸°ì ìœ¼ë¡œ ë¬´ì–¸ê°€ë¥¼ ì‹¤í–‰í•˜ëŠ” ì¼ì´ ì¦ìŠµë‹ˆë‹¤. ì´ë¥¼ êµ¬í˜„í•˜ëŠ” Timerë¥¼ ì‚´í´ë´…ì‹œë‹¤. $ ros2 run py_node_tutorial example_node_2 ==== Hello ROS 2 : 1==== ==== Hello ROS 2 : 2==== ==== Hello ROS 2 : 3==== ==== Hello ROS 2 : 4==== ==== Hello ROS 2 : 5==== mainë¬¸ì— ì¶”ê°€ëœ create_timerì™€ timer_callback í•¨ìˆ˜ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. def timer_callback(): \u0026#34;\u0026#34;\u0026#34;Timer will run this function periodically.\u0026#34;\u0026#34;\u0026#34; global count count += 1 print(f\u0026#39;==== Hello ROS 2 : {count}====\u0026#39;) def main(args=None): \u0026#34;\u0026#34;\u0026#34;Do enter into this main function first.\u0026#34;\u0026#34;\u0026#34; rclpy.init(args=args) node = Node(\u0026#39;node_name\u0026#39;) node.create_timer(0.2, timer_callback) rclpy.spin(node) node.destroy_node() rclpy.shutdown() timerë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ì„œ create_timer í•¨ìˆ˜ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤.\ntimer_period_sec : ì‹¤í–‰ ì£¼ê¸° (ì´ˆ) callback : í•´ë‹¹ ì£¼ê¸°ë§ˆë‹¤ ì‹¤í–‰ë  í•¨ìˆ˜ image from : docs.ros2.org\nexample 3 - spin_once, spin Nodeì˜ ìƒíƒœë¥¼ ì‚´í”¼ë©´ì„œ ë°˜ë³µ ì‹¤í–‰ì‹œí‚¤ëŠ” spin í•¨ìˆ˜ì— ëŒ€í•´ ì¢€ ë” ìì„¸í•˜ê²Œ ì‚´í´ë´…ë‹ˆë‹¤.\nì˜ˆì œ ì‹¤í–‰ $ ros2 run py_node_tutorial example_node_3 ==== Hello ROS 2 : 1==== ==== Hello ROS 2 : 2==== ==== Hello ROS 2 : 3==== ... ì£¼ìš” ì½”ë“œë¥¼ ë¶„ì„í•´ ë³´ê² ìŠµë‹ˆë‹¤. NodeëŠ” ìƒíƒœë¥¼ ì§€ì† ìœ ì§€í•˜ë©´ì„œ ë³€ê²½ëœ ë‚´ìš©ì— ë”°ë¼ ì§€ì •ëœ ë™ì‘ì„ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” ë¡œë´‡ í”„ë¡œê·¸ë¨ì—ì„œ ë§¤ìš° ë³´í¸ì ì¸ ì‘ì—…ìœ¼ë¡œ, ROS 2ì—ì„œëŠ” **spin()**ì´ë¼ëŠ” ì´ë¦„ì˜ í•¨ìˆ˜ë¡œ ê¸°ëŠ¥ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.\ndef main(args=None): \u0026#34;\u0026#34;\u0026#34;Do enter into this main function first.\u0026#34;\u0026#34;\u0026#34; rclpy.init(args=args) node = Node(\u0026#39;node_name\u0026#39;) node.create_timer(0.2, timer_callback) while True: rclpy.spin_once(node, timeout_sec=10) node.destroy_node() rclpy.shutdown() spinì„ ë¹„ë¡¯í•˜ì—¬ spin_once, spin_until_future_completeì™€ ê°™ì´ í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ì„ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ë‹¤ì–‘í•œ ì¶”ê°€ í•¨ìˆ˜ë“¤ì´ ì¡´ì¬í•©ë‹ˆë‹¤.\ntimer_callbackê³¼ OOPì˜ í•„ìš”ì„± def timer_callback(): \u0026#34;\u0026#34;\u0026#34;Timer will run this function periodically.\u0026#34;\u0026#34;\u0026#34; global count count += 1 print(f\u0026#39;==== Hello ROS 2 : {count}====\u0026#39;) # How can I use logger without globalization ? # node.get_logger().info(\u0026#39;\\n==== Hello ROS 2 ====\u0026#39;) callback í•¨ìˆ˜ê°€ ì‚¬ìš©ë˜ë©´ í•„ì—°ì ìœ¼ë¡œ ë‘ í•¨ìˆ˜ ê°„ ê³µìœ ë˜ëŠ” countì™€ ê°™ì€ ìì›ì´ ìƒê¸°ë©°, ì´ countë¥¼ ë‹¤ë£¨ë©´ì„œ ì˜ˆê¸°ì¹˜ ëª»í•œ ì‹¤ìˆ˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì§€ê¸ˆì€ ëª¨ë‘ ì „ì—­ ë³€ìˆ˜ë¡œ ì‘ì—…í•˜ê³  ìˆì—ˆëŠ”ë°, ì´ê²ƒì„ ì–´ë–»ê²Œ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆì„ê¹Œìš”?\nexample 4 - OOP Node ì˜ˆì œ ì‹¤í–‰ì˜ ê²°ê³¼ëŠ” ì´ì „ê³¼ ê°™ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ êµ¬í˜„ì—ì„œ ì°¨ì´ë¥¼ ê°–ìŠµë‹ˆë‹¤. $ ros2 run py_node_tutorial example_node_5 [INFO] [1657348011.971419700] [composition_example_node]: ==== Hello ROS 2 : 1==== [INFO] [1657348012.163466100] [composition_example_node]: ==== Hello ROS 2 : 2==== [INFO] [1657348012.363590700] [composition_example_node]: ==== Hello ROS 2 : 3==== classë¥¼ ì‚¬ìš©í•˜ì—¬ Nodeë¥¼ êµ¬í˜„í•œ ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. class NodeClass(Node): \u0026#34;\u0026#34;\u0026#34;Second Node Class. Just print log periodically. \u0026#34;\u0026#34;\u0026#34; def __init__(self): \u0026#34;\u0026#34;\u0026#34;Node Initialization. You must type name of the node in inheritanced initializer. \u0026#34;\u0026#34;\u0026#34; super().__init__(\u0026#39;composition_example_node\u0026#39;) self.create_timer(0.2, self.timer_callback) self._count = 1 def timer_callback(self): \u0026#34;\u0026#34;\u0026#34;Timer will run this function periodically.\u0026#34;\u0026#34;\u0026#34; self.get_logger().info(f\u0026#39;==== Hello ROS 2 : {self._count}====\u0026#39;) self._count += 1 ROS 1ê³¼ ë‹¬ë¦¬, ROS 2ì˜ OOP êµ¬í˜„ì€ Nodeë¥¼ ìƒì†ë°›ìŠµë‹ˆë‹¤. (ë•Œë¬¸ì— ìƒì„± ì‹œ, Nodeì´ë¦„ì„ super().__init__()ì•ˆì— ë„£ì–´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.)\nì´ë ‡ê²Œ ê°ì²´ì§€í–¥ì„ ì‚¬ìš©í•˜ë©´ Nodeì˜ ê¸°ëŠ¥ë“¤ì„ ì ê·¹ í™œìš©í•˜ì—¬ ë”ìš± ì‰½ê³  ê°•ë ¥í•œ ROS 2 ê°œë°œì´ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤. ì•ìœ¼ë¡œì˜ ì˜ˆì‹œì—ì„œëŠ” ëª¨ë‘ ê°ì²´ ì§€í–¥ì„ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.\nrclpy logger super().__init__(\u0026#39;node_name\u0026#39;) ... node.get_logger().info(\u0026#39;\\n==== Hello ROS 2 ====\u0026#39;) rospy.loginfo()ì™€ ê°™ì´ rclpyì—ì„œë„ get_loggerë¼ëŠ” logging APIë¥¼ ì œê³µí•©ë‹ˆë‹¤. ë‹¤ë§Œ, rclpyì˜ loggerëŠ” Nodeì— ì¢…ì†ë˜ëŠ” ê°œë…ì…ë‹ˆë‹¤. (ROS 2ì—ì„œëŠ” ì—¬ëŸ¬ Nodeê°€ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ ì•ˆì—ì„œ ì‹¤í–‰ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.)\nget_logger()ë¥¼ ì‚¬ìš©í•˜ë©´ ì¼ë°˜ì ì¸ print ì½˜ì†” ì¶œë ¥ê³¼ëŠ” ë‹¬ë¦¬, ì‹¤í–‰ì¤‘ì¸ Nodeì´ë¦„, ì‹œê°„, ìœ„í—˜ì„± ë“±ì„ ë””ë²„ê¹…í•  ìˆ˜ ìˆì–´ ì´í›„ ë³µì¡í•œ ì‹œìŠ¤í…œì—ì„œ í° ë„ì›€ì´ ë©ë‹ˆë‹¤.\nexample 5 - Logger Level ê¸°ë³¸ node í”„ë¡œê·¸ë˜ë°ì˜ ë§ˆì§€ë§‰ ì˜ˆì‹œì…ë‹ˆë‹¤. $ ros2 run py_node_tutorial example_node_5 [INFO] [1657348108.163389800] [node_name]: ==== Hello ROS 2 : 1==== [WARN] [1657348108.163810900] [node_name]: ==== Hello ROS 2 : 1==== [ERROR] [1657348108.164126200] [node_name]: ==== Hello ROS 2 : 1==== [FATAL] [1657348108.164514300] [node_name]: ==== Hello ROS 2 : 1==== ... ROS 1ì—ì„œì™€ ìœ ì‚¬í•˜ê²Œ ROS 2ì—ì„œë„ ìœ„í—˜ë„ì— ë”°ë¼ì„œ ë‹¤ë¥¸ logger levelì„ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\ninfoë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì•„ë˜ë¡œ ê°ˆìˆ˜ë¡ ë†’ì€ ë ˆë²¨ì˜ logì´ë©°, ì œì¼ ì‹¬ê°í•œ errorì™€ fatalì˜ ê²½ìš°, ì½˜ì†” ì¶œë ¥ì‹œì—ë„ ë¹¨ê°„ ê¸€ì”¨ë¡œ ë³´ì´ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nimage from : 51CTO debugì˜ ê²½ìš° ì‹¤ì œ ì½˜ì†” ì¶œë ¥ìœ¼ë¡œëŠ” ë‚˜íƒ€ë‚˜ì§€ ì•Šìœ¼ë©°, íš¨ê³¼ì ì¸ Trackingì„ ìœ„í•´ ROS 1 ê°•ì˜ì—ì„œ ë°°ìš´ rqt console ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.\nROS 2 Parameter ROS 1ì—ì„œì™€ ë§ˆì°¬ê°€ì§€ë¡œ, ROS 2ì—ì„œë„ ê°ì¢… ë§¤ê°œë³€ìˆ˜ë¥¼ ë‹¤ë£° ìˆ˜ ìˆëŠ” ì»¤ë©˜ë“œ ëª…ë ¹ì–´ì™€ ì½”ë“œ APIë¥¼ ì œê³µí•©ë‹ˆë‹¤.\nì˜ˆì œ Package ë¹Œë“œì™€ ì‹¤í–‰ $ colcon build --packages-select py_param_tutorial $ source install/local_setup.bash $ ros2 run py_param_tutorial param_example [INFO] [1672390971.030532687] [param_ex_node]: string_param: world int_param: 119 float_param: 3.1415 arr_param: [1, 2, 3] nested_param.string_param: Wee Woo param_ex_nodeì—ì„œ 5ì¢…ë¥˜ì˜ ë§¤ê°œë³€ìˆ˜ê°€ ì„ ì–¸ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ë“¤ì„ í™•ì¸í•˜ëŠ” ì»¤ë©˜ë“œ ë¼ì¸ì„ ë°°ì›Œë´…ì‹œë‹¤.\nros2 param list $ ros2 param list /param_ex_node: arr_param float_param int_param nested_param.string_param string_param use_sim_time ros2 param get/set - node ì´ë¦„ê³¼ ë§¤ê°œë³€ìˆ˜ ì´ë¦„ì„ ëª¨ë‘ í•„ìš”ë¡œ í•¨ì— ì£¼ì˜í•©ë‹ˆë‹¤. $ ros2 param get /param_ex_node arr_param Integer values are: array(\u0026#39;q\u0026#39;, [1, 2, 3]) $ ros2 param set /param_ex_node arr_param \u0026#39;[1,2,3,4]\u0026#39; Set parameter successful $ ros2 param get /param_ex_node arr_param Integer values are: array(\u0026#39;q\u0026#39;, [1, 2, 3, 4]) ì´ì œ, íŒŒì´ì¬ ì½”ë“œë¥¼ ë¶„ì„í•´ë´…ì‹œë‹¤.\nparameterì˜ ìƒì„±ì€ node ë‚´ì—ì„œ ì´ë£¨ì–´ì§€ë©°, declare_parameterë¥¼ í†µí•´ ìƒì„±í•©ë‹ˆë‹¤. í•¨ìˆ˜ì˜ ë‘ë²ˆì§¸ ì¸ìëŠ” ê¸°ë³¸ê°’ì…ë‹ˆë‹¤. nested_paramê³¼ ê°™ì´, parameterëŠ” ê³„ì¸µ êµ¬ì¡°ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìœ¼ë©° . ì„ í†µí•´ êµ¬ë¶„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. string_paramì´ë¼ëŠ” ì´ë¦„ì„ ê°€ì§„ parameterê°€ ë‘ ì¢…ë¥˜ ì¡´ì¬í•˜ì§€ë§Œ ì„œë¡œ ì†Œì†ëœ ê³„ì¸µì´ ë‹¬ë¼ ê³µì¡´í•  ìˆ˜ ìˆëŠ” ê²ƒì…ë‹ˆë‹¤.\nclass ParamExNode(rclpy.node.Node): def __init__(self): super().__init__(\u0026#39;param_ex_node\u0026#39;) self.declare_parameter(\u0026#39;string_param\u0026#39;, \u0026#39;world\u0026#39;) self.declare_parameter(\u0026#39;int_param\u0026#39;, 119) self.declare_parameter(\u0026#39;float_param\u0026#39;, 3.1415) self.declare_parameter(\u0026#39;arr_param\u0026#39;, [1,2,3]) self.declare_parameter(\u0026#39;nested_param.string_param\u0026#39;, \u0026#39;Wee Woo\u0026#39;) ì„ ì–¸ëœ ë§¤ê°œë³€ìˆ˜ì˜ ê°’ì€ get_parameterë¥¼ í†µí•´ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. get_parameter ìì²´ëŠ” Objectì´ê³ , value ì†ì„±ì´ ì‹¤ì œ ê°’ì„ ê°–ê³  ìˆìŠµë‹ˆë‹¤. string_param = self.get_parameter(\u0026#39;string_param\u0026#39;) int_param = self.get_parameter(\u0026#39;int_param\u0026#39;) float_param = self.get_parameter(\u0026#39;float_param\u0026#39;) arr_param = self.get_parameter(\u0026#39;arr_param\u0026#39;) nested_param = self.get_parameter(\u0026#39;nested_param.string_param\u0026#39;) self.get_logger().info(f\u0026#34;\\nstring_param: {string_param.value} \\ \\nint_param: {int_param.value} \\ \\nfloat_param: {float_param.value} \\ \\narr_param: {arr_param.value} \\ \\nnested_param.string_param: {nested_param.value}\u0026#34; ) parameterëŠ” launch fileì—ì„œë„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. - Hello, 112ë¡œ ë³€ê²½ëœ ê°’ì„ í™•ì¸í•´ë´…ì‹œë‹¤. $ ros2 launch py_param_tutorial launch_with_param.launch.py ... [param_example-1] [INFO] [1672387864.135213913] [param_example]: [param_example-1] string_param: Hello [param_example-1] int_param: 112 [param_example-1] float_param: 3.1415 [param_example-1] arr_param: [1, 2, 3] launch fileì˜ parameters ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì´ëŸ¬í•œ ì‘ì—…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. def generate_launch_description(): param_ex_node = Node( package=\u0026#39;py_param_tutorial\u0026#39;, executable=\u0026#39;param_example\u0026#39;, name=\u0026#39;param_example\u0026#39;, output=\u0026#39;screen\u0026#39;, parameters=[ {\u0026#39;string_param\u0026#39;: \u0026#39;Hello\u0026#39;}, {\u0026#39;int_param\u0026#39;: 112}, ], ) parameterê°€ ë§¤ìš° ë§ì€ ê²½ìš°ì—ëŠ” ROS 1ì—ì„œì™€ ê°™ì´ yaml íŒŒì¼ì„ ì‚¬ìš©í•´ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. launch fileì˜ ì£¼ì„ëœ ë¶€ë¶„ì„ í•´ì œí•˜ê³  ë‹¤ì‹œ ì‹¤í–‰í•´ë´…ì‹œë‹¤. config = os.path.join( get_package_share_directory(\u0026#39;py_param_tutorial\u0026#39;), \u0026#39;config\u0026#39;, \u0026#39;params.yaml\u0026#39; ) param_ex_node = Node( package = \u0026#39;py_param_tutorial\u0026#39;, executable = \u0026#39;param_example\u0026#39;, name = \u0026#39;param_example\u0026#39;, output=\u0026#39;screen\u0026#39;, parameters = [config] ) ëª¨ë“  ë§¤ê°œë³€ìˆ˜ë“¤ì´ ë³€ê²½ëœ ê²ƒì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n$ ros2 launch py_param_tutorial launch_with_param.launch.py ... [param_example-1] [INFO] [1672391557.995024614] [param_example]: [param_example-1] string_param: Yaml Yaml [param_example-1] int_param: 5 [param_example-1] float_param: 3.14 [param_example-1] arr_param: [\u0026#39;I\u0026#39;, \u0026#39;love\u0026#39;, \u0026#39;ROS 2\u0026#39;] [param_example-1] nested_param.string_param: Ooh Wee yaml íŒŒì¼ì€ config/params.yamlì— ìœ„ì¹˜í•˜ê³  ìˆìŠµë‹ˆë‹¤. parameter ê´€ë¦¬ ìš©ë„ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ yaml íŒŒì¼ì€ ì¼ì •í•œ ê·œì¹™ì„ ê°–ì¶°ì•¼ í•©ë‹ˆë‹¤. param_example: ros__parameters: string_param: \u0026#34;Yaml Yaml\u0026#34; int_param: 5 float_param: 3.14 arr_param: [\u0026#39;I\u0026#39;, \u0026#39;love\u0026#39;, \u0026#39;ROS 2\u0026#39;] nested_param: string_param: \u0026#34;Ooh Wee\u0026#34; \u0026lt;node-name\u0026gt;: ros__parameters: \u0026lt;param-name\u0026gt;: \u0026lt;param-value\u0026gt; ... \u0026lt;nested-layer-name\u0026gt;: \u0026lt;param-name\u0026gt;: \u0026lt;param-value\u0026gt; ì´ë ‡ê²Œ ìƒˆë¡œìš´ í´ë”ì™€ íŒŒì¼ì„ ì¶”ê°€í•œ ê²½ìš°, python íŒ¨í‚¤ì§€ì˜ setup.pyë¥¼ ìˆ˜ì •í•´ì£¼ì–´ì•¼ í•˜ë©° íŒ¨í‚¤ì§€ ë¹Œë“œë„ ìƒˆë¡œ í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. import os from glob import glob from setuptools import setup package_name = \u0026#39;py_param_tutorial\u0026#39; setup( name=package_name, version=\u0026#39;0.0.0\u0026#39;, packages=[package_name], data_files=[ (\u0026#39;share/ament_index/resource_index/packages\u0026#39;, [\u0026#39;resource/\u0026#39; + package_name]), (\u0026#39;share/\u0026#39; + package_name, [\u0026#39;package.xml\u0026#39;]), (os.path.join(\u0026#39;share\u0026#39;, package_name, \u0026#39;config\u0026#39;), glob(\u0026#39;config/*.yaml\u0026#39;)), (os.path.join(\u0026#39;share\u0026#39;, package_name, \u0026#39;launch\u0026#39;), glob(\u0026#39;launch/*.launch.py\u0026#39;)), ], launch fileì— ì¶”ê°€ëœ ë‚´ìš©ì„ ë‹¤ì‹œ ì‚´í´ë³´ë©´, ë°©ê¸ˆ ì „ì˜ yaml íŒŒì¼ì„ ë¶ˆëŸ¬ì™€ì„œ nodeì˜ ì‹¤í–‰ optionì— ì „ë‹¬í•˜ê³  ìˆìŠµë‹ˆë‹¤. config = os.path.join( get_package_share_directory(\u0026#39;py_param_tutorial\u0026#39;), \u0026#39;config\u0026#39;, \u0026#39;params.yaml\u0026#39; ) param_ex_node = Node( package = \u0026#39;py_param_tutorial\u0026#39;, executable = \u0026#39;param_example\u0026#39;, name = \u0026#39;param_example\u0026#39;, output=\u0026#39;screen\u0026#39;, parameters = [config] ) ì•„ë˜ ì˜ˆì‹œì—ì„œ ë³´ì´ë“¯ì´ ë¡œë´‡ì˜ ì´ˆê¸° ì†ë„, ìµœëŒ€/ìµœì†Œ ê°’ë“¤, í•˜ë“œì›¨ì–´ì™€ ê´€ë ¨ëœ íŠœë‹ê°’ ë“± ìˆ˜ë§ì€ ë§¤ê°œë³€ìˆ˜ë“¤ì´ ì‚¬ìš©ë˜ë©° ëª¨ë‘ ì§€ê¸ˆ ë°°ìš´ parameterë¥¼ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.\nhttps://github.com/ros-planning/navigation2/blob/main/nav2_bt_navigator/src/bt_navigator.cpp\n"
},
{
	"uri": "/kr/ros2_basic_foxy/lecture4/",
	"title": "Lecture4 - ROS 2 Node C++ Programming",
	"tags": [],
	"description": "",
	"content": " ì‹¤ì œ ë¡œë´‡ ê°œë°œì—ì„œ Pythonë§Œ ì‚¬ìš©ë˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤. tensorflow, pytorchì™€ ê°™ì€ ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ë“¤ì´ ëª¨ë‘ Pythonì„ ì‚¬ìš©í•˜ê³  ìˆê³ , ìƒëŒ€ì ìœ¼ë¡œ ê°œë°œ ê³¼ì •ì´ ì‰¬ì›Œ ë§ì€ ì‚¬ëŒë“¤ì´ Pythonì„ ì‚¬ìš©í•˜ê³  ìˆì§€ë§Œ, ì œì–´, ì„¼ì‹±ì„ ìœ„í•´ì„œëŠ” C++ë¥¼ ëŒ€ë¶€ë¶„ ì‚¬ìš©í•œë‹¤ê³  ë³´ì‹œë©´ ë©ë‹ˆë‹¤.\nimage from : wikipedia ë”°ë¼ì„œ ì•ì„  node í”„ë¡œê·¸ë˜ë° ì˜ˆì‹œë“¤ì„ ëª¨ë‘ C++ë¡œ êµ¬í˜„í•´ ë³¼ ì˜ˆì •ì…ë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì€ C++ ì§€ì‹ì´ í•„ìš”í•˜ì§€ë§Œ í•„ìˆ˜ëŠ” ì•„ë‹™ë‹ˆë‹¤.\ní´ë˜ìŠ¤ ìƒì„± (OOP) ìŠ¤ë§ˆíŠ¸ í¬ì¸í„° í—¤ë” ë¶„ë¦¬ ëŒë‹¤ í•¨ìˆ˜ std::bindì™€ placeholders C++ ë¹Œë“œ ì‹œìŠ¤í…œ (CMake) ì½”ë“œ ì„¤ëª…ì— ì•ì„œ ROS 2 C++ íŒ¨í‚¤ì§€ë¥¼ ê°œë°œí•˜ëŠ” ì ˆì°¨ì— ëŒ€í•´ ë¹ ë¥´ê²Œ í›‘ì–´ë³´ê² ìŠµë‹ˆë‹¤.\níŒ¨í‚¤ì§€ ìƒì„± í›„ src \u0026amp; include í´ë”ì—ì„œ ì½”ë“œ ì‘ì„± ros2 pkg create --build-type ament_cmake \u0026lt;package_name\u0026gt; CMakeLists.txt \u0026amp; package.xml ìˆ˜ì • add_executable(example_node_1 src/node_example_1.cpp) ament_target_dependencies(example_node_1 rclcpp) install( TARGETS example_node_1 DESTINATION lib/${PROJECT_NAME} ) ì½”ë“œ ë¹Œë“œì™€ ë””ë²„ê¹… colcon build --packages-select \u0026lt;package_name\u0026gt; source install/local_setup.bash ì½”ë“œ ì‹¤í–‰ ros2 run \u0026lt;pkg-name\u0026gt; \u0026lt;executable-name\u0026gt; ê°œë°œ ê³¼ì • ìì²´ëŠ” íŒŒì´ì¬ packageì™€ í¬ê²Œ ë‹¤ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.\ní•˜ì§€ë§Œ, C++ ê°œë°œì€ ì½”ë“œë¥¼ ë¹Œë“œí•˜ëŠ” ê³¼ì •ì—ì„œ ê°ì¢… ì»´íŒŒì¼ ì—ëŸ¬ì™€ ë§í¬ ì—ëŸ¬, ëŸ°íƒ€ì„ ì—ëŸ¬ê¹Œì§€ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— ê°œë°œì— ì—¬ëŸ¬ì›€ì´ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nâ‡’ ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ, í•™ìƒ ë¼ì´ì„¼ìŠ¤ë¡œ ë¬´ë£Œ ì‚¬ìš© ê°€ëŠ¥í•œ IDEë¥¼ ì†Œê°œí•˜ê³ , í•¨ê»˜ ì…‹ì—…í•´ë³´ê³ ì í•©ë‹ˆë‹¤.\nCLion ì„¤ì¹˜ì™€ ROS 2 ê°œë°œí™˜ê²½ ì„¤ì • CLionì€ IDEì˜ ëª…ê°€ Jetbrainsì—ì„œ ë§Œë“  C/C++ìš© í†µí•© ê°œë°œ í™˜ê²½ì…ë‹ˆë‹¤. C++ ê°œë°œìë¥¼ í˜ë“¤ê²Œ í•˜ëŠ” ê°ì¢… ì—ëŸ¬ë“¤ì˜ ë””ë²„ê¹…ì„ í¸ë¦¬í•˜ê²Œ í•´ì¤„ ë¿ë”ëŸ¬ ROS 2 ê°œë°œì„ ìœ„í•œ ì†”ë£¨ì…˜ë„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.\nimage from : wikipedia CLionì€ ì˜¤í”ˆì†ŒìŠ¤ê°€ ì•„ë‹Œ íŒë§¤ë˜ê³  ìˆëŠ” ì†Œí”„íŠ¸ì›¨ì–´ì…ë‹ˆë‹¤.\ní•˜ì§€ë§Œ í•™ìƒì—ê²ŒëŠ” ë¬´ë£Œ ë¼ì´ì„¼ìŠ¤ë¥¼ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ë§í¬ë¥¼ í†µí•´ì„œ íšŒì›ê°€ì…ê³¼ í•™ìƒì¸ì¦ì„ ì§„í–‰í•œ ë‹¤ìŒ, CLionì„ ì„¤ì¹˜í•©ì‹œë‹¤.\nhttps://www.jetbrains.com/clion/\nhttps://www.jetbrains.com/community/education/#students\nì´ë©”ì¼ ì¸ì¦ì„ ê±°ì¹˜ë©´ ì–´ë µì§€ ì•Šê²Œ í•™ìƒì¸ì¦ì´ ì™„ë£Œë©ë‹ˆë‹¤. ì´ ê³¼ì •ì€ ìƒëµí•˜ê² ìŠµë‹ˆë‹¤.\ní•™ìƒ ë¼ì´ì„¼ìŠ¤ë¥¼ í†µí•´ CLionì„ ë¹„ë¡¯í•˜ì—¬ IntelliJ, PyCharm, WebStormê³¼ ê°™ì€ ë‹¤ì–‘í•œ ì–¸ì–´ì˜ IDEë¥¼ ë¬´ë£Œë¡œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. snapcraftë¥¼ í†µí•´ CLionì„ ì„¤ì¹˜í•˜ê³  ì‹¤í–‰ í•´ë´…ì‹œë‹¤. $ sudo snap install clion --classic [sudo] password for kimsooyoung: clion 2022.3.1 from jetbrainsâœ“ installed $ clion ì•½ê´€ ë™ì˜ ë° ë¡œê·¸ì¸ì„ í†µí•œ í•™ìƒ ì¸ì¦ì„ ê±°ì¹˜ë©´ ëª¨ë“  ì„¤ì¹˜ ì ˆì°¨ê°€ ì™„ë£Œë©ë‹ˆë‹¤. colcon buildë¥¼ í†µí•´ ë¹Œë“œí–ˆë˜ cpp_node_tutorial packageë¥¼ clion í”„ë¡œì íŠ¸ë¡œ ì—´ì–´ë³´ê² ìŠµë‹ˆë‹¤. clionì—ì„œ File â‡’ Openì„ ì‹¤í–‰í•œ ë’¤ cpp_node_tutorialì˜ CMakeLists.txtë¥¼ ì„ íƒí•©ë‹ˆë‹¤. build targetë¥¼ ì§€ì •í•˜ê³  ì‹¤í–‰í•˜ë©´ CLionìƒì—ì„œ ROS 2 í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. CLionì—ì„œì˜ ì¥ì ì„ ì§ì ‘ ì‚´í´ë³´ê¸° ìœ„í•´ í”„ë¡œê·¸ë¨ ê°œë°œì„ í•¨ê»˜ í•´ë³´ê² ìŠµë‹ˆë‹¤. ë¼ì´ë¸Œ ì½”ë”© Time!!\nëª¨ë“  ì„¤ì •ì´ ì™„ë£Œë˜ì—ˆë‹¤ë©´, ì´ì œ ë³¸ê²©ì ìœ¼ë¡œ C++ ì˜ˆì œ ì½”ë“œë¥¼ ì‚´í´ë´…ì‹œë‹¤.\nexample 1 - Hello ROS 2 íŒŒì´ì¬ì—ì„œ í•œì°¨ë¡€ ì‚´í´ë³¸ ë°” ìˆê¸°ì— ìì„¸í•œ ë¡œì§ë“¤ì€ ìƒëµí•©ë‹ˆë‹¤.\nì˜ˆì œ ì‹¤í–‰ $ ros2 run cpp_node_tutorial example_node_1 [INFO] [1666431282.586519100] [example_node_1]: ==== Hello ROS 2 ==== ì½”ë“œ ë¶„ì„ #include \u0026lt;rclcpp/rclcpp.hpp\u0026gt; int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = rclcpp::Node::make_shared(\u0026#34;example_node_1\u0026#34;); RCLCPP_INFO(node-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 ====\u0026#34;); rclcpp::shutdown(); return 0; } rclcppì€ ROS 2ë¥¼ C++ì—ì„œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì½”ë“œì˜ ì§‘í•©ì…ë‹ˆë‹¤.\nNode ìƒì„± ì‹œ ì£¼ì˜í•˜ì…”ì•¼ í•  ì ì€ â€œëª¨ë“  Nodeê°€ í¬ì¸í„°ì˜ í˜•ì‹ì„ ê°–ëŠ”ë‹¤â€ëŠ” ê²ƒì…ë‹ˆë‹¤. shared_ptrë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¥¼ ë§‰ê¸° ìœ„í•´ íŒŒìƒëœ ëª¨ë“  ë°ì´í„°ë“¤ì„ ì¶”ì í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nrclcppì—ì„œ ë¡œê·¸ì˜ ì‹¤í–‰ì€ RCLCPP_INFOì™€ get_logger() ë©”ì†Œë“œë¥¼ í†µí•´ ì‹¤í–‰í•  ìˆ˜ ìˆìœ¼ë©°, ë¡œê·¸ëŠ” Nodeì—ì„œ ì‹¤í–‰ëœë‹¤ëŠ” ì ì„ ê¸°ì–µí•©ì‹œë‹¤.\nCMakeLists.txt ìˆ˜ì •\n# find_packageë¥¼ í†µí•´ ì¢…ì†ì„±ë“¤ì„ ì¶”ê°€í•©ë‹ˆë‹¤. find_package(\u0026lt;depends\u0026gt; REQUIRED) # ì‹¤í–‰ í”„ë¡œê·¸ë¨ ë¹Œë“œ ì„¤ì • add_executable(\u0026lt;program_name\u0026gt; include/\u0026lt;header\u0026gt;.hpp src/\u0026lt;code\u0026gt;.cpp ...) ament_target_dependencies(\u0026lt;program_name\u0026gt; \u0026lt;dependency1\u0026gt; \u0026lt;dependency2\u0026gt; ...) install( TARGETS \u0026lt;program_name\u0026gt; DESTINATION lib/${PROJECT_NAME} ) íŒ¨í‚¤ì§€ ë¹Œë“œ \u0026amp; ì‹¤í–‰ colcon build --packages-select cpp_node_tutorial source install/local_setup.bash ros2 run cpp_node_tutorial example_node_1 ì˜ˆì œ ì†ŒìŠ¤ ì½”ë“œë¥¼ ì¡°ê¸ˆì´ë¼ë„ ìˆ˜ì •í•˜ì—¬ ì—¬ëŸ¬ë¶„ë“¤ë§Œì˜ ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ê³  CLionì„ í†µí•œ ë¹Œë“œê¹Œì§€ ìŠ¤ìŠ¤ë¡œ í•œ ë²ˆ í•´ë´…ì‹œë‹¤.\nexample 2 - Timer ì˜ˆì œ ì‹¤í–‰ $ ros2 run cpp_node_tutorial example_node_2 ==== Hello ROS 2 : 0 ==== ==== Hello ROS 2 : 1 ==== ==== Hello ROS 2 : 2 ==== ==== Hello ROS 2 : 3 ==== ==== Hello ROS 2 : 4 ==== ... rclcppì—ì„œ timerëŠ” create_wall_timerë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. #include \u0026lt;iostream\u0026gt; #include \u0026lt;memory\u0026gt; #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; static int count = 0; void timer_callback(){ std::cout \u0026lt;\u0026lt; \u0026#34;==== Hello ROS 2 : \u0026#34; \u0026lt;\u0026lt; count \u0026lt;\u0026lt; \u0026#34; ====\u0026#34; \u0026lt;\u0026lt; std::endl; count++; } int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = rclcpp::Node::make_shared(\u0026#34;example_node_2\u0026#34;); auto timer = node-\u0026gt;create_wall_timer(std::chrono::milliseconds(200), timer_callback); rclcpp::spin(node); rclcpp::shutdown(); return 0; } example 3 - OOP Node ê¸°ëŠ¥ ìì²´ëŠ” í° ì˜ë¯¸ê°€ ì—†ìœ¼ë¯€ë¡œ ì½”ë“œë¥¼ ìœ„ì£¼ë¡œ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤. #include \u0026lt;memory\u0026gt; #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; class NodeClass: public rclcpp::Node { public: NodeClass(): Node(\u0026#34;example_node_4\u0026#34;) {} }; int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;NodeClass\u0026gt;(); RCLCPP_INFO(node-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 ====\u0026#34;); rclcpp::shutdown(); return 0; } ëª¨ë“  NodeëŠ” rclcpp::Nodeë¡œë¶€í„° ìƒì†ì„ ë°›ìŠµë‹ˆë‹¤. ìƒì† í›„ ìƒì„±ìì—ì„œ Nodeì˜ ì´ë¦„ì„ ì§€ì •í•´ì¤˜ì•¼ í•˜ë©°, topic pub/sub, loggerì™€ ê°™ì€ ê¸°ëŠ¥ë“¤ì€ ëª¨ë‘ rclcpp::Nodeì— êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\në”ë¶ˆì–´, Node ìì²´ëŠ” í¬ì¸í„°ë¡œ ì·¨ê¸‰ëœë‹¤ëŠ” ì ë„ ë‹¤ì‹œ í•œ ë²ˆ ê°•ì¡°ë“œë¦½ë‹ˆë‹¤.\nexample 4 - OOP Timer Node callback í•¨ìˆ˜ë¥¼ bindingí•˜ëŠ” ë¶€ë¶„ì— ì§‘ì¤‘í•˜ì„¸ìš”. timer_callbackëŠ” í´ë˜ìŠ¤ ë©”ì†Œë“œì´ê¸° ë•Œë¬¸ì— binding ì‹œ NodeClass::timer_callbackì™€ ê°™ì´ ëª…ì‹œí•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. #include \u0026lt;memory\u0026gt; #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; class NodeClass: public rclcpp::Node { private: size_t count; rclcpp::TimerBase::SharedPtr timer; void timer_callback() { RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d\u0026#34;, count); count++; } public: NodeClass() : Node(\u0026#34;example_node_5\u0026#34;) { timer = this-\u0026gt;create_wall_timer( std::chrono::milliseconds(200), std::bind(\u0026amp;NodeClass::timer_callback, this) ); } }; int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;NodeClass\u0026gt;(); rclcpp::spin(node); rclcpp::shutdown(); return 0; } ë§ˆì§€ë§‰ìœ¼ë¡œ rclcpp logger levelì„ ê°„ë‹¨íˆ ì‚´í´ë³´ê³  ë§ˆë¬´ë¦¬ì§“ê² ìŠµë‹ˆë‹¤. void timer_callback() { RCLCPP_DEBUG(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); RCLCPP_WARN(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); RCLCPP_FATAL(this-\u0026gt;get_logger(), \u0026#34;==== Hello ROS 2 : %d ====\u0026#34;, count); count++; } ì°¸ê³ ìë£Œ\nhttps://roboticsbackend.com/ros2-yaml-params/ https://roboticsbackend.com/rclpy-params-tutorial-get-set-ros2-params-with-python/ https://www.jetbrains.com/help/clion/ros2-tutorial.html#change-prj-root "
},
{
	"uri": "/kr/ros2_basic_foxy/lecture5/",
	"title": "Lecture5 - ROS 2 Topic and Examples",
	"tags": [],
	"description": "",
	"content": " Topicì— ëŒ€í•´ ë°°ì›Œë³´ê¸° ì „ì—, ì‹¤ìŠµ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•´ë´…ì‹œë‹¤.\nSRC Gazebo ì´ë²ˆ ROS 2 ê°•ì˜ì˜ ì‹¤ìŠµë“¤ì€ Road Balanceì˜ ì°¨ëŸ‰í˜• ë¡œë´‡ SRCë¥¼ í†µí•´ ì§„í–‰í•˜ê³ ì í•©ë‹ˆë‹¤. ì‹¤ìŠµì„ ì§„í–‰í•˜ê¸° ì „ Gazebo í™˜ê²½ì„ í•¨ê»˜ ì„¸íŒ…í•´ë³´ê² ìŠµë‹ˆë‹¤.\nsrc_gazebo ì‹¤í–‰ ì„¸íŒ… - ë‹¤ì†Œ ë²ˆê±°ë¡œìš´ ì‘ì—…ì´ë¯€ë¡œ gifë¥¼ ë³´ì‹œë©´ì„œ ì°¨ê·¼ì°¨ê·¼ ì˜ ë”°ë¼ì™€ì£¼ì„¸ìš”! cd ~/ros2_ws/src/du2023-ros2 ./setup_scripts.sh # CMakeLists.txt ìˆ˜ì • (ì£¼ì„) colcon build --packages-select src_gazebo source install/local_setup.bash # CMakeLists.txt ìˆ˜ì • (ì£¼ì„ í•´ì œ) colcon build --packages-select src_gazebo colcon build --packages-select src_odometry colcon build --packages-select src_controller source install/local_setup.bash empty world ì‹¤í–‰ ros2 launch src_gazebo empty_world.launch.py ë¹ˆ gazebo í™˜ê²½ì— ì°¨ëŸ‰í˜• ë¡œë´‡ì´ ë“±ì¥í•  ê²ƒì…ë‹ˆë‹¤. í•¨ê»˜ ë“±ì¥í•˜ëŠ” rqt_robot_steeringì„ í†µí•´ ë¡œë´‡ì„ ì›€ì§ì—¬ë³´ì„¸ìš”. ì‹¤í–‰ ì¤‘ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì˜¤ë¥˜ì™€ í•´ê²°ë°©ë²•ì„ ì œì‹œë“œë¦½ë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ ë°œìƒ ì‹œ sudo apt dist-upgradeë¥¼ ì…ë ¥í•˜ë©´ ë©ë‹ˆë‹¤. ë¡œë´‡ì— ë¶€ì°©ë˜ì–´ ìˆëŠ” ì„¼ì„œ ë°ì´í„°ë“¤ê³¼ ì œì–´ ë°ì´í„°ë¥¼ ros2 topic listë¡œ í™•ì¸í•´ë´…ì‹œë‹¤.\n/cmd_vel : Twist msgë¥¼ í†µí•´ ë¡œë´‡ì„ ì œì–´í•˜ëŠ” topic /imu/data : imu ë°ì´í„° /scan : 2D lidar /logi_camera_sensor/image_raw : ì „ë°© ì¹´ë©”ë¼ ë°ì´í„° ROS 2 Topic ê°•ì˜ë¥¼ ì—´ì‹¬íˆ ë”°ë¼ì˜¤ë©´ì„œ ROS ê°œë…ì„ ìŠì–´ë²„ë ¸ì„ ìˆ˜ë„ ìˆìœ¼ë¯€ë¡œ ê°„ë‹¨íˆ ê°œë… ë³µìŠµì„ í•´ë³´ê² ìŠµë‹ˆë‹¤.\nTopicì€ Nodeë“¤ ì‚¬ì´ì— ë°ì´í„°(Message)ê°€ ì˜¤ê°€ëŠ” ê¸¸(Bus)ì˜ ì´ë¦„ì´ë©°, ì ì ˆí•œ ì´ë¦„ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì†¡ìˆ˜ì‹ í•˜ì§€ ì•Šìœ¼ë©´ ì›í•˜ëŠ” ë™ì‘ì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. image from : docs.ros.org\nTopicì˜ ì¤‘ìš”í•œ íŠ¹ì§•ìœ¼ë¡œ Topicì€ ì—¬ëŸ¬ Nodeë“¤ë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìˆê³ , ì „ì†¡ ì‹œì—ë„ ì—¬ëŸ¬ Nodeë“¤ì—ê²Œ ì „ì†¡ì´ ê°€ëŠ¥í•œ ë°©ì‹ì…ë‹ˆë‹¤. image from : docs.ros.org topicì„ í†µí•´ ë°ì´í„°ê°€ ì „ë‹¬ë˜ëŠ” ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\në°ì´í„°ë¥¼ ë³´ë‚´ëŠ” ì£¼ì²´ì¸ publisherëŠ” topicì„ í†µí•´ ì›í•˜ëŠ” ì •ë³´ë¥¼ subscriberì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤. ì´ê²ƒì„ topic publishë¼ê³  ë¶€ë¥´ì§€ìš”. ë°˜ëŒ€ë¡œ, ë°ì´í„°ë¥¼ ë°›ëŠ” ì£¼ì²´ì¸ subscriber ì…ì¥ì—ì„  topicì„ í†µí•´ ë°ì´í„°ë¥¼ ë°›ê²Œ ë˜ë©° ì´ê²ƒì€ topic subscribeë¼ê³  ë¶ˆë¦½ë‹ˆë‹¤. ROS 2 Topic msg ë¡œë´‡ í”„ë¡œê·¸ë˜ë° ì‹œ ì„¼ì„œ, ì œì–´ ë°ì´í„°ë¥¼ ë¹„ë¡¯í•˜ì—¬ ë‹¤ì–‘í•œ ìœ í˜•ì˜ ë°ì´í„°ë“¤ì´ Topicì„ í†µí•´ ì˜¤ê³  ê°‘ë‹ˆë‹¤. ROSì—ì„œëŠ” ì´ëŸ¬í•œ ë°ì´í„° í˜•ì‹ì„ msg - Messageë¼ëŠ” í˜•íƒœë¡œ ì œê³µí•˜ë©°, ì›í•˜ëŠ” ë°ì´í„°ì— ì í•©í•œ topic msgë¥¼ ì‚¬ìš©í•˜ë©´ ë”ìš± íš¨ìœ¨ì ì¸ ë¡œë´‡ í”„ë¡œê·¸ë˜ë°ì´ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.\nimage from : ethz.ch geometry_msgs/Twistì™€ ê°™ì€ messageëŠ” ROS 2ì—ì„œë„ ë™ì¼í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ, ROS 2ì—ì„œëŠ” msg/srv/action ê³¼ ê°™ì´ í•„ë“œì˜ êµ¬ë¶„ì´ í•˜ë‚˜ ë” ì¶”ê°€ë©ë‹ˆë‹¤.\nROS 1 : geometry_msgs/Twist ROS 2 : geometry_msgs/msg/Twist ì¶œì²˜ : http://docs.ros.org/ íŠ¹ì • messageê°€ ì–´ë–»ê²Œ êµ¬ì„±ë˜ì–´ ìˆëŠ”ì§€ ì•Œê³  ì‹¶ì„ ë•ŒëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.\n$ ros2 interface show geometry_msgs/msg/Twist # This expresses velocity in free space broken into its linear and angular parts. Vector3 linear Vector3 angular í˜¹ì€ ì•ì„œ ì œê°€ ì‚´í´ë³¸ ê²ƒ ì²˜ëŸ¼ ê²€ìƒ‰ì„ í•´ ë³´ì•„ë„ ë©ë‹ˆë‹¤.\nROS 2ë¡œ ë„˜ì–´ì˜¤ë©´ì„œ, topic ì»¤ë©˜ë“œë“¤ì€ ë‹¤ìŒê³¼ ê°™ì´ ì‚´ì§ ë°”ë€Œì—ˆìŠµë‹ˆë‹¤.\nrostopic list â‡’ ros2 topic list rostopic info â‡’ ros2 topic info rostopic echo â‡’ ros2 topic echo ROS 2 Topic Tools ROS 2ì—ì„œë„ GUIíˆ´ RQTë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Topicê³¼ ê´€ë ¨ëœ rqt toolsë“¤ì„ ì‚¬ìš©í•´ë´…ì‹œë‹¤.\nROS 1ê³¼ ROS 2ì˜ rqtëŠ” ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ì´ë©° ROS 1ì˜ pluginê³¼ ROS 2ì˜ pluginì´ ì™„ì „ ë™ì¼í•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.\nì‹¤ìŠµì„ ìœ„í•´ gazeboì™€ rqtë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. # Terminal 1 ros2 launch src_gazebo empty_world.launch.py # Terminal 2 rqt rqt ìƒë‹¨ì˜ ë©”ë‰´ë°”ì—ì„œ Plugins â‡’ Topics â‡’ Topic Monitorë¥¼ í´ë¦­í•©ë‹ˆë‹¤. topic monitorë¥¼ í†µí•´ í˜„ì¬ ì˜¤ê°€ê³  ìˆëŠ” topicë“¤ì„ í•œëˆˆì— ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆì—ëŠ” rqt ìƒë‹¨ì˜ ë©”ë‰´ë°”ì—ì„œ Plugins â‡’ Topics â‡’ Message Publisherë¥¼ í´ë¦­í•˜ê³ , + ë²„íŠ¼ì„ ëˆŒëŸ¬ publishë¥¼ ì›í•˜ëŠ” topicì„ ì¶”ê°€í•©ë‹ˆë‹¤.\nTopic PublisherëŠ” ë³„ë„ì˜ ì‘ì—… ì—†ì´ msgì— ì›í•˜ëŠ” ê°’ì„ ì±„ì›Œ topic publishê°€ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” íˆ´ì…ë‹ˆë‹¤. ìµœì¢… publishë¥¼ ìœ„í•´ ì²´í¬ë°•ìŠ¤ë¥¼ í´ë¦­í•˜ê³ , ì›í•˜ëŠ” ê°’ì„ ì±„ì›Œë„£ìŠµë‹ˆë‹¤. ROS Bridge ê°•ì˜ë…¸íŠ¸ë¥¼ ì‘ì„±í•˜ê³  ìˆëŠ” 2023ë…„ ì§€ê¸ˆë„ ROS 1ìœ¼ë¡œ ê°œë°œëœ ì‹œìŠ¤í…œì— ì¢…ì†ì„±ì„ ê°€ì§„ ê¸°ì—…ë“¤ê³¼ í”„ë¡œì íŠ¸ë“¤ì´ ë§ìŠµë‹ˆë‹¤. ROS 1ê³¼ ROS 2ë¥¼ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ëŠ” ì—†ì„ê¹Œìš”? ros1 bridgeë¥¼ ì‹¤ìŠµí•´ë´…ì‹œë‹¤.\nì¼ì „, ROS 1ì—ì„œ ì‚¬ìš©í•˜ë˜ smb gazeboë¥¼ ì˜¤ëœë§Œì— ì‹¤í–‰ì‹œì¼œë´…ì‹œë‹¤. roslaunch smb_gazebo smb_gazebo.launch ros1 bridgeë¥¼ í†µí•´ ROS 2 ì‹œìŠ¤í…œì—ì„œ ë¡œë´‡ì„ ì œì–´í•´ë³´ê² ìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ í„°ë¯¸ë„ì„ ì—´ê³ , ì´ˆê¸° ì˜µì…˜ ì„ íƒ ì‹œ 3ë²ˆì„ ì„ íƒí•˜ë©´ ros1 bridgeê°€ ì‹¤í–‰ë©ë‹ˆë‹¤. (ì´ ë™ì‘ì€ ì‚¬ì‹¤ dynamic_bridgeë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” ê²ƒì…ë‹ˆë‹¤.) sudo apt install ros-foxy-ros1-bridge -y # Terminal 1 - ros bridge ros2 run ros1_bridge dynamic_bridge # Terminal 2 - ros2 foxy ros2 run teleop_twist_keyboard teleop_twist_keyboard ROS 2ë¡œ ì„¤ì •ëœ í„°ë¯¸ë„ì—ì„œ ROS 1ìœ¼ë¡œ êµ¬ë™ë˜ê³  ìˆëŠ” ë¡œë´‡ì„ ì¡°ì¢…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ros bridgeê°€ ìˆìœ¼ë‹ˆ ROS 2 ê°œë°œì„ êµ³ì´ í•˜ì§€ ì•Šì•„ë„ ëœë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë³´ì•ˆ, ì§€ì—°ê³¼ ê°™ì€ ROS 1ì˜ ê³ ì§ˆì ì¸ ë¬¸ì œë“¤ì€ ì—¬ì „íˆ ë‚¨ì•„ìˆê²Œ ë˜ë¯€ë¡œ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•˜ëŠ” ë‹¨ê³„ë¼ë©´, ROS 2ë¡œ ëª¨ë“  ê°œë°œì„ ì§„í–‰í•˜ì‹œê¸¸ ì¶”ì²œë“œë¦½ë‹ˆë‹¤. image from : swri.org ì°¸ê³ ë¡œ, /opt/ros/\u0026lt;ros-version\u0026gt;/setup.bashëŠ” ROS ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ í•„ìš”í•œ ì„¤ì •ì´ ë‹´ê¸´ íŒŒì¼ì…ë‹ˆë‹¤. í˜¹ì—¬ë‚˜ galactic, humbleê³¼ ê°™ì´ ìµœì‹  ë²„ì „ì„ ì‚¬ìš©í•˜ê³  ì‹¶ì„ ë•Œ ì°¸ê³ í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.\nROS 1ê³¼ ROS 2ë¥¼ ëª¨ë‘ ê´€ë¦¬í•˜ê¸°ì—ëŠ” ë§ì€ ë…¸ë ¥ì´ í•„ìš”í•˜ê³ , ì›í•˜ëŠ” ê¸°ëŠ¥ì´ ëª¨ë‘ ë™ì‘í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì „ ë²„ì „ legacyê°€ ìˆëŠ” ê²½ìš°, ì˜ íŒë‹¨í•˜ì—¬ ì‹œìŠ¤í…œì„ ìœ ì§€/ë³´ìˆ˜í•©ì‹œë‹¤.\nMy Gazebo World Topicì˜ ì‘ìš©ìœ¼ë¡œ Gazeboë¥¼ ì‚¬ìš©í•˜ì—¬ ë‚˜ë§Œì˜ ì¥ì• ë¬¼ì„ ë§Œë“¤ê³ , ì¶©ëŒì„ íšŒí”¼í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ê³ ì í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ Gazeboì˜ Building Editor ì‚¬ìš©ë²•ì„ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.\ngazeboë¥¼ ì‹¤í–‰ì‹œí‚¨ ë’¤, ìƒë‹¨ Edit ì˜µì…˜ì—ì„œ Building Editorë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. ìƒë‹¨ ëª¨ëˆˆì¢…ì´ì— ìŠ¤ì¼€ì¹˜ë¥¼ í†µí•´ ê±´ë¬¼ ë²½ì„ ìƒì„±í•  ìˆ˜ ìˆìœ¼ë©°, í•˜ë‹¨ viewë¥¼ í†µí•´ ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ëŠ” ê±´ë¬¼ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í˜¹ì—¬ ì‹¤ìˆ˜ë¥¼ í–ˆê±°ë‚˜, ë³´ë‹¤ ì •í™•í•œ ìˆ˜ì¹˜ë¥¼ ì…ë ¥í•˜ê³  ì‹¶ì€ ê²½ìš°, ëª¨ëˆˆì¢…ì´ ìœ„ì˜ ê²€ì€ ì„ ì„ ë”ë¸” í´ë¦­í•˜ë©´ ì‚¬ì§„ê³¼ ê°™ì´ êµ¬ì²´ì ì¸ ì„¤ì •ì„ ë³€ê²½í•  ìˆ˜ ìˆëŠ” íƒ­ì´ ë“±ì¥í•©ë‹ˆë‹¤. ìˆ˜ì •ì´ ì™„ë£Œë˜ì—ˆë‹¤ë©´, ì™¼ìª½ íƒ­ì—ì„œ door, stairsë„ ì‚¬ìš©í•´ë³´ê³ , Textureë„ ì…í˜€ë´…ì‹œë‹¤. ëª¨ë“  ì‘ì—…ì„ ë§ˆì¹œ ë’¤, File íƒ­ì—ì„œ Save Asë¥¼ ì„ íƒí•˜ì—¬ ì™„ì„±í•œ ë¬¼ì²´ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. (ì €ëŠ” wall ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì €ì¥í•´ë³´ê² ìŠµë‹ˆë‹¤.) ì €ì¥ëœ í´ë” ë‚´ë¶€ëŠ” ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¥¼ ê°–ê²Œ ë©ë‹ˆë‹¤. â”œâ”€ wall â”œâ”€â”€ model.config â””â”€â”€ model.sdf model.config : í•´ë‹¹ modelì˜ ì´ë¦„, ì‘ì„±ì ë“± ê¸°ë³¸ì ì¸ ì •ë³´ë“¤ì´ ê¸°ì…ë©ë‹ˆë‹¤. model.sdf : ì‹¤ì§ì ì¸ sdf í˜•ì‹ì˜ ëª¨ë¸ì´ ìœ„ì¹˜í•©ë‹ˆë‹¤. ì‘ì„±í•œ ë¬¼ì²´ë¥¼ Gazeboì—ì„œ ë‘ê³ ë‘ê³  ì‚¬ìš©í•˜ëŠ” ëª‡ê°€ì§€ ë°©ë²•ë“¤ì´ ìˆìŠµë‹ˆë‹¤.\nGAZEBO_MODEL_PATHì— ì¶”ê°€í•˜ê¸° â‡’ ~/.gazebo/gui.ini íŒŒì¼ ë‚´ model_pathsì— building í´ë”ì— ì ˆëŒ€ ê²½ë¡œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. $ gedit ~/.gazebo/gui.ini [geometry] x=0 y=0 [model_paths] filenames=/home/kimsooyoung/\u0026lt;your-folder-location\u0026gt; launch fileì—ì„œ GAZEBO_MODEL_PATH ìˆ˜ì •í•˜ê¸° â‡’ ëŒ€ì‹  ì´ë ‡ê²Œ í•˜ë©´ í•´ë‹¹ launch file ì‚¬ìš© ì‹œì—ë§Œ GAZEBO_MODEL_PATHê°€ ë°˜ì˜ë©ë‹ˆë‹¤. if \u0026#39;GAZEBO_MODEL_PATH\u0026#39; in os.environ: os.environ[\u0026#39;GAZEBO_MODEL_PATH\u0026#39;] += \u0026#34;:\u0026#34; + gazebo_model_path else: os.environ[\u0026#39;GAZEBO_MODEL_PATH\u0026#39;] = gazebo_model_path ì´ì œ Gazeboë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´, ì‚¬ì§„ê³¼ ê°™ì´ Insert ë¶€ë¶„ì— buildingì´ ì¶”ê°€ë˜ì–´ìˆìŒì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ë¥¼ í´ë¦­ í›„ gazebo í™˜ê²½ìœ¼ë¡œ ì»¤ì„œë¥¼ ì˜®ê¸°ë©´ ì›í•˜ëŠ” ìœ„ì¹˜ì— wallì„ ìœ„ì¹˜ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. wallì´ ì¶”ê°€ëœ worldëŠ” ë³„ë„ë¡œ ì €ì¥í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤. File â‡’ Save World Asë¥¼ í´ë¦­í•˜ë©´ ì™„ì„±ëœ world íŒŒì¼ì„ ì €ì¥í•©ì‹œë‹¤. ìƒì„±í•œ world íŒŒì¼ì„ launch íŒŒì¼ë¡œ ì‹¤í–‰í•´ë´…ì‹œë‹¤.\nì €ì¥í•´ë‘ì—ˆë˜ Gazebo world íŒŒì¼ì„ src_gazeboì˜ worlds í´ë”ì— ìœ„ì¹˜ì‹œí‚µë‹ˆë‹¤. launch íŒŒì¼ì„ ìˆ˜ì •í•˜ì—¬ ìƒˆë¡œìš´ world íŒŒì¼ì˜ ìœ„ì¹˜ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.\ndef generate_launch_description(): ... # gazebo pkg_gazebo_ros = FindPackageShare(package=\u0026#39;gazebo_ros\u0026#39;).find(\u0026#39;gazebo_ros\u0026#39;) pkg_path = os.path.join(get_package_share_directory(\u0026#39;src_gazebo\u0026#39;)) world_path = os.path.join(pkg_path, \u0026#39;worlds\u0026#39;, \u0026#39;ì—¬ëŸ¬ë¶„ì˜-world-file.world\u0026#39;) ... # Start Gazebo server start_gazebo_server_cmd = IncludeLaunchDescription( PythonLaunchDescriptionSource(os.path.join(pkg_gazebo_ros, \u0026#39;launch\u0026#39;, \u0026#39;gzserver.launch.py\u0026#39;)), launch_arguments={\u0026#39;world\u0026#39;: world_path}.items() ) packageë¥¼ ë¹Œë“œí•˜ê³ , gazeboë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•´ë´…ì‹œë‹¤. colcon build --packages-select src_gazebo source install/local_setup.bash ros2 launch src_gazebo empty_world.launch.py ì œì‘í•œ worldì™€ ë¡œë´‡ì´ í•¨ê»˜ ë“±ì¥í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìµœëŒ€í•œ ì—¬ëŸ¬ë¶„ë“¤ë§Œì˜ ì¥ì• ë¬¼ì„ ë§Œë“¤ì–´ë³´ì‹œê³ , í˜¹ì‹œë‚˜ ì´ ê³¼ì •ì—ì„œ ë„ì €íˆ ëª¨ë¥´ê² ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆê±°ë‚˜, ì‹œê°„ì´ ì—†ëŠ” ê²½ìš°, ìš°ì„  ì œê°€ ì œì‘í•œ worldì™€ launch fileì„ ì‚¬ìš©í•˜ë„ë¡ í•©ë‹ˆë‹¤. â‡’ ros2 launch src_gazebo wall_world.launch.py\nROS 2 Topic í”„ë¡œê·¸ë˜ë° example1 - cmd_vel publish ì¤€ë¹„ëœ ì˜ˆì‹œë¥¼ ìš°ì„  ì‹¤í–‰í•´ë´…ì‹œë‹¤. # Terminal 1 ros2 launch src_gazebo empty_world.launch.py # Terminal 2 cd ~/ros2_ws colcon build --packages-select py_topic_tutorial source install/local_setup.bash ros2 run py_topic_tutorial topic_pub_node ë¡œë´‡ì´ ì›ì„ ê·¸ë¦¬ë©° ì›€ì§ì´ê¸° ì‹œì‘í•©ë‹ˆë‹¤. ROS 1 ê°•ì˜ë¥¼ ì™„ë£Œí•˜ì˜€ë‹¤ë©´ ì–´ë–»ê²Œ êµ¬í˜„í•˜ì˜€ì„ì§€ ì•„ì‹œê² ì§€ìš”? ì½”ë“œë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤ - ì‹œì‘ìœ¼ë¡œ, í•„ìš”í•œ íŒŒì´ì¬ íŒ¨í‚¤ì§€ë“¤ì„ import í•©ë‹ˆë‹¤. ROS 2ì—ì„œ íŒŒì´ì¬ í”„ë¡œê·¸ë˜ë°ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” rclpyë¥¼ import í•´ì•¼ í•©ë‹ˆë‹¤. ë”ë¶ˆì–´, Twistë¥¼ importí•˜ëŠ” ë¬¸ë²•ë„ ëˆˆì—¬ê²¨ë´…ì‹œë‹¤. import random from geometry_msgs.msg import Twist import rclpy from rclpy.node import Node í•µì‹¬ì´ ë˜ëŠ” TwistPubNode í´ë˜ìŠ¤ì˜ ìƒì„±ìë¶€í„° ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. class TwistPubNode(Node): def __init__(self): super().__init__(\u0026#39;twist_pub_node\u0026#39;) self.get_logger().info( f\u0026#39;TwistPubNode Created at {self.get_clock().now().to_msg().sec}\u0026#39; ) # self.twist_publisher = self.create_publisher(Twist, \u0026#34;twist_topic\u0026#34;, 10) self.twist_publisher = self.create_publisher(Twist, \u0026#39;/cmd_vel\u0026#39;, 10) create_publisherëŠ” topic publisherë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ë¡œ 3ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ìœ¼ë©° ê°ê°ì— ëŒ€í•œ ì„¤ëª…ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nmessage type : Topic í†µì‹ ì— ì‚¬ìš©ë  msg Type ì…ë‹ˆë‹¤. topic name : ì‚¬ìš©í•  Topic ì´ë¦„ì„ ì§€ì •í•©ë‹ˆë‹¤. (ì´ ì´ë¦„ì„ ì˜ëª» ì„¤ì •í•˜ë©´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” topicì— Publishí•˜ëŠ” ì˜¤ë¥˜ ìƒí™©ì´ ë°œìƒí•˜ë‹ˆ ì£¼ì˜í•©ë‹ˆë‹¤.) queue_size : ëŒ€ê¸°ì—´ì˜ í¬ê¸°ë¼ê³  ì´í•´í•˜ì‹œë©´ ì¢‹ìŠµë‹ˆë‹¤. timer callbackì—ì„œ publishê°€ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ìƒì„±í•œ publisherì—ì„œ publish í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©° ë§¤ê°œë³€ìˆ˜ë¡œ messageê°€ ì „ë‹¬ë©ë‹ˆë‹¤. ... self.create_timer(0.2, self.timer_callback) def timer_callback(self): \u0026#34;\u0026#34;\u0026#34;Timer will run this function periodically.\u0026#34;\u0026#34;\u0026#34; msg = Twist() # Fill in msg with compatible values msg.linear.x = 0.5 msg.angular.z = 1.0 self.twist_publisher.publish(msg) example2 - scan subscription ì´ë²ˆ ì˜ˆì‹œëŠ” ë¼ì´ë‹¤ ë°ì´í„°ë¥¼ ë‹¤ë¤„ë³´ê³ ì í•©ë‹ˆë‹¤. ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. # Terminal 1 $ ros2 launch src_gazebo empty_world.launch.py # Terminal 2 $ ros2 run py_topic_tutorial topic_sub_node [INFO] [1672494602.141200628] [scan_sub_node]: msg.ranges[0] : inf msg.ranges[30] : inf msg.ranges[60] : 0.7975894212722778 msg.ranges[90] : inf msg.ranges[119] : inf ... ì˜ˆì‹œë¥¼ ì‹¤í–‰ì‹œí‚¨ ìƒí™©ì—ì„œ Gazebo ìƒì˜ ë¡œë´‡ ì£¼ë³€ìœ¼ë¡œ ë¬¼ì²´ë¥¼ ë“±ì¥ì‹œì¼œë´…ì‹œë‹¤.\nscan dataì˜ rangesëŠ” ì‚¬ì§„ê³¼ ê°™ì€ ê±°ë¦¬ ë°ì´í„°ë¥¼ ë‹´ê³  ìˆë‹µë‹ˆë‹¤.\nì½”ë“œë¥¼ ì‚´í´ë´…ì‹œë‹¤. ì´ë²ˆì—ëŠ” sensor_msgs/msg/LaserScanì´ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤. import rclpy from rclpy.node import Node from sensor_msgs.msg import LaserScan ScanSubNode í´ë˜ìŠ¤ì˜ ìƒì„±ìì—ì„œëŠ” scan topicì˜ subscriberê°€ ìƒì„±ë©ë‹ˆë‹¤. class ScanSubNode(Node): def __init__(self): super().__init__(\u0026#39;scan_sub_node\u0026#39;) queue_size = 10 # Queue Size self.pose_subscriber = self.create_subscription( LaserScan, \u0026#39;scan\u0026#39;, self.sub_callback, queue_size ) create_subscriptionì€ 4ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ìœ¼ë©° ê°ê°ì— ëŒ€í•œ ì„¤ëª…ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nMessage Type : Topic í†µì‹ ì— ì‚¬ìš©ë  msg Type ì…ë‹ˆë‹¤. topic name : ë°ì´í„°ë¥¼ Subscribeí•  Topicì˜ ì´ë¦„ì„ ì§€ì •í•©ë‹ˆë‹¤. (ì´ ì´ë¦„ì„ ì˜ëª» ì„¤ì •í•˜ë©´ ì•„ë¬´ê²ƒë„ publishí•˜ê³  ìˆì§€ ì•ŠëŠ” topicì„ ë§ˆëƒ¥ ê¸°ë‹¤ë¦¬ê³  ìˆê²Œ ë˜ëŠ” ìƒí™©ì´ ë°œìƒí•  ê²ƒì…ë‹ˆë‹¤.) subscribe callback : ë°ì´í„°ê°€ ì „ë‹¬ë  ë•Œë§ˆë‹¤ ì‹¤í–‰ë˜ëŠ” callback í•¨ìˆ˜ë¡œ, ì „ë‹¬ëœ ë°ì´í„°ë¥¼ í†µí•´ ì‹¤í–‰í•  ì‘ì—…ì´ ì´ í•¨ìˆ˜ ì•ˆì— êµ¬í˜„ë©ë‹ˆë‹¤. queue_size : create_publisherë•Œì™€ ë§ˆì°¬ê°€ì§€ë¡œ, ëŒ€ê¸°ì—´ì˜ í¬ê¸°ë¼ê³  ì´í•´í•˜ì‹œë©´ ì¢‹ìŠµë‹ˆë‹¤. sub_callbackì˜ ì²«ë²ˆì¨° ë§¤ê°œë³€ìˆ˜ëŠ” í•­ìƒ topic message dataê°€ ë©ë‹ˆë‹¤. í•´ë‹¹ messageì—ì„œ ì›í•˜ëŠ” ë°ì´í„°ë§Œ ì¶”ì¶œí•œ ë‹¤ìŒ, loggerë¥¼ í†µí•´ ì½˜ì†” ì¶œë ¥ì„ ì§„í–‰í•©ë‹ˆë‹¤.\ndef sub_callback(self, msg): \u0026#34;\u0026#34;\u0026#34;Timer will run this function periodically.\u0026#34;\u0026#34;\u0026#34; self.get_logger().info(f\u0026#39; \\ \\nmsg.ranges[0] : {msg.ranges[0]} \\ \\nmsg.ranges[30] : {msg.ranges[30]} \\ \\nmsg.ranges[60] : {msg.ranges[60]} \\ \\nmsg.ranges[90] : {msg.ranges[90]} \\ \\nmsg.ranges[119] : {msg.ranges[119]} \\ \u0026#39;) example3 - parking ì´ë²ˆ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•˜ê¸° ì „ì—, empty_world.launch.pyë¥¼ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤. # gazebo pkg_gazebo_ros = FindPackageShare(package=\u0026#39;gazebo_ros\u0026#39;).find(\u0026#39;gazebo_ros\u0026#39;) pkg_path = os.path.join(get_package_share_directory(\u0026#39;src_gazebo\u0026#39;)) # world_path = os.path.join(pkg_path, \u0026#39;worlds\u0026#39;, \u0026#39;empty_world.world\u0026#39;) world_path = os.path.join(pkg_path, \u0026#39;worlds\u0026#39;, \u0026#39;wall_world.world\u0026#39;) ë¬¼ì²´ì™€ ì¶©ëŒí•˜ê¸° ì „ê¹Œì§€ ë¡œë´‡ì„ ì›€ì§ì´ë‹¤ê°€ ì¼ì • ê±°ë¦¬ ë‚´ ë²½ì´ ê²€ì¶œë˜ë©´ ìë™ìœ¼ë¡œ ë©ˆì¶”ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤. # Terminal 1 $ ros2 launch src_gazebo empty_world.launch.py # Terminal 2 $ ros2 run py_topic_tutorial parking_node ... [INFO] [1672563255.067421128] [parking_node]: Distance from Front Object : 0.6280616521835327 [INFO] [1672563255.173734128] [parking_node]: Distance from Front Object : 0.5546504259109497 [INFO] [1672563255.281276729] [parking_node]: Distance from Front Object : 0.5124648809432983 [INFO] [1672563255.389067729] [parking_node]: ==== Parking Done!!! ==== ... ì´ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œëŠ” Topic Publishì™€ Subscribeê°€ ëª¨ë‘ í•„ìš”í•©ë‹ˆë‹¤.\n/cmd_vel topic publish /scan topic subscribe â‡’ ë”°ë¼ì„œ, Nodeì˜ ìƒì„±ìì—ì„œë„ Publisherì™€ Subscriberë¥¼ ëª¨ë‘ ìƒì„±í•©ë‹ˆë‹¤.\nclass ParkingNode(Node): def __init__(self): super().__init__(\u0026#39;parking_node\u0026#39;) queue_size = 10 # Queue Size self.twist_publisher = self.create_publisher(Twist, \u0026#39;cmd_vel\u0026#39;, queue_size) self.scan_subscriber = self.create_subscription( LaserScan, \u0026#39;scan\u0026#39;, self.sub_callback, queue_size ) sub_callbackì—ì„œëŠ” ì „ë°© (msg.ranges[60]) ë¬¼ì²´ì™€ì˜ ê±°ë¦¬ë¥¼ íƒì§€í•˜ê³ , ì´ ê±°ë¦¬ê°€ 0.5m ì´í•˜ê°€ ë˜ë©´ ì •ì§€ topicì„ publish í•©ë‹ˆë‹¤. def sub_callback(self, msg): twist_msg = Twist() distance_forward = msg.ranges[60] if distance_forward \u0026gt; 0.5: self.get_logger().info(f\u0026#39;Distance from Front Object : {distance_forward}\u0026#39;) twist_msg.linear.x = 0.5 self.twist_publisher.publish(twist_msg) else: self.get_logger().info(\u0026#39;==== Parking Done!!! ====\\n\u0026#39;) twist_msg.linear.x = 0.0 self.twist_publisher.publish(twist_msg) CV 2 and ROS 2 Topicê³¼ ROS 2 Bagì„ ì‚¬ìš©í•œ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë³´ê³ ì í•©ë‹ˆë‹¤.\nì´ë²ˆ ì‹¤ìŠµì„ ìœ„í•´ ì œê°€ ë¯¸ë¦¬ ì¤€ë¹„í•œ ë°ì´í„°ì…‹ì„ ì œê³µë“œë¦¬ë‹ˆ, ê¸°ì–µí•˜ê¸° ì‰¬ìš´ ìœ„ì¹˜ì— ë‹¤ìš´ë°›ì•„ ì£¼ì„¸ìš”.\nğŸ“ quadrupped_train.zip\nWindows + WSL2 ìœ ì €ì˜ ê²½ìš° explorer.exe ëª…ë ¹ì–´ë¥¼ í†µí•´ íŒŒì¼ íƒìƒ‰ê¸°ë¥¼ ì—´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì¤€ë¹„ëœ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. # ì˜ˆì œ ì‹¤í–‰ ì¤€ë¹„ sudo apt install ros-foxy-rosbag2 cd ~/ros2_ws colcon build --packages-select py_cv_tutorial source install/local_setup.bash # í„°ë¯¸ë„ 1 â€“ ë°ì´í„° ìœ„ì¹˜ë¡œ ì´ë™í•˜ì—¬ ros2 bag ì‹¤í–‰ cd \u0026lt;ë°ì´í„°ë¥¼ ì €ì¥í•œ ìœ„ì¹˜\u0026gt; ros2 bag play quadrupped_train.bag_0.db3 # í„°ë¯¸ë„ 2 â€“ image_view ì‹¤í–‰ ros2 run rqt_image_view rqt_image_view ì‚¬ì§„ê³¼ ê°™ì´ ê¸°ì°¨ ì„ ë¡œ ëª¨ìŠµì´ ë³´ì¸ë‹¤ë©´ ì„±ê³µì…ë‹ˆë‹¤. í•´ë‹¹ ë°ì´í„°ì…‹ì€ ê¸°ì°¨ ì„ ë¡œì—ì„œ ì£¼í–‰í•˜ëŠ” 4ì¡± ë³´í–‰ ë¡œë´‡ìœ¼ë¡œë¶€í„° ì·¨ë“í•œ ê²ƒì…ë‹ˆë‹¤. ê¸°ì°¨ ì„ ë¡œëŠ” ì£¼ê¸°ì ìœ¼ë¡œ ê´€ë¦¬ê°€ í•„ìš”í•˜ë©°, ê¸¸ê³  ê¸´ ì„ ë¡œë¥¼ ë¡œë´‡ì´ ìë™ìœ¼ë¡œ ê²€ì‚¬í•´ì¤€ë‹¤ë©´ ì•„ì£¼ ìœ ìš©í•  ê²ƒì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ìƒìƒì„ í•´ë³´ë©´ì„œ ì‹¤ìŠµì— ì„í•´ë´…ì‹œë‹¤.\nExample1 - CV Bridge ì´ë¯¸ì§€ë¥¼ ë‹¤ë£¨ê¸° ìœ„í•œ ì˜¤í”ˆì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ OpenCVë¥¼ ì‚¬ìš©í•´ë³´ë ¤ í•©ë‹ˆë‹¤. ì¤€ë¹„ëœ ì˜ˆì‹œì™€, ros2 bag íŒŒì¼ì„ ì‹¤í–‰í•˜ë©´ cv2.imshowë¥¼ í†µí•´ ì—°ì†ëœ ì´ë¯¸ì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n# í„°ë¯¸ë„ 1 $ cd \u0026lt;bag íŒŒì¼ ìœ„ì¹˜\u0026gt; $ ros2 bag play quadruped_train.bag_0.db3 [INFO] [1667077909.362223100] [rosbag2_storage]: Opened database \u0026#39;quadrupped_train/quadrupped_train.bag_0.db3\u0026#39; for READ_ONLY. # í„°ë¯¸ë„ 2 $ ros2 run py_cv_tutorial img_sub [INFO] [1667077909.613586300] [image_subscriber]: Receiving video frame [INFO] [1667077910.934147000] [image_subscriber]: Receiving video frame ... OpenCVì—ì„œëŠ” CV::Mat ì´ë¼ëŠ” íŠ¹ì • íƒ€ì…ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ë¥¼ ROS 2ì˜ Topic Messageë¡œ ë³€í™˜í•˜ê¸° ìœ„í•´ì„œ CV Bridgeë¼ëŠ” ê²ƒì„ ì‚¬ìš©í•©ë‹ˆë‹¤. from cv_bridge import CvBridge # Package to convert between ROS and OpenCV Images import cv2 # OpenCV library class ImageSubscriber(Node): def __init__(self): # Used to convert between ROS and OpenCV images self.br = CvBridge() ... def listener_callback(self, data): ... # Convert ROS Image message to OpenCV image current_frame = self.br.imgmsg_to_cv2(data, \u0026#34;bgr8\u0026#34;) edge_frame = self.hough_transform(current_frame) imgmsg_to_cv2ë¥¼ í†µí•´ CV::Matìœ¼ë¡œ ë³€í™˜ëœ ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ OpenCVì˜ ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤ê³¼ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì½”ë“œì˜ imshow ë¶€ë¶„ì„ ë°”ê¿”ì„œ ì´ë¯¸ì§€ ì²˜ë¦¬ë¥¼ ì ìš©í•´ ë´…ì‹œë‹¤. ì§ì„ ì„ ê²€ì¶œí•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë©°, ë§¤ê°œë³€ìˆ˜ì˜ ìµœì í™”ë¥¼ í†µí•´ ì„ ë¡œë¥¼ ì¸ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì§ì„  ê²€ì¶œì„ ìœ„í•´ ì‚¬ìš©ëœ OpenCV ê¸°ëŠ¥ë“¤ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. ë¡œì§ì„ ì—…ê·¸ë ˆì´ë“œí•˜ì—¬ ì—¬ëŸ¬ë¶„ë§Œì˜ ì„ ë¡œ ê²€ì¶œ ì•Œê³ ë¦¬ì¦˜ì„ ë§Œë“¤ì–´ ë³´ì„¸ìš”!\ncv2.GaussianBlur cv2.fillPoly / cv2.bitwise_and ROI ì„¤ì • cv2.HoughLinesP rosbag to img ì»´í“¨í„° ë¹„ì „ë§Œìœ¼ë¡œ ì™„ë²½í•œ ì„ ë¡œ ì¸ì‹ì„ êµ¬í˜„í•˜ê¸°ëŠ” ë„ˆë¬´ë‚˜ í˜ë“­ë‹ˆë‹¤. ë”¥ëŸ¬ë‹ì„ ì‚¬ìš©í•´ì„œ ì´ë¥¼ ê·¹ë³µí•  ìˆ˜ ìˆì„ ê²ƒì´ë©°, ë°ì´í„°ì…‹ì˜ ì œì‘ì„ ìœ„í•´ rosbag ë°ì´í„°ì—ì„œ ì´ë¯¸ì§€ë¥¼ ì¶”ì¶œí•˜ëŠ” ì˜ˆì‹œë¥¼ ì¤€ë¹„í•˜ì˜€ìŠµë‹ˆë‹¤.\n$ ros2 run py_cv_tutorial rosbag2_to_timedimg /home/kimsooyoung/djhrd_ws/quadrupped_train/quadrupped_train.bag_0.db3 saved: color_1666796292992515592.png saved: color_1666796293035428479.png saved: color_1666796293079139778.png saved: color_1666796293120768031.png ì˜ˆì œ ì‹¤í–‰ ì „ main í•¨ìˆ˜ì—ì„œ bag íŒŒì¼ì˜ ìœ„ì¹˜ë¥¼ ì—¬ëŸ¬ë¶„ì˜ ê²ƒìœ¼ë¡œ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤. def main(args=None): # Change below roots to your ros2 bag locations ROOT_DIR = \u0026#34;/home/kimsooyoung/djhrd_ws/quadrupped_train\u0026#34; FILENAME = \u0026#34;/quadrupped_train.bag_0.db3\u0026#34; DESCRIPTION = \u0026#34;color_\u0026#34; ì˜ˆì œ ì‹¤í–‰ í›„ ì‚¬ì§„ê³¼ ê°™ì´ ê¸°ì°¨ ìƒì„±ëœ ì´ë¯¸ì§€ë“¤ì´ ë³´ì¸ë‹¤ë©´ ì„±ê³µì…ë‹ˆë‹¤. "
},
{
	"uri": "/kr/ros2_basic_foxy/lecture6/",
	"title": "Lecture6 - ROS 2 Service and Examples",
	"tags": [],
	"description": "",
	"content": "ROS 2 Service ROS Serviceì˜ ê°œë…ì„ ë‹¤ì‹œ ë³µìŠµí•´ë´…ì‹œë‹¤.\nimage from : docs.ros.org Service ê°œë… ì •ë¦¬\nServiceë¥¼ ìš”ì²­í•˜ëŠ” ì£¼ì²´ë¥¼ Service Clientë¼ê³  í•˜ë©°, Service ìš”ì²­ ìì²´ë¥¼ Request, í˜¹ì€ Callì´ë¼ê³  í•©ë‹ˆë‹¤. Serviceë¥¼ ìš”ì²­ë°›ëŠ” ì£¼ì²´ë¥¼ Service Serverë¼ê³  í•˜ë©°, Service ServerëŠ” Requestì— ëŒ€í•œ ì‘ë‹µ, ì¦‰ Service Responseë¥¼ ë‹¤ì‹œ Service Clientì—ê²Œ íšŒë‹µí•©ë‹ˆë‹¤. Requestì™€ Responseë¥¼ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ë°ì´í„° íƒ€ì…ì€ srvë¼ê³  í•˜ë©° Requestì™€ Responseë¡œ ë‚˜ë‰©ë‹ˆë‹¤. Serviceì˜ ì¤‘ìš”í•œ íŠ¹ì§• í•œ ê°€ì§€ ì¶”ê°€í•˜ìë©´, í•˜ë‚˜ì˜ Service Serverì— ì—¬ëŸ¬ Clientê°€ request í•  ìˆ˜ ìˆì§€ë§Œ, ServerëŠ” ë™ì‹œì— ì—¬ëŸ¬ requestë¥¼ ì²˜ë¦¬í•˜ì§€ ëª»í•©ë‹ˆë‹¤.\nimage from : docs.ros.org ROS Service ì»¤ë©˜ë“œ ë¼ì¸ ì§€ë‚œ topic ì˜ˆì‹œì™€ ê°™ì´ ROS 1ì—ì„œ ROS 2ë¡œ ë„˜ì–´ì˜¤ë©´ì„œ ë³€ê²½ëœ ì»¤ë©˜ë“œ ë¼ì¸ë“¤ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nrosservice list â‡’ ros2 service list ros2 service infoëŠ” ì—†ìœ¼ë©°, ros2 service typeìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤. srvëŠ” ros2 interface showë¡œ ì¡°íšŒ ê°€ëŠ¥í•©ë‹ˆë‹¤. $ ros2 interface show turtlesim/srv/Spawn float32 x float32 y float32 theta string name # Optional. A unique name will be created and returned if this is empty --- string name ì„œë¹„ìŠ¤ íƒ€ì… ì¤‘ê°„ì— ë³´ì´ëŠ” - - - ë¶€ë¶„ì€ requestì™€ responseì˜ êµ¬ë¶„ìë¼ê³  ìƒê°í•˜ì‹œë©´ ë©ë‹ˆë‹¤.\nService Example - ğŸ“¸ KimChi Service ì´ë²ˆì— ë³´ì—¬ë“œë¦´ ROS 2 service ì˜ˆì‹œëŠ” ì‚¬ì§„ì„ ì°ëŠ” service serverì…ë‹ˆë‹¤.\nì˜ˆì‹œ ì‹¤í–‰ - rqtë¥¼ í†µí•´ service callì´ ì„±ê³µí•˜ë©´ í˜„ì¬ ì‹œê°„ì— í•´ë‹¹í•˜ëŠ” íŒŒì¼ì´ë¦„ìœ¼ë¡œ ë¡œë´‡ì´ ë°”ë¼ë³´ëŠ” ì‹œì•¼ì˜ ì¹´ë©”ë¼ ì´ë¯¸ì§€ê°€ PNG í˜•ì‹ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤. # Terminal 1 - ì—¬ëŸ¬ë¶„ë“¤ë§Œì˜ worldë¥¼ ì‚¬ìš©í•˜ì‹œë©´ ë”ìš± ì¢‹ìŠµë‹ˆë‹¤. $ ros2 launch src_gazebo empty_world.launch.py # Terminal 2 $ colcon build --packages-select py_service_tutorial $ source install/local_setup.bash $ ros2 run py_service_tutorial take_picture_server [INFO] [turtle_circle_server]: Picture Taking Node Started [INFO] [turtle_circle_server]: KimChi~ [INFO] [turtle_circle_server]: Image saved in 1672569224.png # Terminal 3 - rqt ì‹¤í–‰ í›„ service caller ì‹¤í–‰ (plugins =\u0026gt; services =\u0026gt; service caller) $ rqt Service Callerì˜ ì‚¬ìš©ë²•ê³¼ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ì½”ë“œë¥¼ ì‚´í´ë³´ê¸° ì „ì—, ì´ë¥¼ ì–´ë–»ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆì„ì§€ ê°™ì´ ìƒê°í•´ë´…ì‹œë‹¤.\nì‚¬ì§„ ì´¬ì˜ì„ í¬í•¨í•˜ëŠ” Service Server í•„ìš” ë¡œë´‡ ì „ë°© image dataì˜ Subscriber í•„ìš” ROSì˜ sensor_msgs/msg/Imageë¥¼ ì €ì¥ ê°€ëŠ¥í•œ í¬ë©§ìœ¼ë¡œ ë³€ê²½ í•„ìš” ë”°ë¼ì„œ, Nodeì˜ ìƒì„±ìëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•©ë‹ˆë‹¤.\nclass PictureNode(Node): def __init__(self): super().__init__(\u0026#39;turtle_circle_server\u0026#39;) self.server = self.create_service( SetBool, \u0026#39;take_picture\u0026#39;, self.take_picture_callback ) self.subscriber = self.create_subscription( Image, \u0026#39;logi_camera_sensor/image_raw\u0026#39;, self.sub_callback, 10 ) self.br = CvBridge() self.is_request = False ì´ë²ˆì— ì‚¬ìš©í•˜ëŠ” srvëŠ” example_interfaces/srv/SetBoolì´ë©°, Bool Typeì˜ requestì™€ String responseë¥¼ ê°–ê³  ìˆìŠµë‹ˆë‹¤. $ ros2 interface show example_interfaces/srv/SetBool # This is an example of a service to set a boolean value. # This can be used for testing but a semantically meaningful # one should be created to be built upon. bool data # e.g. for hardware enabling / disabling --- bool success # indicate successful run of triggered service string message # informational, e.g. for error messages service callì— ëŒ€í•œ callbackì…ë‹ˆë‹¤. is_requestë¥¼ ë°”ê¿”ì£¼ê¸°ë§Œ í•˜ëŠ”ë°, ì´ê²ƒì´ í•˜ëŠ” ì—­í• ì´ ë¬´ì—‡ì¼ì§€ ìƒê°í•´ë³´ì„¸ìš”. def take_picture_callback(self, request, response): if request.data is True: self.get_logger().info(\u0026#39;KimChi~\u0026#39;) self.is_request = True response.success = True response.message = \u0026#34;Successfully image written\u0026#34; return response ì •ë‹µì€ subscription callbackì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. subscribeëœ ì´ë¯¸ì§€ ë°ì´í„°ëŠ” is_requestê°€ Trueì¸ ìˆœê°„ì—ë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤. CV Bridgeë¥¼ í†µí•´ ROS topicì„ OpenCV í¬ë§·ìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ìˆìœ¼ë©°, imwriteë¥¼ í†µí•´ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. def sub_callback(self, data): if self.is_request: current_frame = self.br.imgmsg_to_cv2(data, \u0026#34;bgr8\u0026#34;) file_name = str(self.get_clock().now().to_msg().sec) + \u0026#39;.png\u0026#39; cv2.imwrite(file_name, current_frame) self.get_logger().info(f\u0026#39;Image saved in {file_name}\u0026#39;) self.is_request = False Gazeboì— ë‹¤ì–‘í•œ ë¬¼ì²´ë¥¼ ë°°ì¹˜ì‹œí‚¨ ë’¤ ì‚¬ì§„ì„ ì°ì–´ë³´ëŠ” ê²ƒë„ ì¢‹ì€ ì‹¤ìŠµì´ ë  ê²ƒì…ë‹ˆë‹¤. ì œê°€ ì¤€ë¹„í•œ datasetì„ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ë¶„ë“¤ë§Œì˜ ì‹¤ìŠµë„ í•´ë³´ì„¸ìš”.\nğŸ“Â 3DGEMS.zip\nì œê³µë˜ëŠ” 3DGEMS í´ë”ë¥¼ ì••ì¶•í•´ì œí•œ ë’¤, ~/.gazebo/models í´ë”ì— ìœ„ì¹˜ì‹œí‚µë‹ˆë‹¤. í•´ë‹¹ ëª¨ë¸ë“¤ì˜ ì¶œì²˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. (\u0026ldquo;The Effect of Color Space Selection on Detectability and Discriminability of Colored Objects.\u0026rdquo; arXiv preprint arXiv:1702.05421 (2017).)\nWSL2ë¥¼ ì‚¬ìš©í•˜ì‹œëŠ” ë¶„ë“¤ê»˜ì„œëŠ” í„°ë¯¸ë„ì—ì„œ explorer.exe . ë¥¼ ì…ë ¥í•˜ë©´ ìœˆë„ìš° íŒŒì¼ íƒìƒ‰ê¸°ë¥¼ ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.\në‹¤ì‹œ í•œ ë²ˆ Gazeboë¥¼ ì‹¤í–‰ì‹œí‚¨ ë’¤ ìƒˆë¡œ ì¶”ê°€ëœ ëª¨ë¸ë“¤ì„ ì‚¬ìš©í•´ë´…ì‹œë‹¤. Server Client Example - Spawn Model ì´ë²ˆ ì˜ˆì‹œëŠ” ROS 1ê°•ì˜ì—ì„œë„ ì‚´í´ë³¸ ë°” ìˆëŠ”, urdfë¥¼ ì‚¬ìš©í•˜ì—¬ gazebo ìƒì— ë¬¼ì²´ë¥¼ ë“±ì¥ì‹œí‚¤ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤.\nì˜ˆì‹œ ì‹¤í–‰ ros2 launch src_gazebo wall_world.launch.py ros2 run py_service_tutorial spawn_model Gazeboì—ì„œ ì¼ì •í•œ ê°„ê²©ì„ ë‘ê³ , í•˜ì–€ìƒ‰ ë°•ìŠ¤ê°€ ë“±ì¥í•˜ê²Œ ë©ë‹ˆë‹¤. ë§¤ë²ˆ ë°•ìŠ¤ê°€ ë“±ì¥í•  ë•Œë§ˆë‹¤ service callì´ ì´ë£¨ì–´ì§€ëŠ” ê²ƒì´ì§€ìš”.\nROS 1ì—ì„œì˜ ì˜ˆì‹œì™€ ê¸°ëŠ¥ì€ ë™ì¼í•˜ë¯€ë¡œ ì¤‘ìš”í•œ ì½”ë“œë“¤ë§Œ ê°„ë‹¨íˆ ë¶„ì„í•´ë´…ì‹œë‹¤. ì‚¬ìš©í•˜ëŠ” srvëŠ” gazebo_msgs/srv/SpawnEntity ì…ë‹ˆë‹¤. from gazebo_msgs.srv import SpawnEntity import rclpy from rclpy.node import Node create_clientë¥¼ í†µí•´ Service Clientë¥¼ ìƒì„¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. class SpawnRobot(Node): def __init__(self): super().__init__(\u0026#39;gazebo_model_spawner\u0026#39;) self.client = self.create_client(SpawnEntity, \u0026#39;spawn_entity\u0026#39;) while not self.client.wait_for_service(timeout_sec=1.0): self.get_logger().error(\u0026#39;service not available, waiting again...\u0026#39;) create_clientì˜ ë§¤ê°œë³€ìˆ˜ëŠ” ê°ê° ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nService srv type - SpawnEntity Service server ì´ë¦„ - \u0026lsquo;spawn_entity\u0026rsquo; mainë¬¸ì€, ì¼ë°˜ì ì¸ node ì‹¤í–‰ê³¼ ë‹¤ì†Œ ì°¨ì´ë¥¼ ë³´ì…ë‹ˆë‹¤. Futureë¼ëŠ” ê°œë…ì„ ì‚¬ìš©í•˜ì—¬ ì´ë²¤íŠ¸ ê¸°ë°˜ spinì„ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.\nfuture = robot_spawn_node.send_req() rclpy.spin_until_future_complete(robot_spawn_node, future) if future.done(): try: response = future.result() except Exception: raise RuntimeError( \u0026#39;exception while calling service: %r\u0026#39; % future.exception() ) else: robot_spawn_node.get_logger().info(\u0026#39;==== Service Call Done ====\u0026#39;) robot_spawn_node.get_logger().info(f\u0026#39;Status_message : {response.status_message}\u0026#39;) finally: robot_spawn_node.get_logger().warn(\u0026#39;==== Shutting down node. ====\u0026#39;) ì¹œêµ¬ì™€ ëª…í™•í•œ ì•½ì†ì„ í–ˆë‹¤ë©´, ê·¸ë™ì•ˆ ë‹¤ë¥¸ ì¼ì„ í•  ìˆ˜ ìˆëŠ” ê²ƒì²˜ëŸ¼ FutureëŠ”, íš¨ìœ¨ì ì¸ ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°ì„ ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.\nimage from : brunch.co\nservice callì´ ì´ë£¨ì–´ì§€ëŠ” send_reqì—ì„œ ì´ Futureë¥¼ ë°˜í™˜í•˜ê³  ìˆìŠµë‹ˆë‹¤. def send_req(self): ... self.future = self.client.call_async(self.req) return self.future launch fileì„ ë³´ë©´ gazeboì˜ ì‹¤í–‰ì„ ë¹„ë¡¯í•˜ì—¬ spawn_model nodeë„ í•¨ê»˜ ì‹¤í–‰ë©ë‹ˆë‹¤. ê·¸ë˜ì„œ gazeboê°€ ë“±ì¥í•˜ìë§ˆì í•˜ì–€ ë°•ìŠ¤ë“¤ì´ ìƒì„±ë˜ì—ˆë˜ ê²ƒì…ë‹ˆë‹¤. spawn_parking_lot = Node( package=\u0026#39;py_service_tutorial\u0026#39;, executable=\u0026#39;spawn_model\u0026#39;, name=\u0026#39;spawn_model\u0026#39;, output=\u0026#39;screen\u0026#39; ) ì´ ì˜ˆì‹œëŠ” ë‹¤ìŒ Actionì—ì„œë„ í™œìš©ë˜ë¯€ë¡œ ì˜ ê¸°ì–µí•´ë‘ì‹œê¸° ë°”ëë‹ˆë‹¤.\nCustom Interfaceì™€ ì½”ë”© ê³¼ì œ - Turtle Jail ROS 2ì—ì„œ custom interfaceë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” C++ Packageì—ì„œ ì‘ì—…ì´ ì´ë£¨ì–´ì ¸ì•¼ í•©ë‹ˆë‹¤. C++ packageëŠ” build type ament_cmakeë¥¼ ì‚¬ìš©í•˜ëŠ” packageì˜€ìŠµë‹ˆë‹¤.\n$ ros2 pkg create --build-type ament_cmake \u0026lt;package-name\u0026gt; $ ros2 pkg create --build-type ament_cmake custom_interfaces í•´ë‹¹ íŒ¨í‚¤ì§€ ë‚´ action, msg, srv ë¼ëŠ” í´ë”ë¥¼ ë§Œë“¤ê³  í•´ë‹¹ í´ë” ì•ˆì— ë‚˜ë§Œì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ë³¸ ë°ì´í„° í˜•ì‹ë“¤ì€ ì´ ë§í¬ë¥¼ ì°¸ê³ í•©ë‹ˆë‹¤.\nì´ë²ˆì— ë§Œë“¤ì–´ë³¼ custom interfaceëŠ” ë‹¤ìŒ ê³¼ì œì™€ ì—°ê²°ë©ë‹ˆë‹¤. ìš°ì„  ì €ë¥¼ ë”°ë¼ì™€ ì£¼ì„¸ìš”.\nsrvë¼ëŠ” í´ë”ë¥¼ ë§Œë“¤ê³ , TurtleJail.srvë¼ëŠ” íŒŒì¼ì„ ìƒì„±í•˜ì—¬ ì•„ë˜ì™€ ê°™ì€ ë‚´ìš©ì„ ì‘ì„±í•©ë‹ˆë‹¤. float32 width float32 height --- bool success í•´ë‹¹ interfaceë¥¼ rclpy, rclcppì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•˜ë„ë¡ í•´ë´…ì‹œë‹¤. ROS 2ëŠ” DDSì˜ IDL(Interface Description Language)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ì–‘í•œ ì–¸ì–´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ë°ì´í„° íƒ€ì…ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nCMakeLists.txt ìˆ˜ì • find_package(rosidl_default_generators REQUIRED) rosidl_generate_interfaces(${PROJECT_NAME} \u0026#34;msg/Num.msg\u0026#34; \u0026#34;srv/AddThreeInts.srv\u0026#34; \u0026#34;srv/TurningControl.srv\u0026#34; \u0026#34;srv/TurtleJail.srv\u0026#34; \u0026#34;action/Fibonacci.action\u0026#34; \u0026#34;action/Maze.action\u0026#34; ) package.xml ìˆ˜ì • \u0026lt;build_depend\u0026gt;rosidl_default_generators\u0026lt;/build_depend\u0026gt; \u0026lt;exec_depend\u0026gt;rosidl_default_runtime\u0026lt;/exec_depend\u0026gt; \u0026lt;member_of_group\u0026gt;rosidl_interface_packages\u0026lt;/member_of_group\u0026gt; íŒ¨í‚¤ì§€ ë¹Œë“œ $ colcon build --packages-select custom_interfaces \u0026amp;\u0026amp; rosfoxy Starting \u0026gt;\u0026gt;\u0026gt; custom_interfaces Finished \u0026lt;\u0026lt;\u0026lt; custom_interfaces [0.62s] Summary: 1 package finished [0.84s] ì´ì œ ROS 2ì—ì„œ í•´ë‹¹ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ë‹¨, í•´ë‹¹ workspaceë¥¼ ë°”ë¼ë³´ê²Œ í•´ì•¼ í•©ë‹ˆë‹¤.) $ ros2 interface show custom_interfaces/srv/TurtleJail float32 width float32 height --- bool success custom interfaceì˜ ì‚¬ìš© ì‹œ íŒŒì´ì¬ íŒ¨í‚¤ì§€ì—ì„œëŠ” ë³„ë„ ì‘ì—… ì—†ì´ ì‚¬ìš© ê°€ëŠ¥í•˜ì§€ë§Œ C++ íŒ¨í‚¤ì§€ëŠ” ì½”ë”© ì‹œ CMakeLists.txtì˜ ìˆ˜ì •ì´ í•„ìš”í•©ë‹ˆë‹¤. ì´ëŠ” ë‹¤ì†Œ ë‚œì´ë„ê°€ ìˆì–´ ê°•ì˜ì—ì„œ ì‚´í”¼ì§€ëŠ” ì•Šê³  ë§í¬ë¥¼ ë‚¨ê²¨ë‘ê² ìŠµë‹ˆë‹¤.\nhttps://docs.ros.org/en/foxy/Tutorials/Beginner-Client-Libraries/Custom-ROS2-Interfaces.html#id10 Assignment - Turtle Jail topicê³¼ serviceì— ëŒ€í•´ì„œ ëª¨ë‘ ì‚´í´ë³¸ ì§€ê¸ˆ ìƒí™©ì—ì„œ ì—¬ëŸ¬ë¶„ë“¤ê»˜ ì½”ë”© ê³¼ì œë¥¼ ì œì‹œí•´ë³´ê³ ì í•©ë‹ˆë‹¤. ì´ë²ˆ ì½”ë”© ê³¼ì œì—ì„œ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ìµœì¢… ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nrqtë¥¼ í†µí•´ turtle_jail_size service callì„ í•˜ë©°, ê°ì˜¥ì˜ ì‚¬ì´ì¦ˆë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.\nê±°ë¶ì´ëŠ” ê°ì˜¥ì„ ë²—ì–´ë‚  ìˆ˜ ì—†ìœ¼ë©°, ê°ì˜¥ì„ ë²—ì–´ë‚˜ëŠ” ìˆœê°„ ì›ì ìœ¼ë¡œ ìˆœê°„ì´ë™í•©ë‹ˆë‹¤.\ní„°ë¯¸ë„ì—ì„œ ì‹¤í–‰í•˜ëŠ” ì ˆì°¨ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. # Terminal 1 â€“ turtlesimì‹¤í–‰ ros2 run turtlesim turtlesim_node # Terminal 2 - turtle_teleop ì‹¤í–‰ ros2 run turtlesim turtle_teleop_key # Terminal 3 - ê³¼ì œ í”„ë¡œê·¸ë¨ ì‹¤í–‰ ros2 run py_service_tutorial turtle_jail [INFO] [turtle_jail_node]: === [Service Client : Ready to Call Service Request] === [INFO] [turtle_jail_node]: ==== [Service Server : Ready to receive Service Request] ==== # Terminal 4 - rqtì˜ service caller ì‹¤í–‰ í›„ /turtle_jail_sizeì—ê²Œ service call cd ~/ros2_ws source install/local_setup.bash rqt ì´ë²ˆ ì˜ˆì‹œëŠ” custom interfaceë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ local_setup.bashë¥¼ ê¼­ ì‹¤í–‰í•´ì£¼ì„¸ìš”!\nì´ ì˜ˆì‹œì—ì„œëŠ” topicê³¼ serviceë¥¼ ëª¨ë‘ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ í•™ìŠµí•œ ë‚´ìš©ë“¤ì„ í™•ì¸í•´ë³¼ ìˆ˜ ìˆëŠ” ì¢‹ì€ ê¸°íšŒê°€ ë  ê²ƒì…ë‹ˆë‹¤.\níŒíŠ¸1 : turtlesimì˜ ì¢Œí‘œê³„ íŒíŠ¸ 2 : ê±°ë¶ì´ë¥¼ ìˆœê°„ì´ë™ì‹œí‚¤ê¸° ìœ„í•´ /turtle1/teleport_absolute serviceë¥¼ ì‚¬ìš©í•˜ì„¸ìš”. "
},
{
	"uri": "/kr/ros2_basic_foxy/lecture7/",
	"title": "Lecture7 - Useful ROS 2 Example, Navigation2",
	"tags": [],
	"description": "",
	"content": " ì½”ë”©ì„ ì‹œì‘í•˜ê¸° ì „ì— êµ¬í˜„í•´ì•¼ í•˜ëŠ” ê¸°ëŠ¥ë“¤ê³¼ Topic, Service ê¸°ì¤€ input, outputì„ ì •ë¦¬í•´ë´…ì‹œë‹¤.\nPart 1 - ê°ì˜¥ êµ¬í˜„ ê±°ë¶ì´ê°€ ì¼ì • ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ê²Œ ë˜ë©´ ë‹¤ì‹œ ì›ìœ„ì¹˜ë¡œ ëŒì•„ì˜¤ê²Œ í•œë‹¤.\nê±°ë¶ì´ì˜ ìœ„ì¹˜ëŠ” /turtle1/pose topic subscribeì„ í†µí•´ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê±°ë¶ì´ê°€ ì¼ì • ìœ„ì¹˜ë¥¼ ë²—ì–´ë‚˜ëŠ” ìˆœê°„, ì›ìœ„ì¹˜ë¡œ ëŒì•„ì˜¤ê²Œ í•˜ëŠ” /turtle1/teleport_absolute service callì„ í•´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•œ service clientê°€ í•„ìš”í•©ë‹ˆë‹¤. Part 2 - ê°ì˜¥ í¬ê¸° ë³€ê²½ ì‚¬ìš©ìë¡œë¶€í„° ê°ì˜¥ì˜ í¬ê¸°ë¥¼ ë³€ê²½í•´ë‹¬ë¼ëŠ” service requestê°€ ì˜¤ë©´ ê¸°ì¡´ ê°ì˜¥ì˜ í¬ê¸°ë¥¼ ë³€ê²½í•˜ëŠ” ì‘ì—…ì´ í•„ìš”í•˜ë‹¤.\n/turtle_jail_size service serverë¥¼ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤. ê°ì˜¥ì˜ í¬ê¸°ê°€ ë³€ê²½ë˜ë©´ topic ë¡œì§ì—ë„ ë°˜ì˜ë˜ì–´ì•¼ í•˜ë¯€ë¡œ OOPì˜ í˜•íƒœë¡œ êµ¬í˜„ì´ í•„ìš”í•  ë“¯ í•©ë‹ˆë‹¤. ì½”ë“œë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ í•„ìš”í•œ topic, service interfaceë“¤ì„ ì¡°íšŒí•©ì‹œë‹¤.\n$ ros2 interface show custom_interfaces/srv/TurtleJail float32 width float32 height --- bool success $ ros2 interface show turtlesim/srv/TeleportAbsolute float32 x float32 y float32 theta --- $ ros2 interface show turtlesim/msg/Pose float32 x float32 y float32 theta float32 linear_velocity float32 angular_velocity ëª¨ë“  í•„ìš”ì¡°ê±´ë“¤ì„ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ í”„ë¡œê·¸ë˜ë°ì„ í•´ë³´ê² ìŠµë‹ˆë‹¤.\ní•„ìš” íŒŒì´ì¬ íŒ¨í‚¤ì§€ import import rclpy from rclpy.node import Node from turtlesim.msg import Pose from turtlesim.srv import TeleportAbsolute from custom_interfaces.srv import TurtleJail Service Server, Service Client, Topic Subscriber ìƒì„± # Create Turtle teleport client self.client = self.create_client(TeleportAbsolute, \u0026#39;turtle1/teleport_absolute\u0026#39;) while not self.client.wait_for_service(timeout_sec=1.0): self.get_logger().info(\u0026#39;Service not available, Waiting again...\u0026#39;) self.request_srv = TeleportAbsolute.Request() self.get_logger().info(\u0026#39;=== [Service Client : Ready to Call Service Request] ===\u0026#39;) # Create Subscriber for turtle1/pose queue_size = 10 # Queue Size self.pose_subscriber = self.create_subscription( Pose, \u0026#39;turtle1/pose\u0026#39;, self.sub_callback, queue_size ) # Create Service Server for User Interfaces self.srv = self.create_service( TurtleJail, \u0026#39;turtle_jail_size\u0026#39;, self.turtle_jail_callback ) self.get_logger().info(\u0026#39;==== [Service Server : Ready to receive Service Request] ====\u0026#39;) í´ë˜ìŠ¤ ë³€ìˆ˜ ì„ ì–¸ (ê°ì˜¥ ì‚¬ì´ì¦ˆ, ë²½ì— ë„ë‹¬í•˜ê¸° ì „ ê±°ë¶ì´ì˜ ê°ë„) # Preserve its rotation before teleport self.cur_theta = 0.0 # jail size in rectangular form self.jail_width = 6.0 self.jail_height = 6.0 topic subscribeì™€ service serverì— ëŒ€í•œ callbackì´ ë‘ ê°œ í•„ìš”í•©ë‹ˆë‹¤.\nê±°ë¶ì´ì˜ Pose Topic Subscribe Callback def sub_callback(self, msg): \u0026#34;\u0026#34;\u0026#34;Turtle Pose Subscriber Callback\u0026#34;\u0026#34;\u0026#34; if abs(msg.x - 6.0) \u0026gt; self.jail_width or abs(msg.y - 6.0) \u0026gt; self.jail_height: self.cur_theta = msg.theta self.get_logger().warn(\u0026#34;You can\u0026#39;t go out Turtle! :(\u0026#34;) self.send_request() ê°ì˜¥ ì‚¬ì´ì¦ˆ ë³€ê²½ ìš”ì²­ ì‹œ ë°œìƒí•˜ëŠ” Service Server Callback def turtle_jail_callback(self, request, response): \u0026#34;\u0026#34;\u0026#34;Service Server for jail resizing client request\u0026#34;\u0026#34;\u0026#34; self.jail_width = request.width self.jail_height = request.height self.get_logger().info(f\u0026#34;\u0026#34;\u0026#34;Jail Size Update to {self.jail_width}/{self.jail_height}\u0026#34;\u0026#34;\u0026#34;) response.success = True return response ë§ˆì§€ë§‰ìœ¼ë¡œ, ê±°ë¶ì´ë¥¼ ì›ì ìœ¼ë¡œ ì´ë™ì‹œì¼œë‹¬ë¼ëŠ” service requestë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤. def send_request(self): \u0026#34;\u0026#34;\u0026#34;Service Clinet request fuction\u0026#34;\u0026#34;\u0026#34; self.request_srv.x = 6.0 self.request_srv.y = 6.0 self.request_srv.theta = self.cur_theta self.future = self.client.call_async(self.request_srv) return self.future ë°”ë¡œ ì½”ë”©ì„ ì‹œì‘í•˜ì§€ ë§ê³ , ë¬´ì—‡ì„ êµ¬í˜„í•´ì•¼ í•˜ëŠ”ì§€ ì ì–´ë³´ëŠ” ê²ƒ, ì¡°ê¸ˆì”© ì¡°ê¸ˆì”© êµ¬í˜„í•œ ë’¤, í™•ì¸í•˜ë©´ì„œ ê°œë°œí•˜ëŠ” ê²ƒ, ROS ë¿ë§Œ ì•„ë‹ˆë¼ ì•ìœ¼ë¡œì˜ í”„ë¡œê·¸ë˜ë°ì—ì„œ ë°˜ë“œì‹œ ìŠì§€ ë§ˆì‹œê¸° ë°”ëë‹ˆë‹¤.\nNavigation 2 ì´ë²ˆ ì‹œê°„ì—ëŠ” ìœ ìš©í•œ ROS 2 í”„ë¡œì íŠ¸ë¥¼ ì†Œê°œí•˜ê³ , ê´€ë ¨ëœ ë‚´ìš©ì„ í•¨ê»˜ ì‚´í´ë³´ê³ ì í•©ë‹ˆë‹¤. ROS 2ì˜ ììœ¨ ì£¼í–‰ ë©”íƒ€í˜í‚¤ì§€ì¸ Navigation 2, Nav2 ì…ë‹ˆë‹¤.\nimage from : https://navigation.ros.org\nNav 2ëŠ” ì‚¼ì„± ë¦¬ì„œì¹˜ ì•„ë©”ë¦¬ì¹´ì˜ Steven Macenskiì˜ ì£¼ë„ í•˜ì— ê°œë°œë˜ê³  ìˆìœ¼ë©°, ì•„ë˜ì™€ ê°™ì€ ììœ¨ì£¼í–‰ì„ ìœ„í•´ í•„ìš”í•œ ê±°ì˜ ëª¨ë“  ê¸°ëŠ¥ë“¤ì„ ì§‘í•©í•´ë‘” í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.\nì§€ë„ ì €ì¥, ì „ì†¡, ê´€ë¦¬ (Map Server) ì§€ë„ ìƒì—ì„œ ë¡œë´‡ì˜ ìœ„ì¹˜ íŒŒì•…í•˜ê¸° (AMCL) A to B ì£¼í–‰ì„ ìœ„í•œ ê²½ë¡œ ìƒì„± (Nav2 Planner) ê²½ë¡œë¥¼ ë”°ë¼ ë¡œë´‡ì„ ì´ë™ì‹œí‚¤ê¸° ìœ„í•œ ì»¨íŠ¸ë¡¤ ì‹œìŠ¤í…œ (Nav2 Controller) ì£¼í–‰ ê²½ë¡œì˜ ìµœì í™” (Nav2 Smoother) Costmap ìƒì„±ê³¼ ì„¼ì„œ ë°ì´í„° ë°˜ì˜ (Nav2 Costmap 2D) Behavior Treeë¥¼ í†µí•œ ë³µì¡í•œ ì£¼í–‰ ì‹œë‚˜ë¦¬ì˜¤ í•¸ë“¤ë§ (Nav2 Behavior Trees and BT Navigator) ì£¼í–‰ ì‹¤íŒ¨ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•œ recovery behaviors (Nav2 Recoveries) Waypoints ì£¼í–‰ (Nav2 Waypoint Follower) Nav2 Nodeë“¤ì˜ ëª¨ë‹ˆí„°ë§ê³¼ ê´€ë¦¬ (Nav2 Lifecycle Manager) ì»¤ìŠ¤í…€ ì•Œê³ ë¦¬ì¦˜ ê°œë°œì„ ìœ„í•œ Plugins (Nav2 Core) ì¼ë°˜ ê°œë°œìë‚˜ ê¸°ì—…ì´ ììœ¨ì£¼í–‰ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œëŠ” ì´ë ‡ê²Œ ë§ì€ ê²ƒë“¤ì´ í•„ìš”í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ, ROS 2ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ Nav 2ë¥¼ í†µí•´ ë§ì€ ì‹œê°„ì„ ë‹¨ì¶•í•  ìˆ˜ ìˆì§€ìš”!\nì´ ê°•ì˜ì—ì„œ ëª¨ë“  ë‚´ìš©ì„ ë‹¤ë£¨ê³  ì‹¶ì§€ë§Œ, ì‹œê°„ì  í•œê³„ê°€ ìˆê¸° ë•Œë¬¸ì— ì˜ˆì‹œë¥¼ í†µí•´ ë¡œë´‡ ììœ¨ì£¼í–‰ì— ëŒ€í•œ ê°œë…ì„ ì²´ê°í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.\nNav 2 Example 1 - SLAM_ToolBox ì²˜ìŒ ê°€ë³´ëŠ” í™˜ê²½ì„ ë§ë‹¥ëœ¨ë¦¬ë©´, ìš°ë¦¬ëŠ” ì£¼ë³€ ìƒí™©ì„ íƒìƒ‰í•˜ê³  ë‚´ ìœ„ì¹˜ë¥¼ íŒŒì•…í•˜ë ¤ í•  ê²ƒì…ë‹ˆë‹¤. ì´ê²ƒì„ ë¡œë³´í‹±ìŠ¤ì—ì„œëŠ” SLAM - Simultaneous localization and mappingì´ë¼ê³  ì´ì•¼ê¸°í•©ë‹ˆë‹¤.\nSLAM ToolboxëŠ” Steven Macenskiì— ì˜í•´ ì œì‘ëœ ROS 2 íŒ¨í‚¤ì§€ì´ë©° backendì™€ frontend SLAM ì•Œê³ ë¦¬ì¦˜ ë¿ë§Œ ì•„ë‹ˆë¼, ROS 2ì™€ í˜¸í™˜ë˜ëŠ” ê´€ë¦¬ ë„êµ¬, ìµœì í™”ê¹Œì§€ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. ì˜ˆì‹œë¥¼ í†µí•´ SRC ë¡œë´‡ìœ¼ë¡œ SLAMì„ ì‹¤ìŠµí•´ë´…ì‹œë‹¤. ë¡œë´‡ì„ ì´ë™ì‹œí‚¤ë©´ì„œ rvizì— ê°±ì‹ ë˜ëŠ” ì§€ë„ë¥¼ í™•ì¸í•©ë‹ˆë‹¤. colcon build --packages-select src_slam colcon build --packages-select src_odometry source install/local_setup.bash # Terminal 1 ros2 launch src_gazebo racecourse.launch.py use_rviz:=false # Terminal 2 ros2 launch src_slam src_slam_gazebo_slam_toolbox.launch.py ì§€ë„ë¥¼ ì €ì¥í•˜ëŠ” ë‘ ê°€ì§€ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤.\nrviz plugin ì‚¬ìš© - RVizìƒì˜ ê³µë€ì— ì§€ë„ë¥¼ ì €ì¥í•  ìœ„ì¹˜ë¥¼ í¬í•¨í•œ ì ˆëŒ€ê²½ë¡œë¥¼ ê¸°ì…í•˜ê³  ì™¼ìª½ â€œSave Mapâ€ ë²„íŠ¼ì„ ëˆŒëŸ¬ ìµœì¢… ì§€ë„ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤. ì»¤ë©˜ë“œ ë¼ì¸ ì‚¬ìš© - ì €ì¥ ìœ„ì¹˜ê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ í›„ ì‹¤í–‰í•˜ì„¸ìš”. ros2 run nav2_map_server map_saver_cli -f \u0026lt;map_dir\u0026gt;/\u0026lt;map_name\u0026gt; ì €ì¥ ê²°ê³¼ë¡œ ë‘ ê°€ì§€ íŒŒì¼ì´ ìƒì„±ë˜ë©°, ì´ëŸ¬í•œ ì§€ë„ ë°ì´í„°ë¥¼ ê´€ë¦¬í•´ì£¼ëŠ” ê²ƒì´ Nav 2ì˜ Map Server ì…ë‹ˆë‹¤. ì§€ë„ ì´ë¯¸ì§€ íŒŒì¼ ì§€ë„ ì •ë³´ë¥¼ ë‹´ì€ yaml íŒŒì¼ Localization ë¡œë´‡ì˜ í˜„ì¬ ìœ„ì¹˜ì™€ ë°©í–¥ì„ íŒŒì•…í•˜ëŠ” ê²ƒì„ localizationì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.\nNav2ì˜ AMCL íŒ¨í‚¤ì§€ëŠ” ì£¼ì–´ì§„ ë§µì„ ê¸°ë°˜ìœ¼ë¡œ Adaptive Monte Carlo Localization ë°©ì‹ì„ ì‚¬ìš©í•˜ì—¬ ë¡œë´‡ì˜ ìœ„ì¹˜ë¥¼ íŒŒì•…í•©ë‹ˆë‹¤.\nimage from : wikipedia\nì´ Adaptive Monte Carlo Localizationì€ ì…ì(Particle)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œë´‡ì˜ ìœ„ì¹˜ë¥¼ íŒŒì•…í•˜ëŠ” ë°©ì‹ì´ë©°, ì´ ì…ìë“¤ì€ ì‹¤ì œ ë¡œë´‡ì²˜ëŸ¼ ì£¼ì–´ì§„ ê°€ì¤‘ì¹˜ì™€ í•¨ê»˜ ê·¸ë“¤ë§Œì˜ ì¢Œí‘œì™€ ë°©í–¥ ê°’ì„ ê°€ì§€ê³  ìˆê²Œ ë©ë‹ˆë‹¤.\në¡œë´‡ì´ ì£¼ì–´ì§„ í™˜ê²½ì—ì„œ ì´ë™í•˜ì—¬ ìƒˆ ì„¼ì„œ ë°ì´í„°ë¥¼ ì œê³µí•  ë•Œë§ˆë‹¤ ì…ìê°€ ë‹¤ì‹œ ìƒ˜í”Œë§ë˜ë©°, ê° ìƒ˜í”Œë§ì—ì„œ ê°€ì¤‘ì¹˜ê°€ ì‘ì€ ì…ìëŠ” ì†Œë©¸ë˜ê³  ê°€ì¤‘ì¹˜ê°€ í° ì…ìëŠ” ë” ì»¤ì§€ë©´ì„œ ìƒì¡´í•©ë‹ˆë‹¤.\nAMCL ì•Œê³ ë¦¬ì¦˜ì„ ì—¬ëŸ¬ ë²ˆ ë°˜ë³µí•˜ê²Œ ë˜ë©´ ì…ìë“¤ì˜ ìœ„ì¹˜ê°€ ìˆ˜ë ´í•˜ì—¬ ë¡œë´‡ í¬ì¦ˆì˜ ê·¼ì‚¬ì¹˜ë¥¼ í‰ê°€í•  ìˆ˜ ìˆê³ , ê²°êµ­ ì´ ë¡œë´‡ì˜ ìµœì¢… ë°©í–¥ê³¼ ìœ„ì¹˜ë¥¼ ì¶”ì •í•˜ê²Œ ë©ë‹ˆë‹¤.\nNav2 Lifecycle Manager Map Server, AMCLê³¼ ê°™ì€ Nav2ì˜ stackì€ Nav2 Lifecycle Managerì— ì˜í•´ ê´€ë¦¬ë©ë‹ˆë‹¤.\nLifecycleì´ë¼ëŠ” ê²ƒì€ ìƒì„±ê³¼ ì‹¤í–‰, ì¼ì‹œì •ì§€ì™€ ìµœì¢… ì¢…ë£Œì™€ ê°™ì´ Nodeì˜ ìƒíƒœë¥¼ ì§€ì¹­í•©ë‹ˆë‹¤. image from : roscon2019\nê¸°ì¡´ ROS 2ë„ lifecycleì„ ê°–ê³  ìˆì§€ë§Œ, Nav 2ëŠ” ì „ìš© lifecycle_managerë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œ ë‹¤ë¥¸ nodeê³¼ ë³„ë„ë¡œ ììœ¨ì£¼í–‰ê³¼ ê´€ë ¨ëœ ìµœì í™”ëœ ì‹œìŠ¤í…œ ì„¤ê³„ê°€ ê°€ëŠ¥í•´ì¡ŒìŠµë‹ˆë‹¤. image from : navigation2\ní•˜ì§€ë§Œ, ROS 2ì˜ lifecycleì´ ì•„ë‹Œ ë…ìì ì¸ ë°©ì‹ì„ ì‚¬ìš©í•˜ê²Œ ë¨ìœ¼ë¡œ ë””ë²„ê¹… íˆ´ ì‚¬ìš©ì´ ë¶ˆê°€í•˜ë‹¤ëŠ” ì ì´ ë¬¸ì œì ìœ¼ë¡œ ëŒ€ë‘ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì´ìœ ë¡œ, nav2 ê°œë°œ ì‹œì—ëŠ” rqt consoleì˜ ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.\nCostmap 2D ììœ¨ì£¼í–‰ì˜ ê²½ë¡œë¥¼ ê³„ì‚°í•  ì‹œ, ì¼ë°˜ì ìœ¼ë¡œ êµ¬ì—­ì„ ë‚˜ëˆ„ê³  ì¥ì• ë¬¼ ì—¬ë¶€, ì¶©ëŒ ê°€ëŠ¥ ì—¬ë¶€ë“±ì„ ì ìˆ˜í™”í•˜ì—¬ êµ¬ì—­ë³„ costmapì„ ë§Œë“­ë‹ˆë‹¤.\nNav2ì—ì„œë„ ë¡œë´‡ì˜ í¬ê¸°ì™€ ì‚¬ìš©ìì˜ ì •ì˜ì— ë”°ë¼ inflationì„ ì ìš©í•œ costmapì„ ìƒì„±í•©ë‹ˆë‹¤.\nNav2ì˜ costmapì—ì„œ ê° ì…€ì˜ costëŠ” unknown, free, occupied, inflatedë¡œ ì •ì˜ë˜ê³ , controller, planner, recovery pluginë“±ì´ ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì•ˆì „í•˜ê³  íš¨ìœ¨ì ì¸ ê²½ë¡œë¥¼ ê³„ì‚°í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ costmapì—ëŠ” ë‘ê°€ì§€ ì¢…ë¥˜ê°€ ìˆëŠ”ë°\nGlobal Costmapì€ SLAMì„ í†µí•´ ì–»ì€ ì •ì  ì§€ë„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±ë˜ë©°, ë²½, ê°€êµ¬ì™€ ê°™ì´ SLAM ë‹¹ì‹œ ì¡´ì¬í–ˆë˜ ì¥ì• ë¬¼ë“¤ì— ëŒ€í•œ costmapì…ë‹ˆë‹¤. Local Costmapì€ ë¡œë´‡ ì£¼ìœ„ ì¼ì • ë²”ìœ„ì— ë¡œë´‡ì— ë¶€ì°©ëœ ì„¼ì„œë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±ë˜ë©°, ë™ì  ì¥ì• ë¬¼ì„ ê°ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¡œë´‡ì´ ì´ë™í•¨ì— ë”°ë¼ ë§¤ë²ˆ ê°±ì‹ ë˜ëŠ” ë°ì´í„°ì…ë‹ˆë‹¤. ì•„ë˜ ì‚¬ì§„ì—ì„œ ì™¼ìª½ì€ Global costmapì„, ì˜¤ë¥¸ìª½ì€ Local costmapì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤.\ninflationì˜ ë³€ê²½ì— ë”°ë¥¸ costmapì˜ ì°¨ì´ëŠ” ì•„ë˜ì™€ ê°™ì´ rviz í™”ë©´ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. inflationì„ ì¤„ì´ê²Œ ë˜ë©´ ê²½ë¡œ ìƒ ê°ˆ ìˆ˜ ìˆëŠ” ì˜ì—­ì´ ë§ì•„ì¡Œì§€ë§Œ, ì¶©ëŒ ì¸¡ë©´ì—ì„œëŠ” ì¢€ ë” ìœ„í—˜í•´ì¡Œë‹¤ê³  ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, ë¡œë´‡ì˜ í¬ê¸°ì™€ ìµœëŒ€ ì†ë„, ì œë™ê±°ë¦¬ë¥¼ ê³ ë ¤í•˜ì—¬ ì ì ˆí•œ inflation radiusë¥¼ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.\nLocal Pathì™€ Global Path ì„¼ì„œ ë°ì´í„°ì—ì„œ ì¥ì• ë¬¼ì´ ê²€ì¶œë˜ì—ˆë‹¤ë©´, local plannerëŠ” ì´ë¥¼ íšŒí”¼í•˜ê¸° ìœ„í•´ ê¸°ì¡´ global plannerì™€ëŠ” ë‹¤ë¥¸ ë³„ë„ì˜ ê²½ë¡œë¥¼ ë”°ë¥´ë„ë¡ ë¡œë´‡ì—ê²Œ ì§€ì‹œí•  ê²ƒì…ë‹ˆë‹¤.\nNav2ì—ì„œ ë¬¼ì²´ íšŒí”¼ë¥¼ ìœ„í•´ ìˆ˜í–‰ë˜ëŠ” ë™ì‘ë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nglobal plannerê°€ ì§€ë„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê±°ì‹œì ì¸ ê²½ë¡œë¥¼ ê³„ì‚°í•˜ë©´ ì´ ê²½ë¡œì˜ ì¼ë¶€ê°€ local plannerì—ê²Œ ì „ë‹¬ë©ë‹ˆë‹¤. local plannerëŠ” ê¸°ë³¸ì ìœ¼ë¡œ global Plannerì˜ íŒŒí¸ì´ì§€ë§Œ, í˜„ì¬ ì£¼í–‰ì¤‘ì¸ í™˜ê²½ê³¼ ì„¼ì„œ ë°ì´í„°ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„, ê²½ë¡œë¥¼ ìµœì‹ í™”í•©ë‹ˆë‹¤. global planê³¼ local planì€ ì—„ì—°íˆ ë‹¤ë¥¸ ì•Œê³ ë¦¬ì¦˜ì´ ì‚¬ìš©ë˜ëŠ” ë¶„ì•¼ì…ë‹ˆë‹¤.\nimage from : Autonomous Wheeled Mobile Robot Control\nController local Pathê°€ ê³„ì‚°ë˜ì—ˆë‹¤ë©´, ì´ì œ ë¡œë´‡ì´ ì‹¤ì œë¡œ í•´ë‹¹ ê²½ë¡œë¥¼ ì£¼í–‰í•  ì°¨ë¡€ì…ë‹ˆë‹¤.\në¡œë´‡ì˜ ìµœëŒ€ ì„ ì†ë„, ê°ì†ë„ì™€ í›„ì§„ ì—¬ë¶€ ë“± ë§¤ê°œë³€ìˆ˜ì— ë”°ë¼ ê²½ë¡œë¥¼ ìµœì í™”í•´ì•¼ í•©ë‹ˆë‹¤. Nav2ì—ì„œëŠ” Controllerê°€ ì´ë¥¼ ë‹´ë‹¹í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nControllerëŠ” ê·¸ ì´ë¦„ê³¼ ê°™ì´ ì£¼ì–´ì§„ ê²½ë¡œë¥¼ ë”°ë¥´ê¸° ìœ„í•´ ë¡œë´‡ì—ê²Œ ì‹¤ì œ ì œì–´ ì‹ í˜¸ë¥¼ ì „ë‹¬í•˜ê²Œ ë˜ë©°, ë”°ë¼ì„œ ì‚¬ìš©í•˜ëŠ” ë¡œë´‡ì˜ ëª¨ë¸ê³¼ ë°€ì ‘í•œ ê´€ë ¨ì´ ìˆìŠµë‹ˆë‹¤. (ì œìë¦¬ íšŒì „, yì¶• ì´ë™ ë“±)\nimage from : dwa_local_planner\nNav2 Behavior Tree ë¡œë´‡ì˜ ì¼ë ¨ì˜ í–‰ë™ë“¤ì€ Tree ìë£Œ êµ¬ì¡°ë¡œ í‘œí˜„ë  ìˆ˜ ìˆìœ¼ë©°, Treeì˜ Nodeì— í•´ë‹¹í•˜ëŠ” ì‘ì—…ì„ êµ¬í˜„í•´ë‘ê³  ì´ë“¤ì„ ì¡°í•©í•˜ì—¬ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nex) A ìœ„ì¹˜ì— ë„ì°©í•œ ë’¤, ë¬¼ê±´ì„ ì‹£ê³ , ë‹¤ì‹œ B ìœ„ì¹˜ë¡œ ì´ë™í•˜ì—¬ ìƒˆë¡œìš´ ë¬¼ê±´ì„ ì‹£ê³ , ìµœì¢…ì ìœ¼ë¡œ Cì§€ì ìœ¼ë¡œ ëŒì•„ì™€ë¼. ë§Œì•½ C ì§€ì ì— ë¬¼ê±´ì´ ê°€ë“ ì°¨ìˆë‹¤ë©´ D ì§€ì ìœ¼ë¡œ ì´ë™í•˜ì—¬ ë¬¼ê±´ì„ ìµœì¢… ì´ì†¡í•´ë¼\u0026hellip; image from : wikipedia\nNav2ëŠ” **BehaviorTree.CPP**ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œë´‡ì˜ ììœ¨ì£¼í–‰ ì‹œë‚˜ë¦¬ì˜¤ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. Behavior TreeëŠ” Nav2ì™€ëŠ” ë³„ë„ì˜ ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œê·¸ë¨ì¸ë°, ì‹œê°í™”ë¥¼ í¬í•¨í•œ ë†’ì€ ì™„ì„±ë„ë¥¼ ê°–ì¶”ê³  ìˆì–´ ê²Œì„ ë° ë¡œë´‡ ë„ë©”ì¸ì—ì„œ ë§ì´ ì‚¬ìš©ë©ë‹ˆë‹¤. https://robohub.org/introduction-to-behavior-trees/\nNav2 Core nav2_core íŒ¨í‚¤ì§€ëŠ” custom ì•Œê³ ë¦¬ì¦˜ì„ ì ìš©í•œ í”ŒëŸ¬ê·¸ì¸ì„ êµ¬í˜„í•  ìˆ˜ ìˆë„ë¡ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì—°êµ¬ì‹¤ì´ë‚˜ ê¸°ì—…ì—ì„œëŠ” ìì‹ ë§Œì˜ ë¡œì§ì„ Pluginìœ¼ë¡œ êµ¬í˜„í•´ì„œ Nav2 ì‹œìŠ¤í…œì— ì ìš©í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ êµ¬í˜„ì˜ ì‹œê°„ì„ ë‹¨ì¶•ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nGlobal Planner â€“ global_planner.hpp Local Planner â€“ local_planner.hpp Recovery behaviors â€“ recovery.hpp Goal checker â€“ goal_checker.hpp Exceptions â€“ exceptions.hpp ì—¬ëŸ¬ë¶„ë§Œì˜ pluginì„ ë§Œë“¤ì–´ë³´ê³  ì‹¶ë‹¤ë©´, ì•„ë˜ ë§í¬ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.\nhttps://navigation.ros.org/plugin_tutorials/index.html Nav2 ì‹¤í–‰ ì˜ˆì‹œ ì§€ë£¨í•œ ì´ë¡ ì„ ë“£ëŠë¼ ê³ ìƒí•˜ì…¨ìŠµë‹ˆë‹¤. ì´ì œ srcë¥¼ í†µí•´ ììœ¨ ì£¼í–‰ ì˜ˆì‹œë¥¼ í•¨ê»˜ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤. colcon build --packages-select src_nav source install/local_setup.bash # Terminal 1 ros2 launch src_gazebo racecourse.launch.py use_rviz:=false # Terminal 2 ros2 launch src_nav bringup_launch.py rqt_graphë¥¼ í™•ì¸í•´ë´…ì‹œë‹¤. ë°©ê¸ˆ ìš°ë¦¬ê°€ ì‹¤í–‰í•œ launch fileì„ ê°™ì´ ì‚´í´ë³¼ê¹Œìš”?\nLaunchDescriptionë¶€í„° ì‚´í´ë´…ì‹œë‹¤. ëŒ€ë¶€ë¶„ launch arguementì˜ ì„ ì–¸ì´ê³  ê²°êµ­ ì‹¤í–‰ê³¼ ê´€ë ¨ëœ ê²ƒì€ bringup_cmd_group ë¿ì…ë‹ˆë‹¤. # Set environment variables ld.add_action(stdout_linebuf_envvar) # Declare the launch options ld.add_action(declare_namespace_cmd) ld.add_action(declare_use_namespace_cmd) ld.add_action(declare_map_yaml_cmd) ld.add_action(declare_use_sim_time_cmd) ld.add_action(declare_slam_cmd) ld.add_action(declare_params_file_cmd) ld.add_action(declare_autostart_cmd) ld.add_action(declare_bt_xml_cmd) ld.add_action(declare_open_rviz_cmd) # Add the actions to launch all of the navigation nodes ld.add_action(bringup_cmd_group) return ld Launch fileì˜ ì‹¤í–‰ ì‹œ GroupActionì„ í†µí•´ ê´€ë ¨ëœ ì‹¤í–‰ í”„ë¡œê·¸ë¨ë“¤ì„ í•œë° ë¬¶ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ëŠ” ì´ìœ ëŠ”, ì—¬ëŸ¬ ë¡œë´‡ì˜ ì‹¤í–‰ì„ ëŒ€ë¹„í•œ ê²ƒì…ë‹ˆë‹¤. IncludeLaunchDescriptionì„ í†µí•´ 4ê°œì˜ launch fileë“¤ì„ ë‹¤ì‹œ ì¶”ê°€í•˜ê³  ìˆìŠµë‹ˆë‹¤. # Specify the actions bringup_cmd_group = GroupAction([ PushRosNamespace( condition=IfCondition(use_namespace), namespace=namespace), IncludeLaunchDescription( PythonLaunchDescriptionSource(os.path.join(my_launch_dir, \u0026#39;slam_launch.py\u0026#39;)), ... IncludeLaunchDescription( # Run Localization only when we don\u0026#39;t use SLAM PythonLaunchDescriptionSource(os.path.join(my_launch_dir, \u0026#39;localization_launch.py\u0026#39;)), ... IncludeLaunchDescription( PythonLaunchDescriptionSource(os.path.join(my_launch_dir, \u0026#39;navigation_launch.py\u0026#39;)), ... IncludeLaunchDescription( PythonLaunchDescriptionSource(os.path.join(my_launch_dir, \u0026#39;rviz_view_foxy_launch.py\u0026#39;)), ... ]) ê°ê°ì˜ í•˜ìœ„ launch fileì€ ê°œë³„ ì‹¤í–‰ë  ìˆ˜ ìˆë„ë¡ êµ¬ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. nav2_lifecycle_managerê°€ ìœ„ì¹˜í•˜ê³  ìˆëŠ” ì ë„ í™•ì¸ ê°€ëŠ¥í•˜ê³  nodeë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ë²•ë„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Node( package=\u0026#39;nav2_lifecycle_manager\u0026#39;, executable=\u0026#39;lifecycle_manager\u0026#39;, name=\u0026#39;lifecycle_manager_localization\u0026#39;, output=\u0026#39;screen\u0026#39;, parameters=[{\u0026#39;use_sim_time\u0026#39;: use_sim_time}, {\u0026#39;autostart\u0026#39;: autostart}, {\u0026#39;node_names\u0026#39;: lifecycle_nodes}]) ... lifecycle_nodes = [nav2, related, nodes] Nav2ì˜ ìµœì í™”ë¥¼ ìœ„í•´ì„œëŠ” ìˆ˜ë§ì€ ë§¤ê°œë³€ìˆ˜ë“¤ê³¼ ì”¨ë¦„í•´ì•¼ í•©ë‹ˆë‹¤. yaml íŒŒì¼ì„ í†µí•´ ê´€ë¦¬ë˜ë©° ì§€ê¸ˆê¹Œì§€ ì‚´í´ë³¸ ë‚´ìš©ë“¤ì´ ëª¨ë‘ ë…¹ì•„ë“¤ì–´ ìˆìŠµë‹ˆë‹¤. amcl: ros__parameters: bt_navigator: ros__parameters: controller_server: ros__parameters: controller_server_rclcpp_node: ros__parameters: use_sim_time: False local_costmap: local_costmap: global_costmap: global_costmap: map_server: ros__parameters: use_sim_time: False yaml_filename: \u0026#34;turtlebot3_world.yaml\u0026#34; map_saver: ros__parameters: planner_server: ros__parameters: planner_server_rclcpp_node: ros__parameters: use_sim_time: False recoveries_server: ros__parameters: robot_state_publisher: ros__parameters: use_sim_time: False ììœ¨ ì£¼í–‰ ì‹œ ë°œìƒí•˜ëŠ” ìƒí™©ë“¤ì— ëŒ€ì²˜í•˜ê¸° ìœ„í•´ ê¸°ë³¸ì ìœ¼ë¡œ Behavior Tree ì˜ˆì‹œë¥¼ ì œê³µí•©ë‹ˆë‹¤. êµ¬ì²´ì ì¸ ë‚´ìš©ë³´ë‹¤ Nodeë¥¼ ì‘ì„±í•˜ê³  ì‹œë‚˜ë¦¬ì˜¤ë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì— ì§‘ì¤‘í•©ì‹œë‹¤.\n"
},
{
	"uri": "/kr/ros2_basic_foxy/lecture8/",
	"title": "Lecture8 - ROS 2 Action and Examples",
	"tags": [],
	"description": "",
	"content": " ì§€ê¸ˆê¹Œì§€ Topic, Serviceì— ëŒ€í•´ ëª¨ë‘ ë°°ì›Œë³´ì•˜ìŠµë‹ˆë‹¤. ë§ˆì§€ë§‰ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì¸ Actionì— ëŒ€í•´ì„œ ë°°ì›Œë´…ì‹œë‹¤.\nROS2 Action ê°œë… Actionì€ Serviceì™€ Topicì˜ íŠ¹ì„±ì„ ëª¨ë‘ ê°–ê³  ìˆìœ¼ë©°, ì‹¤ì œë¡œ ê°€ì¥ ëŠ¦ê²Œ íƒ„ìƒí•œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. ì¼ì „ Serviceì˜ ë‹¨ì ì„ ìƒê¸°ì‹œì¼œë³´ë©´ì„œ Actionì˜ í•„ìš”ì„±ì— ëŒ€í•´ ì²´ê°í•´ë´…ì‹œë‹¤.\nServiceì˜ ì¤‘ìš”í•œ íŠ¹ì§• í•œ ê°€ì§€ ì¶”ê°€í•˜ìë©´, í•˜ë‚˜ì˜ Service Serverì— ì—¬ëŸ¬ Clientê°€ request í•  ìˆ˜ ìˆì§€ë§Œ, ServerëŠ” ë™ì‹œì— ì—¬ëŸ¬ requestë¥¼ ì²˜ë¦¬í•˜ì§€ ëª»í•©ë‹ˆë‹¤.\nimage from : docs.ros.org Actionì€ ë°”ë¡œ ì´ëŸ¬í•œ Serviceì˜ ë‹¨ì ì„ ê·¹ë³µí•˜ê¸° ìœ„í•´ íƒ„ìƒí•œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.\nActionì˜ íŠ¹ì§• action clientëŠ” action serverê°€ Resultë¥¼ ë³´ë‚´ê¸° ì „ê¹Œì§€ ë§ˆëƒ¥ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³ , ë‹¤ë¥¸ ì¼ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. action clientëŠ” Result Responseë¥¼ ë°›ê¸° ì „ì—ë„ ì§€ì†ì ìœ¼ë¡œ Feedbackì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, Feedbackì„ ë°›ê³  ìˆë‹¤ê°€, ë­”ê°€ ì˜ëª» ëŒì•„ê°€ê³  ìˆë‹¤ëŠ” ê²ƒì„ ê°ì§€í•œ ê²½ìš° cancelì„ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. â‡’ í•˜ì§€ë§Œ, ì—¬ëŸ¬ requestë¥¼ ë™ì‹œì— ì‘ì—…í•˜ëŠ” ê²ƒì´ë‚˜, Feedback ì¤‘ì— topic subscribeì™€ ê°™ì€ ì‘ì—…ì€ ë³¸ì§ˆì ìœ¼ë¡œ ë¶ˆê°€í•©ë‹ˆë‹¤. ì´ì— ëŒ€í•œ í•´ê²° ë°©ë²•ë„ í›„ì— ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nimage from : https://docs.ros.org/en/foxy/Tutorials/Understanding-ROS2-Actions.html\nì‚¬ì§„ê³¼ ê°™ì´ Action Clientì™€ Serverê°€ ì£¼ê³ ë°›ëŠ” ë‚´ìš©ì€ í¬ê²Œ 5ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.\nClient â‡’ Server, Goal Request (service requestì™€ ìœ ì‚¬í•©ë‹ˆë‹¤.) server â‡’ client, Goal Response client â‡’ server, Result Request server â‡’ client, Feedback (topicê³¼ ìœ ì‚¬í•©ë‹ˆë‹¤.) server â‡’ client, Result Response ë§Œì•½ 4ë²ˆ ë„ì¤‘ cancelì´ ë°œìƒí•˜ë©´ Actionì€ ì¢…ë£Œë©ë‹ˆë‹¤.\nì´ë ‡ê²Œ Actionì€ Topic, Serviceì˜ íŠ¹ì§•ì„ ëª¨ë‘ ê°–ê³  ìˆìœ¼ë©° Cancelì´ë¼ëŠ” ì¶”ê°€ ê¸°ëŠ¥ê¹Œì§€ ê°–ì¶”ê³  ìˆëŠ” ë³µì¡í•œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.\nAction ì»¤ë©˜ë“œ ë¼ì¸ íˆ´ turtlesimì„ ì‹¤í–‰ì‹œí‚¨ ë’¤, ì‹¤ìŠµì„ ì§„í–‰í•´ë´…ì‹œë‹¤. ros2 run turtlesim turtlesim_node ì‹¤í–‰ ì¤‘ì¸ actionì€ ë‹¤ìŒê³¼ ê°™ì´ ì¡°íšŒ ê°€ëŠ¥í•©ë‹ˆë‹¤. $ ros2 action list /turtle1/rotate_absolute íŠ¹ì • actionì˜ ì •ë³´ë¥¼ ì¡°íšŒí•˜ê¸° ìœ„í•´ ros2 action infoë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. $ ros2 action info /turtle1/rotate_absolute Action: /turtle1/rotate_absolute Action clients: 0 Action servers: 1 /turtlesim Actionì—ì„œ ì‚¬ìš©ë˜ëŠ” ë°ì´í„° íƒ€ì…ì€ actionì´ë©° ros2 interface showë¥¼ í†µí•´ ì¡°íšŒ ê°€ëŠ¥í•©ë‹ˆë‹¤. $ ros2 interface show turtlesim/action/RotateAbsolute # The desired heading in radians float32 theta --- # The angular displacement in radians to the starting position float32 delta --- # The remaining rotation in radians float32 remaining ì»¤ë©˜ë“œ ë¼ì¸ì—ì„œ ì†ì‰½ê²Œ Action Goalì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (feedback optionì„ ì œê³µí•©ë‹ˆë‹¤.) $ ros2 action send_goal \u0026lt;action_name\u0026gt; \u0026lt;action_type\u0026gt; \u0026lt;values\u0026gt; $ ros2 action send_goal /turtle1/rotate_absolute turtlesim/action/RotateAbsolute \u0026#34;{theta : 0.0}\u0026#34; --feedback 1657646954.088327 [0] ros2: using network interface enp7s0 (udp/166.104.135.89) selected arbitrarily from: enp7s0, docker0 Waiting for an action server to become available... Sending goal: theta: 0.0 Goal accepted with ID: d3ddca85948d4099a13dbeb8183e5ecc Result: delta: -0.7839995622634888 Goal finished with status: SUCCEEDED Action í”„ë¡œê·¸ë˜ë° Action Client ì‘ì„±í•˜ê¸° ì¼ì „ ê±°ë¶ì´ë¥¼ íšŒì „ì‹œí‚¤ëŠ” Action Serverì— ë§¤ì¹­ë˜ëŠ” Action Clientì…ë‹ˆë‹¤. ê±°ë¶ì´ê°€ ì›€ì§ì´ê¸° ì›í•˜ëŠ” ê°ë„ë¥¼ ì…ë ¥í•˜ë©´ í•´ë‹¹ ê°ë„ë¡ íšŒì „í•˜ê¸° ì‹œì‘í•©ë‹ˆë‹¤. $ colcon build --packages-select py_action_tutorial $ source install/local_setup.bash $ ros2 run py_action_tutorial turtle_turning_client [INFO] [1672647544.783857088] [turtle_rotate_client]: === Turtle Rotate Action Client Started ==== Enter Target Angle : 3.14 [INFO] [1672647549.097662572] [turtle_rotate_client]: Goal accepted [INFO] [1672647549.193173672] [turtle_rotate_client]: Received feedback: 0.051996707916259766 [WARN] [1672647549.226111271] [turtle_rotate_client]: Action Done !! Result: -0.12800025939941406 Action Clientë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ì„œëŠ” ActionClient íŒ¨í‚¤ì§€ë¥¼ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤. import rclpy from rclpy.action import ActionClient from rclpy.node import Node ìš°ë¦¬ê°€ ì‚¬ìš©í•  turtlesim/action/RotateAbsoluteë¼ëŠ” actionì€ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¥¼ ê°–ìŠµë‹ˆë‹¤. # The desired heading in radians float32 theta --- # The angular displacement in radians to the starting position float32 delta --- # The remaining rotation in radians float32 remaining Action ClientëŠ” ActionClient ì¸ìŠ¤í„´ìŠ¤ì…ë‹ˆë‹¤. Service Clientì™€ ë§¤ìš° ë¹„ìŠ·í•˜ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. # Create Action Client self.action_client = ActionClient(self, RotateAbsolute, \u0026#39;turtle1/rotate_absolute\u0026#39;) action type : Clientê°€ ì‚¬ìš©í•  action ë°ì´í„° íƒ€ì… action name : Action Server ì´ë¦„ wait_for_serverë¥¼ í†µí•´ Action Serverì˜ ì¡´ì¬ ì—¬ë¶€ë¥¼ ìš°ì„  í™•ì¸í•©ë‹ˆë‹¤. # Wait for server first if self.action_client.wait_for_server(10) is False: self.get_logger().error(\u0026#39;Server Not exists\u0026#39;) Action ClientëŠ” callbackì´ ë§ì•„ ê° í•¨ìˆ˜ì— ëŒ€í•œ ì‹¤í–‰ ì‹œì ì„ ì˜ ì•Œì•„ë‘ì…”ì•¼ í•©ë‹ˆë‹¤. # Send Goal then receive future self._send_goal_future = self.action_client.send_goal_async( goal_msg, feedback_callback=self.feedback_callback ) # Done callback Add self._send_goal_future.add_done_callback(self.goal_response_callback) send_goal : main í•¨ìˆ˜ì—ì„œ í˜¸ì¶œë˜ë©°, Goal requestë¥¼ ì§„í–‰í•©ë‹ˆë‹¤. feedback_callback : Serverë¡œë¶€í„°ì˜ Feedbackì´ ë“¤ì–´ì˜¬ ë•Œë§ˆë‹¤ ì‹¤í–‰ë˜ëŠ” Callback ì…ë‹ˆë‹¤. goal_response_callback : Goal Accpetì™€ Reject ì—¬ë¶€ë¥¼ í™•ì¸í•©ë‹ˆë‹¤. get_result_callback : ìµœì¢… resultì— ëŒ€í•œ Callbackìœ¼ë¡œ, Actionì˜ ì œì¼ ë§ˆì§€ë§‰ì— ì‹¤í–‰ë©ë‹ˆë‹¤. Actionì€ ë©”ì»¤ë‹ˆì¦˜ ìì²´ê°€ ì–´ë µê¸° ë•Œë¬¸ì— ì¼ë¶€ëŸ¬ ì‰¬ìš´ ì˜ˆì œë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤. ì½”ë“œì˜ ë¡œì§ì€ ê°„ë‹¨í•˜ë©°, Action Client API ìì²´ì— ì§‘ì¤‘í•˜ë©° ë”°ë¼ì™€ì£¼ì„¸ìš”.\ngoal_response_callback : goalì€ ê·¸ ìì²´ë¡œ Serviceë¼ê³  ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, goal ì™„ë£Œê¹Œì§€ ëŒ€ê¸°í•œ ë’¤ get_result_callbackì„ ì—°ë™í•©ë‹ˆë‹¤. def goal_response_callback(self, future): goal_handle = future.result() if not goal_handle.accepted: self.get_logger().info(\u0026#39;Goal rejected\u0026#39;) return self.get_logger().info(\u0026#39;Goal accepted\u0026#39;) # Add Result cb self._get_result_future = goal_handle.get_result_async() self._get_result_future.add_done_callback(self.get_result_callback) feedback_callbackì€ subscriberì˜ callbackê³¼ ìœ ì‚¬í•˜ê²Œ ë§¤ê°œë³€ìˆ˜ë¡œ feedback ë°ì´í„°ë¥¼ ë°›ìŠµë‹ˆë‹¤. get_result_callbackì€ goal_response_callbackê³¼ ìœ ì‚¬í•˜ê²Œ, futureë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë”ì´ìƒ ì¶”ê°€í•  callbackì€ ì—†ê³  resultë¥¼ ë°›ìœ¼ë©´ì„œ ë§ˆë¬´ë¦¬ë©ë‹ˆë‹¤. def feedback_callback(self, feedback_msg): feedback = feedback_msg.feedback self.get_logger().info(f\u0026#39;Received feedback: {feedback.partial_sequence}\u0026#39;) def get_result_callback(self, future): result = future.result().result self.get_logger().warn(f\u0026#39;Action Done !! Result: {result.sequence}\u0026#39;) rclpy.shutdown() ì´ë²ˆ ì˜ˆì‹œì— êµ¬í˜„ë˜ì–´ ìˆì§€ëŠ” ì•Šì§€ë§Œ, goal_handleë¡œë¶€í„° cancel handlerë¥¼ ìƒì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ì½”ë“œë¥¼ ì˜ˆì‹œì— ì ìš©í•œ ë‹¤ìŒ, cancelë„ ì‹¤ìŠµí•´ë³´ì„¸ìš”. # Cancel the goal future = self.goal_handle.cancel_goal_async() future.add_done_callback(self.cancel_done) # Cancel the timer self.timer.cancel() def cancel_done(self, future): cancel_response = future.result() if len(cancel_response.goals_canceling) \u0026gt; 0: self.get_logger().info(\u0026#39;Goal successfully canceled\u0026#39;) else: self.get_logger().info(\u0026#39;Goal failed to cancel\u0026#39;) rclpy.shutdown() Action Server Example - Parking Master image from : ê¸°í˜¸ì¼ë³´\nì´ë²ˆì—ëŠ” ì¬ë¯¸ìˆëŠ” ì˜ˆì‹œë¥¼ ì¤€ë¹„í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. ì•„ë˜ ëª…ë ¹ì–´ì„ ì…ë ¥í•´ ì£¼ì„¸ìš” cbp custom_interfaces cbp parking_action_server source install/local_setup.bash # Terminal 1 ros2 launch src_gazebo wall_world.launch.py # Terminal 2 ros2 run py_action_tutorial parking_action_server [INFO] [1672654091.689062703] [parking_action_server]: Action Ready... [INFO] [1672654101.355609636] [parking_action_server]: Executing goal... [INFO] [1672654101.356973636] [parking_action_server]: Distance from forward obstacle : 100.0 ... # Terminal 3 ros2 action send_goal /src_parking custom_interfaces/action/Parking \u0026#34;start_flag: true\u0026#34; --feedback Waiting for an action server to become available... Sending goal: start_flag: true Goal accepted with ID: d7bcfec5a6e94bd4a349f4955cc495c8 Feedback: distance: 100.0 Feedback: distance: 1.7898634672164917 ... ë²½ì— ì¸ì ‘í•˜ì—¬ í°ìƒ‰ ìƒìë“¤ì´ ì£¼ì°¨ ê³µê°„ì„ ë°°ì •í•´ì¤„ ê²ƒì…ë‹ˆë‹¤. rqt_robot_steeringìœ¼ë¡œ ë¡œë´‡ì„ ì˜ ì œì–´í•˜ì—¬ ì£¼ì–´ì§„ ì£¼ì°¨ ê³µê°„ì— ì•Œë§ê²Œ ì£¼ì°¨ë¥¼ í•´ë³´ì„¸ìš”!\nFeedbackì„ í†µí•´ ë²½ê³¼ì˜ ê±°ë¦¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, ì´ ê±°ë¦¬ê°€ 0.5m ì´ë‚´ê°€ ë˜ë©´ ì£¼ì°¨ê°€ ì™„ë£Œë©ë‹ˆë‹¤. ì´ ì‹œì ì—ì„œ ì¢Œìš° ê³µê°„ì´ ì–¼ë§ˆê°€ ê· í˜•ì´ ë§ëŠ”ì§€ì— ë”°ë¼ ë‹¤ë¥¸ Resultë¥¼ ì–»ê²Œ ë©ë‹ˆë‹¤.\nì˜¬ë°”ë¥¸ ì£¼ì°¨ ì‹œ â‡’ Success! ì˜ëª»ëœ ì£¼ì°¨ ì‹œ â‡’ Fail Action Server í”„ë¡œê·¸ë˜ë° í”„ë¡œê·¸ë˜ë°ì„ ì‹œì‘í•˜ê¸° ì „, í•„ìš”í•œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ë“¤ì„ ì‚´í´ë´…ì‹œë‹¤.\nAction Server : Goalì„ ë°›ìœ¼ë©´, ì •ë©´ ë²½ê³¼ì˜ ê±°ë¦¬ë¥¼ feedbackìœ¼ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤. ìµœì¢… ResultëŠ” Stringìœ¼ë¡œ ì„±ê³µ ì—¬ë¶€ë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤. LaserScan Sub : ì£¼ë³€ ë¬¼ì²´ì™€ì˜ ìŠ¤ìº”ëœ ê±°ë¦¬ë¥¼ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Feedback Callbackê³¼ Subscription Callback ë‘ í•¨ìˆ˜ë„ êµ¬í˜„í•´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤.\nì´ë²ˆ ì˜ˆì‹œë¥¼ ìœ„í•´ custom interfaceë¥¼ ë§Œë“¤ì–´ ë³´ì•˜ìŠµë‹ˆë‹¤. Action ë°ì´í„° íƒ€ì…ì€ ì„¸ ì¢…ë¥˜ì˜ ë°ì´í„°ë¡œ ì´ë£¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤. #goal definition bool start_flag --- #result definition string message --- #feedback definition float32 distance ì´ì œ ì½”ë“œë¥¼ ì‚´í´ë´…ì‹œë‹¤. Action Serverë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ActionServer íŒ¨í‚¤ì§€ë¥¼ import í•´ì•¼ í•©ë‹ˆë‹¤. import rclpy from rclpy.node import Node from rclpy.action import ActionServer ì½”ë“œ ë¶„ì„ ì „ ì‚´í´ë³¸ ë°”ì™€ ê°™ì´ ë‘ ì¢…ë¥˜ì˜ í•¸ë“¤ëŸ¬ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. class ParkingActionServer(Node): def __init__(self): super().__init__(\u0026#39;parking_action_server\u0026#39;) self.laser_sub = self.create_subscription( LaserScan, \u0026#39;scan\u0026#39;, self.sub_callback, 10 ) self.action_server = ActionServer( self, Parking, \u0026#39;src_parking\u0026#39;, self.execute_callback ) Action Serverì˜ Callbackì…ë‹ˆë‹¤. ì²« ì¸ìëŠ” goal handlerë¡œ feedback ì „ì†¡ì´ ì´ë¥¼ í†µí•´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. feedback msgì—ëŠ” ì •ë©´ ë¬¼ì²´ì™€ì˜ ê±°ë¦¬ê°€ ë‹´ê¹ë‹ˆë‹¤. def execute_callback(self, goal_handle): self.is_sub = True self.get_logger().info(\u0026#39;Executing goal...\u0026#39;) feedback_msg = Parking.Feedback() while self.f_obs_distance \u0026gt; 0.5: feedback_msg.distance = self.f_obs_distance goal_handle.publish_feedback(feedback_msg) self.get_logger().info( f\u0026#34;Distance from forward obstacle : {self.f_obs_distance}\u0026#34; ) time.sleep(1) while loopë¥¼ ë²—ì–´ë‚˜ê²Œ ë˜ë©´ goal succedë¥¼ ìˆ˜í–‰í•˜ê³ , Resultë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤. í˜„ì¬ì˜ ë¡œì§ì€ ì¢Œìš° ë¬¼ì²´ì™€ì˜ ê±°ë¦¬ê°€ ê· ì¼í•  ë•Œ ì„±ê³µìœ¼ë¡œ íŒì •ì§“ìŠµë‹ˆë‹¤. goal_handle.succeed() result = Parking.Result() lr_diff = abs(self.r_obs_distance - self.l_obs_distance) print(lr_diff) if lr_diff \u0026lt; 0.15: result.message = \u0026#34;[Success!] Oh... Teach me how you did :0\u0026#34; else: result.message = \u0026#34;[Fail] Be careful, Poor Driver! \u0026#34; return result mainë¬¸ì—ì„œ íŠ¹ë³„í•œ ì ì„ ì°¾ì•„ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. MultiThreadedExecutorë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ë°ìš”. ì´ê²ƒì´ í•˜ëŠ” ì—­í• ì´ ë¬´ì—‡ì¼ì§€ ì‹¤ìŠµì„ í†µí•´ ì‚´í´ë´…ì‹œë‹¤. try: parking_action_server = ParkingActionServer() # MultiThreadedExecutor ref # https://url.kr/x4kf2b executor = MultiThreadedExecutor() executor.add_node(parking_action_server) try: executor.spin() except KeyboardInterrupt: parking_action_server.get_logger().info(\u0026#39;Keyboard Interrupt (SIGINT)\u0026#39;) finally: executor.shutdown() parking_action_server.destroy_node() finally: rclpy.shutdown() main ë¬¸ì˜ ì£¼ì„ì„ í† ê¸€í•˜ê³ , sub_callbackì— ë””ë²„ê¹… ë©”ì„¸ì§€ë¥¼ ì‹¬ì€ ë‹¤ìŒ, ë‹¤ì‹œ ì˜ˆì œë¥¼ ì‹¤í–‰ ì‹œì¼œë´…ë‹ˆë‹¤. ì–´ë– í•œ ê²°ê³¼ë¥¼ ì–»ìœ¼ì…¨ë‚˜ìš”? def sub_callback(self, data): if self.is_sub: self.f_obs_distance = data.ranges[60] self.r_obs_distance = data.ranges[30] self.l_obs_distance = data.ranges[90] self.get_logger().info(\u0026#34;sub success\u0026#34;) ... # parking_action_server = ParkingActionServer() # rclpy.spin(parking_action_server) # parking_action_server.destroy_node() # rclpy.shutdown() í˜„ì¬ì˜ ì‹œìŠ¤í…œì€ ë‘ ì¢…ë¥˜ì˜ callbackì„ ê°–ê³  ìˆìŠµë‹ˆë‹¤. execute_callbackì´ ì‹¤í–‰ë˜ë©´ì„œ while loopë¡œ ì§„ì…í•˜ë©´, ìì›ì„ ì ìœ í•˜ì—¬ sub_callbackì´ ë™ì‘í•  ìˆ˜ ì—†ëŠ” êµ¬ì¡°ê°€ ë©ë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ROS 2ì—ì„œëŠ” rclpyë‹¨ì—ì„œ ë©€í‹° ìŠ¤ë ˆë”©ì„ êµ¬í˜„í•´ ë‘ì—ˆìŠµë‹ˆë‹¤.\nimage from : docs.ros.org ì´í›„ ì—¬ëŸ¬ê°€ì§€ êµ¬í˜„ì„ í•˜ë‹¤ ë³´ë©´ ì§€ê¸ˆì²˜ëŸ¼ ë‹¤ì¤‘ Subscribeë¥¼ í•´ì•¼í•˜ëŠ” ê²½ìš°ê°€ ë°˜ë“œì‹œ ìƒê¹ë‹ˆë‹¤. í˜¹ì€ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì—¬ëŸ¬ê°œì˜ Nodeë¥¼ ì‹¤í–‰ì‹œì¼œì•¼ í•˜ëŠ” ê²½ìš°ê°€ ë°œìƒí•©ë‹ˆë‹¤. ì´ë•Œ, Node Compositionê³¼ MultiThreadedExecutorë¥¼ ì ê·¹ ì‚¬ìš©í•´ë³´ì„¸ìš”!\nì°¸ê³ ìë£Œ\nhttps://docs.ros.org/en/foxy/Concepts/About-Executors.html "
},
{
	"uri": "/kr/ros2_basic_foxy/lecture9/",
	"title": "Lecture9 - C++ Programming Again, Outro",
	"tags": [],
	"description": "",
	"content": "C++ Programming Again ì‹¤ì§ˆì ìœ¼ë¡œ C++ì„ í†µí•´ ROS 2 ê°œë°œì´ ë§ì´ ì´ë£¨ì–´ì§„ë‹¤ ì´ì•¼ê¸°í•˜ì˜€ìŠµë‹ˆë‹¤. Topic Publishì™€ Subscriberì˜ C++ì½”ë“œë“¤ë„ turtlesim ì˜ˆì œì™€ í•¨ê¼ ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤.\nTopic Publish ì˜ˆì œ - Random Movement Turtle ì˜ˆì œ ì‹¤í–‰ cbp cpp_topic_tutorial source install/local_setup.bash # Terminal 1 ros2 run turtlesim turtlesim_node # Terminal 2 ros2 run cpp_topic_tutorial topic_pub_node â‡’ ê±°ë¶ì´ê°€ ë§ˆêµ¬ì¡ì´ë¡œ ì›€ì§ì´ê¸° ì‹œì‘í•  ê²ƒì…ë‹ˆë‹¤\në¡œë´‡ì„ ì›€ì§ì´ê¸° ìœ„í•´ì„œëŠ” geometry_msgs/msg/Twist í˜•ì‹ì˜ topic message typeì„ ì‚¬ìš©í•´ì•¼ í•¨ì„ ë°°ìš´ ë°” ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ì„œ ë‹¤ìŒê³¼ ê°™ì´, í—¤ë”ë¥¼ include í•˜ë©´ ë©ë‹ˆë‹¤. #include \u0026#34;geometry_msgs/msg/twist.hpp\u0026#34; #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; ë‹¨, íŒŒì´ì¬ê³¼ ë‹¬ë¦¬ c++ í—¤ë”ëŠ” snake_caseë¥¼ ì·¨í•˜ë©°, ì½”ë“œ ì‚¬ìš© ì‹œ CamelCaseë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\nrclcpp::Publisher\u0026lt;geometry_msgs::msg::Twist\u0026gt;::SharedPtr twist_publisher; ... twist_publisher = this-\u0026gt;create_publisher\u0026lt;geometry_msgs::msg::Twist\u0026gt;(\u0026#34;turtle1/cmd_vel\u0026#34;, 10); publisherëŠ” create_publisher í•¨ìˆ˜ë¥¼ í†µí•´ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\u0026lt;\u0026gt; ì•ˆì—ëŠ” message typeì„ ì ì–´ì£¼ê³  ì²« ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ëŠ” ìƒì„±í•  topicì˜ ì´ë¦„ ë‘ ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ë¡œ queue sizeë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤. geometry_msgs::msg::Twistì™€ ê°™ì´ íƒ€ì…ì´ ê¸¸ê¸° ë•Œë¬¸ì— usingì„ ì‚¬ìš©í•˜ì—¬ ì¶•ì•½í•˜ê³¤ í•©ë‹ˆë‹¤.\nTopic Subscribe ì˜ˆì œ - Turtle Pose Sub turtlesim ìƒì˜ ê±°ë¶ì´ì˜ ìœ„ì¹˜ë¥¼ Subscribe ë°›ìŠµë‹ˆë‹¤. # Terminal 1 ros2 run turtlesim turtlesim_node # Terminal 2 ros2 run cpp_topic_tutorial topic_sub_node [INFO] [1666434438.709117200] [turtlepose_sub_node]: x: 5.544/ y: 5.544/ theta: 0.000/ lin_vel: 0.000, ang_vel: 0.000 [INFO] [1666434438.725522800] [turtlepose_sub_node]: x: 5.544/ y: 5.544/ theta: 0.000/ lin_vel: 0.000, ang_vel: 0.000 [INFO] [1666434438.741218300] [turtlepose_sub_node]: x: 5.544/ y: 5.544/ theta: 0.000/ lin_vel: 0.000, ang_vel: 0.000 ... ë¡œì§ ìì²´ëŠ” ì–´ë µì§€ ì•Šê¸°ì— APIì— ì§‘ì¤‘í•˜ì—¬ ë¶„ì„í•´ë³´ê² ìŠµë‹ˆë‹¤. TwistPubNode() : Node(\u0026#34;twist_pub_node\u0026#34;) { twist_publisher = this-\u0026gt;create_publisher\u0026lt;geometry_msgs::msg::Twist\u0026gt;(\u0026#34;turtle1/cmd_vel\u0026#34;, 10); timer = this-\u0026gt;create_wall_timer( std::chrono::milliseconds(500), std::bind(\u0026amp;TwistPubNode::timer_callback, this) ); } subscriberëŠ” create_subscription í•¨ìˆ˜ë¥¼ í†µí•´ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\u0026lt;\u0026gt; ì•ˆì—ëŠ” message typeì„ ì ì–´ì£¼ê³  ì²« ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ëŠ” subscribe topicì˜ ì´ë¦„ ë‘ ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ë¡œ queue size ì„¸ ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ë¡œëŠ” std::bindë¥¼ í†µí•´ callback í•¨ìˆ˜ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤. callbackì˜ ë§¤ê°œë³€ìˆ˜ê°€ 1ê°œì´ê¸°ì— ì´ë¥¼ ì•Œë ¤ì•¼ í•˜ë©°, std::placeholders::_1ì´ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.\nsub_callbackì˜ ì²«ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ì¸ ë°ì´í„°ëŠ” SharedPtr íƒ€ì…ì´ ì‚¬ìš©ëœë‹¤ëŠ” ê²ƒì— ì£¼ì˜í•˜ë©°, ë•Œë¬¸ì— ë ˆí¼ëŸ°ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\nService Clientì™€ Serverì˜ C++ì½”ë“œë“¤ë„ ë¶„ì„í•´ë´…ì‹œë‹¤.\nService Client ì˜ˆì œ - Turtle Spawn Turtle Spawn ì˜ˆì œ - ì˜ìƒê³¼ ê°™ì´ ìš°ë¦¬ê°€ ë‚´ë¦° ëª…ë ¹ëŒ€ë¡œ ê±°ë¶ì´ê°€ ë“±ì¥í•œ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. cbp cpp_service_tutorial source install/local_setup.bash # Terminal 1 ros2 run turtlesim turtlesim_node # Terminal 2 ros2 run cpp_service_tutorial turtle_spawn_client \u0026gt; Turtle X position : 5.0 \u0026gt; Turtle Y position : 5.0 \u0026gt; Turtle Angle : 0.0 \u0026gt; Turtle Name : my_turtle [INFO] [1666434554.012857700] [spawn_turtle_node]: Turtle Named : my_turtle Spawned Successfully. create_clientëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì •ë³´ë¥¼ ìš”í•©ë‹ˆë‹¤.\nì‚¬ìš©í•˜ëŠ” srv íƒ€ì… requestí•  service ì´ë¦„ wait_for_serviceë¥¼ í†µí•´ Service Serverì˜ ì¡´ì¬ ì—¬ë¶€ë¥¼ ì²´í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n... public: SpawnTurtle() : Node(\u0026#34;spawn_turtle_node\u0026#34;){ spawn_client = this-\u0026gt;create_client\u0026lt;Spawn\u0026gt;(\u0026#34;spawn\u0026#34;); while (!spawn_client-\u0026gt;wait_for_service(1s)) { if (!rclcpp::ok()) { RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Interrupted while waiting for the service. Exiting.\u0026#34;); exit(0); } RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;service not available, waiting again...\u0026#34;); } } send_requestë¥¼ í˜¸ì¶œí•¨ìœ¼ë¡œ Service callì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ë•Œ, send_requestì˜ ë°˜í™˜ê°’ì„ ì‚´í´ë³´ë©´, ë¹„ë™ê¸° ì‹¤í–‰ì„ í•˜ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. auto send_request(){ get_user_input(\u0026#34;\u0026gt; Turtle X position : \u0026#34;, spawn_request-\u0026gt;x); get_user_input(\u0026#34;\u0026gt; Turtle Y position : \u0026#34;, spawn_request-\u0026gt;y); get_user_input(\u0026#34;\u0026gt; Turtle Angle : \u0026#34;, spawn_request-\u0026gt;theta); get_user_input(\u0026#34;\u0026gt; Turtle Name : \u0026#34;, spawn_request-\u0026gt;name); return spawn_client-\u0026gt;async_send_request(spawn_request); } spin_until_future_completeëŠ” async_send_requestì˜ ë¹„ë™ê¸° promiseë¥¼ ë°›ì•„ ì‹¤í–‰ ì™„ë£Œê¹Œì§€ ëŒ€ê¸°í•˜ê²Œ ë©ë‹ˆë‹¤. int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;SpawnTurtle\u0026gt;(); auto result = node-\u0026gt;send_request(); // Wait for the result. if (rclcpp::spin_until_future_complete(node, result) == rclcpp::FutureReturnCode::SUCCESS) { RCLCPP_INFO(node-\u0026gt;get_logger(), \u0026#34;Turtle Named : %s Spawned Successfully.\u0026#34;, result.get()-\u0026gt;name.c_str()); } else { RCLCPP_ERROR(node-\u0026gt;get_logger(), \u0026#34;Failed to call service add_two_ints\u0026#34;); } rclcpp::shutdown(); return 0; } promiseì˜ ë°˜í™˜ ì™„ë£Œê°’ì€ enumerator typeì„ ê°–ê³  ìˆìœ¼ë©°, ê³µì‹ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì˜€ìŠµë‹ˆë‹¤. image from : docs.ros2.org\nService Server ì˜ˆì œ - Turtle Turn ê±°ë¶ì´ê°€ ì›ì„ ê·¸ë¦¬ë©° ëŒê¸° ì‹œì‘í•˜ë‹¤ê°€, ì¼ì • ì‹œê°„ì´ ì§€ë‚˜ë©´ ì›€ì§ì„ì„ ë©ˆì¶”ê²Œ ë©ë‹ˆë‹¤. rqtì˜ Service Callerë¥¼ ì‚¬ìš©í•˜ë©°, turtle_turn serviceë¥¼ ì‚¬ìš©í•˜ì‹œë©´ ë©ë‹ˆë‹¤. # Terminal 1 ros2 run turtlesim turtlesim_node # Terminal 2 ros2 run cpp_service_tutorial turtle_circle_server # Terminal 3 [INFO] [1666435009.330619900] [turtle_circle_server]: Turtle Turning Server Started, Waiting for Request... [INFO] [1666435026.497839300] [turtle_circle_server]: 0.00 Seconds Passed [INFO] [1666435026.498143700] [turtle_circle_server]: 0.00 Seconds Passed [INFO] [1666435026.498297800] [turtle_circle_server]: 0.00 Seconds Passed [INFO] [1666435026.498427400] [turtle_circle_server]: 0.00 Seconds Passed ... ì „ì²´ ì½”ë“œ ì¤‘ Service Serverë¥¼ ìƒì„±í•˜ëŠ” í•µì‹¬ì„ ìœ„ì£¼ë¡œ ì‚´í´ë´…ì‹œë‹¤. class TurtleCircleNode : public rclcpp::Node { private: rclcpp::Service\u0026lt;SetBool\u0026gt;::SharedPtr bool_server; void turtle_circle(){ ... } ... } void server_callback(const std::shared_ptr\u0026lt;SetBool::Request\u0026gt; request, const std::shared_ptr\u0026lt;SetBool::Response\u0026gt; response){ if (request-\u0026gt;data) { turtle_circle(); } response-\u0026gt;success = true; response-\u0026gt;message = \u0026#34;Turtle successfully drawed Circle\u0026#34;; } public: TurtleCircleNode() : Node(\u0026#34;turtle_circle_server\u0026#34;){ bool_server = this-\u0026gt;create_service\u0026lt;SetBool\u0026gt;( \u0026#34;turtle_circle\u0026#34;, std::bind(\u0026amp;TurtleCircleNode::server_callback, this, std::placeholders::_1, std::placeholders::_2) create_serviceëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì •ë³´ë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤.\nì‚¬ìš©í•˜ëŠ” srv íƒ€ì… - SetBool ìƒì„±í•  service ì´ë¦„ - turtle_circle request ì‹œ ì‹¤í–‰ë  callback - server_callback service callbackì€ requestì™€ response ë‘ ë°ì´í„°ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ìŠµë‹ˆë‹¤. ë•Œë¬¸ì—, std::placeholders::_1, _2ê°€ ëª…ì‹œëœ ê²ƒì´ ë³´ì…ë‹ˆë‹¤. ë”ë¶ˆì–´, ê±°ë¶ì´ë¥¼ ì›€ì§ì´ê¸° ìœ„í•´ Publisherë„ í•˜ë‚˜ ìƒì„±í•˜ì˜€ìŠµë‹ˆë‹¤.\nì´ë ‡ê²Œ C++ ì½”ë“œê¹Œì§€ ì‚´í´ë³´ì•˜ëŠ”ë°ìš”, Actionì˜ C++ ì½”ë“œëŠ” ì´ë²ˆ ê°•ì˜ì—ì„œëŠ” ë„˜ì–´ê°€ë„ë¡ í•˜ê² ìœ¼ë©°, ë§í¬ë¥¼ ë‚¨ê²¨ë‘ê² ìŠµë‹ˆë‹¤.\nhttps://docs.ros.org/en/foxy/Tutorials/Intermediate/Writing-an-Action-Server-Client/Cpp.html\nAbout Real Robot ì§€ê¸ˆê¹Œì§€ ìš°ë¦¬ì˜ ì‹¤ìŠµì„ ì±…ì„ì¡Œë˜ src ë¡œë´‡ì´ ì–´ë–»ê²Œ ë§Œë“¤ì–´ì¡ŒëŠ”ì§€ ì‚´í´ë³´ë©´ì„œ, ì‹¤ì œ ë¡œë´‡ ì œí’ˆì˜ ê°œë°œ ê³¼ì •ì„ ì‚´í´ë´…ì‹œë‹¤.\ní•­ìƒ ë¡œë´‡ ì‹œìŠ¤í…œì„ ì œì‘í•˜ê¸° ì „, ì €ëŠ” ë¶€í’ˆì˜ ìˆ˜ê¸‰ë¶€í„° ê³„íší•©ë‹ˆë‹¤.\në©”ì¸ PC - ë¼ì¦ˆë² ë¦¬íŒŒì´, ì ¯ìŠ¨ ë‚˜ë…¸, ë¼ë–¼íŒë‹¤, ì˜¤ë“œë¡œì´ë“œ, Mini PC, etcâ€¦ MCU ë³´ë“œ - ì•„ë‘ì´ë…¸, ESP ì‹œë¦¬ì¦ˆ, Teensy, Node MCU etcâ€¦ Actuator - ì„œë³´/ìŠ¤í… ëª¨í„°, BLDC ëª¨í„°, (ì—”ì½”ë” ì¥ì°© ì—¬ë¶€, ì „ì•• ê³ ë ¤) â€¦ Sensor - Lidar, Camera (Monocular, Stereo, RGB-D, 360ë„ ì¹´ë©”ë¼â€¦), Lidar, Range Sensor, etcâ€¦ ì™¸ê´€ - ì•Œë£¨ë¯¸ëŠ„, 3D í”„ë¦°íŒ…, ì ˆê³¡, ì¹´ë³¸ í”Œë ˆì´íŠ¸, CNC ê°€ê³µâ€¦ ì´ëŸ¬í•œ ì´ìœ ë¡œ ë¡œë´‡ ì œì‘ì—ëŠ” ì¼ì • ë¹„ìš©ê³¼ ê²½í—˜ì´ ìš”êµ¬ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ ëª¨ë‘ í”¼ì™€ ì‚´ì´ ë˜ë‹ˆ ì•„ë‚Œì—†ì´ íˆ¬ìí•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.\nimage from : ë¡œë´‡ ì‹ ë¬¸ ë¡œë´‡ ê°œë°œì˜ ì´ˆê¸°ë¶€í„° ë„ˆë¬´ ëª¨ë“  ê²ƒì„ ê³ ë ¤í•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤. ì‘ì€ ì‚¬ì´ì¦ˆì˜ í…ŒìŠ¤íŠ¸ ë² ë“œë¥¼ êµ¬ì¶•í•˜ì—¬ ê¸°ëŠ¥ê³¼ ê²½í—˜ì„ ì¶©ë¶„íˆ ìŒ“ì€ ë’¤, ì ì°¨ í•˜ë“œì›¨ì–´ë¥¼ ê°œì„ í•´ ë‚˜ê°€ë©´ì„œ ì—…ê·¸ë ˆì´ë“œë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.\ní•¨ê»˜í•˜ëŠ” ê°œë°œì€ ì–¸ì œë‚˜ ì¦ê²ìŠµë‹ˆë‹¤.\nê°œë°œì„ ì§„í–‰í•˜ê³  í•˜ë“œì›¨ì–´ë¥¼ ì—…ê·¸ë ˆì´ë“œí•´ê°€ë©´ì„œ, CAD íŒŒì¼ë„ í•¨ê»˜ ê´€ë¦¬í•©ë‹ˆë‹¤. ë¹„ë¡ SRCëŠ” ê¸ˆì† ê°€ê³µì´ ë“¤ì–´ê°„ ê²ƒì€ ì•„ë‹ˆë¼ ë¹„êµì  ê°„ë‹¨í•˜ì§€ë§Œ, ê·œëª¨ ìˆëŠ” ë¡œë´‡ í”„ë¡œì íŠ¸ì—ì„œëŠ” ë°˜ë“œì‹œ ê±°ì³ì•¼ í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. CAD íŒŒì¼ë¡œë¶€í„° urdfë¥¼ ì¶”ì¶œí•˜ê³ , ì›€ì§ì´ëŠ” jointë“¤ì—ëŠ” gazebo controller pluginì„, ì„¼ì„œ jointì—ëŠ” gazebo sensor pluginì„ ì ìš©í•˜ì—¬ ì‹œë®¬ë ˆì´ì…˜ì„ ì œì‘í•©ë‹ˆë‹¤. ì‹œë®¬ë ˆì´ì…˜ì„ í†µí•´ ì œì–´ê¸°ì™€ Odometry Driver, ììœ¨ ì£¼í–‰ ë¡œì§ì˜ ê²€ì¦ì´ ì™„ë£Œë˜ë©´, ì‹¤ì œ ë¡œë´‡ì— ì´ë¥¼ ì ìš©í•©ë‹ˆë‹¤. ì ìš©ê³¼ ê²€ì¦ì„ ë°˜ë³µí•˜ë©´ì„œ ë¡œë´‡ì„ ê³„ì†í•´ì„œ ê°œì„ í•´ë‚˜ê°‘ë‹ˆë‹¤.\nì‘ì€ íŒì„ ì´ì•¼ê¸°í•˜ìë©´, ë°œìƒí•˜ëŠ” ëª¨ë“  ê¸°ë¡ë“¤ì„ ë¬¸ì„œí™”í•˜ëŠ” ê²ƒì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤. í•˜ë“œì›¨ì–´ë¥¼ ë‹¤ë£¨ë‹¤ë³´ë©´, ë°©ê¸ˆê¹Œì§€ ë˜ë˜ ê¸°ëŠ¥ì´ ê°‘ìê¸° ë§ì½ì„ ì¼ìœ¼ì¼œì„œ í•˜ë£¨ë¥¼ ë‚ ë¦¬ëŠ” ë‚ ë„ ìˆìŠµë‹ˆë‹¤. í•­ìƒ ëª¨ë“  ê²ƒì„ ê¸°ë¡í•©ì‹œë‹¤.\nimage from : ì—ëˆ„ë¦¬ë‹·ì»· ê°•ì˜ì˜ ë§ˆì§€ë§‰ìœ¼ë¡œ, ROS / ROS 2ì— ëŒ€í•œ í”„ë¡œì íŠ¸ë“¤, ì„¼ì„œë“¤, ë„ì „í•´ë³¼ ìˆ˜ ìˆëŠ” ê²ƒë“¤ì„ ì œì‹œí•´ë³´ê³ ì í•©ë‹ˆë‹¤.\nTutorial \u0026amp; Courses\nawesome-ros2 : https://github.com/fkromer/awesome-ros2 ROS2 Packages on NVIDIA Jetson : https://nvidia-ai-iot.github.io/ros2_jetson/ros2-packages/ Stereo labs : Getting Started with ROS2 and ZED Micro ROS Tutorial : https://micro.ros.org/docs/tutorials/core/overview/ Self-Driving Cars with ROS 2 \u0026amp; Autoware : https://www.youtube.com/playlist?list=PLL57Sz4fhxLpCXgN0lvCF7aHAlRA5FoFr Certification\nGoogle Source of Code : https://summerofcode.withgoogle.com/ Jetson AI Ambassador : Jetson AI Courses and Certification - NVIDIA Developer Open Source Contribution\nNav2 : https://navigation.ros.org/contribute/index.html ROS 2 Control : https://control.ros.org/master/doc/project_ideas.html MoveIt : https://moveit.ros.org/documentation/contributing/ Gazebo : https://gazebosim.org/docs/all/contributing ì§€ê¸ˆê¹Œì§€ ë¶€ì¡±í•œ ê°•ì˜ë¥¼ í•¨ê»˜í•´ì£¼ì…”ì„œ ê°ì‚¬ë“œë¦¬ë©°, ì¬ë¯¸ìˆëŠ” ë¡œë´‡ ê°œë°œì„ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•˜ì‹œê±°ë‚˜, ê¸°íší•˜ê³  ê³„ì‹  ë¶„, ì»¤í”¼ í•œì” í•˜ë©° ë¡œë´‡ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ê³  ì‹¶ìœ¼ì‹  ë¶„, ì–¸ì œë‚˜ í™˜ì˜í•©ë‹ˆë‹¤. ê¹€ìˆ˜ì˜ / Kim Soo Young\nTel : 010-8689-0259 Email :Â tge1375@hanyang.ac.krÂ /Â mr.swimmingkim@gmail.com "
},
{
	"uri": "/kr/advanced_contents_ros2/lecture1/",
	"title": "Lecture1 - About DDS",
	"tags": [],
	"description": "",
	"content": "About DDS ROS 1ê³¼ ëŒ€ë‘ë˜ëŠ” ê°€ì¥ í° ì°¨ì´ì ìœ¼ë¡œ, ROS 2ëŠ” DDSë¥¼ ë¯¸ë“¤ì›¨ì–´ë¡œ ê¸°ë°˜í•˜ì—¬ ê°œí¸ë˜ì—ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ DDSì— ëŒ€í•œ ê°œìš”ì™€ ê¸°ëŠ¥ì„ ì´í•´í•˜ëŠ” ê²ƒì€ ROS 2ì˜ ì„±ì§ˆì„ íŒŒì•…í•˜ëŠ” ë° ë§ì€ ë„ì›€ì´ ë©ë‹ˆë‹¤.\nWhat is DDS? DDS - Data Distribution ServiceëŠ” OMGì—ì„œ ì •ì˜í•œ Publish-Subscribe ë°©ì‹ì˜ ì‹¤ì‹œê°„ ë°ì´í„° ë¶„ë°° ì„œë¹„ìŠ¤ í‘œì¤€ì…ë‹ˆë‹¤.\nPub-Subì´ë¼ëŠ” ìš©ì–´ëŠ” ROS ê°œë°œìì—ê²Œ ë¬´ì²™ ìµìˆ™í•œ ë‹¨ì–´ì´ì§€ìš”? DDSì˜ ê¸°ë³¸ í†µì‹  ê°œë…ì€ ROSì˜ Topicê³¼ ë§¤ìš° ìœ ì‚¬í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ê²°ë¡ ì„ ë¨¸ë¦¬ì†ì— ì˜ ë‹´ì•„ë‘ê³  ê³„ì†í•´ì„œ ì§„í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤.\nOMG(Object Management Group)ëŠ” ë¶„ì‚° ê°ì²´ ì»´í“¨íŒ…(Distributed Object Computing) ì˜ì—­ì˜ í‘œì¤€ì„ ì œì •í•˜ëŠ” êµ­ì œ ë¹„ì˜ë¦¬ ì»¨ì†Œì‹œì—„ìœ¼ë¡œ ì˜í–¥ë ¥ ìˆëŠ” ê°ì¢… ì„¸ê³„ í‘œì¤€ì„ ì •ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nimage from : ë¶„ì‚°ì´ë™ì»´í“¨íŒ… ì—°êµ¬ì‹¤ OMG DDSëŠ” í†µì‹  í”„ë¡œí† ì½œì´ ì•„ë‹Œ ê¸°ëŠ¥ì  í‘œì¤€ìœ¼ë¡œ, ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ TCP/UDP ê°™ì€ í†µì‹  í”„ë¡œí† ì½œ ìœ„ì—ì„œ ì •ì˜ë˜ëŠ” ê°ì²´ì…ë‹ˆë‹¤.\nê·¸ë¦¼ì˜ ì•„ë˜ì—ì„œë¶€í„° OMG DDSì˜ êµ¬ì¡°ë¥¼ ê°„ë‹¨íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nRTPS(Real-Time Publish-Subscribe Wire Protocol) Layer RTPS LayerëŠ” ë„¤íŠ¸ì›Œí¬ ë‚´, ì°¸ì—¬ì ì •ë³´ë¥¼ ìœ ì§€í•˜ê³ , ë„¤íŠ¸ì›Œí¬ ì°¸ì—¬ìì— ëŒ€í•œ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìë™ ê²€ìƒ‰ì„ í•´ì£¼ë©°, (ê°™ì€ ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ROS 2 ì‹œìŠ¤í…œì€ ì„œë¡œ í†µì‹ ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.) ë”ë¶ˆì–´, ì°¸ì—¬ìì˜ ë™ì  ì¶”ê°€ì™€ ì´íƒˆì— ëŒ€ì‘í•˜ëŠ” ê¸°ëŠ¥ì„ í•©ë‹ˆë‹¤.\nRTPSëŠ” OMGì— ì˜í•´ í‘œì¤€í™”ëœ, ë°ì´í„° ë¶„ì‚° ì‹œìŠ¤í…œì„ ìœ„í•œ í”„ë¡œí† ì½œë¡œì¨ Pub-Sub êµ¬ì¡°ì˜ í†µì‹  ëª¨ë¸ì„ ì§€ì›í•©ë‹ˆë‹¤. UDPì™€ ê°™ì´ ì‹ ë¢°ì„± ì—†ëŠ” ê³„ì¸µ ìœ„ì—ì„œë„ ë™ì‘ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìœ¼ë©°, 4ê°€ì§€ ëª¨ë“ˆë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\nStructure Module : ë°ì´í„° êµí™˜ ì‹œ, í†µì‹ ì— ì°¸ì—¬í•˜ê²Œ ë˜ëŠ” ê°œì²´ë“¤ì— ëŒ€í•´ ì •ì˜í•©ë‹ˆë‹¤. Message Module : Writerì™€ Readerê°„ ì •ë³´ êµí™˜ì„ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ë©”ì‹œì§€ì— ëŒ€í•´ ì •ì˜í•©ë‹ˆë‹¤. Behavior Module : Writerì™€ Readerê°„ ìƒíƒœ, ì‹œê°„ ì¡°ê±´ì— ë”°ë¼ ìˆ˜í–‰ë˜ì–´ì•¼ í•  ë©”ì‹œì§€ ì „ì†¡ ì ˆì°¨ì— ëŒ€í•´ ì •ì˜í•©ë‹ˆë‹¤. Discovery Module : ê°™ì€ ë„ë©”ì¸ ìƒì— ì¡´ì¬í•˜ëŠ” ê°œì²´ì— ëŒ€í•œ ì •ë³´ë¥¼ íƒìƒ‰í•˜ëŠ” ê¸°ëŠ¥ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. Discovery Moduleì€ ë‹¤ìŒê³¼ ê°™ì´ ë‘ ê°€ì§€ì˜ RTPS í”„ë¡œí† ì½œì„ ì‚¬ìš©í•©ë‹ˆë‹¤. PDP(Participant Discovery Protocol) : ì„œë¡œ ë‹¤ë¥¸ ë„¤íŠ¸ì›Œí¬ ìƒì—ì„œì˜ Participantíƒìƒ‰ì„ ìœ„í•œ í”„ë¡œí† ì½œ EDP(Endpoint Discovery Protocol) : Writer, Readerì™€ ê°™ì´ ì„œë¡œ ë‹¤ë¥¸ ì¢…ë‹¨ì  ê°„ì˜ íƒìƒ‰ ì •ë³´ êµí™˜ì— ì‚¬ìš©ë˜ëŠ” í”„ë¡œí† ì½œ image from : OMG DDS(Data Distrubution Service) ê¸°ìˆ  ê°œìš” DDS Discovery ROS 2ë¥¼ ì‚¬ìš©í•˜ëŠ” ë‘ ë””ë°”ì´ìŠ¤ëŠ” ê°™ì€ ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ ìë™ìœ¼ë¡œ ì„œë¡œë¥¼ ì¸ì‹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì–´ë–»ê²Œ ì´ëŸ¬í•œ ë™ì‘ì´ ê°€ëŠ¥í•˜ë©°, ì´ë¥¼ ìœ„í•œ í•„ìš”ì¡°ê±´ì€ ë¬´ì—‡ì¸ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nDiscoveryë¥¼ ìœ„í•´ í•„ìš”í•œ ì •ë³´ë“¤ - DDSÂ ë¯¸ë“¤ì›¨ì–´ í†µì‹ ì„ ìœ„í•´ ì•„ë˜Â 4ê°€ì§€ ì •ë³´ë¥¼ ì‚¬ì „ì— êµí™˜í•´ì•¼ í•©ë‹ˆë‹¤.\nWho : Topic Publish í˜¹ì€ Subscribe ëŒ€ìƒ Where : DDSÂ í‘œì¤€ì—ì„œ ìƒì„±í•œÂ LocatorÂ ì •ë³´ What :Â Publishí•˜ê±°ë‚˜ Subscribeí•˜ë ¤ëŠ”Â Topic How : Topic Publisherì¸ì§€ Subscriberì¸ì§€ì— ëŒ€í•œ ì •ë³´ DDSÂ RTPSë„ ê²°êµ­Â UDPë‚˜Â TCP ë„¤íŠ¸ì›Œí¬ ë ˆì´ì–´ë¥¼ ì‚¬ìš©í•˜ë©°, ì´ë¥¼ ìœ„í•´ì„œ ì‹¤ì§ˆì ìœ¼ë¡œÂ IPì™€Â PORTë“±ì˜ ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.Â í•˜ì§€ë§Œ, DDSëŠ” ì‚¬ìš©ìê°€ ì£¼ì†Œë¥¼ ì§€ì •í•˜ì§€ ì•Šì•„ë„Â â€œTopicâ€ë§Œìœ¼ë¡œ í†µì‹ ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” ê²ƒì´ Locatorì´ë©°, ì´ëŠ” Middle Wareë‹¨ì—ì„œ ëŠ¥ë™ì ìœ¼ë¡œ í†µì‹ ì— í•„ìš”í•œ ì •ë³´ë¥¼ í¬í•¨í•˜ëŠ” ìƒˆë¡œìš´ ê°œë…ì„ ë³„ë„ë¡œ ìƒì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.\nDDSÂ í‘œì¤€ì—ì„œëŠ”Â Discoveryë¥¼ ìˆ˜í–‰í•˜ëŠ”Â ì ˆì°¨ë¥¼Â PDPÂ ì™€Â EDPë¡œ êµ¬ë¶„í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nPDP(Participant Discovery Protocol) : ê°™ì€ ë„ë©”ì¸ì— ì¡´ì¬í•˜ëŠ” ì„œë¡œ ë‹¤ë¥¸Â Participantë¥¼ ê²€ìƒ‰í•˜ëŠ” ì ˆì°¨ë¡œ, Participantì— í¬í•¨ë˜ì–´ ìˆëŠ”Â endpointÂ ì˜ ì •ë³´ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤. EDP(Endpoint Discovery Protocol) : PDPë¥¼ í†µí•´Â Participantê°€ ì„œë¡œë¥¼ íƒì§€í•˜ê³  ë‚˜ë©´, EDPê°€ ìˆ˜í–‰ë©ë‹ˆë‹¤.Â í‘œì¤€ì—ì„œëŠ” ê° í”„ë¡œí† ì½œì´ ì§€ì›í•´ì•¼í•  ìµœì†Œí•œì˜ ê¸°ëŠ¥ì„ ë§Œì¡±í•˜ëŠ”Â SPDPì™€Â SEDPì— ëŒ€í•´ ì„¤ëª…í•˜ê³  ìˆìŠµë‹ˆë‹¤. vendorì— ë”°ë¼ ë‹¤ì–‘í•œ PDPì™€ EDPë¥¼ ì§€ì›í•  ìˆ˜ ìˆì§€ë§Œ, í˜¸í™˜ì„±ì„ ìœ„í•´ ëª¨ë“  RTPSëŠ” SPDP(Simple Participant Discovery Protocol)ì™€ SEDP(Simple Endpoint Discovery Protocol)ë¥¼ í•„ìˆ˜ë¡œ ì§€ì›í•´ì•¼í•©ë‹ˆë‹¤. ì„œë¡œ ë‹¤ë¥¸ vendorë¥¼ ê°€ì§„ ë¨¸ì‹  ì‚¬ì´ì— í†µì‹ ì´ ê°€ëŠ¥í•œ ì´ìœ ì´ê¸°ë„ í•©ë‹ˆë‹¤.\nê·¸ë¦¼ì„ í†µí•´Â SPDPì™€Â SEDPë¥¼ í™œìš©í•œ Discovery ì ˆì°¨ì— ëŒ€í•´ ì•Œì•„ë´…ì‹œë‹¤.\nê°™ì€ Domainì„ ì‚¬ìš©í•˜ëŠ” ParticipantëŠ” ìƒì„± ì‹œ, Discoveryë¥¼ ìˆ˜í–‰í•˜ëŠ”Â 3ìŒì˜Â builtin Writerì™€Â builtin Reader, ê·¸ë¦¬ê³  pre-defined topicë¥¼ í¬í•¨í•˜ê²Œ ë©ë‹ˆë‹¤. DDSê°€ êµ¬ë™ë˜ë©´, ParticipantëŠ” Multicastë¡œ PDP(Participant Discovery Protocol) ë©”ì‹œì§€ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ ì „ì†¡í•˜ê¸° ì‹œì‘í•©ë‹ˆë‹¤. ê°Â Participantì˜Â builtinParticipantWriterì™€Â builtinPariticpantReader ì‚¬ì´ SPDP êµí™˜ì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì „ë‹¬ë˜ëŠ” ì •ë³´ì—ëŠ”Â Participantì— í¬í•¨ëœÂ builtinPublicationWriterì™€Â builtinPublicationReaderì˜Â LocatorÂ ì •ë³´ê°€ ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤. SPDPÂ êµí™˜ ì´í›„, ìƒëŒ€ë°© Participantì˜ ì •ë³´ë¥¼ í†µí•´ ì–‘ì¸¡ Participantë“¤ì€ ì„œë¡œ ì—°ê²°ë©ë‹ˆë‹¤. ì´í›„, Topic ìˆ˜í–‰ì„ ìœ„í•´ ê° Participantì— Endpointì— í•´ë‹¹í•˜ëŠ” Publisherì™€ Datawriterê°€ í•˜ë‚˜ì”© ìƒì„±ë©ë‹ˆë‹¤. SPDPì—ì„œ êµí™˜í–ˆë˜ Locatorì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ builtinPublicationWriterëŠ” builtiinPublicationReaderì—ê²Œ, builtinSubscriptionWriterëŠ” SubscriptionReaderì—ê²Œ Unicastë¥¼ í†µí•´ ì •ë³´ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.(SEDPë¥¼ êµí™˜í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.) ì „ë‹¬ë˜ëŠ” ì •ë³´ì—ëŠ” topic, data type, Qosë“±ì˜ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. SEDPì˜ ê²°ê³¼ë¡œ Participantì— í¬í•¨ëœ Endpointë“¤ì´ ì—°ê²°ë˜ê³ , ì—°ê²°ëœ ë‘ EndpointëŠ” ë™ì¼ Topicìœ¼ë¡œ í†µì‹ ì„ ì‹œì‘í•©ë‹ˆë‹¤. Discovery ê³¼ì •ì„ í•œë²ˆì— ì •ë¦¬í•œ ê·¸ë¦¼ì…ë‹ˆë‹¤. ë‹¤ì‹œ í•œ ë²ˆ ì˜ë¯¸ë¥¼ ì´í•´í•˜ë©´ì„œ ê³¼ì •ì„ ë³µê¸°í•´ë´…ì‹œë‹¤.\nDCPS(Data-Centric Publish-Subscribe) Layer DCPS LayerëŠ” RTPS Layerì™€ Application ì‚¬ì´ì˜ ì¸í„°í˜ì´ìŠ¤ ì—­í• ì„ í•©ë‹ˆë‹¤. ì´í›„ ë‹¤ë¤„ì§€ëŠ” Participant, Domain, Topic ë“±ì„ ì •ì˜í•˜ê³ , Publish-Subscribeë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤. ë”ë¶ˆì–´, DDSì˜ ì¤‘ìš”í•œ ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜ì¸ QoS(Quality of Service)ë„ ë‹´ë‹¹í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nêµ¬í˜„ ì¸¡ë©´ì—ì„œ, DCPSëŠ” Data read/write APIë¥¼ ì œê³µí•¨ìœ¼ë¡œ ì‘ìš© í”„ë¡œê·¸ë¨ë“¤ ì‚¬ì´ ë°ì´í„°ë¥¼ êµí™˜í•  ìƒëŒ€ì— ëŒ€í•œ ì¸ì§€ ì—†ì´ ì›í•˜ëŠ” ë°ì´í„°ì˜ ì†¡ìˆ˜ì‹ ì´ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.\nimage from : OMG DDS(Data Distrubution Service) ê¸°ìˆ  ê°œìš” DataWriter / DataReader DataWriterëŠ” ì†¡ì‹ ì, DataReaderëŠ” ìˆ˜ì‹ ìì˜ ì—­í• ì„ í•©ë‹ˆë‹¤. DataWriterëŠ” Sample(ì‹¤ì œ ë°ì´í„°)ì„ ìƒì„±í•˜ê³  ì „ì†¡í•˜ëŠ” ì—­í• ì„ í•˜ë©°, DataReaderëŠ” Sampleì„ ìˆ˜ì‹ í•˜ëŠ” ê¸°ëŠ¥ì„ í•©ë‹ˆë‹¤. ë‹¨ì¼ DataWriterì™€ DataReaderëŠ” ë‹¨ì¼ Topicë§Œì„ ë³´ìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nPublisher ë°ì´í„° Publishë¥¼ ë‹´ë‹¹í•˜ëŠ” ê°ì²´ë¡œ, í•˜ë‚˜ì˜ PublisherëŠ” ë‹¤ìˆ˜ì˜ DataWriterë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë•Œë¬¸ì—, ê° Publisherë“¤ì€ ì—¬ëŸ¬ Topic ë°ì´í„°ë¥¼ Publish í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Publishí•˜ê³ ì í•˜ëŠ” ë°ì´í„° ê°ì²´ì˜ ê°’ì´ Publisherì—ê²Œ ì „í•´ì§€ë©´ PublisherëŠ” ìì‹ ì—ê²Œ ì„¤ì •ëœ QoSê°’ì— ë”°ë¼ ì—°ê´€ëœ Subscriberì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤.\nSubscriber ë°ì´í„° Subscribeë¥¼ ë‹´ë‹¹í•˜ëŠ” ê°ì²´ë¡œ, Publisherì™€ ìœ ì‚¬í•˜ê²Œ ë‹¤ìˆ˜ì˜ DataReaderë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìœ¼ë©° ì—¬ëŸ¬ Topic ë°ì´í„°ë¥¼ ìˆ˜ì‹ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Subscriberê°€ ë°ì´í„°ë¥¼ ìˆ˜ì‹ í•œ ì´í›„, ì‘ìš© í”„ë¡œê·¸ë¨ì€ DataReaderë¥¼ í†µí•´ ì‹¤ì œ ë°ì´í„°ë¡œ ì ‘ê·¼í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.\nDDS Pub-Subì˜ ê¸°ë³¸ êµ¬ì„± ìš”ì†Œ image from : MDS í…Œí¬ Topic\nTopicì€ Publish-Subscribeì˜ ê´€ê³„ë¥¼ ì •ì˜í•˜ëŠ” Keyì…ë‹ˆë‹¤. topicì€ ë°ì´í„° íƒ€ì…ê³¼ í•´ë‹¹ ë°ì´í„°ì˜ QoSì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. QoSë¥¼ Topic ë°ì´í„°ì— ì¶”ê°€í•˜ê³ , Topicê³¼ ì—°ê´€ëœ DataWriter, Datawriterì— ì—°ê´€ëœ QoSë¥¼ ì„¤ì •í•˜ëŠ” ì‹ìœ¼ë¡œ ì œì–´ë©ë‹ˆë‹¤. (Subscriber ì¸¡ë„ ë™ì¼í•©ë‹ˆë‹¤.)\nTopicì˜ ì´ë¦„ì€ Domain ë‚´ì—ì„œ ìœ ì¼í•´ì•¼ í•©ë‹ˆë‹¤.\nParticipant\nParticipantëŠ” DDS Publisherì™€ Subscriberë¥¼ ë‹´ê²Œ ë˜ëŠ” ê°ì²´ì…ë‹ˆë‹¤. ROS 2ì˜ Nodeì•ˆì— ë‹¤ìˆ˜ì˜ Publisherì™€ Subscriberì™€ ê³µì¡´í•  ìˆ˜ ìˆëŠ” ê²ƒì²˜ëŸ¼, Participantë„ ë‹¤ìˆ˜ì˜ DataWriterì™€ DataReaderë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nDomain\nDomainì€ Participantë“¤ì´ í™œë™í•˜ëŠ” ì˜ì—­ìœ¼ë¡œ, ê°™ì€ Domainì„ ê°–ëŠ” Participantë‚´ì—ì„œë§Œ ì •ë³´ì „ë‹¬ì„ í• Â ìˆ˜ ìˆìŠµë‹ˆë‹¤. ROS 2 í„°ë¯¸ë„ì˜ ì‹¤í–‰ ì‹œ ROS_DOMAIN_IDë¼ëŠ” ì½˜ì†” ì¶œë ¥ì´ ë‚˜ì™”ë˜ ê²ƒì„ ê¸°ì–µí•˜ì‹œë‚˜ìš”?\n*************** Startup Menu for ROS *************** * Usage: To set ROS env to be auto-loaded, please * * assign ros_option in ros_menu/config.yaml * ****************************************************** 0) Do nothing 1) ROS 1 noetic 2) ROS 2 foxy 3) ROS2/ROS1_bridge Please choose an option: 2 ------------------------------------------------------ * ROS_DOMAIN_ID = 30 ------------------------------------------------------ ì´ë ‡ê²Œ DDSì˜ í†µì‹  êµ¬ì¡°ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. ìœ„ êµ¬ì¡°ì—ì„œ ì‹¤ì œ ì‚¬ìš©ìëŠ” Topic, Publisher, Subscriberë§Œ êµ¬í˜„í•˜ë©´ ë˜ë©°, DataWriter, DataReaderì™€ RTPS, DCPSëŠ” DDSê°€ ì•Œì•„ì„œ ì²˜ë¦¬í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ DDSì˜ ì¥ì ì— ê¸°ë°˜í•˜ì—¬ ROS 2 ì‹œìŠ¤í…œì´ ì˜¬ë¼ê°€ê²Œ ë˜ëŠ” ê²ƒì´ì§€ìš”.\nDDS QoS TCPROS/UDPROSë¼ëŠ” ìì²´ í”„ë¡œí† ì½œì„ ì‚¬ìš©í–ˆë˜ ê¸°ì¡´ ROS 1ê³¼ëŠ” ë‹¬ë¦¬, ROS 2ì—ì„œëŠ” QoS ì˜µì…˜ì„ í†µí•´ ì›í•˜ëŠ” ê¸°ëŠ¥ì„ ì„ íƒì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” DDSì˜ QoSë¥¼ ë„ì…í•˜ì˜€ê¸° ë•Œë¬¸ìœ¼ë¡œ, Publisher, Subscriberë¥¼ ì„ ì–¸í•  ë•Œ, QoSë¥¼ ë§¤ê°œë³€ìˆ˜í˜•íƒœë¡œ ì§€ì •í•˜ëŠ” ë°©ì‹ì´ ì‚¬ìš©ë©ë‹ˆë‹¤.\nìƒí™©ì— ë”°ë¼ ë°ì´í„°ì˜ ì‹ ë¢°ì„±ì´ ì¤‘ìš”í•  ìˆ˜ë„ ìˆê³ , ë²„í¼ì˜ í¬ê¸°ë¥¼ í¬ê²Œ í•˜ì—¬ Topicì˜ ì•ˆì •ì„±ì„ ë†’ì—¬ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ í†µì‹ ì˜ í’ˆì§ˆì„ ì˜µì…˜í™”í•˜ê¸° ìœ„í•´ì„œ, DDSì—ì„œëŠ” ì•„ë˜ì™€ ê°™ì€ 22ê°€ì§€ì˜ QoSë¥¼ ì •ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nê°ê°ì˜ QoS ì˜µì…˜ì€ ì—°ê´€ëœ ì¡°í•©ìœ¼ë¡œ Topic, DataWriter, DataReader, Publisher, Subscriber, Domain, Participantì— ì ìš©ë˜ë©°, ë³¸ ì„¸ì…˜ì—ì„œëŠ” ì£¼ë¡œ ì‚¬ìš©ë˜ëŠ” QoSë¥¼ ìœ„ì£¼ë¡œ ì‚´í´ë³´ê³ ì í•©ë‹ˆë‹¤.\nRELIABILITY: ë°ì´í„° í†µì‹ ì˜ ì‹ ë¢°ì„± ë ˆë²¨(ì¬ì „ì†¡ ì—¬ë¶€)ì„ ê²°ì •í•˜ë©° ë‘ ê°€ì§€ ì†ì„±ì„ ì„¤ì • í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. RELIABLE : DataWriter Historyì— ìˆëŠ” ëª¨ë“  ìƒ˜í”Œë“¤ì´ DataReaderì— ì „ë‹¬ë˜ëŠ” ê²ƒì„ ë³´ì¥í•©ë‹ˆë‹¤. BEST_EFFORT : í†µì‹  ì‹œ ì†ì‹¤ëœ ë°ì´í„° ìƒ˜í”Œì„ ì¬ì „ì†¡ í•˜ì§€ ì•Šê³ , ì „ë‹¬ëœ ë°ì´í„°ì˜ ìˆœì„œëŠ” ìœ ì§€ í•©ë‹ˆë‹¤. ì•ŒíŒŒë²³ì€ ë‹¤ìŒê³¼ ê°™ì€ ì˜ë¯¸ë¥¼ ê°–ìŠµë‹ˆë‹¤. T : TOPIC, DR : DataReader, DW : DataWriter, P : Publisher, S : Subscriber\nRxOëŠ”Â Requested/Offeredì˜ ì•½ìë¡œÂ QoSê°€ ì ìš©ë˜ëŠ” ëŒ€ìƒì„Â Publisher(ë°œê°„/ì†¡ì‹ )Â ì¸¡ê³¼Â Subscriber(êµ¬ë…/ìˆ˜ì‹ )Â ì¸¡ìœ¼ë¡œ êµ¬ë¶„í•´ì„œ ì„œë¡œì˜ ìƒê´€ê´€ê³„ë¥¼ í‘œí˜„í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.\nâ€˜YESâ€™ : PublisherÂ ì¸¡ê³¼Â SubscriberÂ ì¸¡ ëª¨ë‘Â QoSê°€ ì ìš©ë˜ì–´ì•¼ í•˜ê³ ,Â ì„¤ì •ëœÂ QoSÂ ê°’ì´ í˜¸í™˜ë˜ì–´ì•¼ í•œë‹¤. â€˜NOâ€™Â : PublisherÂ ì¸¡ê³¼Â SubscriberÂ ì¸¡ ëª¨ë‘Â QoSÂ ê°€ ì ìš©ë˜ì–´ì•¼ í•˜ì§€ë§Œ,Â ì„¤ì •ëœÂ QoSÂ ê°’ì€ ì„œë¡œ ë…ë¦½ì ì´ë‹¤. â€˜N/Aâ€™ : PublisherÂ ì¸¡ê³¼Â SubscriberÂ ì¸¡ ì¤‘ í•œ ì¸¡ì—ë§Œ ì ìš©ë˜ì–´ì•¼ í•œë‹¤. Changeableì´Â â€˜YESâ€™Â ì¼ ê²½ìš°ì—ëŠ”,Â ë™ì‘í•˜ë©´ì„œë„Â QoSÂ ì˜ ê°’ì´ ë³€ê²½ë  ìˆ˜ ìˆì§€ë§Œ, â€˜NOâ€™ì¼ ê²½ìš°ì—ëŠ” ì²˜ìŒ ìƒì„±ëœ ì´í›„ì—ëŠ” ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\nHISTORY : ë°ì´í„°ì˜ ì¬ì „ì†¡ì„ ìœ„í•´ HistoryCacheë‚´ ë°ì´í„° ë³´ê´€ ë°©ë²•ì„ ê²°ì •í•˜ë©° ë‘ ê°€ì§€ ì†ì„±ì„ ì„¤ì • í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. KEEP_LAST : Depth(History Cacheì•ˆì— ìœ ì§€í•˜ê³  ìˆì„ ë°ì´í„° ê°œìˆ˜) í¬ê¸° ë§Œí¼ ìµœì‹  ë°ì´í„°ë¥¼ ìœ ì§€ í•©ë‹ˆë‹¤. KEEP_ALL : DataReaderì—ê²Œ ì¸ìŠ¤í„´ìŠ¤ì˜ ëª¨ë“  ê°’ë“¤ì„ ìœ ì§€í•˜ê³  ì „ì†¡ í•©ë‹ˆë‹¤. DURABILITY : ë‚˜ì¤‘ì— ì°¸ì—¬í•œ DataReaderì—ê²Œ ì´ì „ ë°ì´í„°ë¥¼ ì „ì†¡í• ì§€ ì—¬ë¶€ë¥¼ ê²°ì • í•˜ë©° ë„¤ ê°€ì§€ ì†ì„±ì„ ì„¤ì • í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. VOLATILE : ì—°ê²°ì´ ì„¤ì • ëœ ì´í›„ì˜ ë°ì´í„°ë§Œ ì œê³µ í•©ë‹ˆë‹¤. TRANSIENT LOCAL : DataWriter ìƒëª…ì£¼ê¸°ì™€ ì¼ì¹˜ ì¼ì¹˜í•©ë‹ˆë‹¤. TRANSIENT : DataReaderì— ê³¼ê±° ë°ì´í„°ë¥¼ ì œê³µ í•©ë‹ˆë‹¤. PERSISTENT : Permanent-Storageì— ê³¼ê±° ë°ì´í„°ë¥¼ ì €ì¥í•˜ë©°, ë°ì´í„°ì˜ ìœ íš¨ì„±ì€ System ë³´ë‹¤ ì˜¤ë˜ ì§€ì† ë©ë‹ˆë‹¤. OWNERSHIP : ë‹¤ìˆ˜ì˜ DataWriterê°€ ë™ì¼í•œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°±ì‹ í•˜ê²Œ í—ˆìš©í• ì§€ë¥¼ ê²°ì •í•©ë‹ˆë‹¤. SHARED : ë‹¤ìˆ˜ì˜ DataWriterë“¤ì´ ë™ì¼í•œ ë°ì´í„° ì¸ìŠ¤í„´ìŠ¤ ì—…ë°ì´íŠ¸ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. EXCLUSIVE : ë°ì´í„° ê°ì²´ì˜ ê° ì¸ìŠ¤í„´ìŠ¤ëŠ” í•˜ë‚˜ì˜ DataWriterì— ì˜í•´ì„œë§Œ ìˆ˜ì • ê°€ëŠ¥í•©ë‹ˆë‹¤. PARTITION : Domain ë‚´ë¶€ì—ì„œ Nodeë“¤ì„ ë¶„ë¦¬í•˜ëŠ” ë°©ë²•ì„ ê²°ì • í•©ë‹ˆë‹¤. (Domain ë‚´ì—ì„œ ë³„ë„ì˜ ë…¼ë¦¬ì ì¸ í†µì‹  ì±„ë„ í˜•ì„±) - Partition Nameì´ ê°™ì€ DataWriter/DataReaderê°„ ë°ì´í„° ë°°í¬ ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. Partitionê³¼ Domainì˜ ì°¨ì´ - ë‹¤ë¥¸ Domainë“¤ì— ì†í•˜ëŠ” ê°œì²´ë“¤ì€ ì™„ì „íˆ ì„œë¡œ ë…ë¦½ ëœ ìƒíƒœì…ë‹ˆë‹¤. EntityëŠ” ë‹¤ìˆ˜ì˜ Partitionì— ìˆì„ ìˆ˜ ìˆì§€ë§Œ í•˜ë‚˜ì˜ Domainì—ë§Œ ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nDEADLINE : ë°ì´í„° ìƒ˜í”Œ ì‚¬ì´ì˜ ìµœëŒ€ ë„ì°© ì‹œê°„ì„ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. DataWriterëŠ” DEADLINE(period:Duration_t)ì´ ì„¤ì •ëœ ì‹œê°„ ì•ˆì— ì ì–´ë„ í•œë²ˆ ì´ìƒì˜ ë°ì´í„°ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤. DataReaderëŠ” DEADLINE(period:Duration_t) ì‹œê°„ ì•ˆì— DataWriterë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ì§€ ëª»í•˜ë©´ DDSë¡œë¶€í„° ìœ„ë°˜ í†µë³´ë¥¼ ë°›ìŠµë‹ˆë‹¤. TIME_BASED_FILTER : DataReader ê°€ ë°ì´í„°ë¥¼ í•„í„°ë§ í•˜ëŠ” ì‹œê°„ì„ ê²°ì • í•©ë‹ˆë‹¤. Minimum_separation: Duation_t ê°’ì„ ì„¤ì •í•˜ì—¬ DataReaderëŠ” ì´ ê°’ ì´ë‚´ì— ìˆ˜ì‹ í•œ ë°ì´í„°ëŠ” ì‚­ì œ í•©ë‹ˆë‹¤. ROS 2ì—ì„œëŠ” ìì£¼ ì‚¬ìš©ë˜ëŠ” QoS ì¡°í•©ì„ ë¬¶ì–´ RMW QoS Profileì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ ìš°ë¦¬ê°€ queue_sizeë§Œì„ ì „ë‹¬í•˜ê³  ìˆì—ˆì§€ë§Œ, ì‚¬ì‹¤ì€ ì•„ë˜ ì‚¬ì§„ì˜ Defaultì—ì„œ Depthë§Œ ë°”ê¿”ì£¼ê³  ìˆì—ˆë˜ ê²ƒì…ë‹ˆë‹¤.\nimage from : ì˜¤ë¡œì¹´ ros2ì—ì„œ QoS ì„¤ì •í•˜ëŠ” ë°©ë²•ì€ ë§¤ìš° ê°„ë‹¨í•©ë‹ˆë‹¤. Publisher, Subscriber í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ë©´ì„œ QoS ì˜µì…˜ì„ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬í•˜ë©´ ë©ë‹ˆë‹¤.\npython example - RMW QoS Profile ì‚¬ìš© ì‹œ from rclpy.qos import qos_profile_sensor_data self.string_publisher = self.create_publisher(String, \u0026#39;qos_test_topic\u0026#39;, qos_profile_sensor_data) python example - ì§ì ‘ Profile ì„¤ì • ì‹œ from rclpy.qos import QoSDurabilityPolicy from rclpy.qos import QoSHistoryPolicy from rclpy.qos import QoSProfile from rclpy.qos import QoSReliabilityPolicy my_profile = QoSProfile( reliability=QoSReliabilityPolicy.BEST_EFFORT, history=QoSHistoryPolicy.KEEP_LAST, depth=10, durability=QoSDurabilityPolicy.VOLATILE ) self.string_publisher = self.create_publisher(String, \u0026#39;qos_test_topic\u0026#39;, my_profile) =\u0026gt; ì°¸ê³  ë§í¬ : rclpy/qos.py\ntopic í†µì‹ ì´ ì´ë£¨ì–´ì§€ê³  ìˆëŠ” ìƒí™©ì—ì„œ, QoS ì˜µì…˜ì„ ë³´ê³  ì‹¶ë‹¤ë©´ Topic ì»¤ë©˜ë“œì— verbose ì˜µì…˜ì„ ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤. # Terminal 1 - publisher $ ros2 run py_topic_tutorial qos_example_publisher # Terminal 2 - subscriber $ ros2 run py_topic_tutorial qos_example_subscriber # Terminal 3 - topic info $ ros2 topic info /qos_test_topic --verbose Type: std_msgs/msg/String Publisher count: 1 Node name: twist_pub_node Node namespace: / Topic type: std_msgs/msg/String Endpoint type: PUBLISHER GID: 60.77.10.01.f3.67.78.3d.6b.0c.cc.7b.00.00.14.03.00.00.00.00.00.00.00.00 QoS profile: Reliability: RMW_QOS_POLICY_RELIABILITY_BEST_EFFORT Durability: RMW_QOS_POLICY_DURABILITY_VOLATILE Lifespan: 9223372036854775807 nanoseconds Deadline: 9223372036854775807 nanoseconds Liveliness: RMW_QOS_POLICY_LIVELINESS_AUTOMATIC Liveliness lease duration: 9223372036854775807 nanoseconds Subscription count: 1 Node name: string_sub_node Node namespace: / Topic type: std_msgs/msg/String Endpoint type: SUBSCRIPTION GID: d2.03.10.01.d5.6b.69.e0.be.3f.b5.a2.00.00.14.04.00.00.00.00.00.00.00.00 QoS profile: Reliability: RMW_QOS_POLICY_RELIABILITY_BEST_EFFORT Durability: RMW_QOS_POLICY_DURABILITY_VOLATILE Lifespan: 9223372036854775807 nanoseconds Deadline: 9223372036854775807 nanoseconds Liveliness: RMW_QOS_POLICY_LIVELINESS_AUTOMATIC Liveliness lease duration: 9223372036854775807 nanoseconds DDS QoSëŠ” RxO - requested by offered íŠ¹ì„±ì„ ê°–ê³  ìˆì–´ ì„œë¡œ ì–‘ë¦½í•  ìˆ˜ ì—†ëŠ” ì¡°í•©ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Publishì˜ Reliabilityê°€ BEST_EFFORTì¼ë•Œ, Subscriberì˜ Reliabilityê°€ RELIABLEë¼ë©´, Topic í†µì‹ ì´ ë°œìƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\nì½”ë“œë¥¼ ìˆ˜ì •í•˜ì—¬ ì§ì ‘ ì‹¤ìŠµí•´ë´…ì‹œë‹¤. qos_example_publisher.py qos_example_subscriber.py my_profile = QoSProfile( reliability=QoSReliabilityPolicy.BEST_EFFORT, history=QoSHistoryPolicy.KEEP_LAST, depth=10, durability=QoSDurabilityPolicy.VOLATILE ) ... self.string_publisher = self.create_publisher(String, \u0026#39;qos_test_topic\u0026#39;, qos_profile_sensor_data) my_profile = QoSProfile( reliability=QoSReliabilityPolicy.RELIABLE, history=QoSHistoryPolicy.KEEP_LAST, depth=10, durability=QoSDurabilityPolicy.VOLATILE ) ... self.pose_subscriber = self.create_subscription( String, \u0026#39;qos_test_topic\u0026#39;, self.sub_callback, my_profile ) ì½”ë“œ ë³€ê²½ í›„ ì‹¤í–‰ - Warningê³¼ í•¨ê»˜ Subscriberê°€ ë™ì‘í•˜ì§€ ì•ŠìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. $ ros2 run py_topic_tutorial qos_example_publisher [WARN] [1673945160.449603592] [twist_pub_node]: New subscription discovered on this topic, requesting incompatible QoS. No messages will be sent to it. Last incompatible policy: RELIABILITY_QOS_POLICY $ ros2 run py_topic_tutorial qos_example_subscriber [WARN] [1673945160.455319911] [string_sub_node]: New publisher discovered on this topic, offering incompatible QoS. No messages will be received from it. Last incompatible policy: RELIABILITY_QOS_POLICY QoSë¥¼ í†µí•´ ì›í•˜ëŠ” ë„ë©”ì¸ì—ì„œì˜ ì„±ëŠ¥ì„ ëŒì–´ì˜¬ë¦¬ê³  ì•ˆì •ì„±ì„ ê°–ì¶˜ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•©ì‹œë‹¤.\nâ‡’ ë‹¤ìŒ í˜ì´ì§€ì—ì„œ ê³„ì†ë©ë‹ˆë‹¤.\n"
},
{
	"uri": "/kr/advanced_contents_ros2/lecture2/",
	"title": "Lecture11 - About DDS (2)",
	"tags": [],
	"description": "",
	"content": "DDSì˜ IDL DDSì—ì„œëŠ” íŠ¹ì • ì–¸ì–´ì— ì˜ì¡´ì ì´ì§€ ì•ŠëŠ” ë°ì´í„° í†µì‹ ì„ ìœ„í•´ IDLì„ ì‚¬ìš©í•©ë‹ˆë‹¤.\nIDL - Interface Description Language ë˜ëŠ” Interface Definition LanguageëŠ” ì–´ëŠ í•œ ì–¸ì–´ì— êµ­í•œë˜ì§€ ì•ŠëŠ” ì–¸ì–´ì¤‘ë¦½ì ì¸ ë°©ë²•ìœ¼ë¡œ ì¸í„°í˜ì´ìŠ¤ë¥¼ í‘œí˜„í•¨ìœ¼ë¡œì¨, ê°™ì€ ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì»´í¬ë„ŒíŠ¸ ì‚¬ì´ì˜ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.\nOMGì˜ Interface Definition Language Version 3.5ì— ë”°ë¥¸ ì‚¬ìš© ê°€ëŠ¥í•œ í‚¤ì›Œë“œë“¤ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. image from : MDS í…Œí¬ ROS 2ì—ì„œëŠ” interfaceë¼ëŠ” ì´ë¦„ìœ¼ë¡œ topic message, service srv, action actionì´ ì‚¬ìš©ë˜ì—ˆì§€ìš”. ì´ë“¤ì´ ëª¨ë‘ IDL íƒ€ì…ì„ ê°–ê¸° ë•Œë¬¸ì— rclpy, rclcpp, rcljava ëª¨ë‘ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²ƒì…ë‹ˆë‹¤.\ncustom interfaceë¥¼ ë¹Œë“œí•˜ê²Œ ë˜ë©´, í•´ë‹¹ íŒ¨í‚¤ì§€ ë‚´ë¶€ì— ìƒì„±ëœ IDLë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. build í´ë” ë‚´ë¶€ íŒ¨í‚¤ì§€ í´ë”ì— ì§„ì…í•˜ë©´ ì‚¬ì§„ê³¼ ê°™ì´ ë‹¤ì–‘í•œ ì–¸ì–´ë¥¼ ì§€ì›í•˜ê¸° ìœ„í•œ ì„¤ì • íŒŒì¼ë“¤ì´ ìœ„ì¹˜í•˜ëŠ” ê²ƒì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nrosidl_generator_py__arguments.json { \u0026#34;package_name\u0026#34;: \u0026#34;custom_interfaces\u0026#34;, \u0026#34;output_dir\u0026#34;: \u0026#34;/home/kimsooyoung/ros2_ws/build/custom_interfaces/rosidl_generator_py/custom_interfaces\u0026#34;, \u0026#34;template_dir\u0026#34;: \u0026#34;/opt/ros/foxy/share/rosidl_generator_py/cmake/../resource\u0026#34;, \u0026#34;idl_tuples\u0026#34;: [ \u0026#34;/home/kimsooyoung/ros2_ws/build/custom_interfaces/rosidl_adapter/custom_interfaces:action/Parking.idl\u0026#34;, \u0026#34;/home/kimsooyoung/ros2_ws/build/custom_interfaces/rosidl_adapter/custom_interfaces:srv/CircleTurtle.idl\u0026#34;, \u0026#34;/home/kimsooyoung/ros2_ws/build/custom_interfaces/rosidl_adapter/custom_interfaces:srv/TurtleJail.idl\u0026#34; ], \u0026#34;ros_interface_dependencies\u0026#34;: [ \u0026#34;action_msgs:/opt/ros/foxy/share/action_msgs/msg/GoalInfo.idl\u0026#34;, \u0026#34;action_msgs:/opt/ros/foxy/share/action_msgs/msg/GoalStatus.idl\u0026#34;, \u0026#34;action_msgs:/opt/ros/foxy/share/action_msgs/msg/GoalStatusArray.idl\u0026#34;, \u0026#34;action_msgs:/opt/ros/foxy/share/action_msgs/srv/CancelGoal.idl\u0026#34;, \u0026#34;builtin_interfaces:/opt/ros/foxy/share/builtin_interfaces/msg/Duration.idl\u0026#34;, \u0026#34;builtin_interfaces:/opt/ros/foxy/share/builtin_interfaces/msg/Time.idl\u0026#34;, \u0026#34;unique_identifier_msgs:/opt/ros/foxy/share/unique_identifier_msgs/msg/UUID.idl\u0026#34; ], ... ìƒì„±ëœ IDL íŒŒì¼ ë‚´ë¶€ë¥¼ í•¨ê»˜ ì‚´í´ë´…ì‹œë‹¤. custom_interfaces â‡’ rosidl_adapter â‡’ custom_interfaces â‡’ action í´ë” ë‚´ë¶€ì— ìœ„ì¹˜í•œ Parking.idlì€ ì•„ë˜ì™€ ê°™ì€ IDL í˜•íƒœë¥¼ ë„ê³  ìˆìŠµë‹ˆë‹¤.\nParking.idl // generated from rosidl_adapter/resource/action.idl.em // with input from custom_interfaces/action/Parking.action // generated code does not contain a copyright notice module custom_interfaces { module action { @verbatim (language=\u0026#34;comment\u0026#34;, text= \u0026#34;goal definition\u0026#34;) struct Parking_Goal { boolean start_flag; }; struct Parking_Result { @verbatim (language=\u0026#34;comment\u0026#34;, text= \u0026#34;result definition\u0026#34;) string message; }; struct Parking_Feedback { @verbatim (language=\u0026#34;comment\u0026#34;, text= \u0026#34;feedback definition\u0026#34;) float distance; }; }; }; DDSÂ RTPSÂ íŒ¨í‚· í™•ì¸í•´ë³´ê¸° (wireshark) DDS RTPSì˜ well-know UDP/IP\ndiscoveryê³¼ì •ì—ì„œ participantëŠ” ë¯¸ë¦¬ ì •ì˜ëœ ruleì— ë”°ë¼ addressì™€ portë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. SPDPì—ì„œëŠ” multicastì˜ addressë¡œ 239.255.0.1 ì„ ì‚¬ìš©í•˜ê³  ì•„ë˜ì™€ ê°™ì€ port ì„¤ì • ruleì„ ë”°ë¦…ë‹ˆë‹¤.\n=\u0026gt; ë”°ë¼ì„œ, wireshark ì‹¤í–‰ ì‹œ destination optionì„ 239.255.0.1ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.\nip.dst == 239.255.0.1 Publisherì™€ SubscriberëŠ” ì„œë¡œì˜ Participantì™€ Endpointë¥¼ ì°¾ê³ , ì£¼ê¸°ì ìœ¼ë¡œ HEARBEATì™€ ACKNACKë¥¼ ì£¼ê³ ë°›ìŠµë‹ˆë‹¤. ì´ë²ˆì—ëŠ” ROS 2 Publisherì™€ Subscriberë¥¼ ì‹¤í–‰ì‹œì¼œ ë³´ê³  ì´ë“¤ ì‚¬ì´ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ” ê³¼ì •ì—ì„œ RTPS í”„ë¡œí† ì½œì´ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€, íŒ¨í‚·ì˜ ë¶„ì„ì„ ì§„í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.\ní„°ë¯¸ë„ì„ ì‹¤í–‰í•˜ì—¬ topic publisherë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. $ ros2 run examples_rclcpp_minimal_publisher publisher_member_function [INFO] [1673789194.561595897] [minimal_publisher]: Publishing: \u0026#39;Hello, world! 0\u0026#39; [INFO] [1673789195.061600207] [minimal_publisher]: Publishing: \u0026#39;Hello, world! 1\u0026#39; [INFO] [1673789195.561601140] [minimal_publisher]: Publishing: \u0026#39;Hello, world! 2\u0026#39; [INFO] [1673789196.061605037] [minimal_publisher]: Publishing: \u0026#39;Hello, world! 3\u0026#39; [INFO] [1673789196.561602313] [minimal_publisher]: Publishing: \u0026#39;Hello, world! 4\u0026#39; ... publisher nodeê°€ ì¼ì • ì‹œê°„ë§ˆë‹¤ multicastë¡œ RTPS DATA(p)ë¥¼ ì†¡ì‹ í•˜ëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Publishí•˜ëŠ” DATA(p)ì—ëŠ” DEFAULT_UNITCAST_LOCATOR, DEFAULT_MULTICAST_LOCATOR, METATRAFFIC_UNICAST_LOCATER, METATRAFFIC_MUTICAST_LOCATORì •ë³´ ë“± particiapntì— ëŒ€í•œ ì •ë³´ê°€ ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤.\në”ë¶ˆì–´ í˜„ì¬ ì‚¬ìš©í•˜ê³  ìˆëŠ” Domain IDëŠ” 30ë²ˆì´ê¸° ë•Œë¬¸ì—, 14900í¬íŠ¸ë¥¼ Discovery Multicast Portë¡œ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.\ntopic sublisherë¥¼ ì‹¤í–‰í•˜ê³  ë‹¤ì‹œ íŒ¨í‚·ì„ ìˆ˜ì§‘í•©ë‹ˆë‹¤. $ ros2 run examples_rclcpp_minimal_subscriber subscriber_member_function [INFO] [1673790688.700183037] [minimal_subscriber]: I heard: \u0026#39;Hello, world! 1199\u0026#39; [INFO] [1673790689.200236939] [minimal_subscriber]: I heard: \u0026#39;Hello, world! 1200\u0026#39; [INFO] [1673790689.700209001] [minimal_subscriber]: I heard: \u0026#39;Hello, world! 1201\u0026#39; [INFO] [1673790690.200257339] [minimal_subscriber]: I heard: \u0026#39;Hello, world! 1202\u0026#39; [INFO] [1673790690.700230772] [minimal_subscriber]: I heard: \u0026#39;Hello, world! 1203\u0026#39; ... íŒ¨í‚· ì´ˆë°˜ë¶€ publisher nodeì™€ subscriber nodeëŠ” ì‚¬ì´ì˜ ì •ë³´ êµí™˜(PDP)ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. subscribe nodeì˜ ë“±ë¡ê³¼, reader/writer Entity ì‚¬ì´ PDPê°€ êµí™˜ë˜ë©°, Data(w)ëŠ” publisherì˜ ì •ë³´, Data(r)ì€ subscriberì˜ ì •ë³´ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. PDP ì´í›„ EDPëŠ” ë°ì´í„° íƒ€ì… ë“± Topicì— ëŒ€í•œ ì •ë³´, QoS Profileë“± ë§ì€ ì •ë³´ë¥¼ ë‹´ê³  ìˆê¸° ë•Œë¬¸ì— ìˆ˜ì°¨ë¡€ íŒ¨í‚· ì „ì†¡ì´ ì˜¤ê³ ê°‘ë‹ˆë‹¤. topic info verbose optionì„ ì‚¬ìš©í•˜ì—¬ topicì— ëŒ€í•œ ì •ë³´ì™€ íŒ¨í‚· ì •ë³´ë¥¼ ë¹„êµí•´ë´…ì‹œë‹¤.\n$ ros2 topic info /topic --verbose Type: std_msgs/msg/String Publisher count: 1 Node name: minimal_publisher Node namespace: / Topic type: std_msgs/msg/String Endpoint type: PUBLISHER GID: f9.f7.10.01.2b.c5.e1.c7.cd.59.7c.2a.00.00.15.03.00.00.00.00.00.00.00.00 QoS profile: Reliability: RMW_QOS_POLICY_RELIABILITY_RELIABLE Durability: RMW_QOS_POLICY_DURABILITY_VOLATILE Lifespan: 9223372036854775807 nanoseconds Deadline: 9223372036854775807 nanoseconds Liveliness: RMW_QOS_POLICY_LIVELINESS_AUTOMATIC Liveliness lease duration: 9223372036854775807 nanoseconds ... PDPì™€ EDPê°€ ëª¨ë‘ ëë‚˜ë©´, PublisherëŠ” ìì‹ ê³¼ ë§¤ì¹­ ëœ Subscriberì—ê²Œ Topicì„ Publishë¥¼ ì§„í–‰í•©ë‹ˆë‹¤. ì£¼ê¸°ì ìœ¼ë¡œ ì•„ë˜ ë‘ ì¢…ë¥˜ì˜ íŒ¨í‚·ì´ ë°˜ë³µë˜ëŠ” ê²ƒì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. publisherì˜ DATAì™€ HEARTBEAT íŒ¨í‚· subscriberì˜ HEARTBEAT ìˆ˜ì‹  ë° ACKNACK ì†¡ì‹  íŒ¨í‚· ROS 2 Domain ID DDS ì‹œê°„ ì‚´í´ë³¸ ë°”ì™€ ê°™ì´ ê° DDS Participantë“¤ì€ íŠ¹ì • Domainì— ì†í•˜ê²Œ ë©ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ROS 2ì—ì„œëŠ” Domain ID 0ì„ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë©°, ê°™ì€ Domain IDë¥¼ ì‚¬ìš©í•˜ëŠ” Participantë“¤ ì‚¬ì´ì—ì„œë§Œ Discoveryì™€ í†µì‹ ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nì´ë²ˆ ì‹œê°„ì—ëŠ” ROS 2ì˜ Domain IDë¥¼ ìˆ˜ì •í•´ë³´ê³ , Domain IDë¥¼ ì„¤ì •í•  ì‹œ ì£¼ì˜í•´ì•¼ í•  ì ë“¤ì— ëŒ€í•´ì„œë„ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.\nìš°ì„ , ì˜ˆì‹œë¥¼ í†µí•´ ì„œë¡œ ë‹¤ë¥¸ Domain IDë¥¼ ê°–ëŠ” Participantë“¤ì„ ì‹¤í–‰í•´ë´…ì‹œë‹¤. # Ternimal 1 ros2 topic pub -r 1 /string_topic std_msgs/String \u0026#34;{data: \\\u0026#34;Hello from my 2ND domain\\\u0026#34;}\u0026#34; # Terminal 2 ROS_DOMAIN_ID=1 ros2 topic list # Terminal 3 ros2 topic list ì˜ˆì‹œ ê²°ê³¼ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯ì´ í†µì‹ ì„ ìœ„í•´ì„œëŠ” ê°™ì€ Domain IDë¥¼ ê°–ëŠ” ì¡°ê±´ì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤. $ ros2 topic list /parameter_events /rosout /string_topic Domain IDëŠ” í™˜ê²½ë³€ìˆ˜ë¥¼ í†µí•´ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í„°ë¯¸ë„ì˜ ì‹¤í–‰ ì‹œ Domain IDë¥¼ ìë™ ì ìš©í•˜ê¸° ìœ„í•´ ~/.bashrcë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜ config.yamlì„ ìˆ˜ì •í•˜ì‹œë©´ ë©ë‹ˆë‹¤. export ROS_DOMAIN_ID=\u0026lt;your_domain_id\u0026gt; or # edit ~/ros_menu/config.yaml Config: menu_enable: true ros_option: menu default_ros_domain_id: 30 Menu: ... ROS 2 foxy: option_num: 2 ROS_version: 2 distro_name: foxy ros2_path: /opt/ros/foxy domain_id: # set if you don\u0026#39;t want to use default domain id cmds: DDSëŠ” Domain IDë¥¼ ì‚¬ìš©í•˜ì—¬ Participantë“¤ì´ ì‚¬ìš©í•  UDP Portë¥¼ ì§€ì •í•©ë‹ˆë‹¤. Portê°€ ê³„ì‚°ë˜ëŠ” ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ìœ¼ë©°, ë§í¬ë¥¼ ì°¸ê³ í•©ë‹ˆë‹¤. - ì¶”ê°€ ë§í¬ ROS 2 ê³µì‹ ë¬¸ì„œì—ì„œëŠ” Domain IDì™€ Participant ìˆœì„œì— ë”°ë¼ ì‚¬ìš©ë˜ëŠ” í¬íŠ¸ ë²ˆí˜¸ë¥¼ ê³„ì‚°í•´ì£¼ëŠ” ê³„ì‚°ê¸°ë¥¼ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ìµœëŒ€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” Domain IDì™€ Participant ìˆ˜ë¥¼ í™•ì¸í•´ ë³´ê² ìŠµë‹ˆë‹¤. - ê³µì‹ ë¬¸ì„œ ë§í¬ Domain ID ì„¤ì • ì‹œ ê³ ë ¤í•´ì•¼ í•  ìš”ì†Œë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nê° OS ë³„ë¡œ ì¹¨ë²”í•˜ë©´ ì•ˆë˜ëŠ” í¬íŠ¸ ì˜ì—­ì´ ìˆìŠµë‹ˆë‹¤. (Linux - 32768-60999 / Windows \u0026amp; macOS - 49152-65535) ê° Participantë‹¹ 2ê°œì˜ Unicast Portë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë”°ë¼ì„œ, í•˜ë‚˜ì˜ Domain IDì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìµœëŒ€ Participantì˜ ìˆ˜ëŠ” 120ê°œ ì…ë‹ˆë‹¤. (ROS 2ëŠ” í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì—¬ëŸ¬ Nodeë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— Nodeë¥¼ 120ê°œê¹Œì§€ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤.) ì´ëŸ¬í•œ ì´ìœ ë¡œ ROS 2 ê³µì‹ ë¬¸ì„œì—ì„œëŠ” 0-101 ì‚¬ì´ì˜ Domain IDë¥¼ ì‚¬ìš©í•˜ê¸°ë¥¼ ê¶Œì¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nROS RMWì™€ ë‹¤ì–‘í•œ DDS ë²¤ë”ë“¤ DDS ìì²´ëŠ” ì‚°ì—… í‘œì¤€ì´ë‹¤ë³´ë‹ˆ ë‹¤ì–‘í•œ ë²¤ë”ë“¤ì—ì„œ ì œê³µë˜ê³  ìˆìŠµë‹ˆë‹¤. ROS 2 ì„¤ì¹˜ ì‹œ ìë™ìœ¼ë¡œ Fast DDSê°€ ì‚¬ìš©ë˜ì§€ë§Œ, ì•„ë˜ í‘œì™€ ê°™ì´ ë‹¤ì–‘í•œ DDS ë²¤ë”ë“¤ì´ ì¡´ì¬í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nì´ë ‡ê²Œ ë‹¤ì–‘í•œ DDS ë²¤ë”ë“¤ì— ë§ì¶”ê¸° ìœ„í•´ ROS 2ëŠ” RMW(â€œROSÂ MiddleWare interfaceâ€)ë¼ëŠ” íŒ¨í‚¤ì§€ë“¤ì„ ì œê³µí•©ë‹ˆë‹¤. ë‹¤ë¥¸ ë²¤ë”ì˜ DDSë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ë©´, ì´ RMWë¥¼ ë°”ê¿”ì¤˜ì•¼ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.\nProduct name License RMW implementation Status eProsimaÂ Fast DDS Apache 2 rmw_fastrtps_cpp Full support. Default RMW. Packaged with binary releases. EclipseÂ Cyclone DDS Eclipse Public License v2.0 rmw_cyclonedds_cpp Full support. Packaged with binary releases. RTIÂ Connext commercial, research rmw_connext_cpp Full support. Support included in binaries, but Connext installed separately. GurumNetworksÂ GurumDDS commercial rmw_gurumdds_cpp Community support. Support included in binaries, but GurumDDS installed separately. ì˜¤í”ˆì†ŒìŠ¤ì¸ Fast DDS, Cyclone DDSëŠ” ë¬´ë£Œì´ì§€ë§Œ, ë” ì¢‹ì€ ì„±ëŠ¥ì„ ìœ„í•´ì„œëŠ” rtiì™€ ê°™ì€ ìœ ë£Œ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.\naptë¥¼ í†µí•´ ì†ì‰½ê²Œ rmwë¥¼ ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. $ sudo apt install ros-foxy-rmw ros-foxy-rmw ros-foxy-rmw-fastrtps-dynamic-cpp ros-foxy-rmw-connext-cpp ros-foxy-rmw-fastrtps-dynamic-cpp-dbgsym ros-foxy-rmw-connext-cpp-dbgsym ros-foxy-rmw-fastrtps-shared-cpp ros-foxy-rmw-connext-shared-cpp ros-foxy-rmw-fastrtps-shared-cpp-dbgsym ros-foxy-rmw-connext-shared-cpp-dbgsym ros-foxy-rmw-gurumdds-cpp ros-foxy-rmw-cyclonedds-cpp ros-foxy-rmw-gurumdds-cpp-dbgsym ros-foxy-rmw-cyclonedds-cpp-dbgsym ros-foxy-rmw-gurumdds-shared-cpp ros-foxy-rmw-dbgsym ros-foxy-rmw-gurumdds-shared-cpp-dbgsym ros-foxy-rmw-dds-common ros-foxy-rmw-implementation ros-foxy-rmw-dds-common-dbgsym ros-foxy-rmw-implementation-cmake ros-foxy-rmw-fastrtps-cpp ros-foxy-rmw-implementation-dbgsym ros-foxy-rmw-fastrtps-cpp-dbgsym ROS 2 ì‹œìŠ¤í…œ ìƒì—ì„œ ì‚¬ìš©í•˜ëŠ” DDS ë²¤ë”ë¥¼ ë°”ê¾¸ëŠ” ê²ƒì€ í™˜ê²½ë³€ìˆ˜ë¥¼ ì„¤ì •í•˜ëŠ” ê²ƒìœ¼ë¡œ ì†ì‰½ê²Œ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (í•´ë‹¹ DDSì™€ RMWê°€ ì„¤ì¹˜ë˜ì–´ ìˆë‹¤ëŠ” ê°€ì • í•˜ì—) ë”ë¶ˆì–´, ì„œë¡œ ë‹¤ë¥¸ ë²¤ë”ì˜ DDSë¥¼ ì‚¬ìš©í•˜ê³  ìˆë”ë¼ë„ DDS í‘œì¤€(SPDPì™€ SEDP)ì„ ë”°ë¥´ê³  ìˆë‹¤ë©´ ìƒí˜¸ í†µì‹ ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nExample - Fast DDS \u0026lt;\u0026gt; Cyclone DDS ìƒí˜¸ê°„ Topic í†µì‹  $ export RMW_IMPLEMENTATION=rmw_cyclonedds_cpp $ ros2 run demo_nodes_cpp listener [INFO]: I heard: [Hello World: 1] [INFO]: I heard: [Hello World: 2] [INFO]: I heard: [Hello World: 3] $ export RMW_IMPLEMENTATION=rmw_fastrtps_cpp $ ros2 run demo_nodes_cpp talker [INFO]: Publishing: \u0026#39;Hello World: 1\u0026#39; [INFO]: Publishing: \u0026#39;Hello World: 2\u0026#39; [INFO]: Publishing: \u0026#39;Hello World: 3\u0026#39; ì˜ˆì‹œì˜ ì‹¤í–‰ì—ì„œ ì§€ì—°ì´ ë°œìƒí•¨ìœ¼ë¡œ ì•Œ ìˆ˜ ìˆë“¯ì´, ì‹¤ì œ ì œí’ˆì„ ì œì‘í•  ë•ŒëŠ” ì‚¬ìš©í•˜ëŠ” RMWë¥¼ í†µì¼ì‹œì¼œì£¼ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.\nê°•ì˜ ê°œë°œí™˜ê²½ì—ì„œ ì œê³µí•˜ëŠ” ì„¤ì¹˜ íŠœí† ë¦¬ì–¼ì„ ë”°ë¼ì˜¤ì…¨ë‹¤ë©´ config.yaml íŒŒì¼ì„ ìˆ˜ì •í•¨ìœ¼ë¡œ ì†ì‰½ê²Œ DDS Vendorë¥¼ ë³€ê²½í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. $ gedit ~/ros_menu/config.yaml ROS 2 foxy: option_num: 2 ROS_version: 2 distro_name: foxy ros2_path: /opt/ros/foxy domain_id: # set if you don\u0026#39;t want to use default domain id cmds: # - source ${HOME}/ros2_ws/install/local_setup.${shell} - source_plugin dds_bashrc 1 # - source_plugin openvino_bashrc ì œê³µë˜ëŠ” ê¸°ë³¸ DDS Vendorë“¤ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.\nNumber DDS Vendor 0 Show Menu 1 Eclipse Cyclone DDS 2 OpenSplice 3 FastRTPS dds_bashrcë¥¼ 0ìœ¼ë¡œ ìˆ˜ì •í•œ ë‹¤ìŒ ìƒˆë¡œìš´ í„°ë¯¸ë„ì„ ì‹¤í–‰ì‹œí‚¤ë©´, ì•„ë˜ì™€ ê°™ì´ DDSë¥¼ ì„ íƒí•˜ëŠ” ì˜µì…˜ì´ ë“±ì¥í•©ë‹ˆë‹¤. 0) Do nothing 1) ROS 1 noetic 2) ROS 2 foxy 3) ROS2/ROS1_bridge Please choose an option: 2 ------------------------------------------------------ * ROS_DOMAIN_ID = 0 ------------------------------------------------------ source /home/kimsooyoung/.ros_menu/plugins_bashrc/dds_bashrc 0 **** Choose DDS you want to use **** 1) Eclipse Cyclone DDS 2) OpenSplice CE 3) FastRTPS Please choose an option 1-3: ì°¸ê³ ìë£Œ\nMDSí…Œí¬ ë¡œë´‡ ìš´ì˜ì²´ì œ ê°•ì¢Œ community.rti.com docs.ros.org https://github.com/ADLINK-IST/opensplice "
},
{
	"uri": "/kr/ros_basic_noetic/lecture1/",
	"title": "Lecture1 - Introduction to ROS",
	"tags": [],
	"description": "",
	"content": "What is ROS? ROSë€, ë¡œë´‡ ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œì— ì‚¬ìš©ë˜ëŠ” ì¼ì¢…ì˜ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.\ní”„ë ˆì„ì›Œí¬ë¼ëŠ” ë§ì€, ROS ë‚˜ë¦„ëŒ€ë¡œì˜ ì‹¤í–‰ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê°–ê³  ìˆë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.\nì‚¬ìš©ìì¸ ìš°ë¦¬ë“¤ì€, ì´ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œë´‡ì„ ë‹¤ë£¨ëŠ” ìš°ë¦¬ë§Œì˜ Applicationì„ ë§Œë“¤ê²Œ ë©ë‹ˆë‹¤.\nimage from : wikimedia ê·¸ëŸ°ë° ì™œ OSë¼ëŠ” ì´ë¦„ì´ ë¶™ê²Œ ë˜ì—ˆì„ê¹Œìš”?\në¡œë´‡ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œ, ìˆ˜ë§ì€ í”„ë¡œê·¸ë¨ë“¤ì´ ì‹¤í–‰ë˜ë©°, ROSëŠ” ì´ë“¤ ì‚¬ì´ì˜ ìš°ì„ ìˆœìœ„ì™€, í”„ë¡œê·¸ë¨ ì‚¬ì´ì˜ ë°ì´í„° íë¦„ì„ ì±…ì„ì§‘ë‹ˆë‹¤. ì´ ì‘ì—…ì€ ìŠ¤ì¼€ì¥´ë§ì´ë¼ê³  ë¶ˆë¦¬ë©°, ì´ëŸ¬í•œ ë™ì‘ì„ ìˆ˜í–‰í•˜ëŠ” ì‹œìŠ¤í…œì„ Operating Systemì´ë¼ê³  ë¶€ë¥´ê¸° ë•Œë¬¸ì— ROSë¼ëŠ” ì´ë¦„ì„ ê°–ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.\nimage from : tutorialspoint ë¡œë´‡ì„ ê°œë°œí•˜ê¸° ìœ„í•´ì„œ ì–´ë– í•œ í”„ë¡œê·¸ë¨ë“¤ì´ í•„ìš”í• ê¹Œìš”?\në¡œë´‡ì´ ìˆ˜í–‰í•˜ëŠ” ì„ë¬´ë“¤ì„ í¬ê²Œ 3ê°€ì§€ë¡œ ë¶„ë¥˜í•˜ë©´ ì¸ì§€, íŒë‹¨, ì œì–´ì˜ 3ê°€ì§€ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.\nì¸ì§€ë€, ì„¼ì„œë“¤ì„ í†µí•œ ë¬¼ì²´ ì¸ì§€, ìê¸° ìì‹ ì˜ ìœ„ì¹˜ì™€ ë°©í–¥ ì¸ì§€, ìƒí™© ì¸ì§€ ë“± ë¡œë´‡ì—ê²Œ ìˆì–´ í™˜ê²½ê³¼ ìƒí˜¸ì‘ìš©í•˜ëŠ” ê³¼ì •ì— í•´ë‹¹í•©ë‹ˆë‹¤. íŒë‹¨ì´ë€, ì•/ë’¤ë¡œ ì›€ì§ì¼ì§€, ë¡œë´‡ íŒ”ì„ ë»—ì„ì§€ì™€ ê°™ì´ ì¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì–»ì€ ë°ì´í„°ë¥¼ í†µí•´ ê²°ì •ì„ ë‚´ë¦¬ëŠ” ì‘ì—…ë“¤ì´ í•´ë‹¹í•  ê²ƒì…ë‹ˆë‹¤. ì œì–´ëŠ” ë¡œë´‡ì—ì„œ ë¹¼ë†“ì„ ìˆ˜ ì—†ëŠ” ì˜ì—­ìœ¼ë¡œ, ë¡œë´‡ì€ ì‹¤ì œ ì„¸ìƒì—ì„œ ì›€ì§ì´ê¸° ë•Œë¬¸ì—, ì–¼ë§ˆë‚˜ ì›€ì§ì¼ì§€, ì–´ëŠì •ë„ì˜ ì†ë„ë¡œ í˜ì€ ì–¼ë§ˆë‚˜ ê°•í•˜ê²Œ ì¤„ì§€ ë“± ë¬¼ë¦¬ì ì¸ ì„ë¬´ë¥¼ í¬í•¨í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ ë¡œë´‡ ì‹œìŠ¤í…œì€ ë¬´ì²™ ë³µì¡í•˜ë©°, ì´ë¿ë§Œ ì•„ë‹ˆë¼ íšŒë¡œ, ì„¤ê³„, ì¬ë£Œ, ì—ë„ˆì§€ ë“±ì„ ê³ ë ¤í•´ì•¼ í•˜ëŠ” ì™„ì„±í’ˆ ë¡œë´‡ì€ í˜„ëŒ€ ê³µí•™ì˜ ì§‘í•© ê·¸ ìì²´ë¼ê³  ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nAbout this lecture ì´ ê°•ì˜ì—ì„œ ë‹¤ë£¨ê³ ì í•˜ëŠ” ë¶€ë¶„ì„ ì •í™•íˆí•˜ìë©´, ì¸ì§€ë„ íŒë‹¨ë„ ì œì–´ë„ ì•„ë‹Œ, ì‹œìŠ¤í…œì…ë‹ˆë‹¤.\në¡œë´‡ì˜ ì„¼ì„œ, êµ¬ë™ë¶€, ì•Œê³ ë¦¬ì¦˜ì´ ëª¨ë‘ ì¤€ë¹„ë˜ì–´ ìˆëŠ” ìƒí™©ì—ì„œ, ì´ë“¤ì„ í•˜ë‚˜ì˜ ì‹œìŠ¤í…œìœ¼ë¡œ ì—®ì–´ì£¼ëŠ” ì—­í• ì„ í•˜ëŠ” ê²ƒì´ ë°”ë¡œ ROSì…ë‹ˆë‹¤.\nimage from : ROS Industrial ROSë¼ëŠ” ì‹œìŠ¤í…œì˜ íŠ¹ì„±ìƒ ì •í•´ì§„ ì½”ë“œì™€ ë°©ë²•ìœ¼ë¡œ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ê°œë°œí•´ì•¼ í•˜ë©°, ëŒ€ë¶€ë¶„ ROSë¥¼ ë‹¤ë£¨ëŠ” ê°•ì˜ë¼ê³  í•˜ë©´ ì´ë¥¼ ì§€ì¹­í•©ë‹ˆë‹¤. ìš°ë¦¬ê°€ ë°°ìš°ê³ ì í•˜ëŠ” ì£¼ëœ ë‚´ìš©ë„ ë°”ë¡œ ì´ ë¶€ë¶„ì´ë¼ê³  ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nROS ê°œë… ROS ì»¤ë©˜ë“œ ë‹¤ë£¨ê¸° ROS í”„ë¡œê·¸ë˜ë° - Topic, Service, Action etcâ€¦ í•˜ì§€ë§Œ, ì—¬ê¸°ì„œ ê·¸ì¹˜ì§€ ì•Šê³ , ì €ëŠ” ì¢€ ë” ì‹¤ì§ˆì ì¸ ë¡œë´‡ ê°œë°œì„ ì´ì•¼ê¸°í•˜ê³ ì í•©ë‹ˆë‹¤.\në¦¬ëˆ…ìŠ¤ ì‹œìŠ¤í…œ Docker ì‚¬ìš©í•˜ê¸° ë¡œë´‡ ì‹œë®¬ë ˆì´ì…˜ ë¼ì´ë¸Œ ì½”ë”©ê³¼ ì—ëŸ¬ ë””ë²„ê¹… í•™êµë¥¼ ë‹¤ë‹ˆë‹¤ ë³´ë©´ ì•„ë¬´ë¦¬ ë§ì€ ì´ë¡ ì„ ê³µë¶€í•˜ê³  ë¨¸ë¦¿ì†ì— ì§‘ì–´ë„£ì–´ë„, ì‹œí—˜ì„ ì¹˜ê³  ë‚˜ë©´ ëª¨ë‘ ì‚¬ë¼ì§€ê³¤ í•©ë‹ˆë‹¤. ë¨¸ë¦¬ ì†ì— ë‚¨ëŠ” ê³µë¶€ë¥¼ ìœ„í•´ì„œëŠ” ì§ì ‘ ì½”ë”©ì„ í•´ë³´ê³ , í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•´ë´ì•¼ í•©ë‹ˆë‹¤.\nê°•ì˜ë¥¼ ìˆ˜ê°•í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì„ ìˆ˜ì§€ì‹ ë³¸ ê°•ì˜ëŠ” ìµœëŒ€í•œ ë§ì€ ë¶„ë“¤ì´ ëê¹Œì§€ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, ìµœëŒ€í•œ ì‰½ê³ , í”„ë¡œê·¸ë˜ë° ì‹¤ë ¥ì´ ì¶œì¤‘í•˜ì§€ ì•Šì•„ë„ ëª¨ë‘ ì™„ê°•í•  ìˆ˜ ìˆê²Œ ì§„í–‰í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ê·¸ëŸ¼ì—ë„, ì•„ë˜ ì½”ë“œë¥¼ ì´í•´í•  ìˆ˜ ìˆì„ ì •ë„ì˜ ë°°ê²½ì§€ì‹ì€ í•„ìš”í•©ë‹ˆë‹¤. class OOPNode: def __init__(self): self.counter_ = 0 def hello_du(self, event=None): hello_du = f\u0026#34;hello du {rospy.get_time()}, counter: {self.counter_}\u0026#34; print(hello_du) self.counter_ += 1 def my_first_oop_node(): oop_node = OOPNode() if __name__ == \u0026#39;__main__\u0026#39;: try: my_first_oop_node() except Exception as e: print(e) íŒŒì´ì¬ í´ë˜ìŠ¤, ë©”ì†Œë“œì™€ ì¸ìŠ¤í„´ìŠ¤ for, while, if/else ë“± ê¸°ë³¸ ë¬¸ë²• ê°•ì˜ ì½”ë“œì™€ ê°•ì˜ ë…¸íŠ¸ ì‚¬ìš©ë²• ê°•ì˜ ë„ì¤‘ ì‚¬ìš©ë˜ëŠ” ì½”ë“œë“¤ì€ Github Repositoryë¥¼ í†µí•´ ë°°í¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì½”ë“œ ê°•ì˜ ì¤‘ ì§€ì†í•´ì„œ ë§í¬ë¥¼ í•´ë“œë¦¬ë©°, ê°•ì˜ ì‹œì‘ ì „ ë¯¸ë¦¬ ì‚´í´ë³´ì‹œë©´ ë”ìš± ì¢‹ìŠµë‹ˆë‹¤.\nhttps://github.com/RB2023ROS/du2023-ros1 ê°•ì˜ ë…¸íŠ¸ì˜ ì£¼ì†ŒëŠ” https://rb2023ros.github.io/kr/ ì…ë‹ˆë‹¤. ì½”ë“œì™€ ëª…ë ¹ì–´ ë“± í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ëª¨ë‘ ë‹´ê³  ìˆìœ¼ë¯€ë¡œ ë³µì‚¬/ë¶™ì—¬ë„£ê¸°ë¥¼ í™œìš©í•˜ì—¬ ê°•ì˜ ì²­ì·¨ ì‹œê°„ì„ ì ˆì•½í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.\nì°¸ê³ ë¡œ í•´ë‹¹ ë…¸íŠ¸ëŠ” hugoë¥¼ ì‚¬ìš©í•˜ì—¬ ì œì‘ëœ ì›¹ í˜ì´ì§€ì„ì„ ë°í™ë‹ˆë‹¤.\n"
},
{
	"uri": "/kr/ros_basic_noetic/lecture2/",
	"title": "Lecture2 - Dev Env Setup",
	"tags": [],
	"description": "",
	"content": "Develpoment Environment Setup í”„ë¡œì íŠ¸ ê¸°ë°˜ì˜ ê°•ì˜ì¸ ë§Œí¼, ê°œë°œ í™˜ê²½ì´ êµ¬ì¶•ë˜ì§€ ì•Šìœ¼ë©´ ì•ìœ¼ë¡œì˜ ì‹¤ìŠµì„ ì§„í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì´ë²ˆ íŒŒíŠ¸ì— ë§ì€ ì‹œê°„ì„ ë°°ì •í•˜ì˜€ê³ , í˜ë“¤ ìˆ˜ ìˆì§€ë§Œ ëê¹Œì§€ ë”°ë¼ì™€ì£¼ì‹œë©´ ê°ì‚¬í•©ë‹ˆë‹¤.\nì¤€ë¹„í•œ í™˜ê²½ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nUbuntu Linux ì„¤ì¹˜ì™€ ROS ì„¤ì • wsl2ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ Windows ë‚´ ROS ì„¤ì • Docker ê¸°ë°˜ì˜ ROS ì„¤ì • 1,2,3 ìˆœì„œë¡œ ì¶”ì²œí•˜ëŠ” ì„¤ì •ì…ë‹ˆë‹¤. 1ë²ˆì„ ì§„í–‰í•˜ì‹œë‹¤ê°€ ë„ì €íˆ ëª»í•˜ê² ìœ¼ë©´ 2ë²ˆìœ¼ë¡œ, ê·¸ë˜ë„ ì•ˆë˜ë©´ 3ë²ˆìœ¼ë¡œ ì§„í–‰í•´ ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.\nUbuntu Linux ì„¤ì¹˜ì™€ ROS ì„¤ì • Linuxë¼ê³  í•¨ì€ ì‚¬ì‹¤ OS ìì²´ë¼ê¸°ë³´ë‹¤ OSì˜ ê¸°ì´ˆê°€ ë˜ëŠ” ì½”ì–´ ì†Œí”„íŠ¸ì›¨ì–´ì— ê°€ê¹ìŠµë‹ˆë‹¤. ì´ ì½”ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ë²„ì „ì˜ OSê°€ ê°œë°œë˜ì—ˆìœ¼ë©° ì´ë¥¼ Liunx ë°°í¬íŒ ì´ë¼ê³  ì§€ì¹­í•©ë‹ˆë‹¤.\nUbuntu LinuxëŠ” ë¦¬ëˆ…ìŠ¤ ë°°í¬íŒ ì¤‘ ê°€ì¥ ë„ë¦¬ ì•Œë ¤ì§„ ë°°í¬íŒìœ¼ë¡œ, ì˜êµ­ì˜ SoftwareíšŒì‚¬ì¸ Canonicalê³¼ ìš°ë¶„íˆ¬ ì¬ë‹¨ì—ì„œ ê°œë°œ, ìœ ì§€ë³´ìˆ˜ ë° ë°°í¬ë¥¼ í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nimage from : omdriod.com ê¸°ì¡´ì˜ Windows ë…¸íŠ¸ë¶ì„ ì‚¬ìš©í•˜ê³  ìˆì—ˆë‹¤ë©´ ë“€ì–¼ ë¶€íŒ…ì´ë¼ëŠ” ê²ƒì„ í†µí•´ Ubuntu + Windowsë¥¼ ëª¨ë‘ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. ë“€ì–¼ ë¶€íŒ…ì— ë°©ë²•ì— ëŒ€í•´ì„  ì˜ ì„¤ëª…í•œ ì˜ìƒë“¤ì´ ë§ìœ¼ë¯€ë¡œ ë§í¬ë¡œ ëŒ€ì²´í•˜ê² ìŠµë‹ˆë‹¤.\nHow to Dual Boot Ubuntu 20.04 LTS and Windows 10 How to Dual Boot Ubuntu and Windows 11 Ubuntu 20.04 ì„¤ì¹˜ë¥¼ í™•ì¸ í•˜ì…¨ë‹¤ë©´ í„°ë¯¸ë„ì„ ì‹¤í–‰í•œ ë’¤ ì•„ë˜ì˜ ëª…ë ¹ì–´ë“¤ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.\nterminator ì„¤ì¹˜ sudo apt update sudo apt install terminator -y terminator í™”ë©´ ë¶„í•  ì˜ˆì‹œ\nctrl + alt + t : í„°ë¯¸ë„ ì‹¤í–‰ ctrl + shift + e : ì„¸ë¡œ ë¶„í•  ctrl + shift + o : ê°€ë¡œ ë¶„í•  ctrl + shift + w : ì°½ ë‹«ê¸° alt + í™”ì‚´í‘œ : ì°½ ê°„ ì´ë™ ROS / ROS 2 í•œì¤„ ì„¤ì¹˜ cd ~/ sh -c \u0026#34;$(curl -fsSL https://raw.githubusercontent.com/kimsooyoung/ros_menu/main/scripts/setup.sh)\u0026#34; â€¦ Do you want to install ROS automatically? (y/N): y ë‹¤ìŒìœ¼ë¡œ, ì‹œë®¬ë ˆì´ì…˜ í”„ë¡œê·¸ë¨ì¸ Gazeboë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤. GazeboëŠ” ROSë¥¼ ê´€ë¦¬í•˜ëŠ” ì¡°ì§ì¸ OSRFì—ì„œ ê³µì‹ ì§€ì›í•˜ëŠ” ë¡œë´‡ ì‹œë®¬ë ˆì´í„°ì…ë‹ˆë‹¤.\nsudo sh -c \u0026#39;echo \u0026#34;deb http://packages.osrfoundation.org/gazebo/ubuntu-stable `lsb_release -cs` main\u0026#34; /etc/apt/sources.list.d/gazebo-stable.list\u0026#39; wget https://packages.osrfoundation.org/gazebo.key -O - | sudo apt-key add - sudo apt update sudo apt install gazebo11 libgazebo11-dev -y sudo apt install ros-foxy-gazebo-ros-pkgs -y ê·¸ë¦¼ì™€ ê°™ì´ Gazeboì˜ í™”ë©´ì´ ì–´ë‘¡ê³ , ê·¸ë¦¼ìê°€ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤ë©´ í˜¸í™˜ë˜ëŠ” ê·¸ë˜í”½ ë“œë¼ì´ë²„ë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.\nsudo ubuntu-drivers autoinstall sudo reboot # ì¥ì°©ëœ ì¥ì¹˜ í™•ì¸ ubuntu-drivers devices ë§ˆì§€ë§‰ìœ¼ë¡œ, catkin build systemì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì•„ë˜ ì»¤ë©˜ë“œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.\nsudo apt update sudo apt install python3-catkin-tools Windows + WSL2 ì„¤ì • WSL(Windows Subsystem for Linux) ì´ë€, ë¦¬ëˆ…ìŠ¤ìš© ìœˆë„ìš° í•˜ìœ„ ì‹œìŠ¤í…œì˜ ì•½ìë¡œ, ìœˆë„ìš° 10ì—ì„œ ë„¤ì´í‹°ë¸Œë¡œ ë¦¬ëˆ…ìŠ¤ ì‹¤í–‰ íŒŒì¼(ELF)ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•œ í˜¸í™˜ì„± ê³„ì¸µì…ë‹ˆë‹¤.\nWindows10ë¶€í„° WSLì„ ì§€ì›í•˜ë©°, Windows 2004(20H1) versionë¶€í„° WLS2ë¥¼ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nìµœì‹  Windows ì—…ë°ì´íŠ¸ ì ìš© (\u0026ldquo;Windows Key â‡’ ì—…ë°ì´íŠ¸\u0026quot;ë¡œ ì´ë™í•˜ì—¬ ìµœì‹  ì—…ë°ì´íŠ¸ë¥¼ ì ìš©í•©ë‹ˆë‹¤.) powershellì„ ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰í•œ ë’¤, ì„¤ì¹˜ ë˜ì–´ìˆëŠ” WSL 2ë¥¼ í™œì„±í™”ì‹œí‚µë‹ˆë‹¤. \u0026gt; dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart ë°°í¬ ì´ë¯¸ì§€ ì„œë¹„ìŠ¤ ë° ê´€ë¦¬ ë„êµ¬ ë²„ì „: 10.0.19041.844 ì´ë¯¸ì§€ ë²„ì „: 10.0.19043.1348 ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •í•˜ëŠ” ì¤‘ [==========================100.0%==========================] ì‘ì—…ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. \u0026gt; dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart ë°°í¬ ì´ë¯¸ì§€ ì„œë¹„ìŠ¤ ë° ê´€ë¦¬ ë„êµ¬ ë²„ì „: 10.0.19041.844 ì´ë¯¸ì§€ ë²„ì „: 10.0.19043.1348 ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •í•˜ëŠ” ì¤‘ [==========================100.0%==========================] ì‘ì—…ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. MS Storeë¡œ ì´ë™í•˜ì—¬ windows terminalì„ ì„¤ì¹˜í•©ë‹ˆë‹¤. windows terminal í™”ë©´ ë¶„í•  ì˜ˆì‹œ alt + shift + - : ê°€ë¡œ ë¶„í•  alt + shift + + : ì„¸ë¡œ ë¶„í•  ctrl + shift + w : ì°½ ë‹«ê¸° alt + í™”ì‚´í‘œ : ì°½ ê°„ ì´ë™ ë‹¤ìŒ ë§í¬ë¥¼ í†µí•´ í”„ë¡œê·¸ë¨ì„ ë‹¤ìš´ë°›ê³  WSL 2 Linux ì»¤ë„ ì—…ë°ì´íŠ¸ë¥¼ ì„¤ì¹˜/ì§„í–‰ í›„ ì¬ë¶€íŒ…í•©ë‹ˆë‹¤.\nì»¤ë„ ì—…ë°ì´íŠ¸ë¥¼ ë§ˆì¹œ ë‹¤ìŒ, powershellì— ì•„ë˜ ì»¤ë§¨ë“œ ë¼ì¸ì„ ì…ë ¥í•˜ì—¬ WSL 2ë¥¼ ê¸°ë³¸ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.\n\u0026gt; wsl --set-default-version 2 WSL 2ì™€ì˜ ì£¼ìš” ì°¨ì´ì ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ https://aka.ms/wsl2ë¥¼ ì°¸ì¡°í•˜ì„¸ìš” ì‘ì—…ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. ì´ ì‹œì ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œë“¤ì„ í•œì°¨ë¡€ ì‚´í´ë³´ê³  ê°€ê² ìŠµë‹ˆë‹¤.\nwsl --set-default-version 2 ì—ì„œ ì‘ì—… ì™„ë£Œ ë©”ì„¸ì§€ê°€ ë“±ì¥í•˜ì§€ ì•ŠëŠ” ê²½ìš° â‡’ ì œì¼ ì²˜ìŒ ëª…ë ¹ì–´ë¶€í„° ì œê°€ ë³´ì—¬ë“œë¦° ì˜ˆì‹œì™€ ë™ì¼í•œ ê²°ê³¼ë¥¼ ì–»ì—ˆëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”\nLinuxìš© Windows í•˜ìœ„ ì‹œìŠ¤í…œ ì„¤ì • ì—¬ë¶€ë„ í™•ì¸í•©ë‹ˆë‹¤.\nì§€ê¸ˆê¹Œì§€ ì§„í–‰í•œ ì‘ì—…ë“¤ì´ ì œëŒ€ë¡œ ì„¤ì • ë˜ì–´ìˆëŠ”ì§€ í™•ì¸í•´ë´…ì‹œë‹¤. \u0026gt; wsl -l -v NAME STATE VERSION * Ubuntu-20.04 Running 2 ë¬¸ì œê°€ ì—†ë‹¤ë©´ MS Store ì§„ì… í›„, Ubuntu 20.04 ë²„ì „ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤. ì„¤ì¹˜ ì´í›„, ì—´ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ ì´ˆê¸° ì‹¤í–‰ì„ í•˜ê³  username, passwordë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.\nì´ ì‹œì ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œë“¤ë„ ë‹¤ì‹œ í•œì°¨ë¡€ ì‚´í´ë³´ê³  ê°€ê² ìŠµë‹ˆë‹¤.\nâ€˜The WSL Optional Component is not Enabled. Please Enable it and Try againâ€™ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ê²½ìš° \u0026gt; Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux 0x80370102 ì—ëŸ¬ê°€ ë°œìƒí•œ ê²½ìš° â‡’ ë¶€íŒ… BIOSì—ì„œ ê°€ìƒí™” ê¸°ëŠ¥ì„ í™œì„±í™”í•´ì¤ë‹ˆë‹¤.\n0xc03a001a ì—ëŸ¬ê°€ ë°œìƒí•œ ê²½ìš° â‡’ ë‹¤ìŒ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì„ ì°¸ê³ í•©ë‹ˆë‹¤.\nì„¤ì¹˜ ì´í›„ì—ëŠ” windows terminalì—ì„œ Ubuntu Terminalì„ ì„ íƒí•˜ì—¬ ì‹¤í–‰ ë° ì§„ì…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì„¤ì • íƒ­ì„ í†µí•´ Ubuntu 20.04ë¥¼ ê¸°ë³¸ í„°ë¯¸ë„ë¡œ ì„¤ì • í›„ ì €ì¥í•©ì‹œë‹¤.\nROS / ROS 2ë¥¼ í•œì¤„ ì„¤ì¹˜í•©ë‹ˆë‹¤. $ cd ~/ $ sh -c \u0026#34;$(curl -fsSL https://raw.githubusercontent.com/kimsooyoung/ros_menu/main/scripts/setup.sh)\u0026#34; Installing Neuron Startup Menu... Cloning into \u0026#39;/home/kimsooyoung/ros_menu\u0026#39;... remote: Enumerating objects: 583, done. remote: Counting objects: 100% (290/290), done. remote: Compressing objects: 100% (193/193), done. remote: Total 583 (delta 179), reused 173 (delta 93), pack-reused 293 Receiving objects: 100% (583/583), 154.50 KiB | 3.22 MiB/s, done. Resolving deltas: 100% (340/340), done. Do you want to install ROS automatically? (y/N): y ì„¤ì¹˜ê°€ ì™„ë£Œë˜ì—ˆë‹¤ë©´, ì•ìœ¼ë¡œ í„°ë¯¸ë„ì„ ìƒˆë¡œ ë“±ì¥ì‹œí‚¬ ë•Œë§ˆë‹¤ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•  ROS ë²„ì „ì„ ë¬»ê²Œ ë©ë‹ˆë‹¤. GUI ì¸í„°í˜ì´ìŠ¤ ì„¤ì • ë§í¬ë¥¼ í†µí•´ VcXsrvë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤. â‡’ https://sourceforge.net/projects/vcxsrv/ ì„¤ì¹˜ ì´í›„, XLaunchë¥¼ ì‹¤í–‰í•˜ê³ , ì‚¬ì§„ê³¼ ê°™ì€ ì„¤ì •ì„ ì§„í–‰í•©ë‹ˆë‹¤. ì•ìœ¼ë¡œ ì¬ë¶€íŒ… ì‹œë§ˆë‹¤ ì´ ì„¤ì •ì„ ë°˜ë³µí•´ì¤˜ì•¼ í•˜ë©°, ì¢…ì¢… Gazeboì˜ Memory Leakë¡œ ì¸í•´ í™”ë©´ì´ ì¢…ë£Œë˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìˆëŠ”ë°, ì´ëŸ° ê²½ìš° XLaunchë¥¼ ê°•ì œ ì¢…ë£Œí•´ì£¼ë©´ ë©ë‹ˆë‹¤.\nì„¤ì •ì´ ì˜ ë˜ì—ˆëŠ”ì§€ Gazeboë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. export GAZEBO_IP=127.0.0.1 export DISPLAY=$(cat /etc/resolv.conf | grep nameserver | awk \u0026#39;{print $2}\u0026#39;):0 export LIBGL_ALWAYS_INDIRECT=0 gazebo Gazeboì˜ ì‹¤í–‰ ì‹œ ê·¸ë˜í”½ ì¹´ë“œ ì¸ì‹ ë¬¸ì œê°€ ë°œìƒí•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì–´ë‘ìš´ í™”ë©´ì´ ë“±ì¥í•©ë‹ˆë‹¤.\nì´ëŸ¬í•œ ê²½ìš°, World íƒ­ â‡’ Scene â‡’ Shadows ì˜µì…˜ì„ í† ê¸€í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤. ë§ˆì§€ë§‰ì…ë‹ˆë‹¤! ~/.bashrcë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤. echo \u0026#39;export GAZEBO_IP=127.0.0.1\u0026#39; \u0026gt;\u0026gt; ~/.bashrc echo \u0026#34;export DISPLAY=$(cat /etc/resolv.conf | grep nameserver | awk \u0026#39;{print $2}\u0026#39;):0 \u0026#34; \u0026gt;\u0026gt; ~/.bashrc echo \u0026#39;export LIBGL_ALWAYS_INDIRECT=0\u0026#39; \u0026gt;\u0026gt; ~/.bashrc ë°œìƒí•  ìˆ˜ ìˆëŠ” ì˜¤ë¥˜ ìƒí™©ë“¤ì„ ì‚´í´ë³´ê³  ê°€ê² ìŠµë‹ˆë‹¤.\ngazebo ì‹¤í–‰ ì‹œ symbol error $ gazebo gazebo: symbol lookup error: /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9: undefined symbol: _ZN8ignition10fuel_tools12ClientConfig12SetUserAgentERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE í•´ê²° ë°©ë²• â‡’ sudo apt upgrade -y libignition-math2\nGazebo ìì²´ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ” ê²½ìš°\nPC ì¬ì‹œì‘ í›„ ë°±ì‹  í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œì‹œí‚µë‹ˆë‹¤. ì œì–´íŒ â‡’ ì‹œìŠ¤í…œ ë° ë³´ì•ˆ â‡’ Windows ë°©í™”ë²½ â‡’ ê³ ê¸‰ ì„¤ì • â‡’ ì¸ë°”ìš´ë“œ ê·œì¹™ â‡’ VcXsrv ì‚¬ìš© í—ˆìš©\nGazeboëŠ” ì‹¤í–‰ë˜ì§€ë§Œ, Grid (ì‹¤ì„ )ì´ ë“±ì¥í•˜ì§€ ì•ŠëŠ” ê²½ìš°\nì•ˆíƒ€ê¹ì§€ë§Œ ê·¸ë˜í”½ ë“œë¼ì´ë²„ ë¬¸ì œì¼ ê°€ëŠ¥ì„±ì´ í½ë‹ˆë‹¤. (Window â‡’ ì—…ë°ì´íŠ¸ í™•ì¸ ì§„ì… í›„ ê°€ì¥ ìµœì‹  ë²„ì „ìœ¼ë¡œ ëª¨ë‘ ì—…ê·¸ë ˆì´ë“œë¥¼ ì‹¤í–‰í•´ì¤ë‹ˆë‹¤.)\nDocker ê¸°ë°˜ì˜ ROS ì„¤ì • ì´ì „ ì„¤ì¹˜ ëª¨ë‘ ì‹¤íŒ¨í•˜ì‹  ê²½ìš° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìµœí›„ì˜ ë°©ë²•ì´ì. MacOS ì‚¬ìš©ìë“¤ì„ ìœ„í•œ ì„¤ì •ì…ë‹ˆë‹¤.\ndocker desktop for windowsë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤. â‡’ https://docs.docker.com/desktop/windows/install/ # ì„¤ì¹˜ í™•ì¸ \u0026gt; docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES ì„¤ì¹˜ í™•ì¸ ì´í›„ ë™ì¼í•œ ëª…ë ¹ í”„ë¡¬í”„íŠ¸ì—ì„œ ë‹¤ìŒ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì…ë ¥í•˜ì—¬ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë°›ìŠµë‹ˆë‹¤. (í•´ë‹¹ docker imageëŠ” ê°•ì˜ì— í•„ìš”í•œ ì‘ì—…ì„ ì œê°€ ë¯¸ë¦¬ ì¤€ë¹„í•´ë‘” ê²ƒì…ë‹ˆë‹¤.) docker pull tge1375/du_ros_noetic:0.0.0 docker ì´ë¯¸ì§€ë¥¼ ìµœì´ˆ ì‹¤í–‰ ì‹œ, ë°©ê¸ˆì˜ ëª…ë ¹ í”„ë¡¬í”„íŠ¸ì—ì„œ ì•„ë˜ì™€ ê°™ì€ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”. docker run -it -p 6080:80 --name ros_noetic tge1375/du_ros_noetic:0.0.0 ì…ë ¥ í›„ ë§í¬ë¥¼ í†µí•´ ë¡œì»¬ VNC ì„œë²„ë¡œ ì ‘ì†ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì²« ì‹¤í–‰ ì‹œ ë°©í™”ë²½ ë³´ì•ˆ ê²½ê³ ê°€ ë“±ì¥í•˜ë©°, ì´ë•Œ ë°˜ë“œì‹œ ì—‘ì„¸ìŠ¤ë¥¼ í—ˆìš©í•´ì¤ë‹ˆë‹¤. â‡’ (http://127.0.0.1:6080/) ìœ„ì™€ ê°™ì€ í™”ë©´ì´ ë“±ì¥í–ˆë‹¤ë©´ noVNCì— ì ‘ì†ì´ ì„±ê³µí•œ ê²ƒì…ë‹ˆë‹¤.\nìµœì´ˆ ëª…ë ¹ í”„ë¡¬í”„íŠ¸ì—ì„œ ì‹¤í–‰í•œ ì´í›„ ë‹¤ì‹œ ì‹¤í–‰ì‹œí‚¤ê³  ì‹¶ì€ ê²½ìš°, í˜¹ì€ ì¤‘ì§€ì‹œí‚¤ê³  ì‹¶ì€ ê²½ìš° docker desktopì„ ì‚¬ìš©í•˜ë©´ ë§¤ìš° í¸ë¦¬í•˜ê²Œ ì‘ì—…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. VScode ì…‹ì—… VNCë‚´ì—ì„œì˜ ê°œë°œì€ ë§¤ìš° ë¶ˆí¸í•˜ê¸° ë•Œë¬¸ì—, VScodeë¥¼ í†µí•´ ì½”ë“œ ê°œë°œì„ í•˜ê³ ì í•©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì€ extensionë“¤ì„ ì„¤ì¹˜í•©ì‹œë‹¤.\nDocker Docker Explorer Remote Development ì„¤ì¹˜ ì´í›„, cmd + pë¥¼ í†µí•´ Remote-Containersë¥¼ ì…ë ¥í•˜ë©´, í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆì˜ ëª©ë¡ì„ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì´ë“¤ ì¤‘ ì›í•˜ëŠ” ì»¨í…Œì´í„°ë¥¼ ì„ íƒí•˜ë©´, ìƒˆë¡œìš´ vscodeê°€ ìƒˆë¡œì´ ì‹¤í–‰ë˜ë©° ì‘ì—… í´ë”ë¥¼ ì„¤ì •í•˜ê²Œ ë©ë‹ˆë‹¤.\nLinux Commands ì…‹íŒ…í•œ í™˜ê²½ì€ ëª¨ë‘ ë¦¬ëˆ…ìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤.\në•Œë¬¸ì— ìµœì†Œí•œì˜ ë¦¬ëˆ…ìŠ¤ ì»¤ë©˜ë“œ ì§€ì‹ì´ í•„ìš”í•˜ë©°, ì§šê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.\në¦¬ëˆ…ìŠ¤ í•„ìˆ˜ ëª…ë ¹ì–´\ncd \u0026lt;ë””ë ‰í† ë¦¬\u0026gt; : í•´ë‹¹ ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•˜ê¸° (ì ˆëŒ€ ê²½ë¡œì™€ ìƒëŒ€ ê²½ë¡œ, ../ ì™€ ~/) pwd : í˜„ì¬ ìœ„ì¹˜í•œ ì ˆëŒ€ ê²½ë¡œ ls : í˜„ì¬ ë””ë ‰í† ë¦¬ì— ìœ„ì¹˜í•˜ëŠ” ëª¨ë“  íŒŒì¼ë“¤ (ls -al ì˜µì…˜) touch \u0026lt;íŒŒì¼ ì´ë¦„\u0026gt; : í•´ë‹¹ ì´ë¦„ì„ ê°€ì§„ íŒŒì¼ ìƒì„± source : ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰í•˜ê¸° (source ~/.bashrc) ê°•ì˜ë¥¼ ìœ„í•´ ì•Œì•„ì•¼ í•  ì¶”ê°€ ëª…ë ¹ì–´ë“¤\nsudo : root ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰í•˜ê¸° apt install / remove / purge : ë¦¬ëˆ…ìŠ¤ ë°°í¬ íŒ¨í‚¤ì§€ ì„¤ì¹˜ apt update : aptì˜ ìƒíƒœë¥¼ ìµœì‹ í™”, ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ë“¤ì„ ìµœì‹ í™”í•˜ëŠ” ê³¼ì •ì„ í¬í•¨í•¨ ê·¸ ì™¸ ì•Œì•„ë‘ë©´ ì¢‹ì€ ê²ƒë“¤\ntop / htop : ë¦¬ëˆ…ìŠ¤ì˜ ì‘ì—… ê´€ë¦¬ì ps aux : ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ ì¶œë ¥ (ps aux | grep ros) tee \u0026lt;íŒŒì¼ ì´ë¦„\u0026gt; : í„°ë¯¸ë„ ë¡œê·¸ë¥¼ ê¸°ë¡í•˜ê¸° xdg-open . : í˜„ì¬ ìœ„ì¹˜ì—ì„œ íŒŒì¼ íƒìƒ‰ê¸° ì—´ê¸° ê°•ì˜ ì¤‘ ì„¤ì •ëœ Alias ì„¤ëª…\neb : edit bashrcì˜ ì•½ìë¡œ ~/.bashrc íŒŒì¼ì„ geditì„ í†µí•´ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. sb : source bashrcì˜ ì•½ìë¡œ ìˆ˜ì •ëœ ~/.bashrc íŒŒì¼ì„ ë°˜ì˜ì‹œí‚µë‹ˆë‹¤. killg : ì‹¤í–‰ì¤‘ì¸ Gazeboê´€ë ¨ ëª¨ë“  í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œì‹œí‚µë‹ˆë‹¤. ìœ ìš©í•œ í”„ë¡œê·¸ë¨ë“¤ ì„¤ì¹˜í•˜ê¸°\nsudo apt install gedit sudo apt install terminator -y ì½”ë“œ ì—ë””í„°ì™€ IDE ì¶”ì²œ\nVSCode - https://code.visualstudio.com/ PyCharm - https://www.jetbrains.com/ko-kr/pycharm/download CLion - https://www.jetbrains.com/ko-kr/clion/ ì°¸ê³ ìë£Œ\nhttps://www.youtube.com/watch?v=DW7l9LHdK5c https://www.lainyzine.com/ko/article/how-to-install-wsl2-and-use-linux-on-windows-10/ https://github.com/Tiryoh/docker-ros2-desktop-vnc https://89douner.tistory.com/123 "
},
{
	"uri": "/kr/ros_basic_noetic/lecture3/",
	"title": "Lecture3 - Core of ROS",
	"tags": [],
	"description": "",
	"content": " ì§€ë‚œ ì‹œê°„ ê°œë°œí™˜ê²½ ì„¸íŒ…ì„ ì˜ ì§„í–‰í•˜ì˜€ëŠ”ì§€ í™•ì¸ì„ í•´ë³´ë©´ì„œ ê°•ì˜ë¥¼ ì‹œì‘í•´ë³´ê² ìŠµë‹ˆë‹¤.\ní„°ë¯¸ë„ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•œ ë’¤, gazeboë¥¼ ì‹¤í–‰í•´ ë´…ì‹œë‹¤.\ngazebo ìœ„ ì‚¬ì§„ê³¼ ê°™ì€ í™”ë©´ì´ ë‚˜ì˜¤ì§€ ì•Šì•˜ë‹¤ë©´ ì„¤ì¹˜ê°€ ì œëŒ€ë¡œ ë˜ì§€ ì•Šì€ ê²ƒì…ë‹ˆë‹¤. (sudo apt install libgazebo11 ì„ í†µí•´ ë‹¤ì‹œ ì„¤ì¹˜í•´ë´…ì‹œë‹¤.)\nAbout Gazebo Gazeboì˜ íŠ¹ì§•ê³¼ ê¸°ë³¸ì ì¸ UI, ê·¸ë¦¬ê³  ì‚¬ìš©ë²•ì„ ì§šê³  ë„˜ì–´ê°€ê³ ì í•©ë‹ˆë‹¤.\nimage from : Open Robotics GazeboëŠ” ë¡œë´‡ê³µí•™ì„ ìœ„í•´ ì œì‘ëœ ì „ìš© ë¬¼ë¦¬ ì—”ì§„ ê¸°ë°˜ì˜ ë†’ì€ 3D ì‹œë®¬ë ˆì´í„°ì…ë‹ˆë‹¤.\nROSë¥¼ ê´€ë¦¬í•˜ëŠ” Open Roboticsì—ì„œ ë¹„ë¡¯ëœ ì‹œë®¬ë ˆì´í„°ì¸ë§Œí¼ ROSì™€ ë†’ì€ í˜¸í™˜ì„±ì„ ìë‘í•©ë‹ˆë‹¤.\nGazeboëŠ” ì‹¤ì œ ë¡œë´‡ì„ ìœ„í•œ ì„¤ê³„ ê²€ì¦ í…ŒìŠ¤íŠ¸ì™€ ì‹œë®¬ë ˆì´ì…˜ì„ ìš©ì´í•˜ê²Œ í•˜ë©°, ìœˆë„ìš°, ë§¥, ë¦¬ëˆ…ìŠ¤ì—ì„œ ëª¨ë‘ ì‹¤í–‰ë˜ì§€ë§Œ ëŒ€ë¶€ë¶„ ë¦¬ëˆ…ìŠ¤ ì‹œìŠ¤í…œì—ì„œ ROSì™€ í•¨ê»˜ ì‚¬ìš©ë©ë‹ˆë‹¤.\nâ‡’ ì´í›„ Gazebo ì‚¬ìš© ë° ì˜¤ë¥˜ ë°œìƒ ì‹œ ë””ë²„ê¹…ì„ ìœ„í•´, Gazeboë¥¼ êµ¬ì„±í•˜ëŠ” ìš”ì†Œë“¤ì„ ê°„ë‹¨í•˜ê²Œ ì§šê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.\ngzserver \u0026amp; gzclient GazeboëŠ” Socket-Based Communicationì„ ê°–ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì„œë²„ì™€ Clientë¥¼ ë¶„ë¦¬í•˜ì—¬ ì‹¤í–‰ ê°€ëŠ¥í•˜ë©° ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œì˜ ì‹¤í–‰ í›„ ì—°ë™ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nGazebo Server gzserverëŠ” Gazebo ë™ì‘ì˜ ëŒ€ë¶€ë¶„ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì‹œë®¬ë ˆì´ì…˜í•˜ë ¤ëŠ” ì¥ë©´ê³¼ ê·¸ ì•ˆì— ìˆëŠ” ê°œì²´ íŒŒì¼ì„ ë¶„ì„í•˜ê³ , ê·¸ëŸ° ë‹¤ìŒ ë¬¼ë¦¬ ì—”ì§„ê³¼ ì„¼ì„œ ì—”ì§„ì„ ì‚¬ìš©í•˜ì—¬ ì „ì²´ ì¥ë©´ì„ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤.\ní„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ ì„œë²„ë¥¼ ë…ë¦½ì ìœ¼ë¡œ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n$ gzserver Gazebo Client gzclientëŠ” gzserverì— ì—°ê²°í•˜ì—¬ ëŒ€í™”í˜• ë„êµ¬ì™€ í•¨ê»˜ ì‹œë®¬ë ˆì´ì…˜ì„ ë Œë”ë§í•˜ëŠ” Graphic Clientë¥¼ ì œê³µí•©ë‹ˆë‹¤.\në‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ gzclientë¥¼ ë‹¨ë…ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n$ gzclient clientë§Œ ì‹¤í–‰í•˜ë©´, ì—°ê²°ë˜ê³  ëª…ë ¹ì„ ìˆ˜ì‹ í•  ì„œë²„ê°€ ì—†ê¸° ë•Œë¬¸ì— (ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤ë¥¼ ì†Œë¹„í•˜ëŠ” ê²ƒì„ ì œì™¸í•˜ê³ ) ì•„ë¬´ ê²ƒë„ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\nCombining Gazebo Server and Gazebo Client gzserverë¥¼ ë¨¼ì € ì‹¤í–‰í•œ ë‹¤ìŒ gzclientë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ë©°, ë Œë”ë§í•˜ê¸° ì „ì— ì‹œë®¬ë ˆì´ì…˜ ì¥ë©´, ê°ì²´ ê´€ë ¨ íŒŒë¼ë¯¸í„°ë¥¼ ì´ˆê¸°í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\ngazebo ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ë©´ ë‚´ë¶€ì ìœ¼ë¡œ serverì™€ clientê°€ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.\n$ gazebo ì´ëŸ¬í•œ ì´ìœ ë¡œ Gazeboë¥¼ ì¢…ë£Œí–ˆë‹¤ê³  ìƒê°í•˜ì§€ë§Œ gzserverê°€ ê¹”ë”í•˜ê²Œ ì¢…ë£Œë˜ì§€ ì•ŠëŠ” ìƒí™©ì´ ë°œìƒí•©ë‹ˆë‹¤. â‡’ killgë¥¼ ì‚¬ìš©í•©ì‹œë‹¤!\nWorld Fileê³¼ Model File image from : dronecode World Files Gazebo world fileì—ëŠ” ë¡œë´‡ ëª¨ë¸, í™˜ê²½, ì¡°ëª…, ì„¼ì„œ, ë‹¤ë¥¸ ê¸°íƒ€ ë¬¼ì²´ë“¤ê¹Œì§€ ì‹œë®¬ë ˆì´ì…˜ í™˜ê²½ì˜ ëª¨ë“  ìš”ì†Œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ í™•ì¥ìëª… .worldë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\nì•„ë˜ ì˜ˆì‹œì™€ ê°™ì´ Gazebo ì‹¤í–‰ ì‹œ world íŒŒì¼ì„ ì˜µì…˜ìœ¼ë¡œ í•˜ì—¬ ì‹¤í–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n$ gazebo \u0026lt;yourworld\u0026gt;.world Model Files Gazeboì˜ WorldëŠ” ë‹¤ì–‘í•œ Modelë“¤ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ Modelë§Œì„ ê°€ì§€ê³  gazeboë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤. (gazebo ì´ë ‡ê²ŒëŠ” ë¶ˆê°€í•©ë‹ˆë‹¤.)\nëª¨ë¸ì„ ë³„ë„ì˜ íŒŒì¼ë¡œ ë³´ê´€í•˜ëŠ” ì´ìœ ëŠ” ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì— ì¬ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œì´ë©°, ë¡œë´‡ì˜ ëª¨ë¸ íŒŒì¼ ë˜ëŠ” ë‹¤ë¥¸ ëª¨ë¸ì„ ì›”ë“œ íŒŒì¼ ë‚´ì— í¬í•¨í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ íƒœê·¸ë¥¼ í†µí•´ import í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\u0026lt;include\u0026gt; \u0026lt;uri\u0026gt;model://model_file_name\u0026lt;/uri\u0026gt; \u0026lt;/include\u0026gt; Environment Variables Gazeboì— World, Modelì„ ì—°ë™í•˜ê³ , gzserverì™€ gzclient ê°„ í†µì‹ ì„ ì„¤ì •í•˜ê¸° ì‚¬ìš©í•˜ëŠ” ë§ì€ í™˜ê²½ ë³€ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤.\nì˜ˆë¥¼ ë“¤ì–´, GAZEBO_MODEL_PATHëŠ” Gazeboê°€ ëª¨ë¸ íŒŒì¼ì„ ê²€ìƒ‰í•  ì‹œ ì°¸ì¡°í•˜ëŠ” ê²½ë¡œì…ë‹ˆë‹¤.\nPlugins Gazeboì˜ World, Modelì— ì¥ì°©ë˜ëŠ” ê°ì¢… ì„¼ì„œì™€ ì œì–´ë¥¼ ìœ„í•œ ë‹¤ì–‘í•œ í”ŒëŸ¬ê·¸ì¸ì´ ì¤€ë¹„ë˜ì–´ ìˆìœ¼ë©°, ì´ëŸ¬í•œ í”ŒëŸ¬ê·¸ì¸ì€ ì»¤ë©˜ë“œ ë¼ì¸ì—ì„œ ë¡œë“œí•˜ê±°ë‚˜ SDF íŒŒì¼ ë‚´ë¶€ì— ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ìì²´ Pluginì„ ê°œë°œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.)\nUnderstanding Gazebo GUI ì´ë²ˆì—ëŠ” Gazeboì˜ ê¸°ë³¸ ì¡°ì‘ ë°©ë²•ê³¼ ë‚´ì¥ Toolë“¤ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nìš°ì„  Gazeboë¥¼ ì‹¤í–‰ì‹œí‚µë‹ˆë‹¤. $ gazebo Gazeboì˜ ì‹œì  ë³€í™˜ì€ ë§ˆìš°ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì†ì‰½ê²Œ ì¡°ì‘ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë§ˆìš°ìŠ¤ ì™¼ìª½ ë²„íŠ¼ì„ ëˆ„ë¥´ê³  ë“œë˜ê·¸í•˜ë©´ ì‹œì ì„ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§ˆìš°ìŠ¤ íœ ì„ ëˆ„ë¥¸ ìƒíƒœë¡œ ì´ë™ì‹œí‚¤ë©´ íšŒì „ ì‹œì ì„ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìµœìƒë‹¨ì— ìœ„ì¹˜í•œ Top Toolbarë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ì™¼ìª½ë¶€í„° ì˜¤ë¥¸ìª½ ìˆœì„œëŒ€ë¡œ ê° ì•„ì´ì½˜ ë³„ ê¸°ëŠ¥ì„ ì„¤ëª…í•´ë³´ê² ìŠµë‹ˆë‹¤.\nSelect mode Select modeëŠ” ê°€ì¥ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì»¤ì„œ ëª¨ë“œì…ë‹ˆë‹¤. ì¥ë©´ì„ íƒìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nTranslate mode ì»¤ì„œ ëª¨ë“œë¥¼ ì„ íƒí•œ ë‹¤ìŒ ì´ë™ì‹œí‚¤ê¸¸ ì›í•˜ëŠ” ê°ì²´ë¥¼ í´ë¦­í•©ë‹ˆë‹¤. ì´í›„ ë“±ì¥í•˜ëŠ” 3ì¶• ì¤‘ ì ì ˆí•œ ì¶•ì„ ì‚¬ìš©í•˜ì—¬ ê°œì²´ë¥¼ ì›í•˜ëŠ” ìœ„ì¹˜ë¡œ ëŒê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.\nRotate mode translate modeì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì´ ì»¤ì„œ ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì£¼ì–´ì§„ ëª¨ë¸ì˜ ë°©í–¥ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nScale mode Scale modeë¥¼ ì‚¬ìš©í•˜ë©´ ê°ì²´ì˜ ì „ì²´ í¬ê¸°ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nUndo/Redo ì•,ë’¤ë¡œ ë˜ëŒë¦¬ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.\nSimple shapes íë¸Œ, êµ¬ì²´ ë˜ëŠ” ì‹¤ë¦°ë”ì™€ ê°™ì€ ê¸°ë³¸ 3D ëª¨ë¸ì„ í™˜ê²½ì— ì‚½ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nLights ìŠ¤í¬íŠ¸ë¼ì´íŠ¸, í¬ì¸íŠ¸ ë¼ì´íŠ¸ ë˜ëŠ” ë°©í–¥ì´ ì •í•´ì§„ ì¡°ëª…ê³¼ ê°™ì€ ë‹¤ì–‘í•œ ê´‘ì›ì„ í™˜ê²½ì— ì¶”ê°€í•©ë‹ˆë‹¤.\nCopy/Paste ëª¨ë¸ì„ ë³µì‚¬/ë¶™ì—¬ë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (Ctrl+C/Vë¥¼ í†µí•´ì„œë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.)\nAlign ì´ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ë©´ x y z ì¶• ì¤‘ í•˜ë‚˜ë¥¼ ë”°ë¼ í•œ ëª¨í˜•ì„ ë‹¤ë¥¸ ëª¨ë¸ê³¼ ì •ë ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\në˜ëŠ” ë‘ ëª¨ë¸ì„ íŠ¹ì •í•œ ë©´ ê¸°ë°˜ìœ¼ë¡œ ì„œë¡œ ë¶™ì´ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nChange view ìƒë‹¨ ë·°, ì¸¡ë©´ ë·°, ì „ë©´ ë·°, í•˜ë‹¨ ë·°ì™€ ê°™ì€ ë‹¤ì–‘í•œ ê´€ì ì—ì„œ ì¥ë©´ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\në‹¤ìŒìœ¼ë¡œ Side Panelì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nWorld í˜„ì¬ ì‚¬ìš©ì¤‘ì¸ ì¡°ëª… ë° ëª¨ë¸ë“¤ì´ í‘œì‹œë©ë‹ˆë‹¤. ê°œë³„ ëª¨ë¸ì„ í´ë¦­í•˜ì—¬ ìœ„ì¹˜ ë° ë°©í–¥ê³¼ ê°™ì€ ëª¨ë¸ì˜ ê¸°ë³¸ íŒŒë¼ë¯¸í„°ë¥¼ ë³´ê±°ë‚˜ í¸ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ë¬¼ë¦¬ ì˜µì…˜ì„ í†µí•´ ì¤‘ë ¥ ë° ìê¸°ì¥ê³¼ ê°™ì€ ë¬¼ì„±ì¹˜ë„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. GUI ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´ ê¸°ë³¸ ì¹´ë©”ë¼ ë·° ê°ë„ ë° í¬ì¦ˆì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nInsert ì¶”ê°€í•  ëª¨ë¸ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í™˜ê²½ ë³€ìˆ˜ì— ì§€ì •ëœ í´ë”ì—ì„œ ëª¨ë¸ë“¤ì„ ê²€ìƒ‰í•œ ë’¤ ë°°ì¹˜í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë©°, í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ì—†ì´ë„ Add Path ì˜µì…˜ì„ í†µí•´ ì •í•´ì§„ í¬ë©§ì„ ê°–ëŠ” ëª¨ë¸ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\në‹¤ì‹œ ë³¸ë¡ ìœ¼ë¡œ ëŒì•„ì™€ì„œ, ROS ì„¤ì¹˜ëŠ” ì˜ ë˜ì—ˆëŠ”ì§€ë„ í™•ì¸í•´ë´…ì‹œë‹¤.\n# Terminal 1 roscore # Terminal 2 rosrun rospy_tutorials talker ëª¨ë“  í™•ì¸ì´ ëë‚¬ë‹¤ë©´, ì˜ˆì œ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰ì‹œì¼œë³´ê² ìŠµë‹ˆë‹¤.\nHusky Gazebo ì˜ˆì œ íŒ¨í‚¤ì§€ ì„¤ì¹˜ sudo apt-get update sudo apt-get install ros-noetic-husky-desktop sudo apt-get install ros-noetic-husky-simulator ì˜ˆì œ í”„ë¡œê·¸ë¨ ì‹¤í–‰ # Terminal 1 roslaunch husky_gazebo husky_empty_world.launch # Terminal 2 roslaunch husky_viz view_robot.launch # Terminal 3 rosrun teleop_twist_keyboard teleop_twist_keyboard.py cmd_vel:=/husky_velocity_controller/cmd_vel Terminal 1ì—ì„œ ë°œìƒí•˜ëŠ” ì•„ë˜ ì˜¤ë¥˜ëŠ” ë¬´ì‹œí•´ë„ ì¢‹ìŠµë‹ˆë‹¤.\nëª¨ë“  ì‹¤í–‰ì´ ì •ìƒ ë™ì‘í•˜ì˜€ë‹¤ë©´, Terminal 3ì—ì„œ í‚¤ë³´ë“œë¥¼ í†µí•´ Huskyë¥¼ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¡œë´‡ì´ ì›€ì§ì„ì— ë”°ë¼ ë‘ë²ˆì§¸ í„°ë¯¸ë„ ê²°ê³¼ì˜€ë˜ Rvizì— ì•„ë˜ì™€ ê°™ì€ ë³€í™”ê°€ ìƒê¹ë‹ˆë‹¤. ë‹¤ìŒìœ¼ë¡œ, ìƒˆë¡œìš´ í„°ë¯¸ë„ì—ì„œ ì•„ë˜ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì‹¤í–‰ì‹œì¼œ ë´…ì‹œë‹¤. rosrun rqt_graph rqt_graph ìœ„ ê·¸ë¦¼ì€ ë°©ê¸ˆ ì „ ì‹¤í–‰í•œ ì˜ˆì œ ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë– í•œ ë™ì‘ë“¤ì´ ì´ë£¨ì–´ì§€ê³  ìˆì—ˆëŠ”ì§€ë¥¼ ë³´ì—¬ì£¼ëŠ” ê²ƒìœ¼ë¡œ, ê°•ì˜ë¥¼ ë§ˆì¹  ë•Œë©´ ì—¬ëŸ¬ë¶„ë“¤ì€ ìœ„ ê·¸ë¦¼ì´ ì–´ë– í•œ ì˜ë¯¸ë¥¼ ê°–ëŠ”ì§€ ëª¨ë‘ ì´í•´í•˜ì‹¤ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.\në‹¤ìŒìœ¼ë¡œ, í„°ë¯¸ë„ì„ ìƒˆë¡œ ì‹¤í–‰ì‹œì¼œ rosnode listì™€ rostopic listë¥¼ ì‹¤í–‰ì‹œì¼œ ë´…ì‹œë‹¤.\nrosnode list $ rosnode list /base_controller_spawner /ekf_localization /gazebo /gazebo_gui /joy_teleop/joy_node /joy_teleop/teleop_twist_joy /robot_state_publisher /rosout /teleop_twist_keyboard /twist_marker_server /twist_mux rostopic list $ rostopic list /clock /cmd_vel /diagnostics /e_stop /gazebo/link_states /gazebo/model_states /gazebo/parameter_descriptions /gazebo/parameter_updates /gazebo/performance_metrics /gazebo/set_link_state /gazebo/set_model_state ... ì•ìœ¼ë¡œì˜ ê°•ì˜ë“¤ì—ì„œ, ìœ„ ëª…ë ¹ì–´ë“¤ì´ ì–´ë– í•œ ì˜ë¯¸ë¥¼ ê°–ëŠ”ì§€ í•˜ë‚˜í•˜ë‚˜ì”© í•¨ê»˜ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nROS Node ROSëŠ” ê° í”„ë¡œì„¸ìŠ¤ë“¤ì„ Nodeë¼ëŠ” ë‹¨ìœ„ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤.\në¡œë´‡ì„ ì›€ì§ì´ëŠ” Node, ì„¼ì„œì™€ í†µì‹ í•˜ëŠ” Node, ì‹œê°í™” Node ë“± ë‹¤ì–‘í•œ Nodeë“¤ì´ ì–½í˜€ ë¡œë´‡ ì‹œìŠ¤í…œì„ êµ¬ì„±í•˜ê²Œ ë©ë‹ˆë‹¤. Nodeë“¤ ì‚¬ì´ì—ëŠ” ë°ì´í„°ì˜ ì†¡ìˆ˜ì‹ ì´ í•„ìš”í•©ë‹ˆë‹¤. ì´ë¥¼ ë‹´ë‹¹í•˜ëŠ” ROSì˜ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ë“¤ì´ ìˆìœ¼ë©° ê°ê¸° ë‹¤ë¥¸ íŠ¹ì„±ì„ ê°–ê³  ìˆìŠµë‹ˆë‹¤. Nodeë“¤ë¼ë¦¬ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ê¸° ìœ„í•´ì„œëŠ” ì–´ë–¤ ë…¸ë“œê°€ ì¡´ì¬í•˜ëŠ”ì§€, idëŠ” ëª‡ë²ˆì¸ì§€ ë“±ì˜ ì •ë³´ê°€ ê³µìœ ë˜ì–´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤. ì•„ë˜ ê·¸ë¦¼ì˜ ROS Masterê°€ ì´ë¥¼ ê´€ë¦¬í•´ì£¼ëŠ” ê²ƒì´ë¼ê³  ì´í•´í•˜ì‹œë©´ ë©ë‹ˆë‹¤. image from : clearpathrobotics ê·¸ë ‡ë‹¤ë©´, ë°©ê¸ˆ ìš°ë¦¬ê°€ ì‹¤í–‰í•œ ì˜ˆì‹œì—ì„œë„ ROS Masterì™€ Nodeë“¤ì´ ì‹¤í–‰ë˜ì—ˆê² êµ°ìš”!\nì‹¤í–‰ë˜ëŠ” Nodeë¥¼ í™•ì¸í•˜ëŠ” ë°©ë²•ì€ í¬ê²Œ ë‘ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.\nrosnode command $ rosnode list /base_controller_spawner /ekf_localization /gazebo /gazebo_gui /joy_teleop/joy_node /joy_teleop/teleop_twist_joy /robot_state_publisher /rosout /teleop_twist_keyboard /twist_marker_server /twist_mux rqt_graph rosrun rqt_graph rqt_graph rqt graphë¥¼ ì‚´í´ë³´ë©´, ë™ê·¸ë€ Nodeì™€ Nodeë“¤ ì‚¬ì´ì˜ ë°ì´í„° ì†¡ìˆ˜ì‹ ì´ í™”ì‚´í‘œë¡œ í‘œí˜„ëœ ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í‚¤ë³´ë“œë¥¼ í†µí•´ ì œì–´ ë°ì´í„°ë¥¼ ì†¡ì‹ í•˜ëŠ” teleop_twist_keyboardëŠ” gazebo nodeë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ê³  ìˆìœ¼ë©°, ë”°ë¼ì„œ gazeboëŠ” ì´ ë°ì´í„°ë¥¼ í†µí•´ ì‹¤ì œ ë¡œë´‡ì„ ì›€ì§ì´ê²Œ ë˜ëŠ” ê²ƒì…ë‹ˆë‹¤.\níŠ¹ì • Nodeì— ëŒ€í•´ì„œ ë” ìì„¸í•œ ì •ë³´ë¥¼ ì–»ê³  ì‹¶ë‹¤ë©´, rosnode info ì»¤ë§¨ë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. $ rosnode info /base_controller_spawner -------------------------------------------------------------------------------- Node [/base_controller_spawner] Publications: * /rosout [rosgraph_msgs/Log] Subscriptions: * /clock [rosgraph_msgs/Clock] Services: * /base_controller_spawner/get_loggers * /base_controller_spawner/set_logger_level contacting node http://192.168.55.236:33811/ ... Pid: 63764 Connections: * topic: /rosout * to: /rosout * direction: outbound (43329 - 192.168.55.236:34456) [10] * transport: TCPROS * topic: /clock * to: /gazebo (http://192.168.55.236:33853/) * direction: inbound * transport: TCPROS ì´ì „ ì˜ˆì œë“¤ì€ ì¼ë‹¨ ì¢…ë£Œì‹œí‚¨ ë’¤, ê°„ë‹¨í•œ ìƒˆë¡œìš´ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤.\n# Terminal 1 roscore # Terminal 2 rosrun roscpp_tutorials talker # Terminal 3 rosrun roscpp_tutorials listener # Terminal 4 rqt_graph rqt_graphë¥¼ ë³´ë©´ talker â‡’ listenerë¡œ ë°ì´í„°ê°€ ì „ì†¡ë˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì´ì œ, rqt_graphë¥¼ ë³´ëŠ” ê²ƒì€ ìµìˆ™í•´ì¡Œì§€ìš”?\nì²«ë²ˆì§¸ Gazebo ì˜ˆì‹œì™€ ë‹¤ë¥¸ ì ìœ¼ë¡œ roscoreë¼ëŠ” ê²ƒì„ ì‹¤í–‰í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.\nroscoreëŠ” ROS Masterë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” ëª…ë ¹ì–´ë¡œ ëª¨ë“  ROS Nodeë“¤ì€ Masterì— ì˜í•´ ê´€ë¦¬ë˜ê¸° ë•Œë¬¸ì— roscoreë¥¼ í†µí•´ ì‹¤í–‰ì‹œí‚¤ê±°ë‚˜, roslaunchë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ROS Masterê°€ ì‹¤í–‰ë˜ê³  ìˆì§€ ì•Šë‹¤ë©´, ì•„ë˜ì™€ ê°™ì´ ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤. ETH Super Mega Bot \u0026amp; ROS Workspace ROSëŠ” catkinì´ë¼ëŠ” ë¹Œë“œ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ê¸°ì¡´ c/c++ cross-platform ê°œë°œì„ ê²½í—˜í•˜ì…¨ë‹¤ë©´ cmakeì— ìµìˆ™í•˜ì‹¤í…ë°, ì´ì™€ ë§¤ìš° ë¹„ìŠ·í•©ë‹ˆë‹¤. catkinì„ í†µí•´ ì‹¤í–‰ ê°€ëŠ¥í•œ í”„ë¡œê·¸ë¨ (C/C++ì˜ ë¹Œë“œ), ë¼ì´ë¸ŒëŸ¬ë¦¬, ì¸í„°í˜ì´ìŠ¤ë“¤ì„ ë§Œë“¤ ìˆ˜ ìˆìœ¼ë©°, catkin ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” workspaceë¼ëŠ” íŠ¹ë³„í•œ í´ë”ê°€ í•„ìš”í•©ë‹ˆë‹¤. ROS ê°œë°œì„ í•˜ë‹¤ ë³´ë©´ ì—¬ëŸ¬ í”„ë¡œì íŠ¸ë¥¼ ë™ì‹œì— ì§„í–‰í•˜ëŠ” ê²½ìš°ê°€ ìƒê¹ë‹ˆë‹¤. ìƒˆë¡œìš´ ì‘ì—…ì€ ìƒˆë¡œìš´ í´ë”ë¥¼ ë§Œë“¤ì–´ ì‘ì—…í•˜ë“¯ì´ ROS ì—ì„œë„ ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ëŠ” ìƒˆë¡œìš´ WorkSpaceì—ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì…ë‹ˆë‹¤. ìƒˆë¡œìš´ WSë¡œ ì´ë™í•˜ê²Œ ë˜ë©´ ROSì—ê²Œ ì´ëŸ¬í•œ ë³€í™”ë¥¼ ì•Œë ¤ì¤˜ì•¼ í•˜ë©° ì´ ëª…ë ¹ì–´ê°€ source devel/setup.bash ì…ë‹ˆë‹¤. ì´ë²ˆ ê°•ì˜ìš© WSë¥¼ ë§Œë“¤ì–´ë³´ê³ , ì´í›„ ì—¬ëŸ¬ë¶„ë“¤ë§Œì˜ WSë„ ë§Œë“¤ì–´ ì‘ì—…í•´ë³´ì„¸ìš”! ì¼ë°˜ì ìœ¼ë¡œ ROSì˜ workspaceëŠ” name_wsë¼ëŠ” ì´ë¦„ì„ ê°–ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ë©°, ìš°ë¦¬ëŠ” catkin_wsë¼ëŠ” workspaceë¥¼ ë§Œë“¤ì–´ë³´ê³ ì í•©ë‹ˆë‹¤.\nì•„ë˜ ì»¤ë©˜ë“œ ë¼ì¸ë“¤ì„ ë”°ë¼í•´ì£¼ì„¸ìš” cd ~/ mkdir -p catkin_ws/src cd catkin_ws catkin config --init catkin build ë‹¤ìŒê³¼ ê°™ì´ build, devel, src, log í´ë”ê°€ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤. ROS ì½”ë“œë“¤ì€ ëª¨ë‘ src í´ë” ì•ˆì— ìœ„ì¹˜í•˜ê²Œ ë©ë‹ˆë‹¤. src í´ë” ë‚´ë¶€ì—ì„œ ì½”ë“œ ê°œë°œ â‡’ catkinì„ ì‚¬ìš©í•œ ë¹Œë“œ â‡’ build í´ë” ë‚´ë¶€ì— ì‹¤í–‰ ê°€ëŠ¥í•œ í”„ë¡œê·¸ë¨ ìƒì„±ì˜ ìˆœì„œë¡œ ê°œë°œì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì‹¤ìŠµì„ í†µí•´ ê°œë°œ í”„ë¡œì„¸ìŠ¤ì— ìµìˆ™í•´ì ¸ë´…ì‹œë‹¤.\nì•„ë˜ í´ë”ë¥¼ catkin_ws/src ì•ˆì— ì••ì¶• í•´ì œí•©ë‹ˆë‹¤. Example Packages smb_common.zip (2 ) í„°ë¯¸ë„ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰ì‹œí‚¤ê³  ì•„ë˜ ì»¤ë©˜ë“œ ë¼ì¸ì„ ë”°ë¼í•©ë‹ˆë‹¤. catkin build smb_description catkin build smb_gazebo catkin build smb_control source devel/setup.bash sourceë¡œ ì‹œì‘í•˜ëŠ” ë§ˆì§€ë§‰ ë¼ì¸ì€ ìƒˆë¡œìš´ ë¹Œë“œ í›„ì— í•­ìƒ ì‹¤í–‰í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤. 1ê°•ì„ ì˜ ë”°ë¼í–ˆë‹¤ë©´ sdsë¼ëŠ” ë‹¨ì¶•ì–´ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nì˜ˆì œ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰ì‹œí‚µë‹ˆë‹¤. roslaunch smb_gazebo smb_gazebo.launch ì‹¤í–‰ ì‹œ ë¶‰ì€ ì—ëŸ¬ ë©”ì„¸ì§€ê°€ ë‚˜ì˜¤ì§€ë§Œ ë™ì‘ë§Œ ëœë‹¤ë©´ ë¬¸ì œ ì—†ìŠµë‹ˆë‹¤.\nì´ ë¡œë´‡ì„ í•œë²ˆ ì›€ì§ì—¬ ë³¼ê¹Œìš”? - teleop ì‹¤í–‰ rosrun teleop_twist_keyboard teleop_twist_keyboard.py íŒŒì¼ êµ¬ì¡° ê´€ì ì—ì„œ, ROS Applicationì€ ì—¬ëŸ¬ Packageë“¤ë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì´ë“¤ Packageê°€ ì†ŒìŠ¤ íŒŒì¼ì„ ë‹´ê³  ìˆê³ , catkinì´ ì´ë“¤ì„ ë¹Œë“œí•˜ì—¬ ì‹¤í–‰ í”„ë¡œê·¸ë¨ë“¤ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì œê°€ ê³µìœ í•œ ì••ì¶• íŒŒì¼ ì•ˆì—ë„ 3ê°œì˜ Packageê°€ í¬í•¨ë˜ì–´ìˆë˜ ê²ƒì´ë©°, ROS ê°œë°œìë“¤ì€ ìì‹ ë“¤ì˜ ë¡œë´‡ Packageë¥¼ ê°œë°œí•˜ê³  ê³µìœ í•©ë‹ˆë‹¤. Package ìƒì„± ì‹¤ìŠµ Packageë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\ncd \u0026lt;your-ws\u0026gt;/src catkin_create_pkg \u0026lt;package_name\u0026gt; [depend1] [depend2] [depend3] my_first_packageë¼ëŠ” packageë¥¼ ì‹œí—˜ì‚¼ì•„ ìƒì„±í•´ë´…ì‹œë‹¤.\n# exameple $ catkin_create_pkg my_first_package rospy std_msgs Created file my_first_package/package.xml Created file my_first_package/CMakeLists.txt Created folder my_first_package/src Successfully created files in /home/kimsooyoung/catkin_ws/src/my_first_package. Please adjust the values in package.xml. dependì—ëŠ” í•´ë‹¹ íŒ¨í‚¤ì§€ì˜ ì˜ì¡´ì„± íŒ¨í‚¤ì§€ë“¤ì´ ë‚˜ì—´ë˜ë©°, rospyëŠ” íŒŒì´ì¬ì„ í†µí•´ ROSë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì˜ì¡´ì„±ì…ë‹ˆë‹¤.\në¯¸ë¦¬ ì œê³µë˜ì—ˆë˜ Package, smb_gazeboë¥¼ ì‚´í´ë´…ì‹œë‹¤.\nGazebo ì‹¤í–‰ì— í•„ìš”í•œ ëª¨ë¸ íŒŒì¼ê³¼ í™˜ê²½ íŒŒì¼ ë“± ê¸°ëŠ¥ë³„ ì •ë¦¬ëœ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì´ë ‡ê²Œ Packageë¥¼ ì˜ êµ¬ì„±í•´ë‘ë©´ ì´í›„ ì½”ë“œì˜ ê´€ë¦¬ì—ë„ í¸ë¦¬í•˜ë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.\nì°¸ê³ ìë£Œ\nhttp://wiki.ros.org/ko/ROS/Tutorials/CreatingPackage https://rsl.ethz.ch/education-students/lectures/ros.html https://www.clearpathrobotics.com/assets/guides/noetic/ros/Drive a Husky.html "
},
{
	"uri": "/kr/ros_basic_noetic/lecture4/",
	"title": "Lecture4 - ROS Launch, RViz",
	"tags": [],
	"description": "",
	"content": "ROS Launch ì¼ì „ ì˜ˆì‹œ ì‹¤í–‰ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì‚¬ìš©í–ˆì—ˆìŠµë‹ˆë‹¤.\nroslaunch smb_gazebo smb_gazebo.launch roslaunchë€, ë‹¤ìˆ˜ì˜ ROS Nodeë“¤ì„ í•œë²ˆì— ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” íˆ´ ì…ë‹ˆë‹¤.\nroslaunchë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” xmlì´ë¼ëŠ” í¬ë©§ì„ ì‚¬ìš©í•˜ëŠ” launch fileì´ ìˆì–´ì•¼ í•˜ë©°, ì´ëŠ” ë³´í†µ íŒ¨í‚¤ì§€ì˜ launch í´ë”ì— ìœ„ì¹˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nlaunch fileì˜ êµ¬ì¡°ë¥¼ íŒŒì•…í•´ë´…ì‹œë‹¤.\nlaunchíŒŒì¼ì€ xmlì´ë¼ëŠ” ë¬¸ë²•ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. htmlì„ ì‚¬ìš©í•´ë³´ì…¨ë‹¤ë©´ ì•„ì‹œê² ì§€ë§Œ, \u0026lt;\u0026gt;ë¥¼ ì´ìš©í•˜ì—¬ ë¼ì¸ì„ êµ¬ë¶„í•˜ëŠ” í¬ë©§ì…ë‹ˆë‹¤. í•œ ë¼ì¸ì—ì„œ ëë‚˜ëŠ” ê²½ìš° /\u0026gt;ë¡œ ë§ºì„ ìˆ˜ ìˆì§€ë§Œ, ì—¬ëŸ¬ ë¼ì¸ì´ í•„ìš”í•œ ê²½ìš°ì—ëŠ” ì—¬ëŠ” íƒœê·¸ì™€ ë‹«ëŠ” íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬ë¶„í•©ë‹ˆë‹¤. \u0026lt;tag /\u0026gt; or \u0026lt;tag (value)\u0026gt; ... \u0026lt;/tag\u0026gt; launch fileì€ ì‹œì‘ê³¼ ë, íƒœê·¸ë¡œ ê°ì‹¸ì§‘ë‹ˆë‹¤.\nnode íƒœê·¸ëŠ” ì‹¤í–‰ë˜ëŠ” ROS Nodeë¥¼ ì§€ì¹­í•©ë‹ˆë‹¤. name íƒœê·¸ëŠ” nodeë¥¼ ì‹¤í–‰í•  ë•Œì˜ ì´ë¦„ì„ ì„¤ì •í•˜ëŠ” ë¶€ë¶„ìœ¼ë¡œ ììœ ë¡­ê²Œ ì§€ì • ê°€ëŠ¥í•©ë‹ˆë‹¤. pkg íƒœê·¸ì—ëŠ” í•´ë‹¹ nodeê°€ ì†í•´ìˆëŠ” packageë¥¼ ì ìŠµë‹ˆë‹¤. type íƒœê·¸ì—ëŠ” ì‹¤í–‰ê°€ëŠ¥í•œ íŒŒì¼, í˜¹ì€ í”„ë¡œê·¸ë¨ì„ ì ê²Œ ë˜ë©°, c++ì˜ ê²½ìš° ë¹Œë“œëœ í”„ë¡œê·¸ë¨, íŒŒì´ì¬ì˜ ê²½ìš° íŒŒì´ì¬ íŒŒì¼ì´ ë©ë‹ˆë‹¤. output íƒœê·¸ëŠ” ë¡œê·¸ê°€ ì¶œë ¥ë˜ëŠ” ìœ„ì¹˜ë¥¼ ì§€ì •í•˜ë©° screenì¼ ì‹œ í„°ë¯¸ë„ì— ì¶œë ¥ë©ë‹ˆë‹¤. \u0026lt;launch\u0026gt; \u0026lt;node name=\u0026#34;listener\u0026#34; pkg=\u0026#34;rospy_tutorials\u0026#34; type=\u0026#34;listener.py\u0026#34; output=\u0026#34;screen\u0026#34;/\u0026gt; \u0026lt;node name=\u0026#34;talker\u0026#34; pkg=\u0026#34;rospy_tutorials\u0026#34; type=\u0026#34;talker.py\u0026#34; output=\u0026#34;screen\u0026#34;/\u0026gt; \u0026lt;/launch\u0026gt; ì´ë²ˆì—ëŠ” smb_gazebo.launchë¥¼ ì‚´í´ë´…ì‹œë‹¤.\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;launch\u0026gt; \u0026lt;!-- GAZEBO ARGUMENTS --\u0026gt; \u0026lt;!-- Run Gazebo headless --\u0026gt; \u0026lt;arg name=\u0026#34;headless\u0026#34; default=\u0026#34;false\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;model_path\u0026#34; default=\u0026#34;$(find smb_gazebo)/\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;robot_namespace\u0026#34; default=\u0026#34;\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;robot_model_name\u0026#34; default=\u0026#34;smb\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;enable_ekf\u0026#34; default=\u0026#34;true\u0026#34;/\u0026gt; ... \u0026lt;!-- Load Gazebo world --\u0026gt; \u0026lt;include file=\u0026#34;$(find gazebo_ros)/launch/empty_world.launch\u0026#34;\u0026gt; \u0026lt;env name=\u0026#34;GAZEBO_MODEL_PATH\u0026#34; value=\u0026#34;$(arg model_path)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;world_name\u0026#34; value=\u0026#34;$(arg world_file)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;paused\u0026#34; value=\u0026#34;$(arg paused)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;use_sim_time\u0026#34; value=\u0026#34;$(arg use_sim_time)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;gui\u0026#34; value=\u0026#34;$(arg run_gui)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;headless\u0026#34; value=\u0026#34;$(arg headless)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;debug\u0026#34; value=\u0026#34;$(arg debug)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;verbose\u0026#34; value=\u0026#34;$(arg verbose)\u0026#34;/\u0026gt; \u0026lt;/include\u0026gt; argë€, argumentì˜ ì•½ìì´ë©° launch íŒŒì¼ì—ì„œ ì¸ìë¡œ ì‘ìš©í•˜ëŠ” ì¼ì¢…ì˜ ë³€ìˆ˜ì…ë‹ˆë‹¤.\narg íƒœê·¸ë¥¼ í†µí•´ argumentë¥¼ ì„ ì–¸í•˜ê³  defaultë¥¼ í†µí•´ ì´ˆê¸°ê°’ì„ ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. argumentì˜ ì„ ì–¸ í›„ ì‚¬ìš©ì€ $(arg \u0026ldquo;argument name\u0026rdquo;) ì…ë‹ˆë‹¤. roslaunch ì‹œ argumentë¥¼ ë°”ê¿” ì‹¤í–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, smb_gazebo.launch ì‹¤í–‰ ì‹œ. worldë¥¼ ë°”ê¾¸ì–´ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nroslaunch smb_gazebo smb_gazebo.launch world:=big_map_summer_school ì´ˆê¸° ì‹¤í–‰ ì‹œ ì‹œê°„ì´ ë‹¤ì†Œ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\ní˜„ì¬ ì˜ˆì‹œì—ì„œ ì œê³µë˜ëŠ” worldëŠ” ë‹¤ìŒ 3ê°€ì§€ ì…ë‹ˆë‹¤.\nroslaunch smb_gazebo smb_gazebo.launch ì œì‘í•œ launch fileì„ ë‹¤ì‹œ ë‹¤ë¥¸ launch fileì—ì„œ ë¶ˆëŸ¬ì˜¤ëŠ” ê²½ìš°ê°€ ë”ëŸ¬ ìˆìŠµë‹ˆë‹¤.\nì´ë•Œ, include íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ë©°, íŒ¨í‚¤ì§€ ë‹¨ìœ„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ íŒŒì¼ì˜ ê²½ë¡œë¥¼ ê°€ì ¸ì˜¤ê²Œ ë©ë‹ˆë‹¤.\nincludeí•˜ëŠ” launch fileì˜ ë‚´ë¶€ì—ë„ ì—¬ëŸ¬ argumentë“¤ì´ ìˆì„ ê²ƒì…ë‹ˆë‹¤. ì´ë“¤ì€ arg íƒœê·¸ë¥¼ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\u0026lt;include file=\u0026#34;$(find gazebo_ros)/launch/empty_world.launch\u0026#34;\u0026gt; \u0026lt;env name=\u0026#34;GAZEBO_MODEL_PATH\u0026#34; value=\u0026#34;$(arg model_path)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;world_name\u0026#34; value=\u0026#34;$(arg world_file)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;paused\u0026#34; value=\u0026#34;$(arg paused)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;use_sim_time\u0026#34; value=\u0026#34;$(arg use_sim_time)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;gui\u0026#34; value=\u0026#34;$(arg run_gui)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;headless\u0026#34; value=\u0026#34;$(arg headless)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;debug\u0026#34; value=\u0026#34;$(arg debug)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;verbose\u0026#34; value=\u0026#34;$(arg verbose)\u0026#34;/\u0026gt; \u0026lt;/include\u0026gt; htmlê³¼ ë§ˆì°¬ê°€ì§€ë¡œ \u0026lt;!-- --\u0026gt; ì‚¬ì´ì— ì˜¤ëŠ” ì½”ë“œëŠ” ì£¼ì„ìœ¼ë¡œ ë¬´ì‹œë©ë‹ˆë‹¤.\në‹¨, ì£¼ì˜ì‚¬í•­ í•˜ë‚˜ ìˆìŠµë‹ˆë‹¤. launch íŒŒì¼ì„ ì‚¬ìš©í•˜ë‹¤ë³´ë©´ --ê°€ ì¢…ì¢… ì“°ì´ê³¤ í•˜ëŠ”ë°ìš”. ì´ ê²½ìš° ì£¼ì„ì— ì˜¤ë¥˜ê°€ ë‚˜ë‹ˆ ì£¼ì˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.\nLaunch Fileì„ ë‹¤ë£¨ëŠ” ì—°ìŠµì„ í•´ë´…ì‹œë‹¤.\nsmb_gazebo.launchë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•©ë‹ˆë‹¤.\nworldë¥¼ big_map_summer_schoolë¡œ ìˆ˜ì •í•©ë‹ˆë‹¤. ë¡œë´‡ì´ ë“±ì¥í•˜ëŠ” ìœ„ì¹˜ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•©ë‹ˆë‹¤. xyz : (-0.5, -1.0, 0.4) yaw angle : 90ë„ (3.1415ë¥¼ 1 radianìœ¼ë¡œ ì¡ìŠµë‹ˆë‹¤.) launch fileì— rospy_tutorials Packageì— ìˆëŠ” talker Nodeë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. Rqtì™€ RViz ROSì—ëŠ” ë¡œë´‡ì˜ ë‹¤ì–‘í•œ ì„¼ì„œ ë°ì´í„°ë“¤ì„ ì‹œê°í™”í•´ì£¼ëŠ” 3D íˆ´ì´ ìˆìœ¼ë©°, ì´ëŠ” RVizë¼ê³  ë¶ˆë¦½ë‹ˆë‹¤.\nRvizì˜ ì‚¬ìš©ë²•ì„ ì•Œì•„ë´…ì‹œë‹¤.\nì˜ˆì œ ì‹¤í–‰ # Terminal 1 roslaunch smb_gazebo smb_gazebo.launch world:=big_map_summer_school # Terminal 2 rviz ì‚¬ì§„ê³¼ ê°™ì´ Gazeboì™€ RVizê°€ ì˜ ì‹¤í–‰ëœ ìƒí™©ì—ì„œ ê°•ì˜ë¥¼ ë”°ë¼í•©ë‹ˆë‹¤.\nrvizì—ì„œ ì„¼ì„œ ë°ì´í„°ë¥¼ ì‹œê°í™”í•˜ê¸° ì „, ìš°ì„  ì–´ë–¤ ì¢Œí‘œê³„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‹œê°í™”í• ì§€ ì„¤ì •í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.\nê°™ì€ ì„¼ì„œë¼ë„ ì›ì  ì¢Œí‘œê³„ì—ì„œ ë³¸ ëª¨ìŠµê³¼, ì„¼ì„œ ì¢Œí‘œê³„ì—ì„œ ë³¸ ëª¨ìŠµì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.\nimg from : mathworks ì´ëŠ” RVizì˜ Fixed Frameì—ì„œ ì„¤ì • ê°€ëŠ¥í•©ë‹ˆë‹¤. (odomìœ¼ë¡œ ì„¤ì •í•´ë³´ê² ìŠµë‹ˆë‹¤.)\nì´ì œ ë‹¤ì–‘í•œ ì‹œê°í™” ê¸°ëŠ¥ë“¤ì„ ì‚¬ìš©í•´ë³´ë ¤ í•©ë‹ˆë‹¤.\nê¸°ë³¸ì ìœ¼ë¡œ ë°ì´í„°ì˜ ì¶”ê°€ëŠ” ì™¼ìª½ í•˜ë‹¨ Add ë²„íŠ¼ìœ¼ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤. tf ì‹œê°í™” odometry ì‹œê°í™” point cloud ì‹œê°í™” ì´ë ‡ê²Œ ì˜ ì„¤ì •í•´ë‘” RVizëŠ” config í¬ë©§ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì´í›„ì— ë‹¤ì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nFile â‡’ Save Configë¥¼ í†µí•´ configë¥¼ ì €ì¥í•˜ê³ , Open Configë¥¼ í†µí•´ ì €ì¥í•œ configë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì•„ë˜ì™€ ê°™ì´ ë‹¤ì–‘í•œ Pluginì„ í†µí•´ ì—¬ëŸ¬ ì„¼ì„œ, ë¡œë´‡ ë°ì´í„°ë¥¼ ì‹œê°í™”í•  ìˆ˜ ìˆìœ¼ë©°, ìì‹ ë§Œì˜ Pluginì„ ì œì‘í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\nì§€ê¸ˆê¹Œì§€ ì—¬ëŸ¬ë¶„ë“¤ì´ ë§Œë“  RViz ì„¤ì •ì„ ì €ì¥í•´ë³´ê³ , launch fileì— í†µí•©í•´ë´…ì‹œë‹¤.\nRVizì˜ ì¢Œì¸¡ ìƒë‹¨ File ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ config fileì„ ì €ì¥í•©ë‹ˆë‹¤. ì €ì¥ ìœ„ì¹˜ëŠ” smb_gazebo/rvizë¡œ ì§€ì •í•˜ê² ìŠµë‹ˆë‹¤. (ìƒˆë¡­ê²Œ í´ë”ë¥¼ ë§Œë“¤ì–´ì£¼ì—ˆìŠµë‹ˆë‹¤.) ì´ì œ, launch fileì„ ìˆ˜ì •í•©ì‹œë‹¤. íŒŒì¼ í•˜ë‹¨ launch íƒœê·¸ê°€ ë‹«íˆê¸° ì „ ë¶€ë¶„ì— ì•„ë˜ì™€ ê°™ì€ ë¼ì¸ì„ ì¶”ê°€í•©ë‹ˆë‹¤. \u0026lt;node name=\u0026#34;rviz\u0026#34; pkg=\u0026#34;rviz\u0026#34; type=\u0026#34;rviz\u0026#34; args=\u0026#34;-d $(find smb_gazebo)/rviz/my_config.rviz\u0026#34; /\u0026gt; \u0026lt;/launch\u0026gt; ì´ì œ, ë‹¤ì‹œ Gazebo launchë¥¼ í•´ë´…ì‹œë‹¤.\nroslaunch smb_gazebo smb_gazebo.launch world:=big_map_summer_school Rqt Tools ì§€ê¸ˆê¹Œì§€ ì‚¬ìš©í•œ ROS íˆ´ì€ rqt_graphì™€ RVizê°€ ìˆì—ˆìŠµë‹ˆë‹¤.\nì‚¬ì‹¤ ROSì—ëŠ” ìˆ˜ë§ì€ ì¶”ê°€ íˆ´ë“¤ì´ ì¡´ì¬í•˜ë©° ì´ë“¤ì„ ë¬¶ì–´ rqt toolsë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.\nrqt image view image from : wiki.ros.org\nrqt multiplot image from : project march\nrqt console image from : wiki.ros.org\nrqt robot steering rqt tf tree image from : rqt tf tree\nì´ëŸ¬í•œ ìˆ˜ë§ì€ íˆ´ë“¤ì´ ìˆì–´ ROS ê°œë°œì„ í¸ë¦¬í•˜ê²Œ í•´ì£¼ê³  ìˆìœ¼ë©°, í•¨ê»˜ ROSë¥¼ ê³µë¶€í•˜ë©´ì„œ í•˜ë‚˜ì”© ê°™ì´ ì‚´í´ë³´ê³  ì‚¬ìš©í•´ë³´ë ¤ í•©ë‹ˆë‹¤.\nì°¸ê³ ìë£Œ\nhttp://wiki.ros.org/roslaunch https://www.clearpathrobotics.com/assets/guides/noetic/ros/Drive a Husky.html https://rsl.ethz.ch/education-students/lectures/ros.html "
},
{
	"uri": "/kr/ros_basic_noetic/lecture5/",
	"title": "Lecture5 - First Programming, ROS Topic",
	"tags": [],
	"description": "",
	"content": "ì´ë²ˆ ê°•ì˜ë¶€í„°, ë³¸ê²©ì ì¸ í”„ë¡œê·¸ë˜ë°ì´ ì‹œì‘ë©ë‹ˆë‹¤. ì²«ë²ˆì§¸ë¡œ Nodeì˜ í”„ë¡œê·¸ë˜ë°ì„ ì‚´í´ë³´ê³ ì í•˜ë©°, ì‹œì‘ ì „ ê°„ë‹¨í•œ ë³µìŠµì„ ì§„í–‰í•˜ê³  ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤.\nimage from : clearpathrobotics\nWorkspaceì™€ íŒ¨í‚¤ì§€ # WS ìƒì„± mkdir -p catkin_ws/src cd catkin_ws catkin config --init # Package ìƒì„± catkin_create_pkg \u0026lt;pkg-name\u0026gt; \u0026lt;depend1\u0026gt; \u0026lt;depend2\u0026gt; ... ROS Node Programming C++ ì½”ë“œëŠ” src í´ë” ì•ˆì—, íŒŒì´ì¬ ì½”ë“œëŠ” scriptsë¼ëŠ” í´ë” ì•ˆì— ìœ„ì¹˜ì‹œí‚¤ëŠ” ê²ƒì´ ì¼ë°˜ì ì…ë‹ˆë‹¤. cd \u0026lt;pkg-name\u0026gt; mkdir scripts ì§€ê¸ˆë¶€í„°, ì§ì ‘ ëª…ë ¹ì–´ë¥¼ í•œì¤„ì”© ë”°ë¼ì¹˜ë©´ì„œ ì‹¤ìŠµí•˜ì…”ë„ ì¢‹ê³ , ì œê°€ ë¯¸ë¦¬ ì¤€ë¹„í•´ë‘” Packageë¥¼ ì‚¬ìš©í•˜ì…”ë„ ì¢‹ìŠµë‹ˆë‹¤.\në‹¤ìŒìœ¼ë¡œ, íŒŒì´ì¬ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œí•´ë´…ì‹œë‹¤.\ncd scripts # my_first_node.py ìƒì„± ì²«ë²ˆì§¸ í”„ë¡œê·¸ë˜ë° ì½”ë“œëŠ” Nodeì˜ ê¸°ë³¸ì…ë‹ˆë‹¤.\nëª¨ë“  ì†ŒìŠ¤ì½”ë“œëŠ” github repoì—ì„œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nmy_first_node.py #!/usr/bin/env python3 import rospy from std_msgs.msg import String def my_first_node(): # ROS nodes require initialization # It contains master registration, uploading parameters rospy.init_node(\u0026#39;my_first_node\u0026#39;, anonymous=True) # ROS safe timer rate = rospy.Rate(10) # 10hz # Loop control Example while not rospy.is_shutdown(): hello_du = \u0026#34;hello du %s\u0026#34; % rospy.get_time() rospy.loginfo(hello_du) # Below line calls sleep method in Python internally. rate.sleep() if __name__ == \u0026#39;__main__\u0026#39;: try: my_first_node() except rospy.ROSInterruptException: pass ì½”ë“œë¥¼ ìƒˆë¡œ ì‘ì„±í•œ ë‹¤ìŒì—ëŠ” ìŠµê´€ì ìœ¼ë¡œ íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œí•˜ê³  ì‹¤í–‰í•©ë‹ˆë‹¤. íŒŒì´ì¬ ì½”ë“œì˜ ê²½ìš° íŒŒì¼ì˜ ì‹¤í–‰ ê¶Œí•œì´ ì£¼ì–´ì ¸ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. cd scripts chmod +x * cd ~/catkin_ws catkin build my_first_pkg ì‘ì„±í•œ nodeë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤. ë°˜ë³µí•´ì„œ í„°ë¯¸ë„ ë¡œê·¸ê°€ ë‚¨ì„ ê²ƒì…ë‹ˆë‹¤. # Terminal 1 roscore # Terminal 2 rosrun my_first_package my_first_node.py ì½”ë“œ ë¶„ì„ ì²« ì½”ë“œì¸ ë§Œí¼ ìì„¸í•˜ê²Œ ë¶„ì„í•˜ê³  ë„˜ì–´ê°€ë³´ë ¤ í•©ë‹ˆë‹¤.\nROS Noeticì€ Python 3ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ê°€ìƒí™˜ê²½ì˜ íŒŒì´ì¬, ì§ì ‘ ì„¤ì¹˜í•œ íŒŒì´ì¬ ë“± ì—¬ëŸ¬ ë²„ì „ì´ ì„¤ì¹˜ë˜ì–´ ìˆì„ ê²ƒì…ë‹ˆë‹¤. ê³µì‹ ë¬¸ì„œì—ì„œëŠ” ì´ëŸ¬í•œ í˜¼ë€ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì½”ë“œì˜ ì œì¼ ì²˜ìŒ ì•„ë˜ ë¼ì¸ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•˜ê³  ìˆìŠµë‹ˆë‹¤. #!/usr/bin/env python3 Pythonì„ ì‚¬ìš©í•˜ì—¬ ROSë¥¼ ë‹¤ë£¨ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” íŒ¨í‚¤ì§€ëŠ” rospyì…ë‹ˆë‹¤. importë¥¼ ì‚¬ìš©í•´ë„ ì¢‹ê³  from / importë¥¼ í†µí•´ íŠ¹ì • í´ë˜ìŠ¤ë§Œ ê°€ì ¸ì˜¬ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. import rospy from std_msgs.msg import String ë‹¹ì¥ ì‚¬ìš©í•˜ì§€ëŠ” ì•Šì§€ë§Œ Test Codeë¥¼ ì‘ì„±í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ìƒí™©ì— ëŒ€ë¹„í•˜ê¸° ìœ„í•´ main í•¨ìˆ˜ë¥¼ ë”°ë¡œ ë‘ê³  ì•„ë˜ì™€ ê°™ì´ í”„ë¡œê·¸ë¨ì„ ì‹œì‘í•˜ê¸°ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤. if __name__ == \u0026#39;__main__\u0026#39;: try: my_first_node() except rospy.ROSInterruptException: pass ì´ì œ, my_first_nodeë¥¼ ë¶„ì„í•´ ë³´ê² ìŠµë‹ˆë‹¤. Nodeì˜ ì‹¤í–‰ì„ ìœ„í•´ Masterì— ë“±ë¡í•˜ê³ , ì´ˆê¸°í™”í•˜ëŠ” ì‘ì—…ì´ í•„ìš”í•˜ë©°, ì´ë¥¼ ìœ„í•´ ë³„ë„ë¡œ init_nodeë¼ëŠ” ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. def my_first_node(): # ROS nodes require initialization # It contains master registration, uploading parameters rospy.init_node(\u0026#39;my_first_node\u0026#39;, anonymous=True) ROS ì‹œìŠ¤í…œì€ ê¸°ë³¸ì ìœ¼ë¡œ ë¬´í•œ Loopì…ë‹ˆë‹¤. ì´ Loopê°€ í•œì°¨ë¡€ ë°˜ë³µë˜ëŠ” ì£¼ê¸°ë¥¼ ì„¤ì •í•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. ROSì˜ ì‹œê°„ ì²´ê³„ì— ëŒ€í•´ì„œëŠ” ì´í›„ í•œë²ˆ ë” ë‹¤ë£¨ê² ìŠµë‹ˆë‹¤. # ROS safe timer rate = rospy.Rate(10) # 10hz rospyë¥¼ í†µí•´ ì‹¤í–‰ ì¤‘ì¸ Nodeì˜ ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, is_shutdown()ì€ ì˜ˆê¸°ì¹˜ ëª»í•œ ì—ëŸ¬ê°€ ë°œìƒí•˜ê±°ë‚˜ ì‚¬ìš©ìì˜ ì¢…ë£Œë¥¼ ì¸ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 10Hzë¥¼ ë§ì¶”ê¸° ìœ„í•´ Loopë§ˆë‹¤ sleepì„ ê±¸ì–´ì£¼ê³  ìˆìŠµë‹ˆë‹¤. # Loop control Example while not rospy.is_shutdown(): ... rate.sleep() ROSì—ì„œ ì½˜ì†” ë¡œê·¸ë¥¼ ì–»ëŠ” ë°©ë²•ìœ¼ë¡œ print ë³´ë‹¤ rospy.logë¥¼ ì‚¬ìš©í•˜ê¸°ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤. hello_du = \u0026#34;hello du %s\u0026#34; % rospy.get_time() rospy.loginfo(hello_du) # Below line calls sleep method in Python internally. ROS Timer ROSëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë¬´í•œ Loopë¥¼ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ ì•ˆì—ì„œ ë™ì‘ì‹œí‚¤ëŠ” í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. Timerë¥¼ í†µí•´ ì¼ì • ì‹œê°„ë§ˆë‹¤ ë™ì‘í•˜ëŠ” ì½”ë“œë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\ncd my_first_pkg/scripts # spin_node.py ìƒì„± spin_node.py #!/usr/bin/env python3 import rospy # callback method requires event, which is TimerEvent def hello_du(event=None): hello_du = \u0026#34;hello du %s\u0026#34; % rospy.get_time() rospy.loginfo(hello_du) def my_first_node(): rospy.init_node(\u0026#39;my_first_node\u0026#39;, anonymous=True) # Timer Class is kind of Thread. # It\u0026#39;s rule is execute sleep in certain period with given event. rospy.Timer(rospy.Duration(1.0/100.0), hello_du) rospy.spin() if __name__ == \u0026#39;__main__\u0026#39;: try: my_first_node() except rospy.ROSInterruptException: pass ì½”ë“œì˜ ì‹¤í–‰ ê²°ê³¼ëŠ” ì´ì „ê³¼ ê°™ê¸° ë•Œë¬¸ì— Timerì™€ spinì— ëŒ€í•´ì„œë§Œ ì§šê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.\nTimerëŠ” í¬ê²Œ ë‘ê°€ì§€ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ìŠµë‹ˆë‹¤. ì‹¤í–‰ ì£¼ê¸°ì™€ Callback í•¨ìˆ˜ì…ë‹ˆë‹¤. í•´ë‹¹ ì£¼ê¸°ë§ˆë‹¤ Callback í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚µë‹ˆë‹¤. rospy.Timer(rospy.Duration(1.0/100.0), hello_du) ì•ìœ¼ë¡œ ì—¬ëŸ¬ë¶„ë“¤ì€ ì§ì ‘ while loopë¥¼ êµ¬í˜„í•˜ê¸°ë³´ë‹¤ rospy.spin()ì„ ë” ë§ì´ ì‚¬ìš©í•˜ì‹œê²Œ ë  ê²ë‹ˆë‹¤. Timerë¥¼ ì„ ì–¸í•œ ì´í›„, í•˜ë‚˜ì˜ Threadì—ì„œ ë§‰í˜€ë²„ë¦¬ëŠ” ê²ƒì„ ë°©ì§€í•˜ëŠ” ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. rospy.Timer(rospy.Duration(1.0/100.0), hello_du) rospy.spin() image from : python tutorial\nOOP Node Programming my_first_oop_node.py #!/usr/bin/env python3 import rospy class OOPNode: def __init__(self): self.counter_ = 0 self.timer_ = rospy.Timer(rospy.Duration(1.0/100.0), self.hello_du) def hello_du(self, event=None): hello_du = f\u0026#34;hello du {rospy.get_time()}, counter: {self.counter_}\u0026#34; rospy.loginfo(hello_du) self.counter_ += 1 def my_first_oop_node(): rospy.init_node(\u0026#39;my_first_oop_node\u0026#39;, anonymous=True) oop_node = OOPNode() rospy.spin() if __name__ == \u0026#39;__main__\u0026#39;: try: my_first_oop_node() except rospy.ROSInterruptException: pass ì´í›„ì˜ ì‹¤ìŠµë“¤ì„ ìœ„í•´ í•œê°€ì§€ ì˜ˆì‹œë§Œ ë” ì‚´í´ë³´ê³ ì í•©ë‹ˆë‹¤. ê°ì²´ ì§€í–¥ì„ ì‚¬ìš©í•œ ROS Node ì‘ì„±ë°©ë²•ì…ë‹ˆë‹¤. íŒŒì´ì¬ì—ì„œ OOPë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ Class í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ë©°, selfë“± OOPì™€ ê´€ë ¨ëœ ë‚´ìš©ì€ ëª¨ë‘ ì•Œê³  ìˆë‹¤ëŠ” ìƒíƒœì—ì„œ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.\nOOPë¥¼ ì‚¬ìš©í•˜ë©´ main ë©”ì†Œë“œê°€ ë§¤ìš° ê°„í¸í•´ì§„ë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤. í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ê³ , spinì„ í•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤. def my_first_oop_node(): rospy.init_node(\u0026#39;my_first_oop_node\u0026#39;, anonymous=True) oop_node = OOPNode() rospy.spin() OOPë¡œ ì „í™˜ë˜ë©´ì„œ ë³€ê²½ëœ êµ¬í˜„ì— ì£¼ëª©í•©ì‹œë‹¤. Timerì˜ Callback í•¨ìˆ˜ë¡œ í´ë˜ìŠ¤ ë©”ì†Œë“œê°€ ì‚¬ìš©ë˜ì—ˆìœ¼ë©°, í´ë˜ìŠ¤ ë³€ìˆ˜ì¸ counterë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í•œ ì ì— ì£¼ëª©í•©ë‹ˆë‹¤. class OOPNode: def __init__(self): self.counter_ = 0 self.timer_ = rospy.Timer(rospy.Duration(1.0/100.0), self.hello_du) def hello_du(self, event=None): hello_du = f\u0026#34;hello du {rospy.get_time()}, counter: {self.counter_}\u0026#34; rospy.loginfo(hello_du) self.counter_ += 1 ì•ìœ¼ë¡œ, ëŒ€ë¶€ë¶„ì˜ ì½”ë“œëŠ” OOP ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë©ë‹ˆë‹¤. íŒŒì´ì¬ì˜ í´ë˜ìŠ¤ì— ëŒ€í•´ ìˆ™ì§€ê°€ ë˜ì–´ìˆì§€ ì•Šë‹¤ë©´ ê¼­ ë³µìŠµí•˜ê³  ë‹¤ìŒ ê°•ì˜ë¥¼ ì²­ì·¨í•˜ì„¸ìš”!\nROS Topic ë‹¤ì‹œ ê°œë… í•™ìŠµìœ¼ë¡œ ëŒì•„ì™€ë³´ì•˜ìŠµë‹ˆë‹¤. ì•„ë˜ ê·¸ë¦¼ì€ ì§€ë‚œ ê°•ì˜ì˜ rqt_graphì…ë‹ˆë‹¤.\nìœ„ ê·¸ë¦¼ì—ì„œ ë™ê·¸ë¼ë¯¸ëŠ” Nodeë¥¼ ëœ»í•˜ê³ , í™”ì‚´í‘œëŠ” topicì„ ëœ»í•©ë‹ˆë‹¤.\nì´ë²ˆ ì‹œê°„ì—ëŠ” ì´ Topicì´ ë¬´ì—‡ì¸ì§€ ë°°ì›Œë³´ê³ ì í•©ë‹ˆë‹¤.\nTopicì€ Nodeë“¤ ì‚¬ì´ì— ë°ì´í„°(Message)ê°€ ì˜¤ê°€ëŠ” ê¸¸(Bus)ì˜ ì´ë¦„ì…ë‹ˆë‹¤. image from : docs.ros.org ê·¸ë¦¼ì—ì„œì™€ ê°™ì´ ROS Topicì€\nPublisher(ë°œí–‰ì) Subscriber(êµ¬ë…ì)ë¡œ ë‚˜ëˆ„ì–´ Topicì˜ ì†¡ì‹ , ìˆ˜ì‹ ìë¥¼ êµ¬ë¶„í•©ë‹ˆë‹¤. Publisher, SubscriberëŠ” Nodeì•ˆì—ì„œ ìƒì„±ë˜ë©° ë³„ë„ë¡œ ì‚¬ìš©í•  ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤. Pub/Sub ì‚¬ì´ì— Messageê°€ ì „ë‹¬ë˜ë©°, ì´ ê¸¸ì˜ ì´ë¦„ì´ Topicì¸ ê²ƒì…ë‹ˆë‹¤. ì£¼ì˜í•  ì ì€, Publisher, SubscriberëŠ” ì˜¤ë¡œì§€ Topicì˜ ì´ë¦„ìœ¼ë¡œ ì†Œí†µí•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì–´ë–¤ Nodeì— publish í• ì§€ PublisherëŠ” ì „í˜€ ëª¨ë¥´ë©° ì˜¤ë¡œì§€ Topicì´ ê°™ì€ Subscriberê°€ ë°ì´í„°ë¥¼ ë°›ê²Œ ë©ë‹ˆë‹¤. ë”ë¶ˆì–´, Topicì€ ì—¬ëŸ¬ Nodeë“¤ë¡œ ë¶€í„° ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìˆê³ , ì „ì†¡ ì‹œì—ë„ ì—¬ëŸ¬ Nodeë“¤ì—ê²Œ ì „ì†¡ì´ ê°€ëŠ¥í•œ ë°©ì‹ì…ë‹ˆë‹¤. â‡’ Topicì˜ ì¤‘ìš”í•œ ì†ì„±ì´ë‹ˆ ê¼­ ì•Œì•„ë‘ì…¨ìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.\nimage from : docs.ros.org Nodeì™€ Topicì˜ ê°œë…ì„ ë‹¤ì‹œ í•œ ë²ˆ ë‹¤ì¡ê³  ê°‘ì‹œë‹¤.\nNodeëŠ” ì‹¤í–‰ë˜ëŠ” í”„ë¡œê·¸ë¨ì´ë©°, ROS Masterì— ë“±ë¡í•˜ê³  ê´€ë¦¬ë©ë‹ˆë‹¤. Nodeë“¤ ì‚¬ì´ì˜ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ ì¤‘ Topicì´ë¼ëŠ” ê²ƒì´ ìˆìœ¼ë©°, ì´ëŠ” Publisherì™€ Subscriberë¼ëŠ” ê°œë…ì„ ê°–ê³  ìˆìŠµë‹ˆë‹¤. Publisherì™€ Subscriber ì‚¬ì´ì˜ ì˜¤ê°€ëŠ” ë°ì´í„°ëŠ” íŠ¹ì •í•œ íƒ€ì…ì„ ê°–ìŠµë‹ˆë‹¤. ì´ë¥¼ Messageë¼ê³  ë¶€ë¦…ë‹ˆë‹¤. Topic Message ë¡œë´‡ í”„ë¡œê·¸ë˜ë° ì‹œì—ëŠ” ë‹¤ì–‘í•œ ì„¼ì„œ ë°ì´í„°ë“¤ì´ ë‹¤ë¤„ì§‘ë‹ˆë‹¤. ì„¼ì„œ ë¿ë§Œ ì•„ë‹ˆë¼, ì œì–´ ë°ì´í„°ë„ ì£¼ê³  ë°›ì•„ì•¼ í•©ë‹ˆë‹¤. ROSì—ì„œëŠ” ì£¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì´ëŸ¬í•œ ë°ì´í„° í˜•ì‹ì„ Messageë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì§€ì¹­í•˜ë©°, ì—¬ëŸ¬ ê¸°ë³¸ í˜•íƒœë¥¼ ì œê³µí•©ë‹ˆë‹¤. ë”ë¶ˆì–´ ì‚¬ìš©ìê°€ ì§ì ‘ Messageë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\nì¼ì „ ì˜ˆì‹œì˜ ë¶„ì„ì„ í†µí•´ Topicê³¼ Messageì— ëŒ€í•´ ë‹¤ì‹œ í•œ ë²ˆ ì‚´í´ë´…ì‹œë‹¤. # Terminal 1 roscore # Terminal 2 rosrun roscpp_tutorials talker # Terminal 3 rosrun roscpp_tutorials listener ë‘ í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë˜ê³  ìˆëŠ” ìƒíƒœë¥¼ ìœ ì§€í•˜ë©´ì„œ, ì•„ë˜ ë‚´ìš©ì„ ë”°ë¼ì™€ì£¼ì„¸ìš”\nrostopic listë¥¼ í†µí•´ ì‚¬ìš©ì¤‘ì¸ topicë“¤ì„ ëª¨ë‘ ì¡°íšŒ ê°€ëŠ¥í•©ë‹ˆë‹¤. $ rostopic list /chatter /rosout /rosout_agg íŠ¹ì • topicì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ë¥¼ ì•Œê³  ì‹¶ë‹¤ë©´ rostopic infoë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. talkerì™€ listenerê°€ ì¡°íšŒëœ ëª¨ìŠµë„ ë³´ì…ë‹ˆë‹¤. $ rostopic info /chatter Type: std_msgs/String Publishers: * /talker_215337_1671763968667 (http://192.168.55.236:37863/) Subscribers: * /listener_215355_1671763970127 (http://192.168.55.236:44969/) í•´ë‹¹ topicì´ ì‚¬ìš©ì¤‘ì¸ Messageë¥¼ ì¡°íšŒí•˜ê¸° ìœ„í•´ rostopic typeì„ ì‚¬ìš©í•©ë‹ˆë‹¤. $ rostopic type /chatter std_msgs/String rosmsg showë¥¼ í†µí•´ Messageì˜ ì›í˜•ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. $ rosmsg show std_msgs/String string data topic ë°ì´í„°ë¥¼ ì—¿ë³¼ ìˆ˜ ìˆëŠ” rostopic echoì…ë‹ˆë‹¤. $ rostopic echo /chatter data: \u0026#34;hello world 1671764088.1913402\u0026#34; --- data: \u0026#34;hello world 1671764088.2913551\u0026#34; --- ... rostopic hzë¡œ topicì˜ pub/sub ì£¼ê¸°ë¥¼ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. $ rostopic hz /chatter subscribed to [/chatter] average rate: 10.000 min: 0.100s max: 0.100s std dev: 0.00014s window: 10 average rate: 9.999 min: 0.099s max: 0.100s std dev: 0.00023s window: 20 ë§ˆì§€ë§‰ìœ¼ë¡œ rqt_graphë¥¼ ë‹¤ì‹œ í•œ ë²ˆ ì‚´í´ë´…ì‹œë‹¤.\nrqt_graph ë°©ê¸ˆ ì‚´í´ë³¸ ì»¤ë©˜ë“œ ë¼ì¸ë“¤ì„ ì¶©ë¶„íˆ ìˆ™ì§€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. ê·¸ëŸ¬í•œ ì˜ë¯¸ì—ì„œ, ì´ë²ˆì—ëŠ” Gazebo ì˜ˆì‹œë¥¼ ë¶„ì„í•´ë³¼ê¹Œ í•©ë‹ˆë‹¤.\n# Terminal 1 roslaunch smb_gazebo smb_gazebo.launch # Terminal 2 rosrun teleop_twist_keyboard teleop_twist_keyboard.py rostopic list ê²°ê³¼ $ rostopic list /clicked_point /clock /cmd_vel /diagnostics /e_stop /gazebo/link_states /gazebo/model_states /gazebo/parameter_descriptions /gazebo/parameter_updates /gazebo/performance_metrics /gazebo/set_link_state ... ìš°ë¦¬ê°€ ì§‘ì¤‘í•˜ê³ ì í•˜ëŠ” topicì€ ë¡œë´‡ì„ ì œì–´í•˜ëŠ” /cmd_velì…ë‹ˆë‹¤.\nrostopic info ê²°ê³¼ $ rostopic info /cmd_vel Type: geometry_msgs/Twist Publishers: * /teleop_twist_keyboard (http://192.168.55.236:33903/) Subscribers: * /twist_mux (http://192.168.55.236:38201/) * /gazebo (http://192.168.55.236:33033/) rostopic type ê²°ê³¼ $ rostopic type /cmd_vel geometry_msgs/Twist geometry_msgs/Twistì˜ rosmsg show ê²°ê³¼ $ rosmsg show geometry_msgs/Twist geometry_msgs/Vector3 linear float64 x float64 y float64 z geometry_msgs/Vector3 angular float64 x float64 y float64 z /scanì˜ rostopic echo ê²°ê³¼ $ rostopic echo /scan header: seq: 0 stamp: secs: 204 nsecs: 678000000 frame_id: \u0026#34;rslidar\u0026#34; angle_min: -1.5707999467849731 angle_max: 1.5707999467849731 angle_increment: 0.008700000122189522 time_increment: 0.0 scan_time: 0.033330000936985016 range_min: 0.44999998807907104 range_max: 50.0 ranges: [inf, inf, inf, inf, inf, inf, inf, inf, inf, inf, inf, ... /scanì˜ rostopic hzê²°ê³¼ $ rostopic hz /scan subscribed to [/scan] WARNING: may be using simulated time average rate: 10.000 min: 0.100s max: 0.100s std dev: 0.00000s window: 8 average rate: 10.000 min: 0.100s max: 0.100s std dev: 0.00000s window: 17 rqt_graphì—ì„œ /cmd_velì„ ì°¾ì•„ë³¼ê¹Œìš”?\nrqt_graph Publisher í”„ë¡œê·¸ë˜ë° ì´ë²ˆ ì‹œê°„ ì‚¬ìš©í•  PackageëŠ” py_topic_pkg ì…ë‹ˆë‹¤. ì‹¤ìŠµ ì „ ì‹¤í–‰ë¶€í„° í•´ë³´ê² ìŠµë‹ˆë‹¤.\nPackage Build cd ~/catkin_ws catkin build py_topic_pkg source devel/setup.bash ì˜ˆì œ ì‹¤í–‰ # Terminal 1 roslaunch smb_gazebo smb_gazebo.launch # Terminal 2 rosrun py_topic_pkg cmd_vel_pub.py ë¡œë´‡ì´ ì•„ë˜ì™€ ê°™ì´ ì›ì„ ê·¸ë¦¬ë©° ì›€ì§ì¼ ê²ƒì…ë‹ˆë‹¤.\ncmd_vel_pub.py #!/usr/bin/env python3 import rospy from geometry_msgs.msg import Twist class CmdVelPubNode: def __init__(self): # Publisher requires 3 paramters # 1. topic name # 2. topic msg type # 3. topic queue size self.cmd_vel_pub_ = rospy.Publisher(\u0026#34;cmd_vel\u0026#34;, Twist, queue_size=10) self.timer_ = rospy.Timer(rospy.Duration(1.0/10.0), self.pub_msg) self.twist_ = Twist() def pub_msg(self, event=None): # geometry_msgs.Twist # ref: http://docs.ros.org/en/melodic/api/geometry_msgs/html/msg/Twist.html self.twist_.linear.x = 0.5 self.twist_.angular.z = 1.0 self.cmd_vel_pub_.publish(self.twist_) def cmd_vel_node(): rospy.init_node(\u0026#39;cmd_vel_node\u0026#39;, anonymous=True) cmd_vel_pub_node = CmdVelPubNode() rospy.spin() if __name__ == \u0026#39;__main__\u0026#39;: try: cmd_vel_node() except rospy.ROSInterruptException: pass íŒŒì´ì¬ ros í”„ë¡œê·¸ë˜ë°ì„ ìœ„í•œ rospy, ë¡œë´‡ì˜ ì†ë„ ì œì–´ì— í•„ìš”í•œ Message typeì¸ Twistë¥¼ import í•˜ê³  ìˆìŠµë‹ˆë‹¤. import rospy from geometry_msgs.msg import Twist rospy.Publisherë¥¼ í†µí•´ publisherë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ìµœì†Œ 3ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤. topic ì´ë¦„ topic type queue size self.cmd_vel_pub_ = rospy.Publisher(\u0026#34;cmd_vel\u0026#34;, Twist, queue_size=10)= ìš°ë¦¬ëŠ” ë¡œë´‡ì˜ ì œì–´ ì‹ í˜¸ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ ì „ì†¡í•˜ê³ ì í•©ë‹ˆë‹¤. ë”°ë¼ì„œ Timerë„ ì„ ì–¸í•˜ì˜€ìŠµë‹ˆë‹¤. self.timer_ = rospy.Timer(rospy.Duration(1.0/10.0), self.pub_msg) ë‹¤ìŒìœ¼ë¡œ, Message Typeì¸ geometry_msgs/Twist ê°’ì„ ì±„ì›ë‹ˆë‹¤. í˜„ì¬ ìš°ë¦¬ ë¡œë´‡ì€ 2ì°¨ì› í‰ë©´ì—ì„œ ì›€ì§ì´ë©°, ë¡œë´‡ í˜•íƒœ ë•Œë¬¸ì— ì•ë’¤ ì„ ì†ë„ì™€ ê°ì†ë„ë¥¼ ê°–ê²Œ ë©ë‹ˆë‹¤. ... self.twist_ = Twist() def pub_msg(self, event=None): self.twist_.linear.x = 0.5 self.twist_.angular.z = 1.0 Messageì˜ ì¢…ë¥˜ëŠ” ë§¤ìš° ë§ìŠµë‹ˆë‹¤. êµ¬ê¸€ì„ í†µí•´ ê²€ìƒ‰í•˜ë©´ì„œ ì½”ë”©í•˜ëŠ” ìŠµê´€ì„ ë“¤ì—¬ë´…ì‹œë‹¤.\nfrom : http://docs.ros.org/ linearì˜ ë‹¨ìœ„ëŠ” m/s ì´ë©°, angularì˜ ë‹¨ìœ„ëŠ” rad/s ì…ë‹ˆë‹¤. pi = 3.14\në§ˆì§€ë§‰, ê°€ì¥ ì¤‘ìš”í•œ topic publishëŠ” ìƒì„±í•œ Publisherì˜ publish() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë¯¸ë¦¬ ì¤€ë¹„í•´ë‘” topic messageë¥¼ ì‚¬ìš©í•©ì‹œë‹¤. def pub_msg(self, event=None): # geometry_msgs.Twist # ref: http://docs.ros.org/en/melodic/api/geometry_msgs/html/msg/Twist.html self.twist_.linear.x = 0.5 self.twist_.angular.z = 1.0 self.cmd_vel_pub_.publish(self.twist_) ì´ Nodeë¥¼ ì‹¤í–‰í•˜ë©´, ìš°ë¦¬ì˜ ROSê°€ ì¼ì • ì£¼ê¸°ì— ë§ì¶”ì–´ ì•Œë§ê²Œ topic publishë¥¼ ì‹¤í–‰ì‹œì¼œì¤„ ê²ƒì…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì •í•´ì§„ êµ¬í˜„ì— ë§ì¶”ì–´ ì½”ë“œë§Œ ì‘ì„±í•˜ë©´ ë˜ëŠ” ê²ƒì´ì§€ìš” ğŸ˜Š\ndef cmd_vel_node(): rospy.init_node(\u0026#39;cmd_vel_node\u0026#39;, anonymous=True) cmd_vel_pub_node = CmdVelPubNode() rospy.spin() Subscriber í”„ë¡œê·¸ë˜ë° ì´ë²ˆ ì˜ˆì‹œì—ëŠ” ë¡œë´‡ì— ì¥ì°©ëœ ë¼ì´ë‹¤ ì„¼ì„œë¥¼ ì‚¬ìš©í•´ë³´ë ¤ í•©ë‹ˆë‹¤. ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤. # Terminal 1 roslaunch smb_gazebo smb_gazebo.launch # Terminal 2 rosrun py_topic_pkg laser_scan_sub.py ì‹¤í–‰ ì´í›„, ì˜ìƒê³¼ ê°™ì´ ë°•ìŠ¤ë¥¼ ë¡œë´‡ì˜ ì „ë°©ì— ë°°ì¹˜í•´ë´…ì‹œë‹¤. í„°ë¯¸ë„ì— ë“±ì¥í•˜ëŠ” ë¬¸êµ¬ì— ì§‘ì¤‘í•´ë³´ì„¸ìš”. ë°•ìŠ¤ê°€ ì¶”ê°€ë˜ë©´ì„œ ì¶œë ¥ì°½ì— ì–´ë– í•œ ë³€í™”ê°€ ìƒê¸°ë‚˜ìš”?\në¡œë´‡ì— ë¶€ì°©ëœ ë¼ì´ë‹¤ ì„¼ì„œëŠ” ì „ë°© 180ë„ ì‚¬ë°©ìœ¼ë¡œ 360ê°œì˜ ë ˆì´ì €ë¥¼ í©ë¿Œë¦½ë‹ˆë‹¤.\në ˆì´ì €ì˜ íŠ¹ì„±ìƒ ë¬¼ì²´ë¥¼ ë§ê³  ë˜ëŒì•„ì˜¤ê²Œ ë˜ë©°, ì´ ì‹œê°„ì„ í†µí•´ ë¬¼ì²´ì™€ì˜ ê±°ë¦¬ë¥¼ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì˜ˆì‹œì˜ í”„ë¡œê·¸ë¨ì€ ë¡œë´‡ì— ë¶€ì°©ëœ ë ˆì´ì €ì—ì„œ publishë˜ëŠ” ë°ì´í„°ë¥¼ subscribeí•œ ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ í”„ë¡œê·¸ë˜ë°í•˜ë©´ì„œ pythonìœ¼ë¡œ subscriberë¥¼ ë‹¤ë£¨ëŠ” ë°©ë²•ì— ëŒ€í•´ ë°°ì›Œë´…ì‹œë‹¤.\nlaser_scan_sub.py #!/usr/bin/env python3 import rospy from sensor_msgs.msg import LaserScan class LaserSubNode: def __init__(self): # Publisher requires 3 paramters # 1. topic name # 2. topic msg type # 3. sub callback method self.laser_sub_ = rospy.Subscriber(\u0026#34;scan\u0026#34;, LaserScan, self.laser_cb) # first param of callback method is always topic msg def laser_cb(self, data): rospy.loginfo( len(data.ranges)) print(f\u0026#34;\u0026#34;\u0026#34; data.ranges[0]: {data.ranges[0]} data.ranges[90]: {data.ranges[90]} data.ranges[179]: {data.ranges[179]} data.ranges[270]: {data.ranges[270]} data.ranges[360]: {data.ranges[360]} \u0026#34;\u0026#34;\u0026#34;) def laser_sub_node(): rospy.init_node(\u0026#39;laser_sub_node\u0026#39;, anonymous=True) laser_sub_node = LaserSubNode() rospy.spin() if __name__ == \u0026#39;__main__\u0026#39;: try: laser_sub_node() except rospy.ROSInterruptException: pass ì´ë²ˆì— ì‚¬ìš©í•˜ëŠ” topic messageëŠ” sensor_msgs/LaserScanì…ë‹ˆë‹¤. import rospy from sensor_msgs.msg import LaserScan subscriberëŠ” publisherì™€ ë‹¬ë¦¬ Timerê°€ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. publishë˜ëŠ” ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì•„ë¬´ ë™ì‘ì„ í•  ìˆ˜ ì—†ìœ¼ë©°, publish ì£¼ê¸°ì— ë§ì¶”ì–´ subscribeí•  ìˆ˜ë°–ì— ì—†ëŠ” ê²ƒì´ì§€ìš”.\nsubscriberëŠ” rospy.Subscriberë¡œ ìƒì„±í•˜ë©° ìµœì†Œ 3ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ìš”êµ¬í•©ë‹ˆë‹¤. topic ì´ë¦„ topic message ì´ë¦„ subscribe ë§ˆë‹¤ ì‹¤í–‰ë˜ëŠ” callback ë©”ì†Œë“œ class LaserSubNode: def __init__(self): # Publisher requires 3 paramters # 1. topic name # 2. topic msg type # 3. sub callback method self.laser_sub_ = rospy.Subscriber(\u0026#34;scan\u0026#34;, LaserScan, self.laser_cb) ì´ callback ë©”ì†Œë“œì—ì„œ ì£¼ì˜í•´ì•¼ í•  ì ì€, í•­ìƒ callback methodì˜ ë§¤ê°œë³€ìˆ˜ê°€ subscribeëœ ë°ì´í„°ë¼ëŠ” ì ì…ë‹ˆë‹¤. ì§€ê¸ˆì˜ ê²½ìš° LaserScan íƒ€ì…ì˜ ë°ì´í„°ì¼ ê²ƒì…ë‹ˆë‹¤. # first param of callback method is always topic msg def laser_cb(self, data): rospy.loginfo( len(data.ranges)) ... ë§ˆì§€ë§‰ìœ¼ë¡œ, ê¹”ë”í•œ í„°ë¯¸ë„ ì¶œë ¥ì„ ìœ„í•´ print í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. print(f\u0026#34;\u0026#34;\u0026#34; data.ranges[0]: {data.ranges[0]} data.ranges[90]: {data.ranges[90]} data.ranges[179]: {data.ranges[179]} data.ranges[270]: {data.ranges[270]} data.ranges[360]: {data.ranges[360]} \u0026#34;\u0026#34;\u0026#34;) Subscriber ì‹¤í–‰ ì‹œì—ëŠ” í•­ìƒ rospy.spin()ì„ ìŠì§€ ë§ë„ë¡ í•©ë‹ˆë‹¤. spin ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´ íŠ¹ì • ì“°ë ˆë“œê°€ ìì›ì„ ì ìœ í•˜ê¸° ë•Œë¬¸ì— subscriberì˜ ìƒíƒœë¥¼ ê°±ì‹ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\ndef laser_sub_node(): rospy.init_node(\u0026#39;laser_sub_node\u0026#39;, anonymous=True) laser_sub_node = LaserSubNode() rospy.spin() ê³¼ì œ - ë¬¼ì²´ íšŒí”¼í•˜ê¸° pub/subì˜ ê°œë…ì„ ì˜ ì´í•´í•˜ì˜€ëŠ”ì§€ ì•Œì•„ë³¼ ìˆ˜ ìˆëŠ” ê³¼ì œë¥¼ ì¤€ë¹„í•´ë³´ì•˜ìŠµë‹ˆë‹¤. ì •ë‹µì´ ë”°ë¡œ ìˆëŠ” ê²ƒì€ ì•„ë‹ˆê¸°ì— ë¶€ë‹´ ì—†ì´ í•´ë³´ì‹œê³ , ì €ì˜ ë‹µì•ˆë„ í•œë²ˆ ì‚´í´ë³´ì„¸ìš”.\nì˜ˆì œ ì‹¤í–‰ # Terminal 1 roslaunch smb_gazebo smb_gazebo.launch # Ternimal 2 rosrun py_topic_pkg collision_aviod.py Gazebo ì˜ˆì œë¥¼ ì‹¤í–‰í•˜ì˜€ë‹¤ë©´, ë¡œë´‡ì˜ ì „ë°©ì— ì¥ì• ë¬¼ì„ ë†“ì•„ ì§„ë¡œë¥¼ ë§‰ì•„ë´…ë‹ˆë‹¤. ì—¬ëŸ¬ë¶„ê»˜ì„œ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ê²ƒì€, ë¼ì´ë‹¤ ì„¼ì„œë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œë´‡ì´ íšŒí”¼ ì£¼í–‰ì„ í•˜ë„ë¡ ë§Œë“œëŠ” ê²ƒì…ë‹ˆë‹¤. ì¼ì¢…ì˜ í…œí”Œë › ì½”ë“œë¥¼ ì²¨ë¶€í•˜ì˜€ìœ¼ë©°, my_collision_aviod.pyë¼ëŠ” ì´ë¦„ì˜ ì½”ë“œì…ë‹ˆë‹¤.\ní•´ë‹¹ ì½”ë“œì˜ TODO ë¶€ë¶„ì„ ì‘ì„±í•˜ì—¬ ì—¬ëŸ¬ë¶„ë§Œì˜ íšŒí”¼ ì•Œê³ ë¦¬ì¦˜ì„ ë§Œë“¤ì–´ ë³´ì„¸ìš”!\në¡œë´‡ì˜ ë¼ì´ë‹¤ ë°ì´í„°ì¸ LaserScanì„ Subscribeí•˜ì—¬ Twist Typeì„ ì‚¬ìš©í•˜ëŠ” scan topicìœ¼ë¡œ publishë¥¼ í•˜ê²Œ ë©ë‹ˆë‹¤. class CollisionAvoidNode: def __init__(self): self.laser_sub_ = rospy.Subscriber(\u0026#34;scan\u0026#34;, LaserScan, self.laser_cb) self.cmd_vel_pub_ = rospy.Publisher(\u0026#34;cmd_vel\u0026#34;, Twist, queue_size=10) self.twist_ = Twist() def laser_cb(self, data): # TODO: Prevent robot from collision # make your own logic to do that return None ì œê°€ ì‘ì„±í•œ ì˜ˆì‹œë¥¼ ìˆ˜ì •í•˜ì—¬ ë”ìš± ë˜‘ë˜‘í•œ ë¡œë´‡ì„ êµ¬í˜„í•˜ì…”ë„ ì¢‹ê³ , ììœ ë¡­ê²Œ ì‹¤ìŠµí•´ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤.\nì°¸ê³ ìë£Œ\nhttps://rsl.ethz.ch/education-students/lectures/ros.html https://docs.ros.org/en/foxy/index.html http://wiki.ros.org/msg "
},
{
	"uri": "/kr/ros_basic_noetic/lecture6/",
	"title": "Lecture6 - ROS Service, Parameter",
	"tags": [],
	"description": "",
	"content": " ì§€ë‚œ ì‹œê°„ ë§ˆì§€ë§‰ ì˜ˆì‹œì˜€ë˜ ì¥ì• ë¬¼ íšŒí”¼ ì½”ë“œë¶€í„° ê°„ë‹¨í•˜ê²Œ ë¦¬ë·°í•´ë³´ê³ ì í•©ë‹ˆë‹¤.\nì œê°€ ì‘ì„±í•œ ë¡œì§ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nê³¼ì œë¥¼ í•´ë³´ì…¨ë‹¤ë©´ ì•„ì‹œê² ì§€ë§Œ, ì¸¡ì • ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ê²Œ ë˜ë©´ data.rangesëŠ” inf ê°’ì„ ê°–ê²Œ ë©ë‹ˆë‹¤. ì´ë¥¼ ê±¸ëŸ¬ë‚´ëŠ” ì½”ë“œê°€ ì•„ë˜ ë¶€ë¶„ì…ë‹ˆë‹¤. for i, point in enumerate(data.ranges): if not math.isinf(point) and point \u0026lt; 1.0: ì €ì˜ ë¡œì§ì€, ì •ë©´ì„ ê¸°ì ìœ¼ë¡œ ì™¼ìª½ê³¼ ì˜¤ë¥¸ìª½ ê°ê° infê°€ ì•„ë‹Œ ë°ì´í„°ì˜ ê°œìˆ˜ë¥¼ ì¹´ìš´íŒ…í•©ë‹ˆë‹¤. ì „ì²´ ë°ì´í„°ê°€ 362ê°œì´ê³  ë§ˆì§€ë§‰ ë°ì´í„°ëŠ” ì‚¬ìš©í•˜ê¸° ì•ŠëŠ” ê°’ì´ê¸° ë•Œë¬¸ì—, 180ì„ ê¸°ì ìœ¼ë¡œ ì¡ì•˜ìŠµë‹ˆë‹¤. left_side_count = 0 right_side_count = 0 for i, point in enumerate(data.ranges): if not math.isinf(point) and point \u0026lt; 1.0: if i \u0026gt; 180: left_side_count += 1 else: right_side_count += 1 ì´ì œ, ì œì–´ ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤. ROSë¥¼ ë¹„ë¡¯í•˜ì—¬ ë¡œë´‡ ì‹œìŠ¤í…œì—ì„œëŠ” ëŒ€ë¶€ë¶„ ì˜¤ë¥¸ì† ì¢Œí‘œê³„ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ìœ„ì—ì„œ ë³´ì•˜ì„ rospy.loginfo(hello_du)ë•Œ ì˜¤ë¥¸ì†ì´ ê°ê¸°ëŠ” ë°˜ì‹œê³„ ë°©í–¥ì´ + ë¶€í˜¸ë¥¼ ê°–ê²Œ ë©ë‹ˆë‹¤. ì´ë¥¼ ê³ ë ¤í•˜ì—¬ ê°ì†ë„ë¥¼ ì •í–ˆìŠµë‹ˆë‹¤. 180ì€ magic number, ì¼ì¢…ì˜ ë³€í™˜ ìƒìˆ˜ì…ë‹ˆë‹¤. image from : ì˜¤ë¡œì¹´\ndef laser_cb(self, data): left_side_count = 0 right_side_count = 0 for i, point in enumerate(data.ranges): if not math.isinf(point) and point \u0026lt; 1.0: if i \u0026gt; 180: left_side_count += 1 else: right_side_count += 1 self.twist_.linear.x = 0.3 self.twist_.angular.z = (right_side_count - left_side_count) / 100 self.cmd_vel_pub_.publish(self.twist_) ì§€ë‚œ ê°•ì˜ì—ì„œ ì´ì•¼ê¸°í•œ ê²ƒê³¼ ê°™ì´ ì´ ë¬¸ì œì˜ ì •ë‹µì€ ì—†ìŠµë‹ˆë‹¤.\në‹¤ë§Œ, Topicì˜ Pub / Subì„ ëª¨ë‘ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ì§€ ìŠ¤ìŠ¤ë¡œ ì ê²€í•´ë³¼ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.\nROS Parameter ì•ì„  ì €ì˜ ì˜ˆì‹œì—ì„œ ë§ˆì§€ë§‰ ì†ë„ë¡œ ë³€í™˜í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì‹ì— ë‚˜ëˆ„ê¸° 100ì´ ìˆì—ˆë˜ ê²ƒì„ ê¸°ì–µí•˜ì‹œë‚˜ìš”? ì´ëŸ° ìƒìˆ˜ë¥¼ ì§ì ‘ ì½”ë“œì— ì ëŠ” ê²ƒì€ ì‚¬ì‹¤ ì¶”ì²œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê°œë°œ ì´í›„ í•´ë‹¹ ìƒìˆ˜ë¥¼ ë³€ê²½í•˜ê³ ì í•˜ì˜€ì„ ì‹œ, ì§ì ‘ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ê³  ë‹¤ì‹œ ì‹¤í–‰í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë¶ˆí¸ì„ ì•¼ê¸°í•©ë‹ˆë‹¤.\nì´ëŸ¬í•œ ë¬¸ì œì˜ í•´ê²° ë°©ë²•ìœ¼ë¡œ ROSì˜ ë§¤ê°œë³€ìˆ˜, parameterë¥¼ ë‹¤ë£¨ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.\npy_param_pkg/scripts/various_params.py #!/usr/bin/env python3 import rospy class ParamNode: def __init__(self): self.str_param_ = rospy.get_param(\u0026#39;~str_param\u0026#39;, \u0026#39;hello_world\u0026#39;) self.int_param_ = rospy.get_param(\u0026#39;~int_param\u0026#39;, 2023) self.double_param_ = rospy.get_param(\u0026#39;~double_param\u0026#39;, 3.14) self.bool_param_ = rospy.get_param(\u0026#39;~bool_param\u0026#39;, True) self.list_of_float_param_ = rospy.get_param(\u0026#39;~list_of_float_param\u0026#39;, [1., 2., 3., 4.]) rospy.loginfo(f\u0026#34;\u0026#34;\u0026#34; self.str_param_ = {self.str_param_} self.int_param_ = {self.int_param_} self.double_param_ = {self.double_param_} self.bool_param_ = {self.bool_param_} self.list_of_float_param_ = {self.list_of_float_param_} \u0026#34;\u0026#34;\u0026#34;) def param_node(): rospy.init_node(\u0026#39;param_node\u0026#39;, anonymous=True) param_node = ParamNode() rospy.spin() if __name__ == \u0026#39;__main__\u0026#39;: try: param_node() except rospy.ROSInterruptException: pass ì‹¤í–‰ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. $ rosrun py_param_pkg various_params.py [INFO] [1672014267.630578]: self.str_param_ = hello_world self.int_param_ = 2023 self.double_param_ = 3.14 self.bool_param_ = True self.list_of_float_param_ = [1.0, 2.0, 3.0, 4.0] ë§¤ê°œë³€ìˆ˜ë¥¼ ì„ ì–¸í•˜ê³  ê¸°ë³¸ê°’ì„ ì§€ì •í•˜ëŠ” ë°©ë²•ì€ rospy.get_paramì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë‘ë²ˆì§¸ ê¸°ë³¸ê°’ì„ ì˜ ë³´ë©´ ì–´ë–¤ íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. def __init__(self): self.str_param_ = rospy.get_param(\u0026#39;~str_param\u0026#39;, \u0026#39;hello_world\u0026#39;) self.int_param_ = rospy.get_param(\u0026#39;~int_param\u0026#39;, 2023) self.double_param_ = rospy.get_param(\u0026#39;~double_param\u0026#39;, 3.14) self.bool_param_ = rospy.get_param(\u0026#39;~bool_param\u0026#39;, True) self.list_of_float_param_ = rospy.get_param(\u0026#39;~list_of_float_param\u0026#39;, [1., 2., 3., 4.]) parameter ì•ì— ë¶™ëŠ” ë¬¼ê²° í‘œì‹œ (~)ëŠ” private parameterë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. ì´ì— ëŒ€í•´ ê¶ê¸ˆí•˜ë‹¤ë©´ ì•„ë˜ì˜ ì¶”ê°€ ìë£Œë¥¼ í•™ìŠµí•´ë³´ì„¸ìš”. global_name = rospy.get_param(\u0026#34;/global_name\u0026#34;) relative_name = rospy.get_param(\u0026#34;relative_name\u0026#34;) private_param = rospy.get_param(\u0026#39;~private_name\u0026#39;) default_param = rospy.get_param(\u0026#39;default_param\u0026#39;, \u0026#39;default_value\u0026#39;) ì¶”ê°€ ìë£Œ : wiki.ros\në§¤ê°œë³€ìˆ˜ë¥¼ ë³€ê²½í•˜ëŠ” ê°€ì¥ ë³´ë³€ì ì¸ ë°©ë²•ì€ launch fileì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. launch fileì˜ param íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ Nodeì— ì›í•˜ëŠ” parameterë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. \u0026lt;launch\u0026gt; \u0026lt;node name=\u0026#34;various_param_node\u0026#34; pkg=\u0026#34;py_param_pkg\u0026#34; type=\u0026#34;various_params.py\u0026#34; respawn=\u0026#34;false\u0026#34; output=\u0026#34;screen\u0026#34; \u0026gt; \u0026lt;param name=\u0026#34;str_param\u0026#34; type=\u0026#34;string\u0026#34; value=\u0026#34;roslaunch changed me\u0026#34; /\u0026gt; \u0026lt;/node\u0026gt; \u0026lt;/launch\u0026gt; ROS í”„ë¡œê·¸ë˜ë°ì„ í•˜ë‹¤ ë³´ë©´ ë§¤ê°œë³€ìˆ˜ê°€ ì•„ì£¼ ë§ì´ í•„ìš”í•œ ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ì´ëŸ´ ë•Œë§ˆë‹¤ launch fileì— param íƒœê·¸ ë¼ì¸ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì€ ë§¤ìš° ê·€ì°®ì€ ì¼ì…ë‹ˆë‹¤.\nyamlì´ë¼ëŠ” í˜•ì‹ì˜ íŒŒì¼ë¡œ ë§¤ê°œë³€ìˆ˜ë¥¼ í•œë²ˆì— ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\npy_param_pkg/param/config.yaml str_param: \u0026#34;yaml string\u0026#34; int_param: 9 double_param: 2.71828 bool_param: \u0026#34;false\u0026#34; list_of_float_param: [3., 2., 1.] py_param_pkg/launch/param_with_yaml.launch \u0026lt;launch\u0026gt; \u0026lt;node name=\u0026#34;various_param_node\u0026#34; pkg=\u0026#34;py_param_pkg\u0026#34; type=\u0026#34;various_params.py\u0026#34; respawn=\u0026#34;false\u0026#34; output=\u0026#34;screen\u0026#34; \u0026gt; \u0026lt;rosparam command=\u0026#34;load\u0026#34; file=\u0026#34;$(find py_param_pkg)/param/config.yaml\u0026#34; /\u0026gt; \u0026lt;param name=\u0026#34;str_param\u0026#34; type=\u0026#34;string\u0026#34; value=\u0026#34;roslaunch changed me\u0026#34; /\u0026gt; \u0026lt;/node\u0026gt; \u0026lt;/launch\u0026gt; launch fileì— rosparam íƒœê·¸ë¥¼ ì¶”ê°€í•˜ê³ , load commandë¥¼ ì‚¬ìš©í•˜ë©° ì‚¬ìš©í•˜ëŠ” yaml íŒŒì¼ì˜ ìœ„ì¹˜ë¥¼ file ì˜µì…˜ì„ í†µí•´ ì „ë‹¬í•©ë‹ˆë‹¤.\nROS parameter Commands rostopic, rosnodeì™€ ê°™ì´ parameter ë˜í•œ í„°ë¯¸ë„ ëª…ë ¹ì–´ë¥¼ ê°–ê³  ìˆìŠµë‹ˆë‹¤.\nì ‘ê·¼ ê°€ëŠ¥í•œ ëª¨ë“  parameterë“¤ì„ ë‚˜ì—´í•©ë‹ˆë‹¤. rosparam list íŠ¹ì • paramterì˜ ê°’ì„ ì–»ê³ ìí•˜ë©´ ì•„ë˜ í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. rosparam get \u0026lt;parameter_name\u0026gt; ì„ ì–¸ë˜ì–´ ìˆëŠ” parameterì˜ ê°’ì„ ë³€ê²½í•˜ê³  ì‹¶ì€ ê²½ìš° ì•„ë˜ í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. rosparam set \u0026lt;parameter_name\u0026gt; \u0026lt;value\u0026gt; ì—¬ëŸ¬ë¶„ë“¤ì´ ì‘ì„±í•œ íšŒí”¼ í”„ë¡œê·¸ë¨ì—ë„ ë§¤ê°œë³€ìˆ˜ë¡œ ì‘ìš©í•˜ëŠ” ìƒìˆ˜ë“¤ì´ ìˆì„ ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ parameterë¡œ ë³€ê²½í•˜ì—¬ launch fileê³¼ yaml fileë¡œ ì—…ë°ì´íŠ¸í•˜ëŠ” ì‘ì—…ì„ í•´ë³´ì„¸ìš”\nROS Service Topicì— ì´ì–´ ROSì˜ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ ë‘ë²ˆì§¸ë¡œ Serviceë¥¼ ë°°ì›Œë³´ê² ìŠµë‹ˆë‹¤.\nServiceê°€ ë™ì‘í•˜ëŠ” ë°©ì‹ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.\nê·¸ë¦¼ê³¼ ê°™ì´ Client Nodeê°€ Server Nodeë¡œ requestë¥¼ ì£¼ë©´, í•´ë‹¹ requestì— ëŒ€ì‘í•˜ëŠ” ì ì ˆí•œ responseê°€ ë‹¤ì‹œ Clientì—ê²Œë¡œ ì „ë‹¬ë©ë‹ˆë‹¤. ì´ ê³¼ì •ì„ Service Callì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.\nimage from : docs.ros.org\ní•˜ë‚˜ì˜ Service Serverì—ëŠ” ì—¬ëŸ¬ Client Nodeê°€ request í•  ìˆ˜ ìˆì§€ë§Œ, ServerëŠ” ë™ì‹œì— ì—¬ëŸ¬ requestë¥¼ ì²˜ë¦¬í•˜ì§€ëŠ” ëª»í•©ë‹ˆë‹¤. ë‘ Nodeì—ì„œ ë™ì‹œì— requestê°€ ì™”ë‹¤ë©´, ì¡°ê¸ˆì´ë¼ë„ ë¨¼ì € í†µì‹ í•œ Nodeì˜ ì‘ì—…ì„ ìš°ì„  ì§„í–‰í•˜ê³ , ê·¸ë™ì•ˆ ë‹¤ë¥¸ NodeëŠ” ê¸°ë‹¤ë¦¬ê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤. image from : https://docs.ros.org/en/foxy/Tutorials/Services/Understanding-ROS2-Services.html\nTopicê³¼ ë¹„êµí•˜ì—¬ Serviceì˜ íŠ¹ì§•ì„ ì•Œì•„ë´…ì‹œë‹¤.\n1:1 í†µì‹  : Topic publishë¥¼ í•˜ë©´ ì—¬ëŸ¬ Nodeê°€ Subscribe ê°€ëŠ¥í•©ë‹ˆë‹¤. ë°˜ë©´, ServiceëŠ” requestê°€ ì˜¨ ëŒ€ìƒì—ê²Œë§Œ responseë¥¼ ì¤ë‹ˆë‹¤. ìˆœì°¨ì  í†µì‹  : Service ServerëŠ” ë™ì‹œì— ì—¬ëŸ¬ requestë¥¼ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜„ì¬ ì‘ì—…ì¤‘ì¸ requestê°€ ì²˜ë¦¬ë  ë•Œ ê¹Œì§€ ë‹¤ë¥¸ requestëŠ” ê¸°ë‹¤ë¦¬ê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ë‹¨ë°œì„± : Topicì€ ëŒ€ë¶€ë¶„ ì§€ì†ì ìœ¼ë¡œ publishë¥¼ ì§„í–‰í•˜ëŠ” ë°˜ë©´, ServiceëŠ” 1íšŒì„± í†µì‹ ì…ë‹ˆë‹¤. ì‹¤ì œ ë¡œë´‡ í”„ë¡œê·¸ë¨ì—ì„œ ServiceëŠ” ì–´ë–»ê²Œ ì‚¬ìš©ë  ìˆ˜ ìˆì„ì§€, ì˜ˆì‹œë¥¼ í†µí•´ ì‚´í´ë´…ì‹œë‹¤.\nì˜ˆì œ íŒ¨í‚¤ì§€ ë¹Œë“œ cd ~/catkin_ws catkin build py_service_pkg source devel/setup.bash Service Client ì˜ˆì œ ì‹¤í–‰ - ì•„ë¥´í‚¤ë©”ë°ìŠ¤ ë‚˜ì„  # Terminal 1 roslaunch py_service_pkg empty_gazebo.launch # Terminal 2 rosrun py_service_pkg spawn_model_client.py ë°©ê¸ˆ ì‹¤í–‰í•œ ì˜ˆì‹œëŠ” Gazeboì—ê²Œ boxë¥¼ ë“±ì¥ì‹œì¼œë‹¬ë¼ê³  í•˜ëŠ” Service Clientë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nBoxê°€ ë“±ì¥í•˜ëŠ” ìœ„ì¹˜ë¥¼ ì•„ë˜ ì‚¬ì§„ê³¼ ê°™ì€ ìˆ˜ì‹ì— ë§ì¶”ì–´ ì„¤ì •í•œ ê²ƒ ë¿ì…ë‹ˆë‹¤.\nê·¸ëŸ¼, ì½”ë“œë¥¼ ë¶„ì„í•´ ë³¼ê¹Œìš”?\ní•„ìš”í•œ íŒŒì´ì¬ íŒ¨í‚¤ì§€ë“¤ì„ import í•©ë‹ˆë‹¤. import math import rospy import rospkg from geometry_msgs.msg import Pose from gazebo_msgs.srv import SpawnModel ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ì ì€ msgì™€ srv ë¶€ë¶„ì…ë‹ˆë‹¤. topicì—ì„œ ì‚¬ìš©ë˜ëŠ” ë°ì´í„° íƒ€ì…ì´ Messageì˜€ê³ , í”„ë¡œê·¸ë˜ë° ì‹œì—ëŠ” msgë¡œ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.\nServiceì—ì„œëŠ” msgê°€ ì•„ë‹ˆë¼ srvë¼ëŠ” ë°ì´í„° íƒ€ì…ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. image from : rsl.eth\nì´ srvëŠ” msgì™€ ë‹¤ë¥¸ ì ì´ ìˆëŠ”ë°, requestì™€ responseë¡œ ë‚˜ë‰˜ì–´ ìˆë‹¤ëŠ” ì ì…ë‹ˆë‹¤. \u0026mdash; í‘œì‹œë¥¼ ê¸°ì ìœ¼ë¡œ ìœ„ìª½ì€ Serverì—ê²Œ ì „ë‹¬í•˜ëŠ” request, ì•„ë˜ìª½ì€ Serverê°€ ë‹¤ì‹œ íšŒë‹µí•˜ëŠ” response ë¶€ë¶„ì…ë‹ˆë‹¤. ì´ë²ˆ ì˜ˆì‹œì—ì„œ ì‚¬ìš©í•œ gazebo_msgs/SpawnModelë„ ì•„ë˜ì™€ ê°™ì€ êµ¬ì¡°ë¥¼ ê°–ìŠµë‹ˆë‹¤. image from : docs.ros.org\ngazebo_msgs/SpawnModelë¥¼ ì‚´í´ë³´ë©´ íŒŒë€ ê¸€ìë¡œ geometry_msgs/Poseë¼ëŠ” ë¶€ë¶„ì´ ìˆìŠµë‹ˆë‹¤. ì´ì™€ ê°™ì´ srvëŠ” ë‹¤ë¥¸ msgë¥¼ í’ˆì„ ìˆ˜ë„ ìˆê³ , ì´ë ‡ê²Œ ë§Œë“  srvë¥¼ ë˜ë‹¤ì‹œ ë‹¤ë¥¸ srvì— í¬í•¨ì‹œí‚¬ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\nì½”ë“œ êµ¬í˜„ ê´€ì ì—ì„œ, geometry_msgs/PoseëŠ” Modelì„ ë“±ì¥ì‹œí‚¬ ì´ˆê¸° ìœ„ì¹˜ë¥¼ ì§€ì •í•˜ëŠ”ë° ì‚¬ìš©ë©ë‹ˆë‹¤.\n# initial_pose initial_pose = Pose() initial_pose.position.x = 0.0 initial_pose.position.y = -1 initial_pose.position.z = 0.2 # z rotation -pi/2 to Quaternion initial_pose.orientation.z = -0.707 initial_pose.orientation.w = 0.707 Service Clientì˜ ìƒì„±ê³¼ ì‚¬ìš©ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. spawn_model_prox = rospy.ServiceProxy(\u0026#34;gazebo/spawn_urdf_model\u0026#34;, SpawnModel) ... result = spawn_model_prox( entity_name, model_xml, robot_namespace, initial_pose, reference_frame ) rospy.ServiceProxy()ëŠ” 2ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤.\nservice ì´ë¦„ service ë°ì´í„° íƒ€ì… (srv) ìƒì„±í•œ clientë¡œ requestë¥¼ í•˜ê¸° ìœ„í•´ì„œëŠ” ìƒì„±í•œ ì¸ìŠ¤í„´ìŠ¤ì— ë§¤ê°œë³€ìˆ˜ë¥¼ ì „ë‹¬í•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤. ë§ˆì¹˜ í•¨ìˆ˜ í˜¸ì¶œì²˜ëŸ¼ ë§ì´ì§€ìš”. ì´ëŠ” ServiceProxy ë‚´ë¶€ì ìœ¼ë¡œ call ë©”ì†Œë“œê°€ êµ¬í˜„ë˜ì–´ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.\nservice callì˜ ê²°ê³¼ë¡œ resultê°€ ë°˜í™˜ë˜ë©°, ì˜ˆì‹œì—ì„œëŠ” ì„±ê³µ ì—¬ë¶€ë¥¼ ë°˜í™˜í•˜ë„ë¡ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\nì¶”ê°€ì ìœ¼ë¡œ, modelì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë¶€ë¶„ì„ ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•˜ê³ ì í•©ë‹ˆë‹¤. # model_xml rospack = rospkg.RosPack() model_path = rospack.get_path(\u0026#34;py_service_pkg\u0026#34;) + \u0026#34;/urdf/\u0026#34; with open(model_path + model_name + \u0026#34;.urdf\u0026#34;, \u0026#34;r\u0026#34;) as xml_file: model_xml = xml_file.read().replace(\u0026#34;\\n\u0026#34;, \u0026#34;\u0026#34;) GazeboëŠ” urdfë¼ëŠ” íŒŒì¼ì„ ì „ë‹¬í•˜ë©´ í•´ë‹¹ íŒŒì¼ì„ ê¸°ë°˜ìœ¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ì— ë¬¼ì²´ë¥¼ ë“±ì¥ì‹œì¼œì¤ë‹ˆë‹¤. ì´ urdfë¼ëŠ” ê²ƒì€ ë¡œë´‡ì„ í‘œí˜„í•˜ê¸° ìœ„í•œ ì¼ì¢…ì˜ ì•½ì†ëœ íŒŒì¼ í™•ì¥ëª…ì…ë‹ˆë‹¤.\nimage from : spart\nì„¸ìƒ ëª¨ë“  ë¡œë´‡ë“¤ì€ jointì™€ linkë¡œ í‘œí˜„ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ê°œë…ì„ ë°”íƒ•ìœ¼ë¡œ ë¡œë´‡ì˜ íŠ¹ì„±ì„ í…ìŠ¤íŠ¸ íŒŒì¼ë¡œ í‘œí˜„í•˜ëŠ” í˜•ì‹ì´ ë°”ë¡œ urdfì´ë©°, ì•„ë˜ì™€ ê°™ì´ ì—¬ëŸ¬ íƒœê·¸ì™€ ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ ì‘ì„± ê°€ëŠ¥í•©ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;robot name=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;link name=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;inertial\u0026gt; \u0026lt;mass value=\u0026#34;1\u0026#34;/\u0026gt; \u0026lt;!-- Inertia values were calculated to be consistent with the mass and geometry size, assuming a uniform density. --\u0026gt; \u0026lt;inertia ixx=\u0026#34;0.0108\u0026#34; ixy=\u0026#34;0\u0026#34; ixz=\u0026#34;0\u0026#34; iyy=\u0026#34;0.0083\u0026#34; iyz=\u0026#34;0\u0026#34; izz=\u0026#34;0.0042\u0026#34;/\u0026gt; \u0026lt;/inertial\u0026gt; \u0026lt;visual\u0026gt; \u0026lt;geometry\u0026gt; \u0026lt;box size=\u0026#34;.1 .2 .3\u0026#34;/\u0026gt; \u0026lt;/geometry\u0026gt; \u0026lt;/visual\u0026gt; \u0026lt;collision name=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;geometry\u0026gt; \u0026lt;box size=\u0026#34;.1 .2 .3\u0026#34;/\u0026gt; \u0026lt;/geometry\u0026gt; \u0026lt;/collision\u0026gt; \u0026lt;/link\u0026gt; \u0026lt;/robot\u0026gt; ROS Service Commands gazebo/spawn_urdf_modelê³¼ ê°™ì€ serviceëŠ” gazebo_rosë¥¼ ì‚¬ìš©í•  ë•Œ ìë™ìœ¼ë¡œ í•¨ê»˜ ì‹¤í–‰ë©ë‹ˆë‹¤. ì´ë ‡ê²Œ í˜„ì¬ ì–´ë– í•œ serviceê°€ ì¡´ì¬í•˜ë©°, ë˜ êµ¬ì²´ì ì¸ ì •ë³´ëŠ” ì–´ë–»ê²Œ ì¡°íšŒí•˜ëŠ”ì§€ ì•Œì•„ë´…ì‹œë‹¤.\ní˜„ì¬ ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  serviceë¥¼ ì¡°íšŒí•´ë´…ì‹œë‹¤. $ rosservice list /delete_entity /gazebo/describe_parameters /gazebo/get_parameter_types /gazebo/get_parameters /gazebo/list_parameters /gazebo/set_parameters ... ë¦¬ëˆ…ìŠ¤ì˜ grep ëª…ë ¹ì–´ë¥¼ í•¨ê»˜ ì‚¬ìš©í•´ ë³´ì„¸ìš”.\níŠ¹ì • serviceê°€ ì–´ë–¤ srv íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ”ì§€ ê²€ìƒ‰í•˜ê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. $ rosservice type /gazebo/spawn_urdf_model gazebo_msgs/SpawnModel ì´ë ‡ê²Œ ê²€ìƒ‰ëœ srvëŠ” rossrv showì™€ ê²°í•©í•  ë•Œ ë”ìš± ì§„ê°€ë¥¼ ë°œíœ˜í•©ë‹ˆë‹¤. $ rossrv show `rosservice type /gazebo/spawn_urdf_model` string model_name string model_xml string robot_namespace geometry_msgs/Pose initial_pose geometry_msgs/Point position float64 x float64 y float64 z geometry_msgs/Quaternion orientation float64 x float64 y float64 z float64 w string reference_frame --- bool success string status_message íŠ¹ì • srv íƒ€ì…ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. $ rosservice info /gazebo/spawn_urdf_model Node: /gazebo URI: rosrpc://192.168.55.236:55405 Type: gazebo_msgs/SpawnModel Args: model_name model_xml robot_namespace initial_pose reference_frame gazebo_rosì—ì„œ ì œê³µí•˜ëŠ” ë‹¤ì–‘í•œ serviceë“¤ì´ ìˆìŠµë‹ˆë‹¤. rosservice ì»¤ë©˜ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì¡°íšŒí•´ë³´ê³  ì—¬ëŸ¬ë¶„ë“¤ë§Œì˜ Applicationì„ ìƒê°í•´ ë³´ì„¸ìš”.\nService Server ì˜ˆì œ ì‹¤í–‰ - ê¸´ê¸‰ ì •ì§€ # Terminal 1 roslaunch smb_gazebo smb_gazebo.launch # Terminal 2 rosrun py_service_pkg emergency_stop.py # Terminal 3 rqt ë‘ë²ˆì§¸ Node ì‹¤í–‰ ì‹œ, ë¡œë´‡ì´ ì›ì„ ê·¸ë¦¬ë©° ì›€ì§ì´ê¸° ì‹œì‘í•©ë‹ˆë‹¤. ì„¸ë²ˆì§¸ ëª…ë ¹ì–´ë¥¼ í†µí•´ ë“±ì¥í•˜ëŠ” rqtëŠ” ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. ë¡œë´‡ì—ê²Œ ê¸´ê¸‰ ì •ì§€ ëª…ë ¹ì„ ë‚´ë ¤ë³´ê² ìŠµë‹ˆë‹¤. ì‹¤ì œ ë¡œë´‡ ê°œë°œì‹œì—ë„ ServiceëŠ” ì´ë ‡ê²Œ ë‹¨ë°œì„±ì´ê³ , ë¹ ë¥´ê²Œ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ” ë™ì‘ì— ì£¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. ë”ë¶ˆì–´, ì§€ê¸ˆ ì‹¤í–‰í•œ ì˜ˆì‹œê°€ Service Serverì„ì„ ë‹¤ì‹œ í•œ ë²ˆ ìƒê¸°ì‹œì¼œë“œë¦½ë‹ˆë‹¤.\nimage from : rsl.eth\nì½”ë“œë¥¼ ë¶„ì„í•´ ë´…ì‹œë‹¤.\npy_service_pkg/scripts/emergency_stop.py from geometry_msgs.msg import Twist from std_srvs.srv import SetBool, SetBoolResponse ì´ë²ˆì— ì‚¬ìš©í•˜ëŠ” ë°ì´í„° íƒ€ì…ì€ í¬ê²Œ 2 ì¢…ë¥˜ì…ë‹ˆë‹¤.\në¡œë´‡ ì œì–´ topicì— ì‚¬ìš©ë˜ëŠ” Twist ê¸´ê¸‰ ì •ì§€ serviceì— ì‚¬ìš©ë  SetBool image from : docs.ros.org\nSetBoolResponseì´ë¼ëŠ” ê²ƒì€ SetBool srv ì¤‘ response ë¶€ë¶„ì— í•´ë‹¹í•©ë‹ˆë‹¤. ê¸°ë³¸ ë°ì´í„° íƒ€ì… ì´ë¦„ + Responseë¥¼ ë¶™ì—¬ì£¼ê¸°ë§Œ í•˜ë©´ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.\nROSì˜ msg, srvëŠ” ë‹¤ì–‘í•œ ì–¸ì–´ì™€ ìƒí™©ì„ ê³ ë ¤í•˜ë„ë¡ ë§Œë“¤ì–´ì ¸ ìˆìœ¼ë©°, ROS 2ì—ì„œëŠ” IDLì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ë”ìš± ë°œì „í•˜ì˜€ìŠµë‹ˆë‹¤. ì´í›„ì˜ ì»¤ìŠ¤í…€ ë°ì´í„° íƒ€ì… ì œì‘ì„ í†µí•´ ì´ ê³¼ì •ì„ ë‹¤ì‹œ ì‚´í´ë´…ì‹œë‹¤.\në‹¤ìŒìœ¼ë¡œ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì„ ìƒì„±í•©ë‹ˆë‹¤. class EmergencyStopNode(object): def __init__(self): self.cmd_vel_pub_ = rospy.Publisher(\u0026#34;cmd_vel\u0026#34;, Twist, queue_size=10) self.stop_server_ = rospy.Service(\u0026#34;emergency_stop\u0026#34;, SetBool, self.stop_cb) ë¡œë´‡ ì œì–´ë¥¼ ìœ„í•œ topic publisherì™€ service serverë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\nrospy.Service()ë¥¼ í†µí•´ Service Serverë¥¼ ìƒì„±í•  ìˆ˜ ìˆìœ¼ë©° ë‹¤ìŒê³¼ ê°™ì€ ë§¤ê°œë³€ìˆ˜ë¥¼ í•„ìš”ë¡œí•©ë‹ˆë‹¤.\nService ì´ë¦„ srv íƒ€ì… Clientë¡œë¶€í„° requestê°€ ì˜¬ ì‹œ ì‹¤í–‰ë˜ëŠ” callback í•¨ìˆ˜ callback í•¨ìˆ˜ëŠ” ì¼ì „ subscriberì—ì„œ ì‚´í´ë³¸ ë°” ìˆìŠµë‹ˆë‹¤. service serverì˜ callback í•¨ìˆ˜ëŠ” í•­ìƒ ë§¤ê°œë³€ìˆ˜ë¡œ request srvë¥¼ ë°›ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  return ê°’ì€ í•­ìƒ responseê°€ ë©ë‹ˆë‹¤.\ndef stop_cb(self, request): ... return self.response_ request ë°ì´í„° ì¤‘ boolean ê°’ì„ ê°–ëŠ” dataì˜ true / false ì—¬ë¶€ì— ë”°ë¼ ë¡œë´‡ì˜ ì •ì§€ ì—¬ë¶€ê°€ ê²°ì •ë©ë‹ˆë‹¤. if request.data is True: self.twist_msg_.linear.x = 0.0 self.twist_msg_.angular.z = 0.0 self.cmd_vel_pub_.publish(self.twist_msg_) self.response_.success = True self.response_.message = \u0026#34;Successfully Stopped\u0026#34; else: self.response_.success = False self.response_.message = \u0026#34;Stop Failed\u0026#34; ë§ˆì§€ë§‰ì— ì‚¬ìš©í•œ rqtì˜ service callerëŠ” ë³„ë„ì˜ í”„ë¡œê·¸ë˜ë°ì´ë‚˜ ë³µì¡í•œ í„°ë¯¸ë„ ëª…ë ¹ì–´ ì—†ì´ë„ ì†ì‰½ê²Œ serviceë¥¼ ë‹¤ë£° ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ROSì˜ íˆ´ì…ë‹ˆë‹¤.\nì§€ê¸ˆê¹Œì§€ ROS Serviceì— ëŒ€í•´ ë°°ì›Œë³´ì•˜ìŠµë‹ˆë‹¤. Topicê³¼ ë”ë¶ˆì–´ ë§ì´ ì‚¬ìš©ë˜ëŠ” í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì´ë¯€ë¡œ ì˜ ìˆ™ì§€í•˜ê³  ë³µìŠµí•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.\nì°¸ê³ ìë£Œ\nhttps://rsl.ethz.ch/education-students/lectures/ros.html https://ko.wikipedia.org/wiki/ì•„ë¥´í‚¤ë©”ë°ìŠ¤_ì™€ì„  https://docs.ros.org/en/foxy/index.html http://wiki.ros.org/Services "
},
{
	"uri": "/kr/ros_basic_noetic/lecture7/",
	"title": "Lecture7 - Rqt Tools and rosbag, ROS Time",
	"tags": [],
	"description": "",
	"content": " ê°•ì˜ ì´ˆë°˜, ë‹¤ì–‘í•œ rqt toolë“¤ì„ ì‚´í´ë³¸ ë°” ìˆìŠµë‹ˆë‹¤. ì´ì œëŠ” Topicê³¼ Serviceì— ëª¨ë‘ ìµìˆ™í•´ì¡Œê¸° ë•Œë¬¸ì—, rqtì˜ ë§ì€ ê¸°ëŠ¥ë“¤ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ í•œ ë²ˆ rqtë¥¼ ì‚´í´ë³´ë©´ì„œ í¸ë¦¬í•œ íˆ´ë“¤ì˜ ì‚¬ìš©ë²•ì„ ìµí˜€ë´…ì‹œë‹¤.\nMessage Publisher \u0026amp; Topic Monitor ê°•ì˜ìë¥¼ ë”°ë¼ ë‹¤ìŒê³¼ ê°™ì´ í™”ë©´ì„ êµ¬ì„±í•©ë‹ˆë‹¤.\nplugins â‡’ topics â‡’ Message Publisher pulgins â‡’ topics â‡’ Topic Monitor message publisherë¥¼ ì‚¬ìš©í•˜ë©´ ì½”ë”© ì—†ì´ cmd_velì„ publishê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. Topic Msgì— ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì±„ì›Œë„£ì€ ë’¤, ì£¼ê¸°ë¥¼ ì„ íƒí•œ í›„ ì²´í¬ë°•ìŠ¤ë¥¼ í´ë¦­í•˜ë©´ ë¡œë´‡ì´ ì›€ì§ì´ê¸° ì‹œì‘í•©ë‹ˆë‹¤. Topic Monitorë¥¼ ì‚¬ìš©í•˜ë©´, ì—¬ëŸ¬ ë°ì´í„°ë“¤ì„ íš¨ê³¼ì ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§ ê°€ëŠ¥í•©ë‹ˆë‹¤. Topic Publisherì™€ ë™ì¼í•˜ê²Œ ì²´í¬ë°•ìŠ¤ë¥¼ ëˆŒëŸ¬ topicì„ ì„ íƒí•œ ë’¤, ë³€í•˜ëŠ” ë°ì´í„°ë¥¼ í™•ì¸í•´ë´…ì‹œë‹¤. ì½”ë”© ì—†ì´ ê°„ë‹¨íˆ ê°’ì˜ í™•ì¸ê³¼ ë™ì‘ ì—¬ë¶€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ” íˆ´ë“¤ì´ì—ˆìŠµë‹ˆë‹¤.\nRQT Multiplot ìˆ˜ì¹˜ ë°ì´í„°ë¥¼ ê·¸ë˜í”„ë¡œ ë³´ê³ ì‹¶ì€ ê²½ìš° rqtì˜ multiplotì´ ìœ ìš©í•˜ê²Œ ì‚¬ìš©ë©ë‹ˆë‹¤.\nsudo apt install ros-noetic-rqt-multiplot rosrun rqt_multiplot rqt_multiplot /odom topicì˜ X,Y positionì„ ê¸°ì¤€ìœ¼ë¡œ ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ì•„ë˜ì˜ gifë¥¼ í†µí•´ ëª¨ë“  ê³¼ì •ì„ ê¸°ë¡í•˜ì˜€ìœ¼ë‹ˆ ì°¨ê·¼ì°¨ê·¼ ë”°ë¼ì™€ì£¼ì„¸ìš”.\nRQT Console ì§€ê¸ˆê¹Œì§€ ROSì˜ ì½˜ì†” ë¡œê·¸ë¥¼ ìœ„í•´ rospy.loginfo()ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. ì‚¬ì‹¤ ROSì—ëŠ” loginfoë§ê³ ë„ ë‹¤ì–‘í•œ levelì˜ logger levelì´ ì¡´ì¬í•©ë‹ˆë‹¤. ì‹¤ìŠµì„ í†µí•´ ì‚´í´ë´…ì‹œë‹¤.\nrospy logger level # Terminal 1 roscore # Terminal 2 rosrun my_first_package logger_level.py ì½”ë“œì˜ ë‚´ìš©ê³¼ í•¨ê»˜ ì˜ˆì‹œë¥¼ ì‚´í´ë´…ì‹œë‹¤. def hello_du(self, event=None): hello_du = f\u0026#34;hello du {rospy.get_time()}, counter: {self.counter_}\u0026#34; rospy.logdebug(hello_du) rospy.loginfo(hello_du) rospy.logwarn(hello_du) rospy.logerr(hello_du) rospy.logfatal(hello_du) self.counter_ += 1 ROSëŠ” ì´ 5ê°€ì§€ì˜ logger levelì„ ê°–ì¶”ê³  ìˆìœ¼ë©°, Debug ë¶€í„° Fatalë¡œ ê°ˆìˆ˜ë¡ ë” ë†’ì€ levelì„ ê°–ëŠ”ë‹¤ê³  ë³´ì‹œë©´ ë©ë‹ˆë‹¤. Info level ë¶€í„° ì½˜ì†” ì¶œë ¥ì´ ì´ë£¨ì–´ì§€ë©°, Pythonì˜ stdoutë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\nimage from : 51CTO ìƒí™©ì— ë”°ë¼ ê°ê¸° ë‹¤ë¥¸ levelì˜ logë¥¼ ì‚¬ìš©í•˜ë„ë¡ í•˜ë©´, ì‹¤ì œ ë¡œë´‡ ê°œë°œì‹œì—ë„ í° ë„ì›€ì´ ë©ë‹ˆë‹¤.\nrqtì—ëŠ” ì´ëŸ¬í•œ ë‹¤ì–‘í•œ levelì„ ê°–ëŠ” rosì˜ logë¥¼ í•„í„°ë§í•˜ëŠ” rqt consoleì´ë¼ëŠ” íˆ´ì´ ìˆìŠµë‹ˆë‹¤. ì‚¬ìš© ë°©ë²•ì„ í•¨ê»˜ ì•Œì•„ë´…ì‹œë‹¤.\nê·¸ ë°–ì—ë„ ìˆ˜ë§ì€ rqt ë„êµ¬ë“¤ì´ ìˆì§€ë§Œ, ëª¨ë‘ ì‚´í´ë³´ëŠ” ëŒ€ì‹  ë§í¬ë¡œ ëŒ€ì²´í•˜ê² ìŠµë‹ˆë‹¤. \u0026gt; ROS Wiki\nROS Bags rqt íˆ´ì— ì†í•˜ì§€ëŠ” ì•Šì§€ë§Œ, ê°œë°œ ì‹œ ë§¤ìš° ìœ ìš©í•œ ROSì˜ ê¸°ëŠ¥ì„ í•˜ë‚˜ ë” ì†Œê°œì‹œì¼œë“œë¦¬ê³ ì í•©ë‹ˆë‹¤.\nrosbagì€ í”„ë¡œê·¸ë¨ ë™ì‘ ì¤‘ ë°œìƒí•˜ëŠ” message ë°ì´í„°ë¥¼ ê¸°ë¡í•˜ê³  ë³µê¸°í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” íˆ´ì…ë‹ˆë‹¤. ë¡œë´‡ ì•Œê³ ë¦¬ì¦˜ì„ ê°œë°œí•  ë•Œ, ê°™ì€ ìƒí™©ì— ëŒ€í•´ ì„±ëŠ¥ì„ ë¹„êµí•˜ëŠ” ê²½ìš°, í˜¹ì€ êµìœ¡ ëª©ì ìœ¼ë¡œ ë°ì´í„°ì…‹ì„ ì œê³µí•˜ëŠ” ê²½ìš° ë“±ì— ë§¤ìš° ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nrosbag ì‚¬ìš©ë²•ì„ í•¨ê»˜ ì‹¤ìŠµí•´ë³´ê² ìŠµë‹ˆë‹¤.\nsmb gazeboë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. roslaunch smb_gazebo smb_gazebo.launch world:=big_map_summer_school rosbagì˜ ì‚¬ìš© ì‹œ ì—¬ëŸ¬ ì˜µì…˜ë“¤ì´ ìˆìŠµë‹ˆë‹¤. -o ì˜µì…˜ìœ¼ë¡œ rosbagì˜ ì´ë¦„ì„ ì§€ì •í•©ë‹ˆë‹¤. -a ì˜µì…˜ ì‚¬ìš© ì‹œ ëª¨ë“  topicì„ ì €ì¥í•©ë‹ˆë‹¤. rosbagì˜ ì¢…ë£ŒëŠ” ctrl + cë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. rosbag record -o first_rosbag /scan /tf /tf_static /tfì™€ /tf_staticì€ ì™œ ì €ì¥í•˜ëŠ” ê²ƒì¼ê¹Œìš”? ìƒê°í•´ë´…ì‹œë‹¤.\nrosbag infoë¥¼ í†µí•´ ì €ì¥ì„ ë§ˆì¹œ rosbagì˜ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. $ rosbag info first_rosbag_\u0026lt;time-format-sth\u0026gt;.bag path: first_rosbag_2022-12-27-15-51-55.bag version: 2.0 duration: 4.8s start: Jan 01 1970 09:07:35.31 (455.31) end: Jan 01 1970 09:07:40.12 (460.12) size: 83.8 KB messages: 49 compression: none [1/1 chunks] types: sensor_msgs/LaserScan [90c7ef2dc6895d81024acba2ac42f369] topics: /scan 49 msgs : sensor_msgs/LaserScan ì €ì¥ ì™„ë£Œëœ rosbagì„ ë‹¤ì‹œ ë³µê¸°í•´ë´…ì‹œë‹¤. $ rosbag play first_rosbag_2022-12-27-15-56-23.bag [ INFO] [1672124296.822088842]: Opening first_rosbag_2022-12-27-15-56-23.bag Waiting 0.2 seconds after advertising topics... done. ... rvizë¥¼ í†µí•´ ì‹œê°í™”ê¹Œì§€ í•´ë´…ì‹œë‹¤. rosbagì€ ê¸°ë³¸ì ìœ¼ë¡œ topicì„ ì €ì¥í•©ë‹ˆë‹¤.\nrviz í™”ë©´ì„ ì‚´í´ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ Warningì´ ë°œìƒí•  ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ°ë° ì´ ë¬¸êµ¬, ìµìˆ™í•˜ì§€ ì•Šë‚˜ìš”?\n[ WARN] [1672124550.336965013]: TF_REPEATED_DATA ignoring data with redundant timestamp for frame LF_WHEEL at time 472.056000 according to authority unknown_publisher [ WARN] [1672124550.336981403]: TF_REPEATED_DATA ignoring data with redundant timestamp for frame LH_WHEEL at time 472.056000 according to authority unknown_publisher [ WARN] [1672124550.336991753]: TF_REPEATED_DATA ignoring data with redundant timestamp for frame RF_WHEEL at time 472.056000 according to authority unknown_publisher [ WARN] [1672124550.337003964]: TF_REPEATED_DATA ignoring data with redundant timestamp for frame RH_WHEEL at time 472.056000 according to authority unknown_publisher [ WARN] [1672124550.356035553]: TF_REPEATED_DATA ignoring data with redundant timestamp for frame base_link at time 472.076000 according to authority unknown_publisher [ WARN] [1672124550.356945321]: TF_REPEATED_DATA ignoring data with redundant timestamp for frame LF_WHEEL at time 472.076000 according to authority unknown_publisher [ WARN] [1672124550.356960231]: TF_REPEATED_DATA ignoring data with redundant timestamp for frame LH_WHEEL at time 472.076000 according to authority unknown_publisher [ WARN] [1672124550.356970561]: TF_REPEATED_DATA ignoring data with redundant timestamp for frame RF_WHEEL at time 472.076000 according to authority unknown_publisher ROS Time ì¼ì „ ê°•ì˜ì—ì„œ ì–¸ê¸‰í•œ ë°”ì™€ ê°™ì´, ì´ë²ˆ ê°•ì˜ì— ROSì˜ ì‹œê°„ ì²´ê³„ì— ëŒ€í•´ì„œ ë‹¤ì¡ê³  ê°€ê³ ì í•©ë‹ˆë‹¤.\nrospy.loginfoë¥¼ í†µí•´ ì½˜ì†”ì— ì¶œë ¥ë˜ëŠ” ì‹œê°„ê³¼ ê°™ì´ ROSì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì‹œê°„ì˜ ê¸°ì¤€ì€ PCì˜ Clockì…ë‹ˆë‹¤. (ì´ë¥¼ wall timerë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.) ROS í”„ë¡œê·¸ë¨ì€ ì¼ì • ì£¼ê¸°ë¥¼ ê°–ê³  ë¬´í•œíˆ ë°˜ë³µë˜ëŠ” ìƒí™©ì´ ì¦ìŠµë‹ˆë‹¤. ì´ë•Œ ì‚¬ìš©í•˜ëŠ” ì£¼ê¸°ê°€ ì •í™•í•´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” 2023ë…„ 00ì›” 00ì¼ì´ë¼ëŠ” ì‹œê°„ì²´ê³„ë¥¼ ì‚¬ìš©í•˜ì§€ë§Œ, Gazeboì™€ ê°™ì€ ì‹œë®¬ë ˆì´ì…˜ íˆ´ì€ ì‹œì‘ë˜ëŠ” ì‹œì ì´ ê³§ 0ë¶„ 0ì´ˆê°€ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì‹œê°„ì˜ ì°¨ì´ë¡œ ì¸í•´ warningê³¼ errorê°€ ë¹ˆë²ˆí•˜ê²Œ ë°œìƒí•©ë‹ˆë‹¤. ê·¸ëŸ¼, ì‹¤ì§ˆì ìœ¼ë¡œ ROSì—ì„œ ì‹œê°ê³¼ ì£¼ê¸°, ì‹œê°„ì€ ì–´ë–»ê²Œ ë‹¤ë£¨ëŠ”ì§€ ì˜ˆì‹œì™€ í•¨ê»˜ python ì½”ë“œë¥¼ ì‚´í´ë´…ì‹œë‹¤.\nros_time.py $ rosrun my_first_package ros_time.py [INFO] [1672127477.793024]: Current time 1672127477 792964935 [INFO] [1672127477.793593]: Current time to_sec 1672127477 [INFO] [1672127477.794082]: Past time 1672127477 292964935 [INFO] [1672127477.893132]: Current time 1672127477 893082141 [INFO] [1672127477.893684]: Current time to_sec 1672127477 [INFO] [1672127477.894148]: Past time 1672127477 393082141 ... ì½”ë“œëŠ” ë‹¤ìŒ ìœ„ì¹˜ì—ì„œ í™•ì¸ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. \u0026gt; https://github.com/RB2023ROS/du2023-ros1/blob/main/my_first_package/scripts/ros_time.py\nrospy Time instance rospyì—ì„œëŠ” Timeì´ë¼ëŠ” í´ë˜ìŠ¤ë¡œ ì‹œê°„ì„ í‘œí˜„í•©ë‹ˆë‹¤. ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” í˜„ì¬ ì‹œê°„ì€ rospy.Time.now() ë¡œ íŒŒì•…í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” secì™€ nsecë“±ì˜ í´ë˜ìŠ¤ ë³€ìˆ˜ë¥¼ ê°–ê³  ìˆìŠµë‹ˆë‹¤.\ndef hello_du(self, event=None): now = rospy.Time.now() seconds = now.to_sec() rospy.loginfo(\u0026#34;Current time %i %i\u0026#34;, now.secs, now.nsecs) rospy.loginfo(\u0026#34;Current time to_sec %i\u0026#34;, seconds) rospy Time Duration ì‹œê°„ ê°„ê²©ì„ ë‚˜íƒ€ë‚´ëŠ” í´ë˜ìŠ¤ë¡œ Durationì´ ì‚¬ìš©ë˜ë©°, Time ì¸ìŠ¤í„´ìŠ¤ì™€ +,- ì—°ì‚°ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\ndelta = rospy.Duration(0.5) past = now - delta rospy.loginfo(\u0026#34;Past time %i %i\u0026#34;, past.secs, past.nsecs) rospy Rate while loopì™€ Rateë¥¼ ì‚¬ìš©í•˜ì—¬ ì¼ì • ì£¼ê¸°ë‹¤ë§ˆ ë°˜ë³µë˜ëŠ” êµ¬í˜„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ë•Œ ì‚¬ìš©ë˜ëŠ” ì‹œê°„ ê¸°ì¤€ì€ PCì˜ Clockì…ë‹ˆë‹¤.\nr = rospy.Rate(10) # 10hz while not rospy.is_shutdown(): time_ex.hello_du() r.sleep() Topic vs Service and Action ì§€ê¸ˆê¹Œì§€ ROSì˜ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ Topicê³¼ Serviceì— ëŒ€í•´ ë°°ì›Œë³´ì•˜ìŠµë‹ˆë‹¤. ê·¸ëŸ°ë°, ì‚¬ì‹¤ ROSì˜ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì—ëŠ” Actionì´ë¼ëŠ” í•œê°€ì§€ê°€ ë” ìˆìŠµë‹ˆë‹¤.\nActionì€ Topicê³¼ Service ëª¨ë‘ì˜ íŠ¹ì§•ì„ ê°–ê³  ìˆëŠ” ì§„ë³´ëœ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. Actionì€ Feedbackì´ë¼ëŠ” ê²ƒìœ¼ë¡œ Goal Request ì´í›„ ê³„ì†ì ì¸ ë°ì´í„° ì†¡ìˆ˜ì‹ ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. Actionì€ ROS 2 ê°•ì˜ì—ì„œ ì‚´í´ë³¼ ì˜ˆì •ìœ¼ë¡œ ì–´ë–»ê²Œ ì‚¬ìš©ë  ìˆ˜ ìˆì„ì§€ í•œë²ˆ ê³ ë¯¼í•´ë³´ì„¸ìš”.\nimage from : docs.rog.org ì°¸ê³ ìë£Œ\nhttp://wiki.ros.org/rospy/Overview/Time https://docs.ros.org/en/foxy/index.html "
},
{
	"uri": "/kr/ros_basic_noetic/lecture8/",
	"title": "Lecture8 - Deal with Open Source Projects, Custom Interfaces",
	"tags": [],
	"description": "",
	"content": "Deal with Open Source Projects ì´ë²ˆ ì‹œê°„ì—ëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ í”„ë¡œì íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ë°°ì›Œë³´ê² ìŠµë‹ˆë‹¤. ë³´ë‹¤ ì‹¤ì§ˆì ì¸ ì‚¬ìš© ë°©ë²•ì„ ë³´ì—¬ë“œë¦¬ê¸° ìœ„í•´ ì € ë˜í•œ ì—¬ëŸ¬ë¶„ë“¤ê³¼ ê°™ì€ ìƒí™©ì—ì„œ ì²˜ìŒë¶€í„° í•˜ë‚˜ì”© ê°™ì´ í•´ë³´ê² ìŠµë‹ˆë‹¤.\nì˜¤ëŠ˜ ë°ëª¨í•˜ê³ ì í•˜ëŠ” ë¡œë´‡ ì†Œí”„íŠ¸ì›¨ì–´ëŠ” ë“œë¡  ì‹œë®¬ë ˆì´ì…˜ì…ë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ ì§€ìƒì„ ì›€ì§ì´ëŠ” ë°”í€´ ë¡œë´‡ë§Œì„ ë‹¤ë£¨ì—ˆê¸° ë•Œë¬¸ì— ìƒˆë¡œìš´ í”Œë ›í¼ì„ ë™ì‘ì‹œì¼œë³´ê³ ì í•©ë‹ˆë‹¤.\ní•­ìƒ ì‹œì‘ì€ êµ¬ê¸€ë§ë¶€í„°!! ê²€ìƒ‰ ê²°ê³¼ ì›í•˜ëŠ” íŒ¨í‚¤ì§€ë¥¼ ì°¾ì€ ê²ƒ ê°™ìŠµë‹ˆë‹¤. \u0026gt; https://github.com/RAFALAMAO/hector-quadrotor-noetic ëª©ì ì— ë¶€í•©í•˜ëŠ” ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ì°¾ê¸° ìœ„í•´ì„œ ì•„ë˜ì™€ ê°™ì€ ê¸°ë³¸ì ì¸ ë‚´ìš©ì„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤.\në²„ì „ í˜¸í™˜ì„± êµ¬ì²´ì ì¸ ëª©í‘œì— ë¶€í•©í•˜ëŠ”ì§€ Star, Forkë¥¼ í†µí•´ ê²€ì¦ëœ ì†ŒìŠ¤ì½”ë“œì„ì„ í™•ì¸ Issueë¥¼ í†µí•´ ì‚¬ìš© ì¤‘ ë¬¸ì œê°€ ìˆì§€ëŠ” ì•Šì€ì§€ Readmeë¥¼ ë”°ë¼ package buildë¥¼ ì§„í–‰í•˜ê³  ìµœì´ˆ ì‹¤í–‰ì„ í•´ë³´ê² ìŠµë‹ˆë‹¤.\n# Terminal 1 roslaunch hector_quadrotor_gazebo quadrotor_empty_world.launch # Terminal 2 rosrun hector_ui ui_hector_quad.py ë™ì‘ì—ëŠ” ë¬¸ì œê°€ ì—†ì–´ë³´ì…ë‹ˆë‹¤. ê·¸ëŸ¼ ì´ í”„ë¡œì íŠ¸ê°€ ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–»ê²Œ êµ¬í˜„ë˜ì–´ìˆëŠ”ì§€ ë¶„ì„í•´ë´…ì‹œë‹¤.\nrqt_graph ë¡œë´‡ì˜ ìœ„ì¹˜ë¥¼ ì•Œë ¤ì£¼ëŠ” topicì¸ /ground_truth/stateì™€ /ground_truth_to_tf/poseë¥¼ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. gazeboì—ì„œ ë¬¼ì²´ì˜ ì ˆëŒ€ì ì¸ ìœ„ì¹˜ë¥¼ ì•Œë ¤ì£¼ê¸° ë•Œë¬¸ì— ì´ë¥¼ ground truthë¼ê³  ë¶€ë¥´ê³  ìˆìŠµë‹ˆë‹¤.\nì´ë²ˆì—ëŠ” ì¡°ì¢… í”„ë¡œê·¸ë¨ì˜ ì†ŒìŠ¤ì½”ë“œë¥¼ í™•ì¸í•´ë´…ì‹œë‹¤. (hector_quadrotor_noetic/hector_ui/srcì— ìœ„ì¹˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.) #Callback de pose y orientacion simulador def pose_callback(data): x_p.set(\u0026#34;{0:.2f}\u0026#34;.format(data.pose.pose.position.x)) y_p.set(\u0026#34;{0:.2f}\u0026#34;.format(data.pose.pose.position.y)) z_p.set(\u0026#34;{0:.2f}\u0026#34;.format(data.pose.pose.position.z)) def rot_callback(data): z_o.set(\u0026#34;{0:.2f}\u0026#34;.format( math.degrees(quaterionToRads(data)) )) rospy.init_node(\u0026#39;HectorQ_GUI\u0026#39;, anonymous=False) #Subscribers posicionLider_sub = rospy.Subscriber(\u0026#34;/ground_truth/state\u0026#34;, Odometry , pose_callback) orientaLider_sub = rospy.Subscriber(\u0026#34;/ground_truth_to_tf/pose\u0026#34;, PoseStamped , rot_callback) ë‘ ì¢…ë¥˜ì˜ subscriberê°€ ì¡´ì¬í•˜ë©° ê°ê° UIì˜ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒ ê°™ì´ ë³´ì…ë‹ˆë‹¤.\nì´ë²ˆì—ëŠ” launch fileì„ ë¶„ì„í•´ë´…ì‹œë‹¤ - hector_quadrotor/hector_quadrotor_gazebo/launch/quadrotor_empty_world.launch \u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;launch\u0026gt; \u0026lt;arg name=\u0026#34;paused\u0026#34; default=\u0026#34;false\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;use_sim_time\u0026#34; default=\u0026#34;true\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;gui\u0026#34; default=\u0026#34;true\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;headless\u0026#34; default=\u0026#34;false\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;debug\u0026#34; default=\u0026#34;false\u0026#34;/\u0026gt; \u0026lt;include file=\u0026#34;$(find gazebo_ros)/launch/empty_world.launch\u0026#34;\u0026gt; \u0026lt;arg name=\u0026#34;paused\u0026#34; value=\u0026#34;$(arg paused)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;use_sim_time\u0026#34; value=\u0026#34;$(arg use_sim_time)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;gui\u0026#34; value=\u0026#34;$(arg gui)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;headless\u0026#34; value=\u0026#34;$(arg headless)\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;debug\u0026#34; value=\u0026#34;$(arg debug)\u0026#34;/\u0026gt; \u0026lt;/include\u0026gt; \u0026lt;include file=\u0026#34;$(find hector_quadrotor_gazebo)/launch/spawn_quadrotor.launch\u0026#34; /\u0026gt; \u0026lt;arg name=\u0026#34;model\u0026#34; value=\u0026#34;$(find hector_quadrotor_description)/urdf/quadrotor_hokuyo_utm30lx.gazebo.xacro\u0026#34;/\u0026gt; \u0026lt;/launch\u0026gt; gazebo_rosì˜ empty_world.launch, hector_quadrotor_gazeboì˜ spawn_quadrotor.launchê°€ ì‹¤í–‰ë˜ë©°, modelì´ë¼ëŠ” argumentë¥¼ ê°–ìŠµë‹ˆë‹¤.\nspawn_quadrotor.launchì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ nodeë“¤ì´ ì‹¤í–‰ë©ë‹ˆë‹¤.\nspawn_model robot_state_publisher ground_truth_to_tf controller.launch â‡’ controller_spawner ì´ë ‡ê²Œ rqt íˆ´ë“¤ê³¼ ì½”ë“œì˜ êµ¬ì¡°ë¥¼ íŒŒí—¤ì¹˜ë©´ì„œ ì „ì²´ êµ¬ì¡°ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆìœ¼ë©° ì›í•˜ëŠ” ë¶€ë¶„ë§Œì„ ê³ ì¹˜ë©´ì„œ Packageë¥¼ ë°œì „ì‹œì¼œë‚˜ê°€ëŠ” ê²ƒì…ë‹ˆë‹¤.\nlaunch fileì˜ ì‘ìš©ì„ ì‹¤ìŠµí•´ë´…ì‹œë‹¤. ì¼ì „ ë°°ì›Œë³¸ husky gazeboì™€ hector gazeboë¥¼ í•¨ê»˜ ì‚¬ìš©í•´ë³´ëŠ” ê²ƒì…ë‹ˆë‹¤.\nhusky gazebo ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë‚´ìš©ì„ ë‹´ê³  ìˆì—ˆìŠµë‹ˆë‹¤. gazebo_rosë¥¼ ì‹¤í–‰ì‹œí‚¤ê³  husky modelì„ spawní•˜ëŠ” ë˜ë‹¤ë¥¸ launch fileì„ include í•˜ì˜€ìŠµë‹ˆë‹¤. \u0026lt;launch\u0026gt; \u0026lt;arg name=\u0026#34;world_name\u0026#34; default=\u0026#34;worlds/empty.world\u0026#34;/\u0026gt; \u0026lt;include file=\u0026#34;$(find gazebo_ros)/launch/empty_world.launch\u0026#34;\u0026gt; \u0026lt;arg name=\u0026#34;world_name\u0026#34; value=\u0026#34;$(arg world_name)\u0026#34;/\u0026gt; \u0026lt;!-- world_name is wrt GAZEBO_RESOURCE_PATH environment variable --\u0026gt; \u0026lt;arg name=\u0026#34;paused\u0026#34; value=\u0026#34;false\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;use_sim_time\u0026#34; value=\u0026#34;true\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;gui\u0026#34; value=\u0026#34;true\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;headless\u0026#34; value=\u0026#34;false\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;debug\u0026#34; value=\u0026#34;false\u0026#34;/\u0026gt; \u0026lt;/include\u0026gt; \u0026lt;include file=\u0026#34;$(find husky_gazebo)/launch/spawn_husky.launch\u0026#34;\u0026gt; \u0026lt;/include\u0026gt; \u0026lt;/launch\u0026gt; ê·¸ëŸ¼, ê²¹ì¹˜ëŠ” ë¶€ë¶„ì„ ì œì™¸í•˜ê³  quadrotor_empty_world.launchì˜ ë‚´ìš©ì„ ì¶”ê°€í•˜ì—¬ ìƒˆë¡œìš´ launch fileì„ ë§Œë“¤ì–´ ë´…ì‹œë‹¤. (hetero_spawn.launch ìƒì„±) \u0026lt;launch\u0026gt; \u0026lt;include file=\u0026#34;$(find husky_gazebo)/launch/husky_empty_world.launch\u0026#34; /\u0026gt; \u0026lt;include file=\u0026#34;$(find hector_quadrotor_gazebo)/launch/spawn_quadrotor.launch\u0026#34; /\u0026gt; \u0026lt;arg name=\u0026#34;model\u0026#34; value=\u0026#34;$(find hector_quadrotor_description)/urdf/quadrotor_hokuyo_utm30lx.gazebo.xacro\u0026#34;/\u0026gt; \u0026lt;/launch\u0026gt; ì•„ë˜ì™€ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë„¤ìš”, ì´ëŠ” robot_state_publisher nodeê°€ ì¤‘ë³µë˜ê¸° ë•Œë¬¸ì— ë°œìƒí•˜ëŠ” ë¬¸ì œì…ë‹ˆë‹¤. RLException: roslaunch file contains multiple nodes named [/robot_state_publisher]. Please check all \u0026lt;node\u0026gt; \u0026#39;name\u0026#39; attributes to make sure they are unique. Also check that $(anon id) use different ids. The traceback for the exception was written to the log file ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ, ì €ëŠ” ë‹¤ë¥¸ launch file(spawn_two_quadrotors.launch)ì„ ì°¸ê³ í•´ë³´ì•˜ìŠµë‹ˆë‹¤. group íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ë©´ ê°™ì€ ë¡œë´‡ì˜ ì¤‘ë³µ ì„ ì–¸ì„ namespaceë¥¼ í†µí•´ êµ¬ë¶„í•  ìˆ˜ ìˆê²Œë©ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;launch\u0026gt; \u0026lt;arg name=\u0026#34;model\u0026#34; default=\u0026#34;$(find hector_quadrotor_description)/urdf/quadrotor.gazebo.xacro\u0026#34; /\u0026gt; \u0026lt;group ns=\u0026#34;uav1\u0026#34;\u0026gt; \u0026lt;include file=\u0026#34;$(find hector_quadrotor_gazebo)/launch/spawn_quadrotor.launch\u0026#34;\u0026gt; ... \u0026lt;/group\u0026gt; \u0026lt;group ns=\u0026#34;uav2\u0026#34;\u0026gt; \u0026lt;include file=\u0026#34;$(find hector_quadrotor_gazebo)/launch/spawn_quadrotor.launch\u0026#34;\u0026gt; ... \u0026lt;/group\u0026gt; \u0026lt;/launch\u0026gt; ì´ì œ, hetero_spawn.launchë¥¼ ìµœì¢… ìˆ˜ì •í•´ë´…ì‹œë‹¤. \u0026lt;launch\u0026gt; \u0026lt;include file=\u0026#34;$(find husky_gazebo)/launch/husky_empty_world.launch\u0026#34; /\u0026gt; \u0026lt;arg name=\u0026#34;model\u0026#34; default=\u0026#34;$(find hector_quadrotor_description)/urdf/quadrotor.gazebo.xacro\u0026#34; /\u0026gt; \u0026lt;group ns=\u0026#34;uav1\u0026#34;\u0026gt; \u0026lt;include file=\u0026#34;$(find hector_quadrotor_gazebo)/launch/spawn_quadrotor.launch\u0026#34;\u0026gt; \u0026lt;arg name=\u0026#34;name\u0026#34; value=\u0026#34;uav1\u0026#34; /\u0026gt; \u0026lt;arg name=\u0026#34;tf_prefix\u0026#34; value=\u0026#34;uav1\u0026#34; /\u0026gt; \u0026lt;arg name=\u0026#34;model\u0026#34; value=\u0026#34;$(arg model)\u0026#34; /\u0026gt; \u0026lt;arg name=\u0026#34;z\u0026#34; value=\u0026#34;1.0\u0026#34; /\u0026gt; \u0026lt;/include\u0026gt; \u0026lt;/group\u0026gt; \u0026lt;/launch\u0026gt; ì‹¤í–‰ í›„ topicì„ ì¡°íšŒí•´ë³´ë©´, ì•„ë˜ì™€ ê°™ì´ quadrotorì˜ topic ì•ì— namespaceê°€ ì¶”ê°€ë˜ì–´ ìˆëŠ” ëª¨ìŠµì´ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì—¬ëŸ¬ ë¡œë´‡ì„ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ /cmd_vel, /scanë“± ì‚¬ìš©í•˜ëŠ” topicì˜ ì´ë¦„ì´ ì¤‘ë³µë  ìˆ˜ ìˆì–´ namespaceë¥¼ ì¶”ê°€ ì„¤ì •í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì…ë‹ˆë‹¤.\n$ rostopic list /clock /cmd_vel /husky_velocity_controller/cmd_vel /husky_velocity_controller/odom /husky_velocity_controller/parameter_descriptions /husky_velocity_controller/parameter_updates /imu/data /odometry/filtered ... /uav1/aerodynamics/wrench /uav1/cmd_vel /uav1/command/motor /uav1/command/twist /uav1/command/wrench /uav1/fix_velocity ... ë§ˆì§€ë§‰ìœ¼ë¡œ, ë¡œë´‡ì„ ì œì–´í•´ë³´ë©´ì„œ ì´ë²ˆ ì„¸ì…˜ì„ ë§ˆë¬´ë¦¬í•´ë³´ê² ìŠµë‹ˆë‹¤. gazeboì˜ worldë¥¼ ë°”ê¾¸ê±°ë‚˜, huskyê°€ ì•„ë‹Œ smbë¡œ ëª¨ë¸ì„ ë°”ê¾¸ëŠ” ë“± ì‘ìš© ì˜ˆì‹œë“¤ì„ ì§ì ‘ í•´ë³´ë©´ì„œ launch fileì˜ ì‚¬ìš©ì— ìµìˆ™í•´ì§€ì‹œê¸° ë°”ëë‹ˆë‹¤.\n# husky ì œì–´ rosrun teleop_twist_keyboard teleop_twist_keyboard.py # quadrotor ì œì–´ rosrun hector_ui ui_hector_quad_leader.py ROS Custom Interfaces ROSì—ì„œ ê¸°ë³¸ ì œê³µë˜ëŠ” msgì™€ srvë„ í›Œë¥­í•˜ì§€ë§Œ, ìƒí™©ì— ë”°ë¼ ë‚˜ë§Œì˜ custom msg/srvë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ ì‹œê°„ì—ëŠ” custom interfaceë¥¼ ë§Œë“¤ì–´ë³´ê³ , ì‚¬ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤.\në“œë¡ ì˜ ì´ì°©ë¥™ì„ ì œì–´í•˜ëŠ” srvë¥¼ ë§Œë“¤ì–´ë³´ê³ ì í•©ë‹ˆë‹¤.\nì´ë¥™/ì°©ë¥™ì„ êµ¬ë¶„í•˜ëŠ” stringì´ í•„ìš”í•  ê²ƒì´ë©°, ê¸°ì¤€ì€ ì‹œê°„ì„ ì‚¬ìš©í•˜ê³ ì í•©ë‹ˆë‹¤. ( ex - 2ì´ˆê°„ ì´ë¥™ ) service requestëŠ” ì„±ê³µ ì—¬ë¶€ì¸ bool typeìœ¼ë¡œ í•´ë³´ê² ìŠµë‹ˆë‹¤. custom interfaceë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ì €ëŠ” ë³„ë„ì˜ packageë¥¼ ìƒì„±í•˜ì˜€ìŠµë‹ˆë‹¤. cd ~/catkin_ws/src/du2023-ros1 catkin_create_pkg custom_interfaces package ë‚´ë¶€ì— msg í˜¹ì€ srvë¼ëŠ” í´ë”ë¥¼ ë§Œë“¤ê³ , custom interfaceë¥¼ ì •ì˜í•˜ëŠ”ê²ƒì´ ì¶”ì²œë©ë‹ˆë‹¤. cd custom_interfaces mkdir srv # QuadrotorControl.srv ìƒì„± string command uint8 seconds --- bool success custom_interfaces packageì˜ package.xmlì„ ìˆ˜ì •í•©ë‹ˆë‹¤. \u0026lt;build_depend\u0026gt;message_generation\u0026lt;/build_depend\u0026gt; \u0026lt;exec_depend\u0026gt;message_runtime\u0026lt;/exec_depend\u0026gt; custom_interfaces packageì˜ CMakeLists.txtë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤. # 1. find_package ìˆ˜ì • find_package(catkin REQUIRED COMPONENTS roscpp rospy std_msgs message_generation ) # 2. catkin_package ì£¼ì„ í•´ì œ í›„ ìˆ˜ì • catkin_package( ... CATKIN_DEPENDS message_runtime ... ...) # 3. add_service_filesì— íŒŒì¼ ë°˜ì˜ add_service_files( FILES QuadrotorControl.srv ) # 4. generate_messages ì£¼ì„ í•´ì œ í›„ ìˆ˜ì • generate_messages( DEPENDENCIES std_msgs # Or other packages containing msgs ) custom interfaceë¥¼ ë¹Œë“œí•˜ê³  ìƒì„±ì„ í™•ì¸í•´ë´…ì‹œë‹¤. $ catkin build custom_interfaces $ rossrv show custom_interfaces/QuadrotorControl string command uint8 seconds --- bool success ì§€ê¸ˆ ìƒì„±í•œ QuadrotorControlì€ catkin_wsì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥í•œ srvë¼ëŠ” ì ì— ìœ ì˜í•©ë‹ˆë‹¤. ë‹¤ë¥¸ workspaceì—ì„œëŠ” QuadrotorControlì— ëŒ€í•´ ì•Œ ê¸¸ì´ ì—†ìŠµë‹ˆë‹¤.\nCustom Interfaces ì‚¬ìš©í•´ë³´ê¸° ì‘ì„±í•œ QuadrotorControlë¥¼ ì‚¬ìš©í•˜ì—¬ Service Serverë¥¼ ë§Œë“¤ì–´ë´…ì‹œë‹¤! ì •í•´ì§„ ì‹œê°„ë™ì•ˆ takeoffì™€ land ì›€ì§ì„ì„ ìˆ˜í–‰í•˜ëŠ” Serviceì…ë‹ˆë‹¤. # Terminal 1 roslaunch hector_quadrotor_gazebo quadrotor_empty_world.launch # Terminal 2 rosrun py_service_pkg quadrotor_custom_srv.py # Terminal 3 rqt ì†ŒìŠ¤ ì½”ë“œëŠ” ì´ ë§í¬ì—ì„œ í™•ì¸ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\ncustom_interfaces packageì—ì„œ QuadrotorControl srvë¥¼ import í•˜ë©°, ë¡œë´‡ì˜ ì œì–´ë¥¼ ìœ„í•´ Twist msgë„ import í•˜ì˜€ìŠµë‹ˆë‹¤. import rospy from geometry_msgs.msg import Twist from custom_interfaces.srv import QuadrotorControl, QuadrotorControlResponse Service Serverì™€ Topic Publisherë¥¼ ìƒì„±í•©ì‹œë‹¤. class QuadRotorUpDown(object): def __init__(self): self.cmd_vel_pub_ = rospy.Publisher(\u0026#34;cmd_vel\u0026#34;, Twist, queue_size=10) self.stop_server_ = rospy.Service(\u0026#34;up_down\u0026#34;, QuadrotorControl, self.up_down_cb) self.twist_msg_ = Twist() self.response_ = QuadrotorControlResponse() rospy.loginfo(\u0026#34;Quadrotor Up-Down Server Started\u0026#34;) callback í•¨ìˆ˜ì¸ up_down_cbì…ë‹ˆë‹¤. commandê°€ land/takeoffì¼ ë•Œì˜ ê²½ìš°ë¥¼ ë‚˜ëˆ„ê³ , ê·¸ ì´ì™¸ì˜ ì…ë ¥ì€ ì˜¤ë¥˜ë¡œ íŒëª…í•©ë‹ˆë‹¤. def up_down_cb(self, request): if request.command == \u0026#34;land\u0026#34;: self.twist_msg_.linear.z = -0.5 self.response_.success = True elif request.command == \u0026#34;takeoff\u0026#34;: self.twist_msg_.linear.z = 0.5 self.response_.success = True else: rospy.logwarn(\u0026#34;Unknown Command\u0026#34;) self.response_.success = False return self.response_ requestì˜ seconds ì‹œê°„ë™ì•ˆ ë¡œë´‡ì´ ì›€ì§ì—¬ì•¼ í•  ê²ƒì´ë©°, ì´ë¥¼ ìœ„í•´ nowë¥¼ ê°±ì‹ í•˜ë©° ì§€ë‚˜ê°„ ì‹œê°„ì„ ê³„ì†í•´ì„œ tracking í•©ë‹ˆë‹¤. start = rospy.Time.now() now = rospy.Time.now() while (now - start).secs \u0026lt; request.seconds: now = rospy.Time.now() self.cmd_vel_pub_.publish(self.twist_msg_) ëª¨ë“  ë™ì‘ì´ ì™„ë£Œëœ ì´í›„ì—ëŠ” ë¡œë´‡ì„ ë‹¤ì‹œ ì •ì§€ì‹œí‚µë‹ˆë‹¤. rospy.loginfo(f\u0026#34;{request.command} done, quadrotor stop\u0026#34;) self.twist_msg_.linear.z = 0.0 self.cmd_vel_pub_.publish(self.twist_msg_) return self.response_ Husky Move Base ROS 1ì—ì„œ ë¡œë´‡ ììœ¨ì£¼í–‰ì„ ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ìŠ¤íƒì„ Move Baseë¼ê³  ì§€ì¹­í•©ë‹ˆë‹¤. ROS 1 noeticì—ì„œ husky ë¡œë´‡ì„ í†µí•´ Move Baseë¥¼ ì‹¤ìŠµí•´ë³´ê² ìŠµë‹ˆë‹¤.\nì˜ˆì‹œë¥¼ ìœ„í•´ í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ë‹¤ìš´ë°›ìŠµë‹ˆë‹¤. sudo apt-get install ros-noetic-husky-navigation slam ì˜ˆì‹œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. # Terminal 1 export HUSKY_LMS1XX_ENABLED=1; roslaunch husky_gazebo husky_playpen.launch # Terminal 2 roslaunch husky_viz view_robot.launch # Terminal 3 roslaunch husky_navigation gmapping_demo.launch ì‚¬ì§„ê³¼ ê°™ì€ worldì™€ í•¨ê»˜ huskyê°€ ë“±ì¥í•  ê²ƒì…ë‹ˆë‹¤.\nrvizì—ì„œ map topicì„ ì¶”ê°€í•©ë‹ˆë‹¤. rvizì˜ 2D Nav Goalì„ ì‚¬ìš©í•˜ë©´ ë¡œë´‡ì„ íŠ¹ì • ìœ„ì¹˜ë¡œ ì´ë™ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ ì˜ˆì‹œëŠ” slamê³¼ navigationì„ ë™ì‹œì— ì‹¤í–‰í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤. rqt_graphë¥¼ í†µí•´ ì‚´í´ë³¸ í˜„ ìƒí™©ì˜ nodeë“¤ê³¼ topicì…ë‹ˆë‹¤. ì°¸ê³ ìë£Œ\nhttp://wiki.ros.org/rospy/Overview/Time https://github.com/RAFALAMAO/hector-quadrotor-noetic https://docs.ros.org/en/foxy/index.html http://wiki.ros.org/ROS/Tutorials/CreatingMsgAndSrv https://www.clearpathrobotics.com/assets/guides/noetic/husky/HuskyMove.html "
},
{
	"uri": "/kr/ros_basic_noetic/lecture9/",
	"title": "Lecture9 - ROS TF and Examples",
	"tags": [],
	"description": "",
	"content": " ëŒ€ë¶€ë¶„ì˜ ë¡œë³´í‹±ìŠ¤ ê³¼ì •ë“¤ì—ì„œ ê°€ì¥ ë¨¼ì € ë‹¤ë£¨ëŠ” ê²ƒì´ ë°”ë¡œ ì¢Œí‘œê³„ ë³€í™˜(Transformation) ì…ë‹ˆë‹¤. ë¡œë´‡ì€ ìˆ˜ë§ì€ jointì™€ linkë¡œ ì´ë£¨ì–´ì ¸ ìˆê¸° ë•Œë¬¸ì— ì¢Œí‘œê³„ë¥¼ ë‹¤ë£¨ëŠ” ì¼ì´ ë§¤ìš° ë¹ˆë²ˆí•©ë‹ˆë‹¤.\nROSì—ì„œëŠ” TFë¼ëŠ” íŠ¹ìˆ˜í•œ í˜•íƒœë¡œ ì´ ì¢Œí‘œê³„ì™€ ì‹œê°„ì„ í•¨ê»˜ ë‹¤ë£¨ê³  ìˆìŠµë‹ˆë‹¤. ì˜ˆì‹œì™€ ì„¤ëª…ì„ í†µí•´ ROSì˜ TFì— ëŒ€í•´ ë°°ì›Œë´…ì‹œë‹¤ ğŸ˜Š\nimage from : eth robot dynamics lecture notes ROSëŠ” ì˜¤í”ˆì†ŒìŠ¤ì´ë‹ˆë§Œí¼ ì‚¬ìš©ìë“¤ì´ ì›í•˜ëŠ” ê¸°ëŠ¥ë“¤ì— ë§ì¶”ì–´ ë³€í™”ê°€ ë¹ ë¦…ë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ê²ƒì´ ë‹¨ì ì´ ë˜ëŠ” ê²½ìš°ë„ ìˆëŠ”ë°, ì´ì „ ë²„ì „ê³¼ ìµœì‹  ë²„ì „ì˜ í˜¸í™˜ì„± ë¬¸ì œê°€ ì¢…ì¢… ë°œìƒí•©ë‹ˆë‹¤.\ntf ë˜í•œ tf2ë¡œ ê°œí¸ë˜ë©´ì„œ ì½”ë“œì˜ ìˆ˜ì •ì´ ìˆì—ˆìœ¼ë©°, ì´ë²ˆ ê°•ì˜ì—ì„œëŠ” tf2ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nimage from : wiki.ros ì˜ˆì‹œë¥¼ ë¨¼ì € ì‚´í´ë´…ì‹œë‹¤.\ntf broadcaster # setup example catkin build py_tf2_tutorial source devel/setup.bash roscore # Terminal 1 rosrun turtlesim turtlesim_node # Terminal 2 rosrun py_tf2_tutorial turtle_tf2_broadcaster.py # Terminal 3 rosrun turtlesim turtle_teleop_key # Terminal 4 rviz rvizë¥¼ ì‹¤í–‰í•œ ë’¤ ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•©ë‹ˆë‹¤. rvizì—ì„œ ë³´ì´ëŠ” ì„¸ê°€ì§€ ìƒ‰ìƒì˜ ë§‰ëŒ€ê°€ ë°”ë¡œ tf ì…ë‹ˆë‹¤.\nx,y,zì˜ ê° ì¶•ì„ ê°ê¸° ë‹¤ë¥¸ ìƒ‰ìœ¼ë¡œ í‘œí˜„í•˜ì˜€ìœ¼ë©°, ì—°ê´€ëœ ì¢Œí‘œê³„ë¼ë¦¬ëŠ” ë…¸ë€ ì„ ì„ í†µí•´ ì—°ê²°í•œ ëª¨ìŠµì´ ë³´ì…ë‹ˆë‹¤.\nTerminal 1ì—ì„œ ì‹¤í–‰ì‹œí‚¨ í”„ë¡œê·¸ë¨ì€ turtlesimì´ë¼ëŠ” ê²ƒìœ¼ë¡œ, 2ì°¨ì› í‰ë©´ì—ì„œ ê±°ë¶ì´ í˜•íƒœì˜ ë¡œë´‡ì„ ì‹œë®¬ë ˆì´ì…˜í•œ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. ì´ì œ, Terminal 3ì— ì»¤ì„œë¥¼ ë‘ê³  ê±°ë¶ì´ë¥¼ ì›€ì§ì´ë©´ì„œ, rvizì™€ turtlesimì˜ ë³€í™”ë¥¼ ì‚´í´ë³´ì„¸ìš”. ê±°ë¶ì´ë¥¼ ì¡°ì¢…í•¨ì— ë”°ë¼ ë³€í™”í•˜ëŠ” rviz í™”ë©´ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì „ì²´ ì½”ë“œëŠ” ì•„ë˜ ë§í¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, ì§€ê¸ˆì€ í•„ìš”í•œ ë¶€ë¶„ë§Œ ì§‘ì¤‘ì ìœ¼ë¡œ ë¶„ì„í•´ë³´ê² ìŠµë‹ˆë‹¤.\nhttps://github.com/RB2023ROS/du2023-ros1/blob/main/py_tf2_tutorial/scripts/turtle_tf2_broadcaster.py\ntf ë˜í•œ í•˜ë‚˜ì˜ Packageì…ë‹ˆë‹¤. ì´ì— ë”°ë¼ ê´€ë ¨ëœ python importê°€ í•„ìš”í•©ë‹ˆë‹¤. import rospy # Because of transformations import tf_conversions import tf2_ros import geometry_msgs.msg import turtlesim.msg tfì˜ ë°ì´í„° ì†¡ì¶œì€ broadcastë¼ê³  ë¶€ë¦…ë‹ˆë‹¤. topicì˜ publisherì™€ ê°™ì´ tfì—ì„œëŠ” TransformBroadcasterë¥¼ ì‚¬ìš©í•˜ë©° sendTransformì´ë¼ëŠ” ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. def handle_turtle_pose(msg, turtlename): # tf requires broadbaster # Be Careful, !!TF IS NOT A TOPIC!! br = tf2_ros.TransformBroadcaster() ... br.sendTransform(t) TransformBroadcasterê°€ ì‚¬ìš©í•˜ëŠ” ë°ì´í„° íƒ€ì…ì€ geometry_msgs.msg.TransformStampedì…ë‹ˆë‹¤. í•´ë‹¹ ë°ì´í„° íƒ€ì…ì—ëŠ” 3ì°¨ì› ì¢Œí‘œê³„ì—ì„œì˜ ìœ„ì¹˜, ë°©í–¥, ê·¸ë¦¬ê³  ì‹œê°„ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. image from : docs.ros.org\ní•´ë‹¹ ë°ì´í„° íƒ€ì…ì— ì ì ˆí•œ ê°’ì„ ì±„ì›Œë„£ì–´ì¤€ ë‹¤ìŒ, ìµœì¢… broadcastê°€ ì§„í–‰ë©ë‹ˆë‹¤. ì£¼ì˜í•  ì ìœ¼ë¡œ ì¿¼í„°ë‹ˆì–¸ ê°ë„ ì²´ê³„ë¥¼ ì‚¬ìš©í–ˆë‹¤ëŠ” ì ì…ë‹ˆë‹¤. # prepare tf msg t = geometry_msgs.msg.TransformStamped() t.header.stamp = rospy.Time.now() t.header.frame_id = \u0026#34;world\u0026#34; t.child_frame_id = turtlename t.transform.translation.x = msg.x t.transform.translation.y = msg.y t.transform.translation.z = 0.0 q = tf_conversions.transformations.quaternion_from_euler(0, 0, msg.theta) t.transform.rotation.x = q[0] t.transform.rotation.y = q[1] t.transform.rotation.z = q[2] t.transform.rotation.w = q[3] ì¿¼í„°ë‹ˆì–¸ì€ ì§ê´€ì ìœ¼ë¡œ ì´í•´í•˜ê¸°ëŠ” í˜ë“  ê°ë„ ì²´ê³„ì…ë‹ˆë‹¤. ê³„ì‚°ì˜ í¸ì˜ë¥¼ ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì‚¬ì´íŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. \u0026gt; 3D Rotation Converter\ntfì˜ ì‚¬ìš© ì‹œ ì£¼ì˜í•´ì•¼ í•  ì ì„ ì–¸ê¸‰í•˜ê³ ì í•©ë‹ˆë‹¤.\nturtle_tf2_broadcaster.py ìˆ˜ì • - Experimentë¼ê³  ë˜ì–´ ìˆëŠ” ë¶€ë¶„ì„ ì£¼ì„ í•´ì œí•œ ë‹¤ìŒ ë‹¤ì‹œ ì‹¤í–‰í•´ë´…ì‹œë‹¤. def handle_turtle_pose(msg, turtlename): # tf requires broadbaster # Be Careful, !!TF IS NOT A TOPIC!! br = tf2_ros.TransformBroadcaster() # prepare tf msg t = geometry_msgs.msg.TransformStamped() # t.header.stamp = rospy.Time.now() # Experiment, Late tf2 t.header.stamp = rospy.Time.now() - rospy.Duration(60) t.header.frame_id = \u0026#34;world\u0026#34; rvizë¥¼ ì‹¤í–‰ì‹œí‚¨ í„°ë¯¸ë„ì—ì„œ ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤. [ WARN] [1671940248.738235698]: TF_REPEATED_DATA ignoring data with redundant timestamp for frame turtle1 at time 1671940148.738096 according to authority unknown_publisher tfì—ëŠ” ì‹œê°„ ë°ì´í„°ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ í˜„ì¬ ì‹œê°„ê³¼ tfì— ë‹´ê¸° ì‹œê°„ì˜ ì°¨ì´ê°€ í¬ë‹¤ë©´ ROSëŠ” ì´ë¥¼ ì•ˆì •ì ì´ì§€ ëª»í•œ ê²ƒìœ¼ë¡œ íŒë‹¨í•´ ë¬´ì‹œí•©ë‹ˆë‹¤. (ìœ„ ì—ëŸ¬ëŠ” ì•„ë§ˆ ë¡œë´‡ ê°œë°œì„ í•˜ë©´ì„œ ë§ˆì£¼ì¹˜ê²Œ ë˜ëŠ” Warning Top3ì•ˆì— ë“¤ì§€ ì•Šì„ê¹Œ ì‹¶ìŠµë‹ˆë‹¤.)\nì´ë²ˆ ì˜ˆì‹œì—ëŠ” í„°ë¯¸ë„ì´ 4ê°œë‚˜ í•„ìš”í•˜ì˜€ìŠµë‹ˆë‹¤. ì˜ˆì‹œì˜ ë¹ ë¥¸ ì‹¤í–‰ì„ ìœ„í•´ launch fileì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. \u0026lt;launch\u0026gt; \u0026lt;node pkg=\u0026#34;turtlesim\u0026#34; type=\u0026#34;turtlesim_node\u0026#34; name=\u0026#34;sim\u0026#34;/\u0026gt; \u0026lt;node pkg=\u0026#34;turtlesim\u0026#34; type=\u0026#34;turtle_teleop_key\u0026#34; name=\u0026#34;teleop\u0026#34; output=\u0026#34;screen\u0026#34;/\u0026gt; \u0026lt;node name=\u0026#34;turtle1_tf2_broadcaster\u0026#34; pkg=\u0026#34;py_tf2_tutorial\u0026#34; type=\u0026#34;turtle_tf2_broadcaster.py\u0026#34; respawn=\u0026#34;false\u0026#34; output=\u0026#34;screen\u0026#34; \u0026gt; \u0026lt;param name=\u0026#34;turtle\u0026#34; type=\u0026#34;string\u0026#34; value=\u0026#34;turtle1\u0026#34; /\u0026gt; \u0026lt;/node\u0026gt; \u0026lt;node name=\u0026#34;rviz\u0026#34; pkg=\u0026#34;rviz\u0026#34; type=\u0026#34;rviz\u0026#34; args=\u0026#34;-d $(find py_tf2_tutorial)/rviz/turtlesim_tf.rviz\u0026#34; /\u0026gt; \u0026lt;/launch\u0026gt; tf listener tf broadcasterì˜ ë‹¤ìŒìœ¼ë¡œ tf listenerì— ëŒ€í•´ ë°°ì›Œë´…ì‹œë‹¤.\nturtlesim follow demo roslaunch py_tf2_tutorial follow_demo.launch ì‚¬ì§„ê³¼ ê°™ì´ ìš°ë¦¬ê°€ ì¡°ì¢…í•˜ëŠ” ì²«ë²ˆì§¸ ê±°ë¶ì´ë¥¼ ë‘ë²ˆì§¸ ê±°ë¶ì´ê°€ ë”°ë¼ì˜¤ê²Œ ë©ë‹ˆë‹¤. rvizë¥¼ í†µí•´ tfë“¤ ì‚¬ì´ì— ì–´ë– í•œ ë³€í™”ê°€ ìˆëŠ”ì§€ë„ ì§ì ‘ í™•ì¸í•´ë³´ì„¸ìš” launch íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì€ ë‚´ìš©ì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n\u0026lt;launch\u0026gt; \u0026lt;node pkg=\u0026#34;turtlesim\u0026#34; type=\u0026#34;turtlesim_node\u0026#34; name=\u0026#34;sim\u0026#34;/\u0026gt; \u0026lt;node pkg=\u0026#34;turtlesim\u0026#34; type=\u0026#34;turtle_teleop_key\u0026#34; name=\u0026#34;teleop\u0026#34; output=\u0026#34;screen\u0026#34;/\u0026gt; \u0026lt;node name=\u0026#34;turtle1_tf2_broadcaster\u0026#34; pkg=\u0026#34;py_tf2_tutorial\u0026#34; type=\u0026#34;turtle_tf2_broadcaster.py\u0026#34; respawn=\u0026#34;false\u0026#34; output=\u0026#34;screen\u0026#34; \u0026gt; \u0026lt;param name=\u0026#34;turtle\u0026#34; type=\u0026#34;string\u0026#34; value=\u0026#34;turtle1\u0026#34; /\u0026gt; \u0026lt;/node\u0026gt; \u0026lt;node name=\u0026#34;turtle2_tf2_broadcaster\u0026#34; pkg=\u0026#34;py_tf2_tutorial\u0026#34; type=\u0026#34;turtle_tf2_broadcaster.py\u0026#34; respawn=\u0026#34;false\u0026#34; output=\u0026#34;screen\u0026#34; \u0026gt; \u0026lt;param name=\u0026#34;turtle\u0026#34; type=\u0026#34;string\u0026#34; value=\u0026#34;turtle2\u0026#34; /\u0026gt; \u0026lt;/node\u0026gt; \u0026lt;node pkg=\u0026#34;py_tf2_tutorial\u0026#34; type=\u0026#34;turtle_tf2_listener.py\u0026#34; name=\u0026#34;listener\u0026#34; output=\u0026#34;screen\u0026#34;/\u0026gt; \u0026lt;/launch\u0026gt; turtlesim ì‹¤í–‰ teleop key ì‹¤í–‰ turtle1ì˜ tf broadcaster turtle2ì˜ tf broadcaster tf listener ì´ë²ˆ ì˜ˆì œì—ì„œ ì‚´í´ë³´ê³ ì í•˜ëŠ” ê²ƒì€ tf listenerì…ë‹ˆë‹¤.\nTransformListener í´ë˜ìŠ¤ëŠ” ìƒì„±ë˜ëŠ” ìˆœê°„ë¶€í„° /tf topicì— ê·€ê¸°ìš¸ì´ê¸° ì‹œì‘í•©ë‹ˆë‹¤. BufferëŠ” ì •í•´ì§„ ì‚¬ì´ì¦ˆë§Œí¼ tf ë°ì´í„°ë¥¼ í’ˆê²Œ ë˜ë©°, TransformListenerì— ì „ë‹¬í•˜ê²Œ ë˜ë©´, tf topic dataë¥¼ ë°›ì•„ Bufferì— ìŒ“ì•„ë‘ëŠ” ê²ƒì…ë‹ˆë‹¤. if __name__ == \u0026#39;__main__\u0026#39;: rospy.init_node(\u0026#39;tf2_turtle_listener\u0026#39;) tfBuffer = tf2_ros.Buffer() listener = tf2_ros.TransformListener(tfBuffer) Bufferì˜ lookup_transform ë©”ì†Œë“œëŠ” ë‘ frame ì‚¬ì´ì˜ translation, rotation ë³€í™˜ì„ ê³„ì‚°í•´ì¤ë‹ˆë‹¤. while not rospy.is_shutdown(): try: # calculate transformation btw two dynamic tfs # those tfs were broadcasted from TransformBroadcaster trans = tfBuffer.lookup_transform(turtle_name, \u0026#39;turtle1\u0026#39;, rospy.Time(), rospy.Duration(1.0)) except (tf2_ros.LookupException, tf2_ros.ConnectivityException, tf2_ros.ExtrapolationException): rate.sleep() continue lookup_transform ë©”ì†Œë“œì˜ ì›í˜•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. image from : docs.ros2.org lookup_transformì˜ ê³„ì‚° ê²°ê³¼ë¥¼ ì§ì ‘ ì‚´í´ë³´ê³ ì print ë¬¸ì„ ì¶”ê°€í•˜ì˜€ìœ¼ë©°, ìº¡ì³ ì‚¬ì§„ì„ í†µí•´ ê°„ë‹¨íˆ í•¨ê»˜ ì‚´í´ë´…ì‹œë‹¤.\ntranslationì€ ë‘ ê±°ë¶ì´ì˜ frameì‚¬ì´ ìˆ˜í‰ ê±°ë¦¬ë¥¼ ë³´ì—¬ì£¼ë©° rotationì€ ë‘ frameì‚¬ì´ íšŒì „ì„ ì¿¼í„°ë‹ˆì–¸ìœ¼ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤. ê¸°ì¤€ì´ ë˜ëŠ” frameê³¼ ëª©í‘œ frameì€ idë¡œ êµ¬ë¶„í•˜ë©°, í˜„ì¬ turtle1, turtle2ë¡œ êµ¬ë¶„í•˜ê³  ìˆìŠµë‹ˆë‹¤. í˜„ ìƒí™©ì„ ê·¸ë¦¼ìœ¼ë¡œ ê°„ë‹¨íˆ ì •ë¦¬í•˜ìë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nlookup_transformì˜ ê³„ì‚° ê²°ê³¼ëŠ” target frameì¸ turtle2ì˜ ìœ„ì¹˜ê°€ source frameì¸ turtle1 ê¸°ì¤€ì—ì„œëŠ” ì–´ë– í•œ ì¢Œí‘œë¥¼ ê°–ëŠ”ì§€ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.\nimage from : CMU Qatar ë¡œë³´í‹±ìŠ¤ì—ì„œ ì´ëŸ¬í•œ ì¢Œí‘œ ë³€í™˜ì€ ë§¤ìš° ìì£¼ ì‚¬ìš©ë˜ë©°, ì¼ë°˜ì ìœ¼ë¡œ Homogeneous Matrixì˜ í˜•íƒœë¡œ í‘œí˜„í•©ë‹ˆë‹¤.\nfrom : eth robotics lecture notes ê·¸ ë°–ì—, ì½”ë“œì—ì„œ êµ¬í˜„ëœ ê¸°ëŠ¥ì„ ê°„ë‹¨íˆ ì‚´í´ë³´ë©° ë§ˆë¬´ë¦¬í•˜ê² ìŠµë‹ˆë‹¤.\në‘ë²ˆì§¸ ê±°ë¶ì´ë¥¼ ë“±ì¥ì‹œí‚¤ëŠ” service client # Spawn second turtle rospy.wait_for_service(\u0026#39;spawn\u0026#39;) spawner = rospy.ServiceProxy(\u0026#39;spawn\u0026#39;, turtlesim.srv.Spawn) turtle_name = rospy.get_param(\u0026#39;turtle\u0026#39;, \u0026#39;turtle2\u0026#39;) spawner(4, 2, 0, turtle_name) ê±°ë¶ì´ë¥¼ ì œì–´í•˜ê¸° ìœ„í•œ Twist msg topic publisher # turtle2 controller turtle_vel = rospy.Publisher(\u0026#39;%s/cmd_vel\u0026#39; % turtle_name, geometry_msgs.msg.Twist, queue_size=1) rate = rospy.Rate(50.0) while not rospy.is_shutdown(): ... turtle_vel.publish(msg) rate.sleep() ì´ë ‡ê²Œ tfì— ëŒ€í•´ì„œ turtlesim ì˜ˆì‹œì™€ í•¨ê»˜ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ë¡œë³´í‹±ìŠ¤ì—ì„œ ìì£¼ ì‚¬ìš©ë˜ëŠ” ì¢Œí‘œê³„ì™€ ê·¸ë“¤ ì‚¬ì´ì˜ ë³€í™˜ì„ ì‹œê°„ ë°ì´í„°ì™€ í•¨ê»˜ í‘œí˜„í•˜ëŠ” ê²ƒì´ ROSì˜ tf2ì…ë‹ˆë‹¤.\në‹¤ìŒ ê°•ì˜ì— ê³„ì† ì´ì–´ì§‘ë‹ˆë‹¤.\n"
},
{
	"uri": "/kr/ros_basic_noetic/lecture10/",
	"title": "Lecture10 - TF2 Examples, Outro",
	"tags": [],
	"description": "",
	"content": "tf2 ì‚¬ë¡€ ì œê°€ ê°•ì¡°í•´ì„œ ìê¾¸ ì¢Œí‘œê³„ê°€ tfê°€ ì¤‘ìš”í•˜ë‹¤ê³  ë§í•˜ê³  ìˆëŠ”ë°, ê·¸ ì´ìœ ë¥¼ ì˜ˆì‹œì™€ í•¨ê»˜ ì¢€ ë” ìì„¸íˆ ì‚´í´ë³´ê³ ì í•©ë‹ˆë‹¤.\nhusky slam # ì˜ˆì‹œ ì¢…ì†ì„± ì„¤ì¹˜ sudo apt install ros-noetic-slam-gmapping # Terminal 1 roslaunch smb_gazebo smb_gazebo.launch world:=big_map_summer_school # Terminal 2 roslaunch py_tf2_tutorial slam_gmapping.launch # Terminal 3 rosrun teleop_twist_keyboard teleop_twist_keyboard.py # [option] rviz (ì´ì „ ì˜ˆì‹œì—ì„œ rvizë¥¼ ì¶”ê°€í•˜ì˜€ë‹¤ë©´ ë„˜ì–´ê°€ì…”ë„ ì¢‹ìŠµë‹ˆë‹¤.) rviz rvizë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì„¸íŒ…í•©ë‹ˆë‹¤. ì´ì œ teleopì„ í†µí•´ ë¡œë´‡ì„ ì´ë™ì‹œí‚¤ë©´ì„œ, rviz í™”ë©´ì˜ ë³€í™”ë¥¼ í™•ì¸í•´ë´…ì‹œë‹¤. ë¡œë´‡ì´ ì›€ì§ì´ë©´ì„œ ìì‹ ì˜ ìœ„ì¹˜ë¥¼ íŒŒì•…í•¨ê³¼ ë™ì‹œì— ì§€ë„ë¥¼ ìƒì„±í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤.\në§ˆì§€ë§‰ìœ¼ë¡œ, rqtë¥¼ ì‹¤í–‰í•˜ì—¬ tf treeë¥¼ ì‹¤í–‰ì‹œí‚µë‹ˆë‹¤. tf treeëŠ” tf ê´€ë ¨ ìƒíƒœë¥¼ ì‹œê°í™”í•˜ì—¬ í•œë²ˆì— ë³¼ ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê³ ë§ˆìš´ íˆ´ì…ë‹ˆë‹¤. treeë¥¼ í™•ëŒ€í•´ì„œ ì‚´í´ë³´ìë©´, slam_gmappingì€ map â†’ odomìœ¼ë¡œì˜ tf broadcastë¥¼ ë‹´ë‹¹í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë”ë¶ˆì–´ mapì€ ëª¨ë“  tfì˜ ìµœìƒë‹¨ì— ì¡´ì¬í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì´ìœ ë¡œ rvizì—ì„œ fixed frameì„ mapìœ¼ë¡œ ì„¤ì •í•œ ê²ƒì…ë‹ˆë‹¤. í€´ì¦ˆ: ë§Œì•½ tf treeê°€ ì˜¨ì „íˆ ì—°ê²°ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´ ì–´ë–¤ ì¼ì´ ë°œìƒí• ê¹Œìš”?\nimage from : answers.ros.org ì„¼ì„œ ì…ì¥ì—ì„œë„ tfëŠ” ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤.\nê°™ì€ ë°ì´í„°ë¼ë„ ê·¸ ê¸°ì¤€ì´ ì–´ë”˜ì§€ì— ë”°ë¼ì„œ ì „í˜€ ë‹¤ë¥¸ ì˜ë¯¸ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.\nì˜ˆë¥¼ ë“¤ì–´, ë¼ì´ë‹¤ì˜ tfë¥¼ 180ë„ ë°˜ëŒ€ë¡œ ì„¤ì •í•´ë²„ë¦¬ë©´ í›„ë°©ì— ìˆëŠ” ì¥ì• ë¬¼ì„ ì „ë°© ì¥ì• ë¬¼ë¡œ ì˜ëª» ì¸ì‹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nimage from : answers.ros.org ë”ë¶ˆì–´, ë¡œë´‡ íŒ”ê³¼ ê°™ì€ ê´€ì ˆë¡œë´‡ì—ê²Œë„ tfëŠ” ë¬´ì²™ ì¤‘ìš”í•œ ì˜ë¯¸ë¥¼ ê°–ìŠµë‹ˆë‹¤. ê° jointì˜ ìƒíƒœë¥¼ í†µí•´ tfë¥¼ ê³„ì‚°í•˜ê³  ì´ë¥¼ í†µí•´ ìµœì¢…ì ìœ¼ë¡œ ë¡œë´‡ íŒ”ì˜ ëì ì´ ì–´ë””ì— ìœ„ì¹˜í•˜ëŠ”ì§€ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nMoveIt! ì‹¤ìŠµí•´ë³´ê¸° ì´ë²ˆ ì‹œê°„ì—ëŠ” ì¡°ê¸ˆ ì‰¬ì–´ê°€ëŠ” ëŠë‚Œìœ¼ë¡œ ìœ ìš©í•œ ROS Packageë¥¼ ì†Œê°œí•´ë“œë¦¬ê³ ì í•©ë‹ˆë‹¤.\nimage from : moveit github MoveItì€ ë‹¤ê´€ì ˆ ë¡œë´‡ì˜ ëª¨ì…˜ ì œì–´ë¥¼ ìœ„í•œ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. ì´ë¦„ë§Œ ë“¤ì–´ì„œëŠ” ê°ì´ ì˜ ì˜¤ì§€ ì•Šì§€ìš”? ê°„ë‹¨í•œ ì˜ˆì‹œë¥¼ í†µí•´ ì‚´í´ë´…ì‹œë‹¤.\nìš°ë¦¬ ì¸ê°„ì€ íŒ”ì„ ì´ìš©í•˜ì—¬ ë¬¼ê±´ì„ ì¡ëŠ” ê²ƒì´ ë§¤ìš° ì‰½ê³  ê°„ë‹¨í•˜ì§€ë§Œ, ì‚¬ì‹¤ ì´ëŠ” ê¸°êµ¬í•™ì ìœ¼ë¡œ, ë™ì—­í•™ì ìœ¼ë¡œ, ì—ë„ˆì§€ ì°¨ì›ì—ì„œ ë§¤ìš° ìµœì í™”ëœ ì›€ì§ì„ì…ë‹ˆë‹¤. ë¡œë´‡ íŒ”ì˜ ê²½ìš° ì¥ì°©ëœ ëª¨í„°ì˜ ë°©í–¥ê°ì´ ì œí•œëœ ê²½ìš°ë„ ìˆê³ , ìê¸° ìì‹ ê³¼ ì–½í˜€ë²„ë¦¬ëŠ” ë¬¸ì œë„ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë©°, ê°™ì€ ëª©í‘œë¥¼ ê°–ë”ë¼ê³  ë‹¤ì–‘í•œ ê²½ë¡œë¡œ ì›€ì§ì¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ìµœì ì˜ ê²½ë¡œì— ëŒ€í•œ ê¸°ì¤€ë„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤. image from : mecademic ë¡œë´‡ íŒ”ì˜ ì£¼ìš” êµ¬ì„± Base : ê³ ì •ëœ ì§€ì§€ë¶€ Arm : ì‹¤ì§ˆì ì¸ ë¡œë´‡ íŒ” End Effector : Arm ëì— ë¶€ì°©ë˜ëŠ” ê¸°êµ¬ì˜ í†µì¹­, ì¼ë°˜ì ìœ¼ë¡œ ë¬¼ì²´ë¥¼ ì¡ê³  ë†“ëŠ” ë™ì‘ì„ ìˆ˜í–‰ MoveItì€ ê´€ì ˆ ë¡œë´‡ì˜ ê¸°ë³¸ êµ¬ì„±ê³¼ Mass Matrix, ê° ëª¨í„°ì˜ ì œí•œê³¼ ì›í•˜ëŠ” ì›€ì§ì„ì„ ì§€ì •í•´ì£¼ë©´ ì´ì— ë”°ë¼ ê° ê´€ì ˆì˜ ìœ„ì¹˜, ì†ë„, ê°€ì†ë„ ê²½ë¡œë¥¼ ìµœì í™”(Planning) í•´ì£¼ëŠ” í”„ë ˆì„ì›Œí¬ì´ë©°, ê·¸ ë°–ì—ë„, ë¬¼ì²´ ì¸ì§€, ì¥ì• ë¬¼ íšŒí”¼, End Effectorì— ê°€í•´ì§€ëŠ” í˜ê¹Œì§€ ê³ ë ¤ ê°€ëŠ¥í•œ ê±°ëŒ€í•œ ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.\nMoveIt Motion Planning Framework\nì´ë²ˆ ì˜ˆì œë¡œ ì €ì™€ í•¨ê»˜ MoveItì˜ ê°€ì¥ ê¸°ë³¸ì ì¸ ë°ëª¨ë¥¼ í•¨ê»˜ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤. ì˜ˆì‹œì— ì‚¬ìš©ë˜ëŠ” ë¡œë´‡ì€ FRANKA EMIKAì˜ PANDAë¼ëŠ” ë¡œë´‡ì…ë‹ˆë‹¤. FRANKA EMIKA - PANDA\nì•„ë˜ ì»¤ë©˜ë“œ ë¼ì¸ì„ í•¨ê»˜ ë”°ë¼ì™€ì£¼ì„¸ìš”.\napt íŒ¨í‚¤ì§€ ì„¤ì¹˜ sudo apt install ros-noetic-moveit-setup-assistant sudo apt install ros-noetic-moveit sudo apt install ros-noetic-gazebo-ros-control joint-state-publisher sudo apt install ros-noetic-controller-manager sudo apt install ros-noetic-ros-controllers sudo apt install ros-noetic-ros-control sudo apt install ros-noetic-robot-state-publisher ì˜ˆì œ íŒ¨í‚¤ì§€ Clone cd ~/catkin_ws git clone https://github.com/ros-planning/moveit_tutorials.git -b master git clone https://github.com/ros-planning/panda_moveit_config.git -b noetic-devel ê´€ë ¨ ì¢…ì†ì„± ì„¤ì¹˜ - rosdep ì¶”ê°€ ì„¤ëª… cd ~/catkin_ws/src rosdep install -y --from-paths . --ignore-src --rosdistro noetic íŒ¨í‚¤ì§€ ë¹Œë“œ cd ~/catkin_ws catkin build source devel/setup.bash ë°ëª¨ ì‹¤í–‰ roslaunch panda_moveit_config demo_gazebo.launch ì—¬ê¸°ê¹Œì§€ ì˜ ë”°ë¼ì˜¤ì…¨ë‚˜ìš”? ê·¸ë ‡ë‹¤ë©´ ê°•ì˜ìì˜ ì„¤ëª…ì— ë”°ë¼ RViz Motion Planning Pluginì„ ì‚¬ìš©í•´ë´…ë‹ˆë‹¤.\nì°¸ê³ ìë£Œ\nhttps://rsl.ethz.ch/education-students/lectures/ros.html https://ros-planning.github.io/moveit_tutorials/ http://wiki.ros.org/tf/Tutorials "
},
{
	"uri": "/kr/advanced_contents_ros1/lecture1/",
	"title": "Lecture1 - ROSCPP",
	"tags": [],
	"description": "",
	"content": "roscpp Programming rosëŠ” ë‹¤ì–‘í•œ ì–¸ì–´ë¥¼ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ ì‚´í´ë³´ì•˜ë˜ rospyëŠ” ê°€ì¥ ì‰½ê³  ë¹ ë¥´ê²Œ ë°°ìš¸ ìˆ˜ ìˆì–´ì„œ ì‚¬ìš©í•˜ì˜€ì§€ë§Œ, UDPROS, Nodelet, Pluginê³¼ ê°™ì€ Advanced ROS ê°œë°œì„ ìœ„í•´ì„œëŠ” C++ í”„ë¡œê·¸ë˜ë°ì„ í†µí•œ Node ê°œë°œì´ í•„ìš”í•©ë‹ˆë‹¤.\nimage from : wikipedia rospyë¥¼ í†µí•´ ê°œë…ì„ ëª¨ë‘ ìµí˜”ê¸° ë•Œë¬¸ì— ì´ë²ˆ ê°•ì˜ì—ì„œëŠ” ê°œë°œ APIë¥¼ ìœ„ì£¼ë¡œ roscppì„ ë°°ì›Œë³´ê² ìŠµë‹ˆë‹¤.\nê°€ì¥ ê¸°ì´ˆê°€ ë˜ëŠ” Node í”„ë¡œê·¸ë˜ë°ë¶€í„° ì°¨ì´ì ì„ ì‚´í´ë´…ì‹œë‹¤. rospy roscpp #!/usr/bin/env python3 import rospy from std_msgs.msg import String def my_first_node(): # ROS nodes require initialization # It contains master registration, uploading parameters rospy.init_node(\u0026#39;my_first_node\u0026#39;, anonymous=True) # ROS safe timer rate = rospy.Rate(10) # 10hz # Loop control Example while not rospy.is_shutdown(): hello_du = \u0026#34;hello du %s\u0026#34; % rospy.get_time() rospy.loginfo(hello_du) # Below line calls sleep method in Python internally. rate.sleep() if __name__ == \u0026#39;__main__\u0026#39;: try: my_first_node() except rospy.ROSInterruptException: pass #include \u0026lt;ros/ros.h\u0026gt; #include \u0026lt;std_msgs/String.h\u0026gt; int main(int argc, char** argv){ ros::init(argc, argv, \u0026#34;basic_node\u0026#34;); ros::NodeHandle nh; ros::Rate r(5); while ( ros::ok() ) { ROS_INFO(\u0026#34;This is Basic Node\u0026#34;); // ros::spinOnce(); r.sleep(); } return 0; } ê°„ë‹¨íˆ í‘œë¥¼ í†µí•´ ë¹„êµí•´ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ìƒë‹¹ ë¶€ë¶„ ë°˜ë³µë˜ëŠ” ì ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nrospy roscpp Client Library import rospy #include \u0026lt;ros/ros.h\u0026gt; initialization rospy.init_node ros::init interface import from std_msgs.msg import String #include \u0026lt;std_msgs/String.h\u0026gt; logging rospy.loginfo() ROS_INFO() spin rospy.spin() ros::spin() rate rospy.Rate() ros::Rate() rospyì™€ì˜ ì°¨ì´ì ìœ¼ë¡œ, roscppì€ NodeHandleì´ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. roscppì€ NodeHandleì„ í†µí•´ parameter, publisher, subscriber, serviceServerë“¤ì„ ìƒì„±í•˜ë©°, ë§¤ê°œë³€ìˆ˜ë¡œ namespaceë¥¼ ë°›ìŠµë‹ˆë‹¤.\ncmd_vel_pub ì˜ˆì‹œì½”ë“œì— namespaceë¥¼ ì„¤ì •í•œ ë’¤ topicê°’ì˜ ë³€í™”ë¥¼ ì‚´í´ë´…ì‹œë‹¤.\nros::NodeHandle nh(\u0026#34;my_namespace\u0026#34;); ë”ë¶ˆì–´, NodeHandleì€ ROS Node lifecycle ì¤‘ â€œstartâ€ì˜ íŠ¸ë¦¬ê±°ê°€ ë©ë‹ˆë‹¤. Nodeì˜ Lifecycleì— ëŒ€í•œ ìì„¸í•œ ì„¤ëª…ì€ ë§í¬ë¡œ ëŒ€ì²´í•˜ê² ìŠµë‹ˆë‹¤.\nimage from : Initialization and Shutdown NodeHandleì€ ë°˜ë“œì‹œ ros::init ë³´ë‹¤ ë’¤ì— ìƒì„±ë˜ì–´ì•¼ í•©ë‹ˆë‹¤\nROS C++ Package Build C++ë¡œ ì‘ì„±ëœ ì½”ë“œëŠ” ë¹Œë“œê°€ í•„ìš”í•˜ë©° caktin ì‹œìŠ¤í…œì—ì„œëŠ” CMakeê°€ ë¹Œë“œë¥¼ ë„ì™€ì¤ë‹ˆë‹¤.\në¹Œë“œ ì‹œì— í•„ìš”í•œ ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬, ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤, ë¹Œë“œ ì†ì„±ê³¼ ê°™ì€ ìƒì„¸ ë‚´ìš©ë“¤ì´ CMakeLists.txtì— ìœ„ì¹˜í•©ë‹ˆë‹¤.\në³¸ ê°•ì˜ì—ì„œëŠ” CMakeì— ëŒ€í•´ì„œëŠ” ìì„¸íˆ ë‹¤ë£¨ì§€ ì•Šê³ , í”„ë¡œê·¸ë˜ë° ì‹œ ì•Œì•„ì•¼ í•˜ëŠ” ë¶€ë¶„ë§Œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nfind_package - ROSì—ì„œ ê¸°ë³¸ ì œê³µí•˜ëŠ” íŒ¨í‚¤ì§€ë“¤ì„ ì†ì‰½ê²Œ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ## Find catkin macros and libraries ## if COMPONENTS list like find_package(catkin REQUIRED COMPONENTS xyz) ## is used, also find other catkin packages find_package(catkin REQUIRED COMPONENTS roscpp geometry_msgs sensor_msgs ) ì»´íŒŒì¼ ì˜µì…˜ - add_executableê³¼ add_dependenciesë¥¼ ì ìš©í•˜ê³ , ë¹Œë“œ ê²°ê³¼ê°€ ìœ„ì¹˜í•˜ëŠ” ì§€ì ì„ catkin workspaceì˜ build í´ë”ë¡œ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤. ## Declare a C++ executable ## With catkin_make all packages are built within a single CMake context ## The recommended prefix ensures that target names across packages don\u0026#39;t collide add_executable(cmd_vel_pub_node src/cmdvel_pub.cpp) add_executable(laser_sub_node src/laser_sub.cpp) ... add_dependencies(cmd_vel_pub_node ${cmd_vel_pub_node_EXPORTED_TARGETS} ${catkin_EXPORTED_TARGETS}) add_dependencies(laser_sub_node ${laser_sub_node_EXPORTED_TARGETS} ${catkin_EXPORTED_TARGETS}) ... target_link_libraries(cmd_vel_pub_node ${catkin_LIBRARIES} ) target_link_libraries(laser_sub_node ${catkin_LIBRARIES} ) ì´í›„ catkin buildì™€ ì‹¤í–‰ì€ rospyì™€ ë™ì¼í•©ë‹ˆë‹¤. (executable nameì— ì£¼ì˜í•©ë‹ˆë‹¤.) catkin build \u0026lt;pkg-name\u0026gt; source devel/setup.bash rosrun \u0026lt;pkg-name\u0026gt; \u0026lt;executable-name\u0026gt; roscpp Topic roscppì˜ ì˜ˆì‹œë“¤ì€ rospyì™€ ë™ì¼í•œ ê¸°ëŠ¥ì„ í•˜ë„ë¡ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤. ì½”ë“œì˜ APIì— ì§‘ì¤‘í•˜ì—¬ ë¹„êµ, ë¶„ì„í•´ë³´ê² ìŠµë‹ˆë‹¤. # Terminal 1 roslaunch smb_gazebo smb_gazebo.launch # Example 1 rosrun cpp_topic_pkg cmd_vel_pub # Example 2 rosrun cpp_topic_pkg laser_scan_sub cmd_vel_pub code python c\u0026#43;\u0026#43; #!/usr/bin/env python3 import rospy from geometry_msgs.msg import Twist class CmdVelPubNode: def __init__(self): # Publisher requires 3 paramters # 1. topic name # 2. topic msg type # 3. topic queue size self.cmd_vel_pub_ = rospy.Publisher(\u0026#34;cmd_vel\u0026#34;, Twist, queue_size=10) self.timer_ = rospy.Timer(rospy.Duration(1.0/10.0), self.pub_msg) self.twist_ = Twist() def pub_msg(self, event=None): # geometry_msgs.Twist # ref: http://docs.ros.org/en/melodic/api/geometry_msgs/html/msg/Twist.html self.twist_.linear.x = 0.5 self.twist_.angular.z = 1.0 self.cmd_vel_pub_.publish(self.twist_) def cmd_vel_node(): rospy.init_node(\u0026#39;cmd_vel_node\u0026#39;, anonymous=True) cmd_vel_pub_node = CmdVelPubNode() rospy.spin() if __name__ == \u0026#39;__main__\u0026#39;: try: cmd_vel_node() except rospy.ROSInterruptException: pass #include \u0026lt;ros/ros.h\u0026gt; #include \u0026lt;geometry_msgs/Twist.h\u0026gt; class CmdVelPubNode { private: ros::Publisher cmd_vel_pub_; ros::Timer timer_; geometry_msgs::Twist twist_msg_; public: CmdVelPubNode(ros::NodeHandle *nh) { ROS_INFO(\u0026#34;Publisher and Subscriber initialized\u0026#34;); timer_ = nh-\u0026gt;createTimer(ros::Duration(0.1), \u0026amp;CmdVelPubNode::timerCallback, this); cmd_vel_pub_ = nh-\u0026gt;advertise\u0026lt;geometry_msgs::Twist\u0026gt;(\u0026#34;cmd_vel\u0026#34;, 10); } void timerCallback(const ros::TimerEvent\u0026amp; event){ twist_msg_.linear.x = 0.5; twist_msg_.angular.z = 0.5; cmd_vel_pub_.publish(twist_msg_); } }; int main(int argv, char** argc) { ros::init(argv, argc, \u0026#34;cmd_vel_node\u0026#34;); // ros::NodeHandle nh(\u0026#34;my_namespace\u0026#34;); ros::NodeHandle nh; CmdVelPubNode cmd_pub_node(\u0026amp;nh); ros::spin(); return 0; } laser_scan_sub code python c\u0026#43;\u0026#43; #!/usr/bin/env python3 import rospy from sensor_msgs.msg import LaserScan class LaserSubNode: def __init__(self): # Publisher requires 3 paramters # 1. topic name # 2. topic msg type # 3. sub callback method self.laser_sub_ = rospy.Subscriber(\u0026#34;scan\u0026#34;, LaserScan, self.laser_cb) # first param of callback method is always topic msg def laser_cb(self, data): rospy.loginfo( len(data.ranges)) print(f\u0026#34;\u0026#34;\u0026#34; data.ranges[0]: {data.ranges[0]} data.ranges[90]: {data.ranges[90]} data.ranges[179]: {data.ranges[179]} data.ranges[270]: {data.ranges[270]} data.ranges[360]: {data.ranges[360]} \u0026#34;\u0026#34;\u0026#34;) def laser_sub_node(): rospy.init_node(\u0026#39;laser_sub_node\u0026#39;, anonymous=True) laser_sub_node = LaserSubNode() rospy.spin() if __name__ == \u0026#39;__main__\u0026#39;: try: laser_sub_node() except rospy.ROSInterruptException: pass #include \u0026lt;ros/ros.h\u0026gt; #include \u0026lt;geometry_msgs/Twist.h\u0026gt; #include \u0026lt;sensor_msgs/LaserScan.h\u0026gt; class LaserSubNode { private: ros::Subscriber laser_sub_; ros::Timer timer_; public: LaserSubNode(ros::NodeHandle *nh) { ROS_INFO(\u0026#34;Publisher and Subscriber initialized\u0026#34;); // TCPROS // laser_sub_ = nh-\u0026gt;subscribe(\u0026#34;scan\u0026#34;, 10, \u0026amp;LaserSubNode::laserSubCallback, this); // UDPROS laser_sub_ = nh-\u0026gt;subscribe(\u0026#34;scan\u0026#34;, 10, \u0026amp;LaserSubNode::laserSubCallback, this, ros::TransportHints() .unreliable() .reliable() .maxDatagramSize(1000) .tcpNoDelay() ); } void laserSubCallback(const sensor_msgs::LaserScanConstPtr data){ ROS_INFO_STREAM(\u0026#34;data.ranges[0]: \u0026#34; \u0026lt;\u0026lt; data-\u0026gt;ranges[0]); ROS_INFO_STREAM(\u0026#34;data.ranges[90]: \u0026#34; \u0026lt;\u0026lt; data-\u0026gt;ranges[90]); ROS_INFO_STREAM(\u0026#34;data.ranges[179]: \u0026#34; \u0026lt;\u0026lt; data-\u0026gt;ranges[179]); ROS_INFO_STREAM(\u0026#34;data.ranges[270]: \u0026#34; \u0026lt;\u0026lt; data-\u0026gt;ranges[270]); ROS_INFO_STREAM(\u0026#34;data.ranges[360]: \u0026#34; \u0026lt;\u0026lt; data-\u0026gt;ranges[360]); // std::cout \u0026lt;\u0026lt; std::to_string(data.ranges[0]) \u0026lt;\u0026lt; std::endl; ROS_INFO(\u0026#34;Publisher and Subscriber initialized\u0026#34;); } }; int main(int argv, char** argc) { ros::init(argv, argc, \u0026#34;laser_sub_node\u0026#34;); // ros::NodeHandle nh(\u0026#34;my_namespace\u0026#34;); ros::NodeHandle nh; LaserSubNode laser_sub_node(\u0026amp;nh); ros::spin(); return 0; } rospy roscpp Publisher rospy.Publisher(topic_name, Message-Type, queue_size) advertise(topic_name, queue_size) Subscriber rospy.Subscriber(topic_name, Message-Type, callback) subscribe(topic_name, queue_size, callback) C++ë¡œ OOP ì½”ë“œ ì‘ì„± ì‹œ, boostë¥¼ í†µí•œ bindingì´ í•„ìš”í•¨ì— ìœ ì˜í•©ë‹ˆë‹¤. CmdVelPubNode(ros::NodeHandle *nh) { ROS_INFO(\u0026#34;Publisher and Subscriber initialized\u0026#34;); timer_ = nh-\u0026gt;createTimer(ros::Duration(0.1), \u0026amp;CmdVelPubNode::timerCallback, this); cmd_vel_pub_ = nh-\u0026gt;advertise\u0026lt;geometry_msgs::Twist\u0026gt;(\u0026#34;cmd_vel\u0026#34;, 10); } íŒŒì´ì¬ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ sub callbackì˜ ì²«ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ëŠ” topic msg dataì´ë©°, std::shared_ptrê°€ ì‚¬ìš©ë©ë‹ˆë‹¤. void sub_callback(const sensor_msgs::LaserScanConstPtr \u0026amp;data ){ ROS_INFO_STREAM(\u0026#34;data.ranges[0]: \u0026#34; \u0026lt;\u0026lt; data-\u0026gt;ranges[0]); } roscppì—ì„œëŠ” Logger ì‚¬ìš© ì‹œ c_str í¬ë©§ìœ¼ë¡œ ë³€í™˜í•´ì¤˜ì•¼ í•œë‹¤ëŠ” ë‹¨ì ì´ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ê°„í¸í•˜ê²Œ í•˜ê¸° ìœ„í•´ ì €ëŠ” ROS_INFO_STREAMë¥¼ ì• ìš©í•©ë‹ˆë‹¤. ROS_INFO_STREAM(\u0026#34;data.ranges[0]: \u0026#34; \u0026lt;\u0026lt; data-\u0026gt;ranges[0]); ROSUDP ROS Topic í†µì‹ ì„ ìœ„í•´ Publisherì™€ Subscriberê°„ì˜ negotiationì´ ì´ë£¨ì–´ì§€ë©°, ì´ ì‹œì ì—ì„œ Subscriberì— ì˜í•´ TCP/UDPROS ì¤‘ ì–´ë– í•œ í†µì‹ ì´ ì‚¬ìš©ë  ì§€ ê²°ì •ë©ë‹ˆë‹¤. Subscriber ì½”ë“œë¥¼ ìˆ˜ì •í•˜ì—¬ UDPROSë¥¼ ì‚¬ìš©í•´ë´…ì‹œë‹¤.\nsubscribe ì˜ˆì‹œë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•˜ê³  ë¹Œë“œ í›„ ë‹¤ì‹œ ì‹¤í–‰ì‹œì¼œë´…ì‹œë‹¤. laser_sub_ = nh-\u0026gt;subscribe(\u0026#34;scan\u0026#34;, 10, \u0026amp;LaserSubNode::laserSubCallback, this, ros::TransportHints() .unreliable() .reliable() .maxDatagramSize(1000) .tcpNoDelay() ); ìœ„ ì½”ë“œì—ì„œ, unreliableì€ UDPROSë¥¼, reliableì€ TCPROSë¥¼ ëœ»í•©ë‹ˆë‹¤. UDPROSë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, maxDatagramSizeë¥¼ ì§€ì •í•  ìˆ˜ ìˆìœ¼ë©°, TCPROSë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° tcpNoDelayë¥¼ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. ìœ„ ì½”ë“œëŠ” UDPROS í†µì‹ ì„ ë¨¼ì € ì‹œë„í•œ ë’¤, ì‘ë‹µì´ ì—†ë‹¤ë©´ TCPROSë¥¼ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.\nì´ ê°™ì€ ì„¤ì •ì— ëŒ€í•œ ìƒì„¸ ë‚´ìš©ì€ ë§í¬ë¥¼ í™•ì¸í•©ì‹œë‹¤. â‡’ ì°¸ê³ ë§í¬ : ros::TransportHints Class Reference\nì†ŒìŠ¤ì½”ë“œ ë¹Œë“œ í›„ ë‹¤ì‹œ ì‹¤í–‰ catkin build cpp_topic_pkg source devel/setup.bash rosrun cpp_topic_pkg laser_scan_sub rosnode infoë¥¼ í†µí•´ transport ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤. â‡’ UDPROSë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. $ rosnode info /laser_sub_node -------------------------------------------------------------------------------- ... * topic: /scan * to: /pointcloud_to_laserscan (http://192.168.55.236:39875/) * direction: inbound * transport: UDPROS roscpp Service service ì˜ˆì‹œë“¤ë„ rospyì™€ ë™ì¼í•œ ê¸°ëŠ¥ì„ ê°–ìŠµë‹ˆë‹¤. # Terminal 1 roslaunch smb_gazebo smb_gazebo.launch # Example 1 rosrun cpp_service_pkg emergency_stop # Example 2 rosrun cpp_service_pkg spawn_model_client emergency_stop code python c\u0026#43;\u0026#43; #! /usr/bin/env python3 import rospy from roslaunch.pmon import start_process_monitor from geometry_msgs.msg import Twist from std_srvs.srv import SetBool, SetBoolResponse class EmergencyStopNode(object): def __init__(self): self.cmd_vel_pub_ = rospy.Publisher(\u0026#34;cmd_vel\u0026#34;, Twist, queue_size=10) self.stop_server_ = rospy.Service(\u0026#34;emergency_stop\u0026#34;, SetBool, self.stop_cb) self.pm_ = start_process_monitor() self.twist_msg_ = Twist() self.response_ = SetBoolResponse() rospy.loginfo(\u0026#34;E Stop Server Started\u0026#34;) self.twist_pub() rospy.sleep(0.1) def twist_pub(self): self.twist_msg_.linear.x = 0.5 self.twist_msg_.angular.z = 1.0 self.cmd_vel_pub_.publish(self.twist_msg_) def stop_cb(self, request): if request.data is True: self.twist_msg_.linear.x = 0.0 self.twist_msg_.angular.z = 0.0 self.cmd_vel_pub_.publish(self.twist_msg_) self.response_.success = True self.response_.message = \u0026#34;Successfully Stopped\u0026#34; else: self.response_.success = False self.response_.message = \u0026#34;Stop Failed\u0026#34; return self.response_ def main(): rospy.init_node(\u0026#34;emergency_stop_node\u0026#34;) e_stop_node = EmergencyStopNode() rospy.sleep(1.0) e_stop_node.twist_pub() rospy.spin() if __name__ == \u0026#39;__main__\u0026#39;: try: main() except rospy.ROSInterruptException: pass #include \u0026lt;ros/ros.h\u0026gt; #include \u0026lt;std_srvs/SetBool.h\u0026gt; #include \u0026lt;geometry_msgs/Twist.h\u0026gt; using SetBool = std_srvs::SetBool; class EmergencyStopNode { private: ros::ServiceServer service_; ros::Publisher cmd_vel_pub_; geometry_msgs::Twist twist_msg_; public: EmergencyStopNode(ros::NodeHandle *nh){ service_ = nh-\u0026gt;advertiseService(\u0026#34;emergency_stop\u0026#34;, \u0026amp;EmergencyStopNode::eStopCallback, this); cmd_vel_pub_ = nh-\u0026gt;advertise\u0026lt;geometry_msgs::Twist\u0026gt;(\u0026#34;cmd_vel\u0026#34;, 10); ROS_INFO_STREAM(\u0026#34;EmergencyStopNode Started\u0026#34;); } void moveRobot(){ twist_msg_.linear.x = 0.5; twist_msg_.angular.z = 1.0; cmd_vel_pub_.publish(twist_msg_); } bool eStopCallback(SetBool::Request \u0026amp;req, SetBool::Response \u0026amp;res){ if(req.data == true){ twist_msg_.linear.x = 0.0; twist_msg_.angular.z = 0.0; cmd_vel_pub_.publish(twist_msg_); res.success = true; res.message = \u0026#34;Successfully Stopped\u0026#34;; return true; } else { res.success = false; res.message = \u0026#34;Stop Failed\u0026#34;; return false; } } }; int main(int argc, char **argv) { ros::init(argc, argv, \u0026#34;emergency_stop_node\u0026#34;); ros::NodeHandle nh; EmergencyStopNode e_stop_service(\u0026amp;nh); auto start_time = ros::Time::now(); auto cur_time = ros::Time::now(); while( (cur_time - start_time) \u0026lt; ros::Duration(3.0)){ e_stop_service.moveRobot(); cur_time = ros::Time::now(); } ros::spin(); ros::shutdown(); return 0; } spawn_model_client code python c\u0026#43;\u0026#43; #! /usr/bin/env python3 \u0026#34;\u0026#34;\u0026#34; referenced from programcreek url : https://www.programcreek.com/python/example/93572/rospkg.RosPack \u0026#34;\u0026#34;\u0026#34; import math import rospy import rospkg from geometry_msgs.msg import Pose from gazebo_msgs.srv import SpawnModel def spawn_helix(): rospy.init_node(\u0026#34;gazebo_spawn_model\u0026#34;) # model_name model_name = \u0026#34;box\u0026#34; # model_xml rospack = rospkg.RosPack() model_path = rospack.get_path(\u0026#34;py_service_pkg\u0026#34;) + \u0026#34;/urdf/\u0026#34; with open(model_path + model_name + \u0026#34;.urdf\u0026#34;, \u0026#34;r\u0026#34;) as xml_file: model_xml = xml_file.read().replace(\u0026#34;\\n\u0026#34;, \u0026#34;\u0026#34;) # robot_namespace robot_namespace = \u0026#34;\u0026#34; # initial_pose initial_pose = Pose() initial_pose.position.x = 0.0 initial_pose.position.y = -1 initial_pose.position.z = 0.2 # z rotation -pi/2 to Quaternion initial_pose.orientation.z = -0.707 initial_pose.orientation.w = 0.707 # reference_frame reference_frame = \u0026#34;world\u0026#34; theta = 0.0 spawn_model_prox = rospy.ServiceProxy(\u0026#34;gazebo/spawn_urdf_model\u0026#34;, SpawnModel) for i in range(100): # service call initial_pose.position.x = theta * math.cos(theta) initial_pose.position.y = theta * math.sin(theta) theta += 0.2 entity_name = model_name + str(i) result = spawn_model_prox( entity_name, model_xml, robot_namespace, initial_pose, reference_frame ) \u0026#34;\u0026#34;\u0026#34; result fromat bool success string status_message \u0026#34;\u0026#34;\u0026#34; rospy.loginfo(result) if __name__ == \u0026#39;__main__\u0026#39;: try: spawn_helix() except rospy.ROSInterruptException: pass #include \u0026lt;fstream\u0026gt; // ros.h doesn\u0026#39;t contain this lib #include \u0026lt;ros/ros.h\u0026gt; #include \u0026lt;ros/package.h\u0026gt; #include \u0026lt;geometry_msgs/Pose.h\u0026gt; #include \u0026lt;gazebo_msgs/SpawnModel.h\u0026gt; void addXml(gazebo_msgs::SpawnModel\u0026amp; model_in, const std::string\u0026amp; file_path ){ std::ifstream file(file_path); std::string line; while (!file.eof()){ std::getline(file, line); model_in.request.model_xml += line; } file.close(); } class SpawnModelClient { private: ros::ServiceClient spawn_model_prox; int model_num_ = 0; double theta_ = 0.0; public: SpawnModelClient(ros::NodeHandle *nh){ spawn_model_prox = nh-\u0026gt;serviceClient\u0026lt;gazebo_msgs::SpawnModel\u0026gt;(\u0026#34;gazebo/spawn_urdf_model\u0026#34;); for(auto i = 0; i \u0026lt; 100; i++){ this-\u0026gt;serviceCall(); } } void serviceCall(){ gazebo_msgs::SpawnModel model; // add roslib in find_package() auto file_path = ros::package::getPath(\u0026#34;cpp_service_pkg\u0026#34;) + \u0026#34;/urdf/box.urdf\u0026#34;; addXml(model, file_path); model.request.model_name = \u0026#34;box\u0026#34; + std::to_string(model_num_++); model.request.reference_frame = \u0026#34;world\u0026#34;; model.request.initial_pose = getPose(); // ServiceClient.call() =\u0026gt; return bool type if (spawn_model_prox.call(model)){ auto response = model.response; ROS_INFO(\u0026#34;%s\u0026#34;, response.status_message.c_str()); // Print the result given by the service called } else { ROS_ERROR(\u0026#34;Failed to call service /trajectory_by_name\u0026#34;); ros::shutdown(); } model_num_++; } geometry_msgs::Pose getPose(){ geometry_msgs::Pose initial_pose; initial_pose.position.x = theta_ * cos(theta_); initial_pose.position.y = theta_ * sin(theta_); theta_ += 0.2; initial_pose.position.z = 0.2; initial_pose.orientation.z = -0.707; initial_pose.orientation.w = 0.707; return initial_pose; } }; int main(int argc, char** argv){ ros::init(argc, argv, \u0026#34;gazebo_spawn_model\u0026#34;); ros::NodeHandle nh; SpawnModelClient spawn_model_client(\u0026amp;nh); ros::shutdown(); return 0; } Service Serverì™€ Clientë¥¼ ìƒì„±í•˜ëŠ” ì½”ë“œ API ì°¨ì´ë¥¼ ë¹„êµí•´ë´…ì‹œë‹¤. rospy roscpp Server rospy.Service(service_name, srv_type, callback) advertiseService(service_name, srv_type, callback) Client rospy.ServiceProxy(server_name, srv_type) serviceClient\u0026lt;srv_type\u0026gt;(service_name) Time rospy.Time.now() ros::Time::now() rospack rospkg.RosPack().get_path() ros::package::getPath() ì‹¤ì œ ë¡œë´‡ í”„ë¡œê·¸ë˜ë°ì‹œì—ëŠ” pythonë³´ë‹¤ c++ê°€ ìš°ì„¸í•˜ê²Œ ì‚¬ìš©ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” ì´ë¯¸ rospyë¥¼ í†µí•´ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì— ëŒ€í•´ ì´í•´í•˜ì˜€ê¸° ë•Œë¬¸ì— ê°„ë‹¨íˆ ì§šê³  ë„˜ì–´ê°”ìœ¼ë©°, ê´€ë ¨ëœ ì¶”ê°€ ê°œë°œì€ ê°•ì˜ ë…¸íŠ¸ë¥¼ í†µí•´ ì§€ì† ì—…ë°ì´íŠ¸í•  ì˜ˆì •ì…ë‹ˆë‹¤.\nì°¸ê³ ìë£Œ\nhttp://wiki.ros.org/roscpp/Overview/Publishers and Subscribers http://docs.ros.org/ "
},
{
	"uri": "/kr/advanced_contents_ros1/lecture2/",
	"title": "Lecture2 - More About ROS System",
	"tags": [],
	"description": "",
	"content": " ROS Nodeê°€ ì‹¤í–‰ë˜ê³  Topic í†µì‹ ì´ ì´ë£¨ì–´ì§€ê¸° ìœ„í•´ì„œ Masterì—ê²Œ ìì‹ ì„ ë“±ë¡í•˜ê³  Masterì— ì˜í•œ Nodeê°„ TCPROS / UDPROS ì—°ê²°ì´ ì´ë£¨ì–´ì ¸ì•¼ í•©ë‹ˆë‹¤.\nê°œë… ì •ë¦¬ì™€ ì˜ˆì‹œ, ê·¸ë¦¬ê³  ë°ëª¨ë¥¼ í†µí•´ ROSì˜ í†µì‹  ì‹œìŠ¤í…œì— ëŒ€í•´ ë°°ì›Œë´…ì‹œë‹¤.\nXMLRPC Extensible Markup Language - XMLì´ë€, ì›¹ ì„œë¹„ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ í‘œí˜„í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ë§ˆí¬ì—… ì–¸ì–´ì…ë‹ˆë‹¤. (such as HTML), ëª¨ë“  ë°ì´í„°ë¥¼ êµ¬ì¡°í™”í•´ì„œ transportí•˜ê¸° ë•Œë¬¸ì— ê²€ìƒ‰ê³¼ ì¬ì‚¬ìš©ì— ìœ ë¦¬í•©ë‹ˆë‹¤. ROSì—ì„œ ì‚¬ìš©í•˜ëŠ” launch fileë„ xmlì„ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë¯€ë¡œ ROS ê°œë°œìë“¤ì—ê²ŒëŠ” ìµìˆ™í•œ ë¬¸ë²•ì¼ ê²ƒì…ë‹ˆë‹¤. image from : xml íŒŒì¼ì˜ ë¹„ë°€ RPC - remote procedure call ë€, ë¶„ì‚° ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì—ì„œì˜ í”„ë¡œê·¸ë˜ë°ì„ ìš©ì´í•˜ê²Œ í•˜ê¸° ìœ„í•´ ë“±ì¥í•œ ê¸°ìˆ ë¡œ, ì›ê²©ì— ì •ì˜ëœ í•¨ìˆ˜ë¥¼ ë¡œì»¬ì—ì„œ í˜¸ì¶œí•˜ëŠ” ì‹ìœ¼ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nimage from : RPCë€? ì´ ë‘˜ì„ ê²°í•©í•œ XML-RPCëŠ” RPC ê¸°ìˆ  ê³¼ì •ì—ì„œ XMLì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì„œë²„-í´ë¼ì´ì–¸íŠ¸ ì •ë³´ê°€ XML ë¬¸ì„œë¡œ ë§Œë“¤ì–´ì ¸ ì‘ë‹µí•˜ê²Œ ë©ë‹ˆë‹¤.\nXML-RPC Request Format Example - HTTP Headerë¥¼ í¬í•¨í•œ ì˜ˆì‹œì´ë©°, /xmlrpcë¼ëŠ” ì„œë²„ì— circleAreaë¼ëŠ” methodë¥¼ request í•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤. POST /xmlrpc HTTP 1.0 User-Agent: myXMLRPCClient/1.0 Host: 192.168.124.2 Content-Type: text/xml Content-Length: 169 \u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;methodCall\u0026gt; \u0026lt;methodName\u0026gt;circleArea\u0026lt;/methodName\u0026gt; \u0026lt;params\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt;\u0026lt;double\u0026gt;2.41\u0026lt;/double\u0026gt;\u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;/params\u0026gt; \u0026lt;/methodCall\u0026gt; XML-RPC Response Format Example - Requestì™€ ìœ ì‚¬í•œ êµ¬ì¡°ë¥¼ ê°–ì§€ë§Œ methodCall ëŒ€ì‹  methodResponseê°€ ì‚¬ìš©ë˜ë©°, methodNameê°€ ì—†ë‹¤ëŠ” ì°¨ì´ë¥¼ ê°–ìŠµë‹ˆë‹¤. HeaderëŠ” ì„±ê³µ, ì‹¤íŒ¨ ìœ ë¬´ì™€ ìƒê´€ ì—†ì´ 200 OKë¥¼ ë°˜í™˜í•œë‹¤ëŠ” ì ì— ìœ ì˜í•©ë‹ˆë‹¤. HTTP/1.1 200 OK Date: Sat, 06 Oct 2001 23:20:04 GMT Server: Apache.1.3.12 (Unix) Connection: close Content-Type: text/xml Content-Length: 124 \u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;methodResponse\u0026gt; \u0026lt;params\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt;\u0026lt;double\u0026gt;18.24668429131\u0026lt;/double\u0026gt;\u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;/params\u0026gt; \u0026lt;/methodResponse\u0026gt; ROSëŠ” Topic, Service í†µì‹ ì„ ìœ„í•´ standard TCP/UDP socketì— ê¸°ë°˜í•˜ì—¬ ë…ìì ì¸ Headerì™€ í”„ë¡œí† ì½œì„ ê°€ì§„ TCPROS/UDPROSë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì´ë“¤ì— ëŒ€í•´ í•˜ë‚˜ì”© ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\nConnection Header Connection HeaderëŠ” Nodeê°„ í†µì‹ ì´ ì´ë£¨ì–´ì§€ê¸° ìœ„í•œ typing, routing ë°ì´í„°ë¥¼ í¬í•¨í•˜ê³  ìˆìœ¼ë©° TCPROSì™€ UDPROS ë³„ë„ ë‹¤ë¥¸ í˜•íƒœë¥¼ ê°–ê³  ìˆìŠµë‹ˆë‹¤. ê³µì‹ ë¬¸ì„œì—ì„œ ëª…í™•íˆ ë°íˆê³  ìˆëŠ” TCPROSì˜ Connection Headerë¥¼ ë¶„ì„í•´ë´…ì‹œë‹¤.\nEncoding Formatì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. 4-byte length + [4-byte field length + field=value ]* * All length fields are little-endian integers * Field names and values are strings. rostopic pub /chatter std_msgs/String \u0026quot;helloâ€ ì— ëŒ€í•œ hex outputì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. ì „ì²´ header ê¸¸ì´ 176 ë°”ì´íŠ¸ â‡’ (b0 00 00 00, little-endian ì‚¬ìš©)\nb0 00 00 00 20 00 00 00 6d 65 73 73 61 67 65 5f 64 65 66 69 6e 69 74 69 6f 6e 3d 73 74 72 69 6e 67 20 64 61 74 61 0a 0a 25 00 00 00 63 61 6c 6c 65 72 69 64 3d 2f 72 6f 73 74 6f 70 69 63 5f 34 37 36 37 5f 31 33 31 36 39 31 32 37 34 31 35 35 37 0a 00 00 00 6c 61 74 63 68 69 6e 67 3d 31 27 00 00 00 6d 64 35 73 75 6d 3d 39 39 32 63 65 38 61 31 36 38 37 63 65 63 38 63 38 62 64 38 38 33 65 63 37 33 63 61 34 31 64 31 0e 00 00 00 74 6f 70 69 63 3d 2f 63 68 61 74 74 65 72 14 00 00 00 74 79 70 65 3d 73 74 64 5f 6d 73 67 73 2f 53 74 72 69 6e 67 09 00 00 00 05 00 00 00 68 65 6c 6c 6f message_definition í•„ë“œëŠ” ì•„ë˜ì™€ ê°™ì´ í•´ì„ë©ë‹ˆë‹¤. - ê¸¸ì´ 32 bytes (20 00 00 00) 6d 65 73 73 61 67 65 5f 64 65 66 69 6e 69 74 69 6f 6e 3d 73 74 72 69 6e 67- m e s s a g e _ d e f i n i t i o n = s t r i n g- 20 64 61 74 61 0a 0a d a t a \\n \\n callerid í•„ë“œëŠ” ì•„ë˜ì™€ ê°™ì´ í•´ì„ë©ë‹ˆë‹¤. - ê¸¸ì´ 37 bytes (25 00 00 00) 63 61 6c 6c 65 72 69 64 3d 2f 72 6f 73 74 6f 70 69 63 5f 34 37 36 37 5f 31 33- c a l l e r i d = / r o s t o p i c _ 4 7 6 7 _ 1 3- 31 36 39 31 32 37 34 31 35 35 37 1 6 9 1 2 7 4 1 5 5 7 latching í•„ë“œëŠ” ì•„ë˜ì™€ ê°™ì´ í•´ì„ë©ë‹ˆë‹¤. - ê¸¸ì´ 10 bytes (0a 00 00 00) 6c 61 74 63 68 69 6e 67 3d 31 l a t c h i n g = 1 md5sum í•„ë“œëŠ” ì•„ë˜ì™€ ê°™ì´ í•´ì„ë©ë‹ˆë‹¤. - ê¸¸ì´ 39 bytes (27 00 00 00) 6d 64 35 73 75 6d 3d 39 39 32 63 65 38 61 31 36 38 37 63 65 63 38 63 38 62 64- m d 5 s u m = 9 9 2 c e 8 a 1 6 8 7 c e c 8 c 8 b d- 38 38 33 65 63 37 33 63 61 34 31 64 31 8 8 3 e c 7 3 c a 4 1 d 1 topic í•„ë“œëŠ” ì•„ë˜ì™€ ê°™ì´ í•´ì„ë©ë‹ˆë‹¤. - ê¸¸ì´ 14 bytes (0e 00 00 00) 74 6f 70 69 63 3d 2f 63 68 61 74 74 65 72 t o p i c = / c h a t t e r message type í•„ë“œëŠ” ì•„ë˜ì™€ ê°™ì´ í•´ì„ë©ë‹ˆë‹¤. - ê¸¸ì´ 20 bytes (14 00 00 00) 74 79 70 65 3d 73 74 64 5f 6d 73 67 73 2f 53 74 72 69 6e 67 t y p e = s t d _ m s g s / S t r i n g helloë¼ëŠ” ë°ì´í„° responseëŠ” 5 bytesë¥¼ ê°–ê³ , message body í•„ë“œ ê¸¸ì´ëŠ” 9 bytesì´ë©°, std_msgs/String íƒ€ì…ì„ ê°–ìŠµë‹ˆë‹¤. 09 00 00 00 05 00 00 00 68 65 6c 6c 6f h e l l o ì´ë ‡ê²Œ Topic responseëŠ” íŠ¹ì • í•„ë“œì™€ ë°ì´í„°ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\nì‚¬ìš©ë˜ëŠ” ëª¨ë“  í•„ë“œì— ëŒ€í•œ ë°ì´í„°ëŠ” ë§í¬ë¡œ ëŒ€ì²´í•˜ê² ìŠµë‹ˆë‹¤.\nì°¸ê³ ë§í¬ : http://wiki.ros.org/ROS/Connection Header TCPROS TCPROSëŠ” ROSì˜ Topic, Service í†µì‹  ì‹œ Inbound connectionìœ¼ë¡œ TCP ì†Œì¼“ì„ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ì¼ì „ ì‚´í´ë³¸ Connection Headerì—ì„œì™€ ê°™ì´ íŠ¹ì • í•„ë“œë“¤ì„ ê²°í•©í•˜ì—¬ Headerì™€ Dataë¥¼ ì†¡ìˆ˜ì‹ í•©ë‹ˆë‹¤.\në§Œì•½ headerê°€ \u0026rsquo;topic\u0026rsquo; í•„ë“œë¥¼ í¬í•¨í•˜ê³  ìˆë‹¤ë©´ ROS Topic ì—°ê²°ë¡œ ì´ë£¨ì–´ì§€ê³  \u0026lsquo;service\u0026rsquo; í•„ë“œë¥¼ í¬í•¨í•˜ê³  ìˆë‹¤ë©´ ROS Service ì—°ê²°ë¡œ ì´ë£¨ì–´ì§€ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.\nê°ê°ì˜ í•„ë“œë“¤ì— ëŒ€í•œ ê°„ëµí•œ ë‚˜ì—´ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. TCPROS subscriberì˜ Request\nmessage_definition: full text of message definition callerid: subscriber node name topic: name of the topic the subscriber is connecting to md5sum: md5sum of the message type type: message type md5sum ì´ë€? íŒŒì¼ì„ ë‹¤ìš´ë°›ê±°ë‚˜, ì´ë™í•˜ê±°ë‚˜, ë³µì‚¬í•œ í›„ì— ì›ë³¸íŒŒì¼ê³¼ ë™ì¼í•œ íŒŒì¼ì¸ì§€ í™•ì¸í•˜ëŠ” ëª©ì ìœ¼ë¡œ ì“°ì´ëŠ” í•´ì‹œ ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤. (ex - gitì˜ SHA-1)\nTCPROS publisherì˜ Response\nmd5sum: md5sum of the message type type: message type TCPROS service clientì˜ Request\ncallerid: node name of service client service: name of the topic the subscriber is connecting to md5sum: md5sum of the message type type: service type optional í•„ë“œë“¤\ntcp_nodelay: ì´ ê°’ì´ \u0026lsquo;1\u0026rsquo; ì¼ ì‹œ topic í†µì‹ ì— TCP_NODELAY ì˜µì…˜ì„ ì ìš©í•©ë‹ˆë‹¤. latching: latchë¥¼ ì‚¬ìš©í•˜ë©´ ë§ˆì§€ë§‰ìœ¼ë¡œ ë©”ì‹œì§€ê°€ ì €ì¥ë˜ê³  ì´í›„ ì—°ê²° ì‹œ ì´ ë°ì´í„°ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤. ì§€ë„ì™€ ê°™ì´ ì •ì ì´ê³  ëŠë¦° ë°ì´í„°ë¥¼ ë‹¤ë£° ë•Œ ìœ ìš©í•©ë‹ˆë‹¤. ì´ ê°’ì´ \u0026lsquo;1\u0026rsquo; ì´ë©´ publishí•˜ëŠ” ë°ì´í„°ê°€ latchë¼ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. persistent: ì´ ê°’ì´ \u0026lsquo;1\u0026rsquo; ì¼ ì‹œ, Service ServerëŠ” ì—¬ëŸ¬ Requestì— ëŒ€ì‘í•˜ì—¬ ê³„ì† í†µì‹ ì„ ì—´ì–´ë‘¬ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. error: í†µì‹  ì‹¤íŒ¨ ì‹œ ë“±ì¥í•˜ëŠ” human-readable error messageì…ë‹ˆë‹¤. ok: Service Responseì—ì„œ ì‚¬ìš©ë˜ëŠ” ê°’ìœ¼ë¡œ ì´ ê°’ì´ \u0026lsquo;1\u0026rsquo; ì¼ ì‹œ, responseê°€ ì„±ê³µì ìœ¼ë¡œ í†µì‹ ë˜ì§€ë§Œ, ì´ ê°’ì´ \u0026lsquo;0\u0026rsquo; ì¼ ì‹œ, serialized string íƒ€ì…ì˜ ì—ëŸ¬ ë©”ì„¸ì§€ê°€ ì´ì–´ì§‘ë‹ˆë‹¤. ê²½ìš°ì— ë”°ë¼ return falseë¡œ ì¸í•´ ë¹„ì–´ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. UDPROS UDPROSëŠ” ROSì˜ Topic, Service í†µì‹  ì‹œ Inbound connectionìœ¼ë¡œ UDP ì†Œì¼“ì„ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. UDPROSëŠ” standard UDP datagramê³¼ serializedëœ message dataë¥¼ ì‚¬ìš©í•˜ë©°, ë¡œë´‡ì˜ ì œì–´ì™€ ì„¼ì„œ ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ê²ƒê³¼ ê°™ì´ ë¹ ë¥¸ í†µì‹ ì— ì‚¬ìš©ë©ë‹ˆë‹¤.\nUDPROS header formatì€ ì•„ë˜ì™€ ê°™ìœ¼ë©° TCPROSì— ë¹„í•´ í›¨ì”¬ ê°„ë‹¨í•©ë‹ˆë‹¤.\n+---------------------------------+ | Connection ID | +---------------------------------+ |Opcode | Msg ID | Block # | +---------------------------------+ Connection ID - 32-bit valueë¡œ connection negotiation ì¤‘ ê²°ì •ë©ë‹ˆë‹¤. Opcode - UDPROSëŠ” ì—¬ëŸ¬ datagram typeì„ ì§€ì›í•˜ëŠ”ë°, ì´ë“¤ì„ ëª…ì‹œí•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤. DATA0 (0) - ROS messageì˜ ê°€ì¥ ì²˜ìŒì— ì „ì†¡ë©ë‹ˆë‹¤. DATAN (1) - ì²« ì „ì†¡ ì´í›„ ê³„ì†í•´ì„œ ì´ íƒ€ì…ì´ ì‚¬ìš©ë©ë‹ˆë‹¤. PING (2) - heartbeat packetì…ë‹ˆë‹¤. ERR (3) - ê°‘ì‘ìŠ¤ëŸ° connection ë‹¨ì ˆ ì‹œ ì‚¬ìš©ë©ë‹ˆë‹¤. Message ID - ìƒˆ ë©”ì‹œì§€ê°€ ì „ì†¡ë  ë•Œë§ˆë‹¤ ì¦ê°€ë˜ë©° ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” 8ë¹„íŠ¸ ê°’ì…ë‹ˆë‹¤. Block # - opcodeê°€ DATANì¸ ê²½ìš°, í˜„ì¬ datagram ë²ˆí˜¸ê°€ ë˜ë©°, opcodeê°€ DATA0ì´ ì•„ë‹Œ ì´ìƒ 0ì„ ê°–ê³ , ì „ì²´ ROS messageì˜ ê°œìˆ˜ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì¶”ê°€ íŠ¹ì§•\nROS messagesëŠ” ë‹¤ìˆ˜ì˜ Subscriberë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì²« datagramì€ ì „ì²´ datagramsì˜ ìˆ˜ë¥¼ ë‹´ê²Œ ë©ë‹ˆë‹¤. connection negotiation ì¤‘ ì‚¬ìš©í•  ìµœëŒ€ message per datagramì´ ê²°ì •ë©ë‹ˆë‹¤. ROSì˜ í†µì‹  ì‹œìŠ¤í…œ ì´ì •ë¦¬ ROS Masterì™€ Nodeì— ì˜í•´ Topicê³¼ Serviceê°€ ì´ë£¨ì–´ì§€ëŠ” ê³¼ì •ì„ ì´ì •ë¦¬í•´ë´…ì‹œë‹¤.\nroscore ëª…ë ¹ì–´ë¥¼ í†µí•´ Nodeê°„ ì ‘ì†ì„ ì£¼ê´€í•˜ê³  URI ì£¼ì†Œ/í¬íŠ¸ë¥¼ ë“±ë¡ë°›ëŠ” ROS Masterë¥¼ êµ¬ë™ì‹œí‚µë‹ˆë‹¤. rosrun í˜¹ì€ roslaunchì— ì˜í•´ Nodeê°€ ì‹¤í–‰ë©ë‹ˆë‹¤. Subscriber Nodeê°€ êµ¬ë™ë˜ëŠ” ê³¼ì •ì—ì„œ, Node ìì‹ ì˜ ì´ë¦„, Topic ì´ë¦„, Message Type, URI ì£¼ì†Œì™€ í¬íŠ¸ê°€ ì£¼ê³  ë°›ì•„ì§‘ë‹ˆë‹¤. ë‹¤ìŒìœ¼ë¡œ, Publisher Nodeê°€ êµ¬ë™ë˜ë©° Subscriberì™€ ë§ˆì°¬ê°€ì§€ë¡œ Topic ë“±ë¡ì„ ìœ„í•´ Masterì™€ ê°ì¢… ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ìŠµë‹ˆë‹¤. ROS Masterê°€ Subscriber Nodeì—ê²Œ Publisherì˜ ì •ë³´ë¥¼ ì „ë‹¬í•˜ê³ , ì´ë•Œ, XML-RPCë¥¼ ì´ìš©í•˜ì—¬ í†µì‹ í•©ë‹ˆë‹¤. Subscriber NodeëŠ” ROS Masterë¡œë¶€í„° Publisherì˜ ì •ë³´ë¥¼ ë°›ì•„ í•´ë‹¹ Nodeì—ê²Œ ì§ì ‘ ì ‘ì† ìš”ì²­ì„ í•©ë‹ˆë‹¤. Node ì´ë¦„, Topic ì´ë¦„, ë°©ì‹(TCPROS ë˜ëŠ” UDPROS)ê³¼ ê°™ì€ ì •ë³´ë¥¼ XMLRPC ë¥¼ ì´ìš©í•˜ì—¬ í†µì‹ í•˜ê²Œ ë©ë‹ˆë‹¤. Publisher NodeëŠ” Subscriber Nodeì—ê²Œ ì ‘ì† ì‘ë‹µì„ í•˜ê²Œ ë˜ê³ , ìì‹ ì˜ TCP ì„œë²„ì˜ ì •ë³´ì¸ URIì£¼ì†Œì™€ í¬íŠ¸ë¥¼ XMLRPC ë¥¼ ì´ìš©í•˜ì—¬ ì „ë‹¬í•˜ê²Œ ë©ë‹ˆë‹¤. Subscriber NodeëŠ” TCPROSë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ë¥¼ ë§Œë“¤ê³ , Publisher Nodeì™€ ì§ì ‘ ì—°ê²°í•©ë‹ˆë‹¤. ì´ì œë¶€í„°, Publisher NodeëŠ” Subscriber Nodeì—ê²Œ ì •í•´ì§„ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•˜ê²Œ ë©ë‹ˆë‹¤. Serviceì˜ ê²½ìš° Topicê³¼ ë‹¬ë¦¬ 1íšŒì„± ì—°ê²°ì´ê¸° ë•Œë¬¸ì—, ì ‘ì†, ì„œë¹„ìŠ¤ ìš”ì²­, ì„œë¹„ìŠ¤ ì‘ë‹µì´ ìˆ˜í–‰ë˜ê³  ì„œë¡œê°„ì˜ ì ‘ì†ì„ ëŠê²Œ ë©ë‹ˆë‹¤. ì´í›„ Service í†µì‹ ì„ ë‹¤ì‹œ ì§„í–‰í•´ì•¼ í•˜ëŠ” ê²½ìš° ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì§„í–‰í•´ì•¼ í•©ë‹ˆë‹¤. Topic ì ‘ì†ì˜ ì¢…ë£Œ ì‹œ, Nodeì˜ ì¢…ë£Œ ì‹œì—ë„ ê° Nodeë“¤ì€ ROS Masterì—ê²Œ XML-RPCë¥¼ í†µí•´ ì¢…ë£Œ Messageë¥¼ ì£¼ê³ ë°›ìŠµë‹ˆë‹¤. ROS Packet Analysis Demo ROS ë‚´ë¶€ì˜ í†µì‹ ì´ ì´ë£¨ì–´ì§€ëŠ” ê³¼ì •ì„ ë°°ìš´ ë§Œí¼ WireSharkë¥¼ í†µí•´ ì‹¤ì œ ì˜¤ê°€ëŠ” íŒ¨í‚·ì„ ë¶„ì„í•´ ë´…ì‹œë‹¤.\nWireshark ì„¤ì¹˜ sudo apt update sudo apt install wireshark sudo wireshark ROS MasterëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 11311 í¬íŠ¸ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •ë˜ì–´ìˆìŠµë‹ˆë‹¤. í˜„ì¬ IPì˜ 11311 í¬íŠ¸ íŒ¨í‚·ì„ ë¶„ì„í•˜ì—¬ roscore ì‹¤í–‰ ì‹œ ì˜¤ê°€ëŠ” íŒ¨í‚·ë“¤ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ip.addr == \u0026lt;my-ip-addr\u0026gt; || tcp.port == 11311 # Terminal roscore TCP handshakeê°€ ì´ë£¨ì–´ì§„ ë’¤ parameter server, logger, roslaunch, rosgraph, statistics_window_max_sizeë¥¼ ë¹„ë¡¯í•˜ì—¬ ë‹¤ì–‘í•œ ì„œë¹„ìŠ¤ê°€ Request, Responseë¥¼ í†µí•´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤. ROS Masterë¥¼ ì¢…ë£Œí•  ì‹œì—ë„ ì‹¤í–‰ë˜ê³  ìˆëŠ” ëª¨ë“  ì„œë¹„ìŠ¤ë“¤ì€ 11311í¬íŠ¸ë¥¼ í†µí•´ ì¢…ë£Œ ì‹ í˜¸ë¥¼ Request-Response í•©ë‹ˆë‹¤.\nì´ë²ˆì—ëŠ” Publisherë¥¼ ì‹¤í–‰í•œ ë’¤, ROS Masterì™€ ì˜¤ê°€ëŠ” íŒ¨í‚·ì„ ì‚´í´ë´…ì‹œë‹¤. rostopic pub /chatter std_msgs/String \u0026#34;hello\u0026#34; íŒ¨í‚·ì„ ì‚´í´ë³´ë©´, XMLRPCë¥¼ í†µí•´ Topic Publisherì˜ í¬íŠ¸ì™€ ì´ë¦„, Topic ì´ë¦„ê³¼ Message type ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Packet - 1 Packet - 2 \u0026lt;methodCall\u0026gt; \u0026lt;methodName\u0026gt; registerService \u0026lt;/methodName\u0026gt; \u0026lt;params\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; /rostopic_18957_1673097448137 \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; /rostopic_18957_1673097448137/get_loggers \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; rosrpc://166.104.135.89:44311 \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; http://166.104.135.89:33575/ \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;/params\u0026gt; \u0026lt;/methodCall\u0026gt; \u0026lt;?xml version=\u0026#39;1.0\u0026#39; ?\u0026gt; \u0026lt;methodCall\u0026gt; \u0026lt;methodName\u0026gt; registerPublisher \u0026lt;/methodName\u0026gt; \u0026lt;params\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; /rostopic_18957_1673097448137 \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; /chatter \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; std_msgs/String \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; http://166.104.135.89:33575/ \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;/params\u0026gt; \u0026lt;/methodCall\u0026gt; Connection Headerë¥¼ ì‹¤ì œë¡œ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤. rostopic echoë¥¼ ì‹¤í–‰í•œ ë’¤ íŒ¨í‚·ì˜ data fieldë¥¼ ì‚´í´ë´…ë‹ˆë‹¤. $ rostopic echo /chatter data: \u0026#34;hello\u0026#34; --- ì‹¤ì œ /chatter topicì˜ ì •ë³´ë¥¼ ì¡°íšŒí•´ë³´ë©´ data í•„ë“œì˜ ê²°ê³¼ì™€ ì¼ì¹˜í•˜ëŠ” ê²ƒì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. $ rostopic info /chatter Type: std_msgs/String Publishers: * /rostopic_18957_1673097448137 (http://166.104.135.89:33575/) Subscribers: None /chatter Topic Subscriberë¥¼ ì‹¤í–‰í•˜ê³ , topic publisherì˜ í¬íŠ¸(í˜„ì¬ëŠ” 33575)ë¡œ ì˜¤ê°€ëŠ” íŒ¨í‚·ì„ ë¶„ì„í•´ë³´ê² ìŠµë‹ˆë‹¤. ip.addr == \u0026lt;my-ip-addr\u0026gt; || tcp.port == 33575 (/chatter publisherì˜ í¬íŠ¸ê°€ 33575ì˜€ìŒ) Topic echoë¥¼ í†µí•´ Subscriberë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. $ rostopic echo /chatter data: \u0026#34;hello\u0026#34; --- ìš°ì„ , ìƒì„±ëœ Subscriber ì •ë³´ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. $ rostopic info /chatter Type: std_msgs/String Publishers: * /rostopic_18957_1673097448137 (http://166.104.135.89:33575/) Subscribers: * /rostopic_21890_1673098174449 (http://166.104.135.89:36479/) íŒ¨í‚·ì„ ì‚´í´ë³´ë©´, Subscriberì— ëŒ€í•œ ì •ë³´ì™€ ë°ì´í„° íƒ€ì…ì— ëŒ€í•œ ì •ë³´ê°€ XML-RPCë¥¼ í†µí•´ ì˜¤ê³  ê°„ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Packet - 1 Packet - 2 \u0026lt;methodCall\u0026gt; \u0026lt;methodName\u0026gt; registerPublisher \u0026lt;/methodName\u0026gt; \u0026lt;params\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; /rostopic_21890_1673098174449 \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; /rosout \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; rosgraph_msgs/Log \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; http://166.104.135.89:36479/ \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;/params\u0026gt; \u0026lt;/methodCall\u0026gt; \u0026lt;methodResponse\u0026gt; \u0026lt;params\u0026gt; \u0026lt;param\u0026gt; \u0026lt;value\u0026gt; \u0026lt;array\u0026gt; \u0026lt;data\u0026gt; \u0026lt;value\u0026gt; \u0026lt;int\u0026gt; 1 \u0026lt;/int\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; current system state \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;value\u0026gt; \u0026lt;array\u0026gt; \u0026lt;data\u0026gt; \u0026lt;value\u0026gt; \u0026lt;array\u0026gt; \u0026lt;data\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; /rosout_agg \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; rosgraph_msgs/Log \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/data\u0026gt; \u0026lt;/array\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;value\u0026gt; \u0026lt;array\u0026gt; \u0026lt;data\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; /rosout \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; rosgraph_msgs/Log \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/data\u0026gt; \u0026lt;/array\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;value\u0026gt; \u0026lt;array\u0026gt; \u0026lt;data\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; /chatter \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;value\u0026gt; \u0026lt;string\u0026gt; std_msgs/String \u0026lt;/string\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/data\u0026gt; \u0026lt;/array\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/data\u0026gt; \u0026lt;/array\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/data\u0026gt; \u0026lt;/array\u0026gt; \u0026lt;/value\u0026gt; \u0026lt;/param\u0026gt; \u0026lt;/params\u0026gt; \u0026lt;/methodResponse\u0026gt; ë‹¤ìŒìœ¼ë¡œ, turtlesimì„ í†µí•´ topic message dataì˜ ë³€í™”ë¥¼ ì‚´í´ë³´ê³ ì í•©ë‹ˆë‹¤.\nturtlesimì„ ì‹¤í–‰ì‹œí‚¨ ë’¤ rosnode infoë¥¼ í†µí•´ ê°ì¢… ì •ë³´ë“¤ì„ ì¡°íšŒí•©ë‹ˆë‹¤. ì‚¬ìš©ì¤‘ì¸ í†µì‹  ë°©ë²• (TCPROS), Nodeì˜ í¬íŠ¸ ë²ˆí˜¸ ë“± ë‹¤ì–‘í•œ ì •ë³´ë“¤ì´ ì¡°íšŒë©ë‹ˆë‹¤. $ rosrun turtlesim turtlesim_node $ rosnode info /turtlesim -------------------------------------------------------------------------------- Node [/turtlesim] Publications: * /rosout [rosgraph_msgs/Log] * /turtle1/color_sensor [turtlesim/Color] * /turtle1/pose [turtlesim/Pose] Subscriptions: * /turtle1/cmd_vel [unknown type] Services: * /clear * /kill * /reset * /spawn * /turtle1/set_pen * /turtle1/teleport_absolute * /turtle1/teleport_relative * /turtlesim/get_loggers * /turtlesim/set_logger_level contacting node http://166.104.135.89:39875/ ... Pid: 29120 Connections: * topic: /rosout * to: /rosout * direction: outbound (33435 - 166.104.135.89:60856) [26] * transport: TCPROS rostopic infoë¥¼ í†µí•´ cmd_vel topicì— ëŒ€í•œ ì •ë³´ë¥¼ ì¡°íšŒí•˜ì˜€ìŠµë‹ˆë‹¤. ì‚¬ìš©ì¤‘ì¸ í¬íŠ¸ ë²ˆí˜¸ë¥¼ í™•ì¸í•œ ë’¤ wiresharkë¥¼ í†µí•´ í•´ë‹¹ í¬íŠ¸ë¡œ ì˜¤ê°€ëŠ” íŒ¨í‚·ì„ ë¶„ì„í•©ë‹ˆë‹¤. $ rostopic info /turtle1/cmd_vel Type: geometry_msgs/Twist Publishers: None Subscribers: * /turtlesim (http://166.104.135.89:39875/) wireshark í•„í„° ì¡°ê±´ë¬¸ ip.addr == \u0026lt;my-ip\u0026gt; || tcp.port == 39875 teleop keyë¥¼ í†µí•´ ê±°ë¶ì´ì˜ ì¡°ì¢…ì„ ì¤€ë¹„í•˜ê³ , í•´ë‹¹ ì‘ì—… ì¤‘ ë°œìƒí•œ íŒ¨í‚·ì„ ë¶„ì„í•©ë‹ˆë‹¤. rosrun turtlesim turtle_teleop_key XML-RPC í†µì‹ ë“¤ì´ ì´ë£¨ì–´ì§„ ë’¤ë¡œ, TCP í†µì‹ ì´ ì´ì–´ì§€ëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nTCP Data í•„ë“œì˜ ë‚´ìš©ì—ëŠ” ì•„ë˜ì™€ ê°™ì€ ë°ì´í„°ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\ncallerid=/teleop_turtle latching=0\u0026#39;md5sum=acffd30cd6b6de30f120938c17c593fbjmessage_definition=## ## Severity level constants ## byte DEBUG=1 #debug level byte INFO=2 #general level byte WARN=4 #warning level byte ERROR=8 #error level byte FATAL=16 #fatal/critical level ## ## Fields ## Header header byte level string name # name of the node string msg # message string file # file the message came from string function # function the message came from uint32 line # line the message came from string[] topics # topic names that the node publishes ================================================================================ MSG: std_msgs/Header # Standard metadata for higher-level stamped data types. # This is generally used to communicate timestamped data # in a particular coordinate frame. # # sequence ID: consecutively increasing ID uint32 seq #Two-integer timestamp that is expressed as: # * stamp.sec: seconds (stamp_secs) since epoch (in Python the variable is called \u0026#39;secs\u0026#39;) # * stamp.nsec: nanoseconds since stamp_secs (in Python the variable is called \u0026#39;nsecs\u0026#39;) # time-handling sugar is provided by the client library time stamp #Frame this data is associated with string frame_id topic=/rosouttype=rosgraph_msgs/Log callerid=/teleop_turtle latching=0\u0026#39;md5sum=9f195f881246fdfa2798d1d3eebca84armessage_definition=# This expresses velocity in free space broken into its linear and angular parts. Vector3 linear Vector3 angular ================================================================================ MSG: geometry_msgs/Vector3 # This represents a vector in free space. # It is only meant to represent a direction. Therefore, it does not # make sense to apply a translation to it (e.g., when applying a # generic rigid transformation to a Vector3, tf2 will only apply the # rotation). If you want your data to be translatable too, use the # geometry_msgs/Point message instead. float64 x float64 y float64 z topic=/turtle1/cmd_veltype=geometry_msgs/Twist teleop keyì—ì„œ ì•/ë’¤/CW/CCWì™€ ê°™ì´ ë‹¤ì–‘í•œ ì¡°ì¢… ì‹ í˜¸ë¥¼ publishí•´ë³´ê³  ì´ë•Œì˜ TCP Dataê°€ ì–´ë–»ê²Œ ë³€í™”í•˜ëŠ”ì§€ í™•ì¸í•´ë´…ì‹œë‹¤. â‡’ ê¸°ë³¸ì ìœ¼ë¡œ sequence / timestampê°€ ë³€í™”í•˜ë©°, ë¯¸ë¬˜í•˜ê²Œ dataê°€ ë‹¤ë¥¸ ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì´ë ‡ê²Œ topic messageëŠ” serializationì´ ë˜ì–´ ìˆìœ¼ë©°, ê³µì‹ ë¬¸ì„œí™” ê°™ì´ MD5 sumì„ ì‚¬ìš©í•©ë‹ˆë‹¤. image from : roswiki ROS URI ì„¤ì • ROSì—ëŠ” ë‹¤ì–‘í•œ í™˜ê²½ ë³€ìˆ˜ë“¤ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ì´ë“¤ ì¤‘ Masterê°€ ì‚¬ìš©í•  IPì™€ Portë¥¼ ì„¤ì •í•˜ëŠ” í™˜ê²½ ë³€ìˆ˜ê°€ ìˆìœ¼ë©°, ì´ëŠ” ì•„ë˜ì™€ ê°™ì´ ì¡°íšŒ ê°€ëŠ¥í•©ë‹ˆë‹¤. $ echo $ROS_MASTER_URI http://192.168.0.1:11311 ì„œë¡œ ë‹¤ë¥¸ ë””ë°”ì´ìŠ¤ì—ì„œ ë™ì‘í•˜ëŠ” ROS ì‹œìŠ¤í…œì¼ì§€ë¼ë„ ê°™ì€ MASTER URIë¥¼ ê°–ë„ë¡ í•˜ë©´ ì›ê²© í†µì‹ ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì›ê²© ì‹œê°í™”ì™€ ì›ê²© ì œì–´ë¥¼ ì£¼ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤.\nimage from : turtlebot3 git ROS_MASTER_URIë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nROS_MASTER_URI=http://master-ip-addr:master-ip-port ROS_IP=\u0026lt;í˜„ì¬ ë””ë°”ì´ìŠ¤ì˜ ip-addr\u0026gt; ROS_HOSTNAME=\u0026lt;í˜„ì¬ ë””ë°”ì´ìŠ¤ì˜ hostname\u0026gt; ROS_IPì™€ ROS_HOSTNAMEëŠ” ì„œë¡œ ì–‘ë¦½í•  ìˆ˜ ì—†ê³ , ë‘˜ ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nbashrcì˜ ìˆ˜ì •ì„ í•´ë‘ë©´, ìƒˆë¡œìš´ í„°ë¯¸ë„ì„ ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ë³€ê²½ëœ ë‚´ìš©ì´ ë°˜ì˜ë  ìˆ˜ ìˆì–´ í¸ë¦¬í•©ë‹ˆë‹¤. ê°•ì˜ ì´ˆë°˜, ì €ì˜ ì…‹ì—…ì„ ë”°ë¼ì˜¤ì…¨ë‹¤ë©´, ~/ros_menu/config.yamlì„ ìˆ˜ì •í•˜ì—¬ ì†ì‰½ê²Œ ë³€ê²½í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Config: menu_enable: true ros_option: menu default_ros_domain_id: 30 Menu: ROS 1 noetic: option_num: 1 ROS_version: 1 distro_name: noetic ros1_path: /opt/ros/noetic master_ip: # set if roscore isn\u0026#39;t on this computer cmds: # - source ${HOME}/catkin_ws/devel/setup.${shell} # - source_plugin openvino_bashrc ê°™ì€ ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ë‘ PCë¥¼ ì‚¬ìš©í•´ì„œ ì›ê²©ìœ¼ë¡œ ë¡œë´‡ì„ ì¡°ì¢…í•´ë³´ëŠ” ì‹¤ìŠµì„ ì§„í–‰í•´ë´…ì‹œë‹¤. # PC 1 - ROS Masterë¥¼ ì‹¤í–‰ì‹œí‚¤ê³  ë¡œë´‡ ë“±ì¥ì‹œí‚¤ê¸° roslaunch smb_gazebo smb_gazebo.launch # PC 2 - Master URI ë³€ê²½ í›„ ë¡œë´‡ ì¡°ì¢… rosrun teleop_twist_keyboard teleop_twist_keyboard.py image from : robots.nootrix ìë£Œì¶œì²˜\nhttps://www.tutorialspoint.com/xml-rpc/xml_rpc_fault.htm http://wiki.ros.org/ROS/Connection Header http://wiki.ros.org/ROS/TCPROS ë¡œë´‡ ìš´ì˜ì²´ì œ ê°•ì¢Œ : ROS ê°œë… ì •ë¦¬ (ì˜¤í”ˆì†ŒìŠ¤ ì†Œí”„íŠ¸ì›¨ì–´ \u0026amp; í•˜ë“œì›¨ì–´: ë¡œë´‡ ê¸°ìˆ  ê³µìœ  ì¹´í˜ (ì˜¤ë¡œì¹´)) http://wiki.ros.org/ROS/EnvironmentVariables#ROS_IP.2FROS_HOSTNAME "
},
{
	"uri": "/kr/advanced_contents_ros2/lecture3/",
	"title": "Lecture12 - SROS2",
	"tags": [],
	"description": "",
	"content": "sros2 DDSëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë³´ì•ˆì´ ì ìš©ë˜ì–´ ìˆì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤. ëŒ€ì‹ , ì•„ë˜ì™€ ê°™ì´ 5ê°€ì§€ì˜ ë³´ì•ˆ ê¸°ëŠ¥ì´ í‘œì¤€ ì •ì˜ì— í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì‚¬ìš©ìëŠ” ì´ë“¤ì„ Plugin í˜•íƒœë¡œ ì¶”ê°€í•˜ì—¬ ì‚¬ìš©í•˜ê²Œ ë˜ë©°, ì£¼ë¡œ Vendorë‹¨ì—ì„œ íŒ¨ì¹˜ í˜•íƒœë¡œ ì œê³µí•©ë‹ˆë‹¤.\nAuthentication: ê°™ì€ ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ê³ , íŠ¹ì • domainë‚´ì— ì¡´ì¬í•˜ëŠ” participant ì‚¬ì´ì˜ ì‹ ì›ì„ ê²€ì‚¬í•©ë‹ˆë‹¤. (x.509 ì¸ì¦ì„œì™€ íŠ¹ì • Public Key Infrastructure - PKIë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ) Access control: participantì˜ ë™ì‘, í˜¹ì€ ë¦¬ì†ŒìŠ¤ë¥¼ ì œí•œí•©ë‹ˆë‹¤. (apparmorë‚˜ cgroupì´ ì•„ë‹ˆë¼ íŠ¹ì • participantë¥¼ íŠ¹ì • DDS ë„ë©”ì¸ìœ¼ë¡œ ì œí•œí•˜ê±°ë‚˜, participantê°€ íŠ¹ì • DDS í•­ëª©ì„ ì½ê±°ë‚˜ ì“¸ ìˆ˜ ìˆë„ë¡ í•˜ëŠ” í˜•íƒœì…ë‹ˆë‹¤.) Cryptography: encryption/decryption/signing/hashing/digital signaturesì™€ ê°™ì€ ì•”í˜¸í™” ê´€ë ¨ ì‘ì—…ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤. (Authenticationê³¼ Access control pluginì—ì„œ ëª¨ë‘ ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê²Œ ë˜ê³ , DDSì˜ Topic Messageë¥¼ ì•”í˜¸í™”í•©ë‹ˆë‹¤.) Logging: DDSì˜ ë³´ì•ˆ ê´€ë ¨ ì´ë²¤íŠ¸ë¥¼ ë¡œê¹…í•©ë‹ˆë‹¤. Data tagging: dataì— ì¶”ê°€ labelì„ ë‹¬ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë°ì´í„°ì˜ ë³´ì•ˆ ì¸¡ë©´ ë¶„ë¥˜ë¥¼ í•  ìˆ˜ ìˆìœ¼ë©°, ë”ìš± ê°œì„ ëœ access controlì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì•„ë˜ 2ì¢…ë¥˜ëŠ” í•„ìˆ˜ í‘œì¤€ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ëŒ€ë¶€ë¶„ì˜ Vendorë“¤ì€ ì œê³µí•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.\nROS 2 Security Working Group (SWG)ì€ DDSì™€ ROS 2ì˜ ë³´ì•ˆê³¼ ê´€ë ¨ëœ ì˜¤í”ˆ ê·¸ë£¹ì…ë‹ˆë‹¤. í•´ë‹¹ ê·¸ë£¹ì—ì„œëŠ” DDSì˜ ë³´ì•ˆ ì·¨ì•½ì ì„ ë¶„ì„í•˜ì˜€ëŠ”ë°ìš”, ê·¸ ê²°ê³¼ ì´ 13ì¢…ë¥˜ì˜ ë³´ì•ˆ ì·¨ì•½ì ì„ ë°œê²¬í•˜ì˜€ìŠµë‹ˆë‹¤.\nì´ëŸ¬í•œ 13ê°€ì§€ ì·¨ì•½ì„±ì€ CVE(Common Vulnerabilities and Exposure)ë¡œ ë“±ë¡ë˜ì—ˆê³ , ì´ ì¤‘ 7ê°œëŠ” CVSS(Common Vulnerability Scoring System) v3ë¥¼ ê¸°ì¤€ìœ¼ë¡œ \u0026lsquo;High\u0026rsquo; ë“±ê¸‰ì„ íŒì •ë°›ì•˜ìœ¼ë©°, ë‚˜ë¨¸ì§€ 5ê°œ ë˜í•œ \u0026lsquo;Medium\u0026rsquo; ë“±ê¸‰ì„ íŒì •ë°›ì•˜ìŠµë‹ˆë‹¤.\nì´ëŸ¬í•œ ë¶„ì„ ê²°ê³¼ë¡œ US Cybersecurity and Infrastructure Security Agency (CISA)ëŠ” DDS ì‹œìŠ¤í…œì— ë³´ì•ˆ ê¶Œê³  ê²½ê³  ICS Advisory (ICSA-21-315-02)ë¥¼ ë‚´ë ¸ê³ , ê·¸ ê²°ê³¼ ê° DDS ë²¤ë”ë“¤ì€ í˜„ì¬ ë³´ì•ˆì— ê³„ì†í•´ì„œ ì‹ ê²½ì“°ê³  ìˆëŠ” ìƒí™©ì…ë‹ˆë‹¤.\n=\u0026gt; í•´ë‹¹ 13ì¢…ì˜ ë³´ì•ˆ ì·¨ì•½ì ì— ëŒ€í•´ì„œ ê°„ë‹¨íˆ ë¦¬ë·°ë¥¼ í•´ë³´ê² ìŠµë‹ˆë‹¤.\nNetwork-based vulnerabilities Network Layerì—ì„œ ê³ ì˜ì ì¸ RTPS packet ì „ì†¡ì„ í†µí•´ DoS ê³µê²©ì´ ê°€ëŠ¥í•œ ì  ë¶ˆì¶©ë¶„í•œ IP Check (ê¸°ë³¸ Domain Multicast IP ë“±) ê´€ë ¨ DDS í‘œì¤€ - CVE-2021-38425, CVE-2021-38429, CVE-2021-38487, CVE-2021-43547 ê´€ë ¨ ìœ„í—˜ ì½”ë“œ - Common Weakness CWE-406 Configuration-based vulnerabilities DDSì˜ ì…‹ì—… íŒŒì¼ì€ XML, JSON, YAMLê³¼ ê°™ì€ ë³´í¸ì ì¸ í˜•íƒœë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ ìœ„í—˜í•˜ë‹¤ê³  íŒë‹¨ ex1) DDS ì‹œìŠ¤í…œ ì¤‘ ë³´ì•ˆì´ ì·¨ì•½í•œ XML ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ íŒŒê³ ë“¤ì–´ ì•¡ì„¸ìŠ¤ ê¶Œí•œì„ íƒˆì·¨í•  ìˆ˜ ìˆìŒ ex2) íŠ¹ì • XML Pasrse ë‚´ ë¶€ì ì ˆí•œ ê°’ì„ ì „ë‹¬í•˜ì—¬ buffer overflowë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆìŒ â‡’ ì´ëŸ¬í•œ ì´ìœ ë¡œ í˜„ì¬ ëŒ€ë¶€ë¶„ì˜ DDS Vendorë“¤ì€ ë³´ì•ˆ Patchë¥¼ ë°°í¬í•œ ìƒí™©ì…ë‹ˆë‹¤.\nFast DDS https://github.com/eProsima/Fast-DDS Open DDS https://opendds.org/ rti DDS https://www.rti.com/products/dds-standard ì•„ë˜ ì²¨ë¶€ íŒŒì¼ì—ëŠ” Ubuntuë¥¼ ê´€ë¦¬í•˜ëŠ” Canonical ì¬ë‹¨ì—ì„œ ë°°í¬í•œ ROS ì‚¬ìš©ìë¥¼ ìœ„í•œ ë³´ì•ˆ ê°•í™” ì „ëµë“¤ì´ ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤. ë¼ì¦ˆë² ë¦¬íŒŒì´ì™€ TurtleBot ë¡œë´‡ì„ í†µí•´ ê°ì¢… ë³´ì•ˆ í…ŒìŠ¤íŠ¸ë¥¼ í•œ ê²°ê³¼ë¡œ ì–»ê²Œ ëœ ì¸ì‚¬ì´íŠ¸ê°€ ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤.\nDisabling USB Remove default users such as â€œubuntuâ€ SSH hardening Disabling Internet Protocol v6 Unattended upgrades Example Packages Securing ROS_WhitePapaer_10.03.20.pdf (325 ) SROS2 ROS 1ì˜ srosì™€ ë§ˆì°¬ê°€ì§€ë¡œ sros2ëŠ” ROS 2ì˜ ë³´ì•ˆì„ ìœ„í•œ ë„êµ¬ë“¤ì˜ ì§‘í•©ì…ë‹ˆë‹¤.\nCA ì¸ì¦ì„œ ìë™ ìƒì„±, x.509ì— ê¸°ë°˜í•œ keypair ìƒì„± keypairs, governance and permissions filesë“±ì´ ë‹´ê¸°ëŠ” keystore ìƒì„± DDS trafficì„ ì•”í˜¸í™”í•˜ëŠ” governance file ì œê³µ SROS2 ê³µì‹ ë ˆí¼ëŸ°ìŠ¤ì—ì„œ ì œê³µí•˜ëŠ” ê¸°ë³¸ ì˜ˆì‹œë“¤ì„ í•¨ê»˜ ì‹¤í–‰í•´ë³´ê³ , íŒ¨í‚· ë¶„ì„ë„ ì§„í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.\nsros2 setup sudo apt update \u0026amp;\u0026amp; sudo apt install libssl-dev sudo apt install ros-foxy-demo-nodes-cpp -y sudo apt install ros-foxy-demo-nodes-py -y mkdir ~/sros2_demo cd ~/sros2_demo ê°ì¢… ì¸ì¦ ê´€ë ¨ íŒŒì¼ë“¤ì´ ìœ„ì¹˜í•˜ê²Œ ë  keystoreë¥¼ ìƒì„±í•©ë‹ˆë‹¤. $ ros2 security create_keystore demo_keystore creating keystore: demo_keystore creating new CA key/cert pair creating governance file: demo_keystore/enclaves/governance.xml creating signed governance file: demo_keystore/enclaves/governance.p7s all done! enjoy your keystore in demo_keystore cheers! ìƒì„±ëœ keystore í´ë”ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í´ë” í˜•íƒœë¥¼ ì·¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. â”œâ”€â”€ enclaves â”‚Â â”œâ”€â”€ governance.p7s â”‚Â â””â”€â”€ governance.xml â”œâ”€â”€ private â”‚Â â”œâ”€â”€ ca.key.pem â”‚Â â”œâ”€â”€ identity_ca.key.pem -\u0026gt; ca.key.pem â”‚Â â””â”€â”€ permissions_ca.key.pem -\u0026gt; ca.key.pem â””â”€â”€ public â”œâ”€â”€ ca.cert.pem â”œâ”€â”€ identity_ca.cert.pem -\u0026gt; ca.cert.pem â””â”€â”€ permissions_ca.cert.pem -\u0026gt; ca.cert.pem ì•„ë˜ ì˜ˆì‹œì™€ ê°™ì´ ê°ì¢… ì¸ì¦í‚¤ê°€ ìƒì„±ë˜ëŠ” ê²ƒì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nca.key.pem -----BEGIN PRIVATE KEY----- MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgiXuds0wpQA1F7Cnv +533UuaPWKnZBYscqvHoyo00XOqhRANCAATI2CRyvxYccuxaWGTKDDe5b2dmdqH5 pBBbeHXXD1QRt7khzpX11InLr9jjpmaotgNIl6oap5d5IF1cIQUXuF1Y -----END PRIVATE KEY----- Authentication Example ì²«ë²ˆì§¸ ì˜ˆì‹œì—ì„œëŠ” ì¸ì¦ keypairë¥¼ ê°€ì§„ topic publisherì™€ subscriberë¥¼ ìƒì„±í•´ë³´ë ¤ í•©ë‹ˆë‹¤. ë”ë¶ˆì–´ wiresharkë¥¼ í†µí•´ ì•”í˜¸í™”ëœ topic messageë„ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.\nsros2 í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë‘ ì„¸íŠ¸ì˜ ì¸ì¦ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ros2 security create_key demo_keystore /talker_listener/talker ros2 security create_key demo_keystore /talker_listener/listener keystore í´ë” ë‚´ë¶€ì— ì¸ì¦ì„œì™€ permissionì´ë¼ëŠ” config íŒŒì¼ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. â”œâ”€â”€ enclaves â”‚Â â”œâ”€â”€ governance.p7s â”‚Â â”œâ”€â”€ governance.xml â”‚Â â””â”€â”€ talker_listener â”‚Â â”œâ”€â”€ listener â”‚Â â”‚Â â”œâ”€â”€ cert.pem â”‚Â â”‚Â â”œâ”€â”€ governance.p7s -\u0026gt; ../../governance.p7s â”‚Â â”‚Â â”œâ”€â”€ identity_ca.cert.pem -\u0026gt; ../../../public/identity_ca.cert.pem â”‚Â â”‚Â â”œâ”€â”€ key.pem â”‚Â â”‚Â â”œâ”€â”€ permissions_ca.cert.pem -\u0026gt; ../../../public/permissions_ca.cert.pem â”‚Â â”‚Â â”œâ”€â”€ permissions.p7s â”‚Â â”‚Â â””â”€â”€ permissions.xml â”‚Â â””â”€â”€ talker â”‚Â â”œâ”€â”€ cert.pem â”‚Â â”œâ”€â”€ governance.p7s -\u0026gt; ../../governance.p7s â”‚Â â”œâ”€â”€ identity_ca.cert.pem -\u0026gt; ../../../public/identity_ca.cert.pem â”‚Â â”œâ”€â”€ key.pem â”‚Â â”œâ”€â”€ permissions_ca.cert.pem -\u0026gt; ../../../public/permissions_ca.cert.pem â”‚Â â”œâ”€â”€ permissions.p7s â”‚Â â””â”€â”€ permissions.xml â”œâ”€â”€ private â”‚Â â”œâ”€â”€ ca.key.pem â”‚Â â”œâ”€â”€ identity_ca.key.pem -\u0026gt; ca.key.pem â”‚Â â””â”€â”€ permissions_ca.key.pem -\u0026gt; ca.key.pem â””â”€â”€ public â”œâ”€â”€ ca.cert.pem â”œâ”€â”€ identity_ca.cert.pem -\u0026gt; ca.cert.pem â””â”€â”€ permissions_ca.cert.pem -\u0026gt; ca.cert.pem ì˜ˆì œë¥¼ ì‹¤í–‰í•˜ê¸° ì „, ì¼ë°˜ì ì¸ Topic í†µì‹  ì‹œ String dataê°€ íŒ¨í‚·ì— ë…¸ì¶œë˜ëŠ” ëª¨ìŠµì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. wiresharkë¥¼ ì‹¤í–‰ì‹œí‚¨ ë’¤, ì»¤ë©˜ë“œ ë¼ì¸ì„ ì‹¤í–‰ì‹œí‚¤ê³  íŒ¨í‚·ì„ ìˆ˜ì§‘í•©ë‹ˆë‹¤.\n# Terminal 1 ros2 run demo_nodes_cpp talker # Terminal 2 ros2 run demo_nodes_cpp listener â‡’ RTPS Heartbeat íŒ¨í‚·ì„ ì‚´í´ë³´ë©´, Hello World ë¼ëŠ” ë°ì´í„°ê°€ ê³ ìŠ¤ë€íˆ ë…¸ì¶œë˜ì–´ ìˆëŠ” ëª¨ìŠµì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nì´ì œ ë³´ì•ˆ ì˜µì…˜ì„ ì ìš©í•´ë³´ê² ìœ¼ë©°, sros2ì—ì„œëŠ” ë‹¤ì–‘í•œ í™˜ê²½ ë³€ìˆ˜ë¥¼ í†µí•´ ë³´ì™„ ê´€ë ¨ ì˜µì…˜ì„ ë³€ê²½í•  ìˆ˜ ìˆë„ë¡ í•˜ê³  ìˆìŠµë‹ˆë‹¤. securityë¥¼ enable ì‹œì¼œë³´ê² ìŠµë‹ˆë‹¤. export ROS_SECURITY_KEYSTORE=~/sros2_demo/demo_keystore export ROS_SECURITY_ENABLE=true export ROS_SECURITY_STRATEGY=Enforce ë‹¤ìŒìœ¼ë¡œ, ì‚¬ìš©í•œ RMW DDSë¥¼ ë³€ê²½í•´ì¤ë‹ˆë‹¤. ì•ˆíƒ€ê¹ê²Œë„ CycloneDDSì˜ Debian PackageëŠ” ë³´ì•ˆ pluginì„ ì œê³µí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë³´ì•ˆ ì˜µì…˜ ì ìš© ì‹œ ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤. (ì†ŒìŠ¤ ì½”ë“œ ë¹Œë“œë¥¼ í•˜ë©´ í•´ê²°ë©ë‹ˆë‹¤.) $ ros2 run demo_nodes_cpp talker --ros-args --enclave /talker_listener/talker [INFO] [1674150011.742615669] [rcl]: Found security directory: /home/kimsooyoung/sros2_demo/demo_keystore/enclaves/talker_listener/talker 1674150011.756184 [19] talker: Could not load Authentication library: dds_security_auth: cannot open shared object file: No such file or directory 1674150011.756216 [19] talker: Could not load Authentication plugin. 1674150011.756221 [19] talker: Could not load security [ERROR] [1674150011.757250268] [rmw_cyclonedds_cpp]: rmw_create_node: failed to create DDS participant \u0026gt;\u0026gt;\u0026gt; [rcutils|error_handling.c:108] rcutils_set_error_state() This error state is being overwritten: ... ë”°ë¼ì„œ, ì´ë²ˆ ì˜ˆì‹œë¥¼ ìœ„í•´ Fast DDSë¡œ RMWë¥¼ ë³€ê²½í•˜ê² ìŠµë‹ˆë‹¤. export RMW_IMPLEMENTATION=rmw_fastrtps_cpp ì„œë¡œ ë‹¤ë¥¸ Vendor ë¼ë¦¬ëŠ” ë³´ì•ˆ pluginì´ í˜¸í™˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. (ë³´ì•ˆì€ í‘œì¤€ì´ ì•„ë‹™ë‹ˆë‹¤.)\nrmw_connextdds ( rit DDS )ëŠ” ìœ ë£Œ ì‚¬ìš© ì‹œ ë³´ì•ˆ ì˜µì…˜ì„ ì‚¬ìš© ê°€ëŠ¥í•˜ë©° 30ì¼ ë¬´ë£ŒíŒì„ ì‚¬ìš©í•˜ì…”ë„ ë©ë‹ˆë‹¤. â‡’ https://www.rti.com/free-trial\nì´ì œ pub-sub ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤. # Terminal 1 $ cd ~/sros2_demo/ $ export RMW_IMPLEMENTATION=rmw_fastrtps_cpp $ ros2 run demo_nodes_cpp talker --ros-args --enclave /talker_listener/talker [INFO] [1674150302.868609218] [rcl]: Found security directory: /home/kimsooyoung/sros2_demo/demo_keystore/enclaves/talker_listener/talker [INFO] [1674150303.901477001] [talker]: Publishing: \u0026#39;Hello World: 1\u0026#39; [INFO] [1674150304.901496377] [talker]: Publishing: \u0026#39;Hello World: 2\u0026#39; # Terminal 2 $ cd ~/sros2_demo/ $ export RMW_IMPLEMENTATION=rmw_fastrtps_cpp $ ros2 run demo_nodes_cpp listener ??? $ ros2 run demo_nodes_cpp listener --ros-args --enclave /talker_listener/listener ë³´ì•ˆ ì˜µì…˜ì„ ì ìš©í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— Publisherê°€ ë™ì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\ní˜„ ìƒí™©ì—ì„œ ë‹¤ì‹œê¸ˆ wiresharkë¥¼ ì‹¤í–‰í•˜ì—¬ íŒ¨í‚·ì„ ìˆ˜ì§‘í•´ë³´ê² ìŠµë‹ˆë‹¤. ì‚¬ì§„ê³¼ ê°™ì´ ì´ì œëŠ” RTPSê°€ ì•„ë‹Œ, TLSv1.2 í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ê°€ ì˜¤ê°€ê²Œ ë©ë‹ˆë‹¤. í•´ë‹¹ íŒ¨í‚·ì„ ì—´ì–´ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ì•”í˜¸í™”ê°€ ë˜ì–´ìˆìŠµë‹ˆë‹¤. ë”ë¶ˆì–´, RTPS í”„ë¡œí† ì½œ íŒ¨í‚·ì„ ì‚´í´ë³´ë©´, enclave ì˜µì…˜ì´ ì ìš©ëœ ê²ƒë„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë§Œì•½, ì„œë¡œ ë‹¤ë¥¸ ë¨¸ì‹ ë¼ë¦¬ í†µì‹ ì„ í•˜ê³  ì‹¶ë‹¤ë©´, demo_keystoreë¥¼ ë‘ ë¨¸ì‹  ëª¨ë‘ ë™ì¼í•˜ê²Œ ì†Œìœ í•˜ê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ì˜†ìë¦¬ì— ë‹¤ë¥¸ PCê°€ ìˆë‹¤ë©´ ì§ì ‘ ì‹¤ìŠµí•´ë³´ì„¸ìš”\nmkdir -p ~/sros2_demo/demo_keystore scp -r talker USERNAME@oldschool.local:~/sros2_demo/demo_keystore Access Control ì‹œìŠ¤í…œì˜ ë³´ì•ˆ ìˆ˜ì¤€ì„ ë†’ì´ê¸° ìœ„í•´ ê° ë…¸ë“œê°€ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì‘ì—…ì„ ì œí•œí•˜ëŠ” Access Controlì„ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ ì˜ˆì‹œì—ì„œëŠ” íŠ¹ì • topicë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë„ë¡ profileì„ ì§€ì •í•´ë³´ê² ìŠµë‹ˆë‹¤.\nROS 2ì—ì„œ ê¸°ë³¸ ì œê³µí•˜ëŠ” policy ì˜ˆì‹œë¥¼ ë³µì‚¬í•©ë‹ˆë‹¤. sudo apt update \u0026amp;\u0026amp; sudo apt install subversion cd ~/sros2_demo svn checkout https://github.com/ros2/sros2/trunk/sros2/test/policies cloneí•œ policyë¥¼ ë°”íƒ•ìœ¼ë¡œ nodeì˜ actionì„ ì œí•œí•˜ëŠ” descriptionì„ ìƒì„±í•©ë‹ˆë‹¤. cd ~/sros2_demo ros2 security create_permission demo_keystore /talker_listener/talker policies/sample.policy.xml ros2 security create_permission demo_keystore /talker_listener/listener policies/sample.policy.xml ìœ„ ì‘ì—…ì€ talker / listenerì˜ cert.pemì´ ìˆì–´ì•¼ ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nì¼ì „ ì˜ˆì‹œë¥¼ ë‹¤ì‹œ ì‹¤í–‰ì‹œì¼œë³´ê² ìŠµë‹ˆë‹¤. ì–¼í• ë³´ê¸°ì—ëŠ” ë‹¬ë¼ì§„ ì ì´ ì „í˜€ ì—†ì–´ ë³´ì…ë‹ˆë‹¤. # Terminal 1 ros2 run demo_nodes_cpp talker --ros-args -e /talker_listener/talker # Terminal 2 ros2 run demo_nodes_py listener --ros-args -e /talker_listener/listener í•˜ì§€ë§Œ, argumentë¥¼ í†µí•´ ì‚¬ìš©í•˜ëŠ” topicì„ ë‹¤ë¥¸ ê²ƒìœ¼ë¡œ ë°”ê¾¸ëŠ” ìˆœê°„, not found in allow ruleë¼ëŠ” ëª…ë ¹ì–´ì™€ í•¨ê»˜ Nodeê°€ ìƒì„±ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. # Terminal 1 ros2 run demo_nodes_cpp talker --ros-args -e /talker_listener/talker # Terminal 2 ros2 run demo_nodes_py listener --ros-args -r chatter:=not_chatter -e /talker_listener/listener [INFO] [1674152415.259964110] [rcl]: Found security directory: /home/kimsooyoung/sros2_demo/demo_keystore/enclaves/talker_listener/listener 2023-01-20 03:20:15.303 [SECURITY Error] rt/not_chatter topic not found in allow rule. (/tmp/binarydeb/ros-foxy-fastrtps-2.1.2/src/cpp/security/accesscontrol/Permissions.cpp:1271) -\u0026gt; Function check_create_datareader 2023-01-20 03:20:15.303 [SECURITY Error] Error checking creation of local reader bb.dd.19.9c.75.22.60.e0.55.c1.c0.3a|0.0.11.4 (rt/not_chatter topic not found in allow rule. (/tmp/binarydeb/ros-foxy-fastrtps-2.1.2/src/cpp/security/accesscontrol/Permissions.cpp:1271)) -\u0026gt; Function register_local_reader 2023-01-20 03:20:15.303 [PARTICIPANT Error] Problem creating associated Reader -\u0026gt; Function createSubscriber ì´ë²ˆ ì˜ˆì‹œì—ì„œ ì‚¬ìš©í•œ policy fileì…ë‹ˆë‹¤. - policies/sample.policy.xml topic publisherì™€ subscriberëŠ” ì˜¤ì§ /chatter topicë§Œì„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ access limit ê±¸ë¦¬ê²Œ ë©ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;policy version=\u0026#34;0.2.0\u0026#34; xmlns:xi=\u0026#34;http://www.w3.org/2001/XInclude\u0026#34;\u0026gt; \u0026lt;enclaves\u0026gt; \u0026lt;xi:include href=\u0026#34;talker_listener.policy.xml\u0026#34; xpointer=\u0026#34;xpointer(/policy/enclaves/*)\u0026#34;/\u0026gt; \u0026lt;xi:include href=\u0026#34;add_two_ints.policy.xml\u0026#34; xpointer=\u0026#34;xpointer(/policy/enclaves/*)\u0026#34;/\u0026gt; \u0026lt;xi:include href=\u0026#34;minimal_action.policy.xml\u0026#34; xpointer=\u0026#34;xpointer(/policy/enclaves/*)\u0026#34;/\u0026gt; \u0026lt;enclave path=\u0026#34;/sample_policy/admin\u0026#34;\u0026gt; \u0026lt;profiles\u0026gt; \u0026lt;profile ns=\u0026#34;/\u0026#34; node=\u0026#34;admin\u0026#34;\u0026gt; \u0026lt;xi:include href=\u0026#34;common/node.xml\u0026#34; xpointer=\u0026#34;xpointer(/profile/*)\u0026#34;/\u0026gt; \u0026lt;actions call=\u0026#34;ALLOW\u0026#34; execute=\u0026#34;ALLOW\u0026#34;\u0026gt; \u0026lt;action\u0026gt;fibonacci\u0026lt;/action\u0026gt; \u0026lt;/actions\u0026gt; \u0026lt;services reply=\u0026#34;ALLOW\u0026#34; request=\u0026#34;ALLOW\u0026#34;\u0026gt; \u0026lt;service\u0026gt;add_two_ints\u0026lt;/service\u0026gt; \u0026lt;/services\u0026gt; \u0026lt;topics publish=\u0026#34;ALLOW\u0026#34; subscribe=\u0026#34;ALLOW\u0026#34;\u0026gt; \u0026lt;topic\u0026gt;chatter\u0026lt;/topic\u0026gt; \u0026lt;/topics\u0026gt; \u0026lt;/profile\u0026gt; \u0026lt;/profiles\u0026gt; \u0026lt;/enclave\u0026gt; \u0026lt;/enclaves\u0026gt; \u0026lt;/policy\u0026gt; ì°¸ê³ ìë£Œ\nhttps://canonical.com/blog/security-vulnerabilities-on-the-data-distribution-service-dds https://github.com/ros2/sros2 https://canonical.com/blog/what-is-sros-2 "
},
{
	"uri": "/kr/advanced_contents_ros1/lecture3/",
	"title": "Lecture3 - SROS",
	"tags": [],
	"description": "",
	"content": " ì´ì „ ë°ëª¨ë¥¼ í†µí•´ ROSì˜ ë³´ì•ˆ ì·¨ì•½ì„±ì— ëŒ€í•´ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì·¨ì•½ì ë“¤ì„ ê°œì„ í•˜ê¸° ìœ„í•œ ë°©ë²•ìœ¼ë¡œ SROSì— ëŒ€í•´ ë°°ì›Œë³´ê² ìŠµë‹ˆë‹¤.\nsrosëŠ” ë§ˆì§€ë§‰ commit 2018ë…„ ì´í›„ ê°œë°œì´ ì‚¬ì‹¤ìƒ ë©ˆì¶˜ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. ROS ê°œë°œìë“¤ì´ ë³´ì•ˆì„ ìœ„í•´ ì–´ë– í•œ ë…¸ë ¥ì„ ë“¤ì˜€ëŠ”ì§€ ì •ë„ë§Œ ì‚´í´ë³´ê³ , ë°ëª¨ì™€ ìì„¸í•œ ë‚´ìš©ì€ ROS 2 ê°•ì˜ì—ì„œ ì´ì–´ë‚˜ê°€ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.\nUDPROSê°€ roscppë§Œ ì§€ì›í–ˆë˜ ê²ƒì²˜ëŸ¼, srosë„ rospyì™€ ì‚¬ìš©í•  ì‹œ ì œí•œì´ ìˆìŠµë‹ˆë‹¤. TCPROS UDPROS rospy X O roscpp O O rosjava O O srosëŠ” ROSì˜ client ë¼ì´ë¸ŒëŸ¬ë¦¬ ì†ŒìŠ¤ ì½”ë“œì— ë³´ì•ˆì„ ì ìš©í•˜ì—¬ ìƒˆë¡­ê²Œ ê°œë°œí•œ ROS Client Libraryì…ë‹ˆë‹¤. srosê°€ ì‚¬ìš©ë˜ëŠ” ì ˆì°¨ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. sros ë¹Œë“œ (ê¸°ì¡´ ROS ì½”ë“œê°€ ì•„ë‹Œ) sroskeyserver ì‹¤í–‰ sroscore ì‹¤í–‰ sroslaunchë¥¼ í†µí•´ ì‘ìš© í”„ë¡œê·¸ë¨ ì‹¤í–‰ srosì—ì„œ ì œê³µë˜ëŠ” ê¸°ëŠ¥ë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nì†Œì¼“ ì „ì†¡ì— ëŒ€í•œ Native TLS ì§€ì› ROS ë…¸ë“œë‹¨ì—ì„œ ìë™ ìƒì„±ëœ node key pairs ê´€ë¦¬ ë¦¬ëˆ…ìŠ¤ ì»¤ë„ ë‹¨ì—ì„œì˜ ë³´ì•ˆ ê°•í™” (AppArmor profile library) x.509 ì¸ì¦ì„œ ì‚¬ìš© ì§€ì› etcâ€¦ SROSëŠ” ROS ë‚´ì˜ ë³´ì•ˆ ê°•í™”ë¥¼ ìœ„í•œ ë°©ë²•ë“¤ì˜ ì§‘í•©ì„ ì§€ì¹­í•˜ë©°, í¬ê²Œ 3 ê³„ì¸µì˜ ë³´ì•ˆì„ ì œê³µí•©ë‹ˆë‹¤. ê° ê³„ì¸µë“¤ì— ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ëª…ì„ í•´ë³´ê² ìŠµë‹ˆë‹¤.\nTransport Security Access Control Process Profile Transport Security and ROS SROSëŠ” TLSë¥¼ í™œìš©í•˜ì—¬ ROS ê´€ë ¨ íŠ¸ë˜í”½ì„ ë³´í˜¸í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì•…ì˜ì ì¸ í–‰ìœ„ìì˜ redirection, ë©”ì‹œì§€ë¥¼ íƒˆì·¨í•˜ì—¬ ì¤‘ê°„ì— ìˆ˜ì •í•œë‹¤ê±°ë‚˜ Spoofingì„ ë§‰ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì‹œìŠ¤í…œ/ë¬¼ë¦¬ì  ìˆ˜ì¤€ ì•¡ì„¸ìŠ¤ë¥¼ í†µí•´ ë¡œë´‡ì´ ì†ìƒë˜ë”ë¼ë„ TLSì—ì„œ ì œê³µí•˜ëŠ” Forward Secrecy ë•ë¶„ì— ì´ì „ì— ê¸°ë¡ëœ íŠ¸ë˜í”½ë„ ë³´í˜¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nSROSê°€ TLSë¥¼ ì ìš©í•œ ë°©ë²•ì€, ë„¤íŠ¸ì›Œí¬ ìŠ¤íƒê³¼ ROS í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ì´ì— TLSë¥¼ ë¼ì›Œ ë„£ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ SROSëŠ” ëª¨ë“  Socket ìˆ˜ì¤€ì˜ ROS í†µì‹ ì„ Wrappingí•  ìˆ˜ ìˆìœ¼ë©°, ì‚¬ìš©ìëŠ” ê¸°ì¡´ ROS í”„ë¡œê·¸ë¨ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³ ë„ SROSì˜ ëª¨ë“  ì´ì ì„ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nimage from : hpbn.co SROS Keyserver KeyserverëŠ” ROS nodeì—ê²Œ ì¸ì¦ëœ keyë¥¼ ë¶„ë°°í•˜ê³  ê´€ë¦¬í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. KeyserverëŠ” ROSì™€ ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ë˜ë©°, ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ì‹¤í–‰ë˜ì–´ë„ ë¬´ê´€í•©ë‹ˆë‹¤. ë§Œì•½ ìì‹ ë§Œì˜ PKI ë°©ì‹ì„ ê°–ê³  ìˆë‹¤ë©´ ê¸°ë³¸ ì œê³µë˜ëŠ” keyserverë¥¼ ëŒ€ì²´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nSROSëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë³´ì•ˆì— ìµìˆ™ì¹˜ ì•Šê³ , TLS ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ëŠ” ê°œë…ì— ì„œíˆ¬ë¥¸ ì‚¬ìš©ìë¥¼ ëŒ€ìƒìœ¼ë¡œ ë§Œë“¤ì–´ì¡ŒìŠµë‹ˆë‹¤.\nKeyserverë¥¼ í†µí•œ Node configurationê³¼ ì‹¤í–‰ì€ ì•„ë˜ ë§í¬ë¥¼ ì°¸ê³ í•©ë‹ˆë‹¤. How is a Keyserver used in SROS\nRunning Keyserver SROSì˜ Nodeë“¤ì€ ì‹¤í–‰ ì „ Keyserverë¥¼ í†µí•œ key ìƒì„±ê³¼ CAë¥¼ í†µí•œ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤. ì´ ê³¼ì • ì—†ì´ ìƒì„±ëœ nodeë“¤ì€ rosmasterì™€ì˜ ì—°ê²°ì´ ê±°ë¶€ë©ë‹ˆë‹¤.\nkeyserver ì‹¤í–‰ $ sroskeyserver Starting an XML-RPC server to bootstrap SSL key distribution... Certificate generated: root Certificate generated: master sleeping until keyserver has generated the initial keyring... Horray, the keyserver is now open for business. SROSëŠ” ~/.ros í´ë” ë‚´ ìì‹ ë§Œì˜ configurationì„ êµ¬ì¶•í•©ë‹ˆë‹¤. ì´ ë‚´ë¶€ì—ëŠ” ì¸ì¦ì— í•„ìš”í•œ ê°ì¢… íŒŒì¼ë“¤ì´ ìœ„ì¹˜í•˜ê²Œ ë©ë‹ˆë‹¤. $ tree ~/.ros/sros /root/.ros/sros â”œâ”€â”€ config â”‚ â”œâ”€â”€ keyserver_config.yaml â”‚ â””â”€â”€ policy_config.yaml â””â”€â”€ keystore â”œâ”€â”€ ca â”‚ â”œâ”€â”€ master â”‚ â”‚ â”œâ”€â”€ master.cert â”‚ â”‚ â””â”€â”€ master.pem â”‚ â””â”€â”€ root â”‚ â”œâ”€â”€ root.cert â”‚ â””â”€â”€ root.pem â”œâ”€â”€ capath â”‚ â”œâ”€â”€ d11d170d.0 -\u0026gt; /root/.ros/sros/keystore/ca/root/root.cert â”‚ â””â”€â”€ f4ad5f10.0 -\u0026gt; /root/.ros/sros/keystore/ca/master/master.cert â””â”€â”€ utils â””â”€â”€ keyserver â”œâ”€â”€ keyserver.cert â””â”€â”€ keyserver.pem 8 directories, 10 files ì´ˆê¸° ì‹¤í–‰ ì‹œ ë¡œë”©ëœ configuration íŒŒì¼ì€ keyserverì— CAë¥¼ ë¡œë“œí•˜ë„ë¡ ì§€ì‹œí•˜ê³ , keystoreì— ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš° ë°©ë²•ì„ ì§€ì‹œí•©ë‹ˆë‹¤. rootì™€ ì¤‘ê°„ Master CAê°€ ì´ˆê¸°í™”ë˜ë©´ keyserverëŠ” ìì²´ transport ì¸ì¦ì„œì™€ keypair ë¡œë”©ì„ ìš”ì²­ë°›ìŠµë‹ˆë‹¤. keyserverëŠ” ìì²´ keyë¥¼ ì‚¬ìš©í•˜ì—¬ ìì‹ ì—ê²Œ ì—°ê²°ì„ ì‹œë„í•˜ê³ , keyserverì˜ API ëì´ ì˜¨ë¼ì¸ ìƒíƒœì´ë©° ì‘ë™ ì¤‘ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤. ì´ ì‘ì—…ì´ ëª¨ë‘ ì™„ë£Œë˜ë©´ keyserverê°€ ì—°ê²° Nodeì˜ ìš”ì²­ì„ ë°›ì„ ì¤€ë¹„ê°€ ë©ë‹ˆë‹¤. Access Control Access Controlì„ í†µí•´ ROSì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¦¬ì†ŒìŠ¤ì™€ Actionì„ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. SROS íŠœí† ë¦¬ì–¼ì—ì„œëŠ” ì•„ë˜ì™€ ê°™ì€ ROS APIë“¤ì— ëŒ€í•˜ì—¬ Access Control ì„¤ì •ì´ ê°€ëŠ¥í•˜ë‹¤ê³  ì´ì•¼ê¸°í•˜ê³  ìˆìŠµë‹ˆë‹¤.\ntopics publish subscribe parameters read write services advertise call ROS API master calls slave calls Access Controlì˜ ì‹¤ì œ êµ¬í˜„ ë°©ì‹ì— ìˆì–´ SROSì—ì„œ ì œì•ˆí•˜ëŠ” ë‘ê°€ì§€ ë°©ë²•ì„ ê°„ëµíˆ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤.\nCertificate Embedding SROSëŠ” Nodeê°„ ë³´ì•ˆ ë„¤íŠ¸ì›Œí¬ ì†Œì¼“ ì—°ê²°(TLS í•¸ë“œì…°ì´í¬) ì‹œ X.509 ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ê²€ì¦ëœ ë°©ì‹ì„ ì‚¬ìš©í•˜ê³  ê³„ì‚° íš¨ìœ¨ì´ ì¢‹ë‹¤ëŠ” ì¥ì ì´ ìˆì§€ë§Œ, ì´ëŸ¬í•œ ë°©ì‹ì€ Policy dataê°€ public ì´ê¸° ë•Œë¬¸ì— node, topic ì´ë¦„ì´ ë…¸ì¶œë  ì—¼ë ¤ê°€ ìˆìŠµë‹ˆë‹¤. Online Arbiter ì¤‘ì•™ ì§‘ì¤‘ì‹ìœ¼ë¡œ ë°ì´í„° í†µì‹ ì„ ì¤‘ì¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. global policyì— ëŒ€í•œ ì •ë³´ë¥¼ ì•Œê³  ìˆëŠ” ì¤‘ì•™ í†µì œ í”„ë¡œì„¸ìŠ¤ê°€ ìš”ì²­ëœ Nodeì™€ ì ‘ì´‰í•˜ê³  í—ˆìš©ì—¬ë¶€ë¥¼ íŒë‹¨í•©ë‹ˆë‹¤. ì´ëŠ” ROS Master Nodeê°€ ì‚¬ìš©í•˜ëŠ” ê¸°ì¡´ DNS ë°©ì‹ê³¼ ìœ ì‚¬í•˜ì§€ë§Œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ëŒ€ì‹  access control restrictionì„ ì‚¬ìš©í•œë‹¤ëŠ” ì°¨ì´ì ì´ ìˆìŠµë‹ˆë‹¤. Linux Security Modules AppArmor(ì• í”Œë¦¬ì¼€ì´ì…˜ Armor)ëŠ” í”„ë¡œê·¸ë¨ í”„ë¡œíŒŒì¼ë¡œ í”„ë¡œê·¸ë¨ì˜ ê¸°ëŠ¥ì„ ì œí•œí•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ë¦¬ëˆ…ìŠ¤ ì»¤ë„ ë³´ì•ˆ ëª¨ë“ˆì…ë‹ˆë‹¤. SROS íŠœí† ë¦¬ì–¼ì—ì„œëŠ” AppArmorì˜ ROS í˜¸í™˜ í”„ë¡œíŒŒì¼ ì˜ˆì‹œë¥¼ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.\nimage from : https://wiki.apparmor.net/ AppArmorë¥¼ í™œìš©í•˜ì—¬ ROS í”„ë¡œì„¸ìŠ¤ë¥¼ ê²©ë¦¬í•˜ê³  ë³´í˜¸í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ ì•…ì˜ì ì´ê±°ë‚˜ ì˜¤ì‘ë™í•˜ëŠ” Nodeê°€ Host ì‹œìŠ¤í…œê³¼ ë‹¤ë¥¸ Nodeì— ë¯¸ì¹  ìˆ˜ ìˆëŠ” ì˜í–¥ì„ ì œí•œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì˜ˆë¥¼ ë“¤ë©´, íŠ¹ì • IMU Nodeì— ëŒ€í•´ ì „ìš© Busë¥¼ ì˜ˆì•½í•˜ê³  ë…¸ë“œê°€ í•´ë‹¹ Serial Portë¥¼ ì‚¬ìš©í•˜ì§€ ëª»í•˜ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì™€ ê°™ì´ íŠ¹ì • ë…¸ë“œì— ëŒ€í•œ í”„ë¡œíŒŒì¼ì„ ì§€ì •í•˜ê³  ì˜ˆì•½ëœ ì¥ì¹˜ì—ë§Œ ì½ê³  ì“¸ ìˆ˜ ìˆëŠ” ê¶Œí•œì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nAppArmor ì„¤ì¹˜ sudo apt-get install apparmor apparmor-utils AppArmorë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ í”„ë¡œíŒŒì¼ configuration fileì„ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤. githubë¥¼ í†µí•´ ROSë¥¼ ìœ„í•œ í”„ë¡œíŒŒì¼ ì˜ˆì‹œë¥¼ ì œê³µí•˜ê³  ìˆìœ¼ë©°, ì´ë¥¼ AppArmorì˜ ì„¤ì • í´ë”ë¡œ ë³µì‚¬í•©ë‹ˆë‹¤. git clone https://github.com/ros-infrastructure/apparmor_profiles sudo cp --recursive apparmor_profiles/profiles /etc/apparmor.d ê° í”„ë¡œíŒŒì¼ë“¤ì— ëŒ€í•œ ì„¤ëª…ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. $ tree apparmor_profiles/profiles/ apparmor_profiles/profiles/ â”œâ”€â”€ ros # root profile library folder â”‚Â â”œâ”€â”€ base # base networking and signal abstractions for ROS â”‚Â â”œâ”€â”€ node # node abstractions executables needed for ros nodes â”‚Â â”œâ”€â”€ nodes # additional node specific abstractions â”‚Â â”‚Â â””â”€â”€ roslaunch # additional file and signal abstractions for roslaunch â”‚Â â””â”€â”€ python # node abstractions needed for python nodes â””â”€â”€ tunables # root tunables folder for AppArmor profile variables â”œâ”€â”€ ros # path abstractions executables needed for ros nodes â””â”€â”€ ros.d # additional distro specific abstractions â””â”€â”€ kinetic # path definition for default kinetic install í”„ë¡œíŒŒì¼ì„ ë³€ê²½í•˜ê²Œ ë˜ë©´, AppArmorë¥¼ ìƒˆë¡­ê²Œ ì¬ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” ì•„ë˜ í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. sudo service apparmor restart SROS Tutorialì—ì„œëŠ” Topicì„ ì‚¬ìš©í•˜ëŠ” talker - listenerì— ëŒ€í•œ í”„ë¡œíŒŒì¼ê³¼ ì‹¤í–‰ ì˜ˆì‹œë¥¼ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. Custom í”„ë¡œíŒŒì¼ì˜ ì‘ì„±ë²•ê³¼ ì‹¤í–‰ ë°©ë²•ì€ ë§í¬ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.\nCustomizing AppArmor Profiles for ROS ì°¸ê³ ìë£Œ\nhttp://wiki.ros.org/SROS/CommandLineTools http://wiki.ros.org/SROS/Concepts/PolicyDissemination http://wiki.ros.org/SROS/Tutorials/TrasportSecurityAndROS "
},
{
	"uri": "/kr/ros_and_gazebo/lecture1/",
	"title": "Lecture1 - Gazebo and Robot",
	"tags": [],
	"description": "",
	"content": "FusionBot ì†Œê°œ ì´ë²ˆ ì‹¤ìŠµì„ ìœ„í•´ ëª¨ë°”ì¼ ë¡œë´‡ì—ì„œ ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” íƒ€ì…ì˜ ë¡œë´‡, FusionBotì„ ì¤€ë¹„í•˜ì˜€ìŠµë‹ˆë‹¤. FusionBotì„ í†µí•´ ROSì—ì„œì˜ ë¡œë´‡ í‘œí˜„ ë°©ë²•ì„ ìµíŒ ë’¤, ì‹¤ì œ CAD íŒŒì¼ì—ì„œ Gazebo ìƒì˜ ë¡œë´‡ì„ êµ¬í˜„í•˜ëŠ” ì‹¤ìŠµì„ ì§„í–‰í•´ë´…ì‹œë‹¤.\nì‹¤ìŠµì„ ìœ„í•œ git repoë¥¼ cloneí•œ ë’¤ ì¢…ì†ì„±ë“¤ì„ ì„¤ì¹˜í•©ì‹œë‹¤. cd ~/ros2_ws/src git clone https://github.com/RB2023ROS/du2023-gz.git cd du2023-gz ./setup_scripts.sh URDFì™€ Robot Description ì¼ë°˜ì ìœ¼ë¡œ, ë¡œë´‡ì€ Linksì™€ Joints ë‘ê°€ì§€ ìš”ì†Œë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.\nLink : ë‹¨ë‹¨í•˜ê²Œ ê³ ì •ëœ ê°•ì²´(rigid-body)ì´ë©°, ì‚¬ëŒì˜ ê³¨ê²©ì— í•´ë‹¹í•©ë‹ˆë‹¤. Joint : link ì‚¬ì´ë¥¼ ê²°í•©í•´ì£¼ê³  ì´ë“¤ ì‚¬ì´ ìš´ë™ì„ ê²°ì •ì§“ìŠµë‹ˆë‹¤. ì‚¬ëŒì˜ ê´€ì ˆì— í•´ë‹¹í•©ë‹ˆë‹¤. ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ jointë“¤ì´ ì¡´ì¬í•˜ì§€ë§Œ, ì´ë¡ ì ìœ¼ë¡œ ì´ë“¤ì€ ê²°êµ­ prismatic + revolute jointì˜ ê²°í•©ìœ¼ë¡œ ì„¤ëª…ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nrevolute joint : íšŒì „ ìš´ë™ì„ ê°–ëŠ” joint prismatic joint : ìˆ˜í‰ ë³‘ì§„ ìš´ë™ì„ ê°–ëŠ” joint ê·¸ë¦¬ê³  ROSì—ì„œëŠ” ê°œë°œ ìƒ í¸ì˜ë¥¼ ìœ„í•´ í¬ê²Œ 6ê°€ì§€ì˜ jointë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ìš”.\nrevoluteÂ - ê°ë„ ì œí•œì„ ê°€ì§„ íšŒì „ continuousÂ - ê°ë„ ì œí•œì´ ì—†ëŠ” íšŒì „ prismaticÂ - ìˆ˜í‰ ìš´ë™ fixedÂ - ê³ ì • ê°•ì²´ floatingÂ - 6 DOF jointë¡œ gazeboì—ì„  ì‚¬ìš© ë¶ˆê°€ Planar â€“ í‰ë©´ì„ ë¯¸ë„ëŸ¬ì§€ëŠ” ìš´ë™ (ë¬¼ë¦¬ì  êµ¬ì„±ì´ ì‰½ì§€ ì•Šì•„ ê±°ì˜ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ) Linkì™€ Jointë¡œ ê²°í•©ëœ ë¡œë´‡ì„ ê²°êµ­ í…ìŠ¤íŠ¸ë¡œ í‘œí˜„í•  ìˆ˜ ìˆì§€ ì•Šê² ëƒëŠ” ê¸°ë³¸ ì „ì œ í•˜ì—, ë¡œë´‡ ê³µí•™ìë“¤ì€ URDF - Unified Robot Description Formatë¼ëŠ” í‘œì¤€ì„ ë§Œë“¤ê²Œ ë©ë‹ˆë‹¤. ì‹¤ì œë¡œ urdfë§Œ ìˆë‹¤ë©´ ì‹œë®¬ë ˆì´í„° ì¢…ë¥˜ì— ìƒê´€ ì—†ì´ ë™ì¼í•œ ë¡œë´‡ ì™¸í˜•ì„ ë“±ì¥ì‹œí‚¬ ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.\nimage from : Martin Androvich URDFëŠ” XML ë¬¸ë²•ì„ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë©° ROS 1ì˜ launch fileê³¼ ê°™ì´ ë‹¤ì–‘í•œ tagë¥¼ í†µí•´ ë¡œë´‡ì„ í‘œí˜„í•˜ê²Œ ë©ë‹ˆë‹¤. ì˜ˆì‹œë¥¼ í†µí•´ URDFì— ëŒ€í•œ ì´í•´ë„ë¥¼ ê°€ì ¸ë´…ì‹œë‹¤.\nURDFì˜ linkê°€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ì†ì„±ë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\ninertial : í•´ë‹¹ linkì˜ ì§ˆëŸ‰, ê´€ì„± ëª¨ë©˜íŠ¸ì™€ ê°™ì€ ë¬¼ì„±ì¹˜ë¥¼ í¬í•¨í•©ë‹ˆë‹¤. visual : ë¡œë´‡ì´ ê²‰ìœ¼ë¡œ ë³´ì—¬ì§€ëŠ” ì‹œê°ì ì¸ ìš”ì†Œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. STLê³¼ ê°™ì€ 3D ëª¨ë¸ë§ íŒŒì¼ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. collision : visualì€ ê²‰ìœ¼ë¡œ ë³´ì—¬ì§€ëŠ” ëª¨ìŠµì¼ ë¿, ì‹¤ì œ í•´ë‹¹ linkê°€ ìì¹˜í•˜ëŠ” ë¶€í”¼ëŠ” collisionì—ì„œ ì§€ì •ë©ë‹ˆë‹¤. Visualê³¼ collisionì„ ì¼ì¹˜ì‹œí‚¬ìˆ˜ë¡ ì¢‹ê¸° ë•Œë¬¸ì— 3D ëª¨ë¸ë§ íŒŒì¼ì„ ì‚¬ìš©í•˜ê¸°ë„ í•©ë‹ˆë‹¤. ì¢…ì¢… ê³„ì‚° ë‹¨ìˆœí™”ë¥¼ ìœ„í•´ ê°„ì†Œí™”ëœ ëª¨ë¸ì„ ì‚¬ìš©í•˜ê¸°ë„ í•©ë‹ˆë‹¤. \u0026lt;link name=\u0026#34;base_link\u0026#34;\u0026gt; \u0026lt;inertial\u0026gt; \u0026lt;origin xyz=\u0026#34;0 0 0\u0026#34; rpy=\u0026#34;0 0 0\u0026#34; /\u0026gt; \u0026lt;mass value=\u0026#34;8.3\u0026#34; /\u0026gt; \u0026lt;inertia ixx=\u0026#34;5.249466E+13\u0026#34; ixy=\u0026#34;-1.398065E+12\u0026#34; ixz=\u0026#34;-3.158592E+12\u0026#34; iyy=\u0026#34;5.786727E+13\u0026#34; iyz=\u0026#34;-5.159120E+11\u0026#34; izz=\u0026#34;3.114993E+13\u0026#34; /\u0026gt; \u0026lt;/inertial\u0026gt; \u0026lt;visual\u0026gt; \u0026lt;origin xyz=\u0026#34;0 0 0\u0026#34; rpy=\u0026#34;0 3.1415 3.1415\u0026#34; /\u0026gt; \u0026lt;geometry\u0026gt; \u0026lt;mesh filename=\u0026#34;package://neuronbot2_description/meshes/neuronbot2/base_link.stl\u0026#34; scale=\u0026#34;0.001 0.001 0.001\u0026#34; /\u0026gt; \u0026lt;/geometry\u0026gt; \u0026lt;material name=\u0026#34;black\u0026#34; /\u0026gt; \u0026lt;/visual\u0026gt; \u0026lt;collision\u0026gt; \u0026lt;origin xyz=\u0026#34;0 0 0.125\u0026#34; rpy=\u0026#34;0 0 0\u0026#34; /\u0026gt; \u0026lt;geometry\u0026gt; \u0026lt;box size=\u0026#34;0.25 0.25 0.25\u0026#34; /\u0026gt; \u0026lt;/geometry\u0026gt; \u0026lt;material name=\u0026#34;black\u0026#34; /\u0026gt; \u0026lt;/collision\u0026gt; \u0026lt;/link\u0026gt; URDFì˜ Jointê°€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ì†ì„±ë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nname : jointì˜ ì´ë¦„ì€ í›„ì— tf publish ì‹œ ê·¸ëŒ€ë¡œ ì‚¬ìš©ë˜ê¸° ë•Œë¬¸ì— í˜¼ë€ì„ ì•¼ê¸°í•˜ì§€ ì•Šë„ë¡ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤. type : ì˜ˆì‹œì—ì„œ ì‚¬ìš©ì¤‘ì¸ joint typeì€ fixedì™€ continuousë¡œ. fixedëŠ” ë‹¨ë‹¨íˆ ê²°í•©ëœ jointë¥¼, continuousëŠ” ë¬´í•œíˆ ëŒì•„ê°ˆ ìˆ˜ ìˆëŠ” jointë¥¼ ëœ»í•©ë‹ˆë‹¤. origin : parent linkì˜ ì›ì ì„ ê¸°ì¤€ìœ¼ë¡œ í•œ jointì˜ ìœ„ì¹˜ë¥¼ ì§€ì •í•˜ê²Œ ë˜ë©°, ì´ëŸ¬í•œ ìˆ˜ì¹˜ëŠ” ëª¨ë¸ë§ íŒŒì¼ì„ í†µí•´ ë¯¸ë¦¬ ì¡°ì‚¬ëœ ì´í›„ URDFë¡œ ë³€í™˜ë©ë‹ˆë‹¤. axis : íšŒì „í•˜ëŠ” jointì˜ ê²½ìš° ì–´ë– í•œ ì¶•ì„ ê¸°ì¤€ìœ¼ë¡œ íšŒì „ë˜ëŠ”ì§€ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤. parent, child : í•´ë‹¹ jointì˜ ì „, í›„ linkë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ê¸°íƒ€ ì†ì„±ë“¤ (limit, dynamics, calibration, mimic, safety_controller â€¦) : ê°ì¢… ì—­í•™ì ì¸ ì†ì„±ì„ í‘œí˜„í•©ë‹ˆë‹¤. \u0026lt;joint name=\u0026#34;r_wheel_joint\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34;/\u0026gt; \u0026lt;child link=\u0026#34;wheel_right_link\u0026#34;/\u0026gt; \u0026lt;origin xyz=\u0026#34;0.0 -0.09 0.0415\u0026#34; rpy=\u0026#34;0 0 0\u0026#34;/\u0026gt; \u0026lt;axis xyz=\u0026#34;0 1 0\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;joint name=\u0026#34;l_wheel_joint\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34;/\u0026gt; \u0026lt;child link=\u0026#34;wheel_left_link\u0026#34;/\u0026gt; \u0026lt;origin xyz=\u0026#34;0.0 0.109 0.0415\u0026#34; rpy=\u0026#34;0 0 0\u0026#34;/\u0026gt; \u0026lt;axis xyz=\u0026#34;0 1 0\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; urdfì˜ jointëŠ” ì ˆëŒ€ ì¢Œí‘œë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•˜ëŠ” extrinsic ì²´ê³„ë¥¼ ê°–ìŠµë‹ˆë‹¤.\nê¸°íƒ€ ì†ì„±ë“¤\norigin : í•´ë‹¹ ìš”ì†Œì˜ ì›ì ì„ ê¸°ì¤€ìœ¼ë¡œ, ìœ„ì¹˜ì™€ ë°©í–¥ì„ ê²°ì •í•©ë‹ˆë‹¤. 3ì¶• ì§êµ ì¢Œí‘œê³„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ x,y,z ì¶•ê³¼ roll pitch yaw íšŒì „ê°ì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. geometry : visualê³¼ collisionì˜ ê¸°í•˜í•™ì  ìš”ì†Œë¥¼ ê²°ì •í•˜ëŠ” íƒœê·¸ì…ë‹ˆë‹¤. urdfì—ì„œëŠ” box, cylinder, sphereì™€ ê°™ì´ ë‹¨ìˆœí•œ ë„í˜•ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. ë³„ë„ stl íŒŒì¼ì„ ì‚¬ìš©í•´ë„ ë˜ì§€ë§Œ ë¡œë´‡ì„ ë‹¨ìˆœí™”í•˜ê³  ì‹¶ì€ ê²½ìš° ì´ë¥¼ í†µí•´ ê°„ì†Œí™”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. material : color, textureë“±ì„ ì§€ì •í•  ìˆ˜ ìˆìœ¼ë©°, ì™¸í–¥ì ì¸ ë””ìì¸ì„ ìœ„í•œ ìš”ì†Œì…ë‹ˆë‹¤. Xacro URDF ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ëŒì´ ëª¨ë‘ ì‘ì„±í•˜ê¸°ëŠ” ë§¤ìš° ë¹„íš¨ìœ¨ì ì…ë‹ˆë‹¤. ë”ë¶ˆì–´, Gazeboì—ì„œë§Œ ì‚¬ìš©í•˜ëŠ” ì†ì„±ì„ ë”°ë¡œ ë¶„ë¦¬í•˜ê³  ì‹¶ì€ ê²½ìš°, íŒŒì¼ì„ ë‚˜ëˆ„ì–´ ê´€ë¦¬í•˜ê³  ì‹¶ì„ ê²ƒì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ìš•êµ¬ë¥¼ ì¶©ì¡±ì‹œí‚¤ê¸° ìœ„í•´ì„œ ROSëŠ” URDFì˜ ì‘ì„±ì„ ë³´ë‹¤ í¸í•˜ê²Œ í•´ì£¼ëŠ” XML Macro, Xacroë¥¼ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤.\níŠ¹íˆ xacroëŠ” ìˆ˜ì‹, ì¡°ê±´ì„ ì‚¬ìš© ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ë¡œë´‡ íŒŒì¼ì„ ë‹¤ë£¨ê¸° ë§¤ìš° ìš©ì´í•˜ë©°, íŠ¹ì • ìš”ì†Œë¥¼ ëª¨ë“ˆí™” í›„ ì¬ì‚¬ìš©í•˜ëŠ” ë“± íš¨ìœ¨ì ì¸ URDF ì‘ì„±ì´ ê°€ëŠ¥í•˜ë„ë¡ ë„ì™€ì¤ë‹ˆë‹¤.\n\u0026lt;xacro:macro name=\u0026#34;pr2_arm\u0026#34; params=\u0026#34;suffix parent reflect\u0026#34;\u0026gt; \u0026lt;pr2_upperarm suffix=\u0026#34;${suffix}\u0026#34; reflect=\u0026#34;${reflect}\u0026#34; parent=\u0026#34;${parent}\u0026#34; /\u0026gt; \u0026lt;pr2_forearm suffix=\u0026#34;${suffix}\u0026#34; reflect=\u0026#34;${reflect}\u0026#34; parent=\u0026#34;elbow_flex_${suffix}\u0026#34; /\u0026gt; \u0026lt;/xacro:macro\u0026gt; \u0026lt;xacro:pr2_arm suffix=\u0026#34;left\u0026#34; reflect=\u0026#34;1\u0026#34; parent=\u0026#34;torso\u0026#34; /\u0026gt; \u0026lt;xacro:pr2_arm suffix=\u0026#34;right\u0026#34; reflect=\u0026#34;-1\u0026#34; parent=\u0026#34;torso\u0026#34; /\u0026gt; ... \u0026lt;pr2_upperarm suffix=\u0026#34;left\u0026#34; reflect=\u0026#34;1\u0026#34; parent=\u0026#34;torso\u0026#34; /\u0026gt; \u0026lt;pr2_forearm suffix=\u0026#34;left\u0026#34; reflect=\u0026#34;1\u0026#34; parent=\u0026#34;elbow_flex_left\u0026#34; /\u0026gt; \u0026lt;pr2_upperarm suffix=\u0026#34;right\u0026#34; reflect=\u0026#34;-1\u0026#34; parent=\u0026#34;torso\u0026#34; /\u0026gt; \u0026lt;pr2_forearm suffix=\u0026#34;right\u0026#34; reflect=\u0026#34;-1\u0026#34; parent=\u0026#34;elbow_flex_right\u0026#34; /\u0026gt; CMakeë¥¼ í†µí•´ ì†ì‰½ê²Œ Xacro íŒŒì¼ë“¤ì„ URDFë¡œ ìë™ ë³€í™˜í•˜ëŠ” ì‘ì—…ì„ ì‹¤ìŠµí•´ë´…ì‹œë‹¤.\ní•´ë‹¹ íŒ¨í‚¤ì§€ ë¹Œë“œ colcon build --packages-select fusionbot_description source install/setup.bash íŒ¨í‚¤ì§€ ë¹Œë“œê°€ ë°œìƒí•˜ë©´ ëª¨ë“  ê´€ë ¨ íŒŒì¼ë“¤ì˜ symbolic linkê°€ workspaceì˜ install//share í´ë”ì— ìƒì„±ë©ë‹ˆë‹¤. CMakeëŠ” ì´ share í´ë” ë‚´ì— ìˆëŠ” symbolic linkë¥¼ ìœ„ì£¼ë¡œ ì‘ì—…í•˜ë¯€ë¡œ ìƒˆë¡œìš´ íŒŒì¼ì´ ìƒê²¼ë‹¤ë©´ ì£¼ê¸°ì ìœ¼ë¡œ colcon buildë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.\nCMakelists.txt ìˆ˜ì • - ì£¼ì„ë˜ì–´ ìˆëŠ” ë¼ì¸ì„ ì£¼ì„ í•´ì œí•©ë‹ˆë‹¤. find_package(xacro REQUIRED) # Xacro files file(GLOB xacro_files urdf/*.urdf.xacro) foreach(it ${xacro_files}) # remove .xacro extension string(REGEX MATCH \u0026#34;(.*)[.]xacro$\u0026#34; unused ${it}) set(output_filename ${CMAKE_MATCH_1}) # create a rule to generate ${output_filename} from {it} xacro_add_xacro_file(${it} ${output_filename}) list(APPEND urdf_files ${output_filename}) endforeach(it) add_custom_target(media_files ALL DEPENDS ${urdf_files}) íŒ¨í‚¤ì§€ë¥¼ ë‹¤ì‹œ ë¹Œë“œí•˜ë©´, ìë™ìœ¼ë¡œ ìƒì„±ëœ urdf íŒŒì¼ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. sudo apt install ros-foxy-xacro -y colcon build --packages-select fusionbot_description \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;!-- =================================================================================== --\u0026gt; \u0026lt;!-- | This document was autogenerated by xacro from /home/swimming/nav2_ws/src/nav2_rosdevday_2021/djhrd_ros2/fusionbot_description/urdf/fusionbot.urdf.xacro | --\u0026gt; \u0026lt;!-- | EDITING THIS FILE BY HAND IS NOT RECOMMENDED | --\u0026gt; \u0026lt;!-- =================================================================================== --\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34;\u0026gt; \u0026lt;material name=\u0026#34;silver\u0026#34;\u0026gt; \u0026lt;color rgba=\u0026#34;0.700 0.700 0.700 1.000\u0026#34;/\u0026gt; \u0026lt;/material\u0026gt; ... ê¸°ì¡´ fusionbot.urdfë¥¼ ì œê±°í•œ ë’¤ ìë™ ìƒì„±ë˜ëŠ” ëª¨ìŠµì„ í™•ì¸í•´ë³´ì„¸ìš”.\nCMakeëŠ” ì‚¬ìš©ìì˜ í¸ì˜ë¥¼ ìœ„í•´ ì¶”ê°€í•´ë‘” ê²ƒì¼ ë¿ í‚¤ì›Œë“œë¥¼ í†µí•´ Xacro â‡’ URDFë¡œì˜ ë³€í™˜ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤. í¸í•œ ë°©ë²•ì„ ì‚¬ìš©í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. (workspaceë¥¼ sourcing í•˜ì…”ì•¼ ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.)\nxacro fusionbot.urdf.xacro \u0026gt; fusionbot.urdf joint state publisherì™€ robot state publisher urdfë¥¼ ëª¨ë‘ ì‘ì„±í–ˆë‹¤ë©´, ì´ì œ ROSì—ê²Œ ì´ ì •ë³´ë¥¼ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ë‹´ë‹¹í•˜ëŠ” íŒ¨í‚¤ì§€ì¸ joint state publisherì™€ robot state publisherì— ëŒ€í•´ í•™ìŠµí•´ ë´…ì‹œë‹¤.\nê°œë… í•™ìŠµ ì´ì „, ì˜ˆì‹œë¥¼ ë¨¼ì € ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤. ros2 launch fusionbot_description description.launch.py WSL2 + Windows ì‹œìŠ¤í…œì—ì„œëŠ” ë¡œë´‡ ì™¸ê´€ì´ ë³´ì´ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nrviz ìƒì— ë¡œë´‡ì´ ë“±ì¥í–ˆìœ¼ë©°, ë¡œë´‡ê³¼ tfë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. joint state publisher guië¼ëŠ” ì‘ì€ ì°½ì´ ë“±ì¥í•˜ë©°, ì´ ì•ˆì— ìœ„ì¹˜í•œ ì‘ì€ ìŠ¬ë¼ì´ë“œë°”ë¥¼ ì›€ì§ì´ë©´ ë¡œë´‡ì˜ ë°”í€´ì— ë°•íŒ tfë„ íšŒì „í•©ë‹ˆë‹¤. ROSì—ì„œëŠ” ì´ë ‡ê²Œ tfì™€ descriptionì˜ í˜•íƒœë¡œ ë¡œë´‡ì„ ì¸ì§€í•©ë‹ˆë‹¤. joint state publisher joint state publisherëŠ” ë¡œë´‡ ë‚´ ì¡´ì¬í•˜ëŠ” ë‹¤ì–‘í•œ joint ê°’ë“¤ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°±ì‹ í•˜ì—¬ /joint_statesë¼ëŠ” topicìœ¼ë¡œ publish í•©ë‹ˆë‹¤. í•´ë‹¹ topicì€ sensor_msgs/msg/JointState msgë¥¼ ì‚¬ìš©í•˜ë©°, ê° jointë“¤ì˜ ì´ë¦„, í˜„ì¬ ìœ„ì¹˜, ì†ë„ì™€ í˜ì„ ë°°ì—´ í˜•íƒœë¡œ ë‹´ê²Œ ë©ë‹ˆë‹¤.\n$ ros2 interface show sensor_msgs/msg/JointState # This is a message that holds data to describe the state of a set of torque controlled joints. # # # The state of each joint (revolute or prismatic) is defined by: # * the position of the joint (rad or m), # * the velocity of the joint (rad/s or m/s) and # * the effort that is applied in the joint (Nm or N). # ... std_msgs/Header header string[] name float64[] position float64[] velocity float64[] effort joint state publisher gui ì˜ˆì œ ì‹¤í–‰ ì‹œ ë“±ì¥í–ˆë˜ ì¡°ê·¸ë§Œ ì°½ì€ joint_state_publisher_guië¼ê³  ë¶ˆë¦¬ë©°, ë¡œë´‡ ë‚´ ì¡°ì‘ì´ ê°€ëŠ¥í•œ jointë“¤ì„ ê°„ë‹¨í•˜ê²Œ ì œì–´í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ì‘ì€ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ êµ¬ì„±í•œ URDFì˜ ë°©í–¥ì€ ì•Œë§ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ì§€, ì›ì ì€ ì˜ ë§ëŠ”ì§€ ë“±ì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.\ntopic echoë¥¼ ì‹¤í–‰ì‹œí‚¨ ë’¤, joint_state_publisher_guië¥¼ ì¡°ì‘í•´ë³´ë©´ì„œ ë³€í™”ë¥¼ ì‚´í´ë´…ì‹œë‹¤. $ ros2 topic echo /joint_states header: stamp: frame_id: \u0026#39;\u0026#39; name: - right_wheel_joint - left_wheel_joint position: - 1.918884792812646 - -1.409318464400381 velocity: [] effort: [] --- â‡’ right_wheel_jointëŠ” ìœ„ì¹˜ 1.9188ë¥¼ ê°–ê³  ìˆìœ¼ë©°, ì†ë„ì™€ í˜ì€ ì œì–´ë˜ê³  ìˆì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤.\nâ‡’ left_wheel_jointëŠ” ìœ„ì¹˜ -1.4093ë¥¼ ê°–ê³  ìˆìœ¼ë©°, ì†ë„ì™€ í˜ì€ ì œì–´ë˜ê³  ìˆì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤.\nì´ë ‡ê²Œ joint state publisherëŠ” í˜„ì¬ ë¡œë´‡ì´ ê°€ì§„ ì›€ì§ì¼ ìˆ˜ ìˆëŠ” ëª¨ë“  jointë“¤ì„ ì˜ˆì˜ì£¼ì‹œí•˜ê³  topicìœ¼ë¡œ publishí•˜ëŠ” nodeì…ë‹ˆë‹¤.\nrobot state publisher URDFì˜ jointëŠ” joint state publisherê°€ ë‹´ë‹¹í–ˆë‹¤ë©´, robot state publisherëŠ” ëª¨ë“  linkì™€ joint ê°’ì„ ì§€ì†ì ìœ¼ë¡œ Subscribeí•˜ì—¬ ì „ì²´ ë¡œë´‡ì˜ êµ¬ì¡°ë¥¼ tf í˜•ì‹ìœ¼ë¡œ publishí•©ë‹ˆë‹¤. ë”ë¶ˆì–´, robot state publisherê°€ publishí•˜ëŠ” /robot_description topicì€ rvizì—ì„œ ë¡œë´‡ì˜ ì‹œê°í™”ë¥¼ ìœ„í•´ ì‚¬ìš©ë˜ê³ , gazeboì—ì„œ ë¡œë´‡ì„ ë“±ì¥ì‹œí‚¤ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.\nì°¸ê³ ë¡œ, ROS 2ì—ì„œ tf treeë¥¼ ì–»ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ì™€ ê°™ì€ ì»¤ë©˜ë“œ ë¼ì¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. (ëª‡ ì´ˆê°„ tf listenì„ ê±°ì¹œ ë’¤ pdf í˜•íƒœë¡œ tf treeë¥¼ ë„ì¶œí•´ì¤ë‹ˆë‹¤.)\n$ ros2 run tf2_tools view_frames.py ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ë‚´ìš©ë“¤ì„ ë³µìŠµí•´ë´…ì‹œë‹¤.\në¡œë´‡ ëª¨ë¸ì´ ROSì—ê²Œ ì „ë‹¬ë˜ê¸° ìœ„í•´ urdfë¥¼ ì‚¬ìš©í–ˆê³ , ì´ëŠ” linkì™€ jointë¡œ ì´ë£¨ì–´ì¡ŒìŠµë‹ˆë‹¤. ë¡œë´‡ ë‚´ jointëŠ” joint state publisherê°€ ë‹´ë‹¹í•˜ë©°, robot state publisherëŠ” joint stateì™€ í•¨ê»˜ linkë¥¼ ê²°í•©í•˜ì—¬ ìµœì¢… tfë¥¼ broadcastí–ˆìŠµë‹ˆë‹¤. ê° Nodeê°„ ì—°ê²°ì„ rqt_graphë¥¼ í†µí•´ ì‚´í´ë³´ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.\nLaunch file ë¶„ì„ description.launch.pyë¥¼ ë¶„ì„í•´ë´…ì‹œë‹¤.\nrviz descriptionì„ ìœ„í•´ í•„ìš”í•œ NodeëŠ” ì´ 3ê°€ì§€ì…ë‹ˆë‹¤. (í˜„ì¬ëŠ” joint_state_publish_guiê°€ ì‚¬ìš©ë˜ê³  ìˆì§€ë§Œ ì´í›„ì—ëŠ” ì¼ë°˜ joint_state_publisherê°€ ì‚¬ìš©ë©ë‹ˆë‹¤.) return LaunchDescription([ joint_state_publisher_gui, robot_state_publisher, TimerAction( period=5.0, actions=[rviz] ), ]) joint_state_publisher_guiëŠ” ì¼ë°˜ì ì¸ Node ì‹¤í–‰ ì˜µì…˜ê³¼ ë™ì¼í•©ë‹ˆë‹¤. # Joint State Publisher joint_state_publisher_gui = Node( package=\u0026#39;joint_state_publisher_gui\u0026#39;, executable=\u0026#39;joint_state_publisher_gui\u0026#39;, name=\u0026#39;joint_state_publisher_gui\u0026#39; ) robot_state_publisherëŠ” urdfë¥¼ argumentë¡œ ìš”êµ¬í•©ë‹ˆë‹¤. urdf íŒŒì¼ì˜ ìœ„ì¹˜ëŠ” os.path.joinë¥¼ í†µí•´ ì „ë‹¬í•˜ê³  ìˆìœ¼ë©°, ì—¬ê¸°ì„œì˜ pathëŠ” src í´ë”ê°€ ì•„ë‹Œ install í´ë”ì˜ symbolic linkë¥¼ ì°¸ì¡°í•œë‹¤ëŠ” ê²ƒì— ì£¼ì˜í•©ë‹ˆë‹¤. # Prepare Robot State Publisher Params urdf_file = os.path.join(description_pkg_path, \u0026#39;urdf\u0026#39;, \u0026#39;fusionbot_description.urdf\u0026#39;) # Robot State Publisher robot_state_publisher = Node( package=\u0026#39;robot_state_publisher\u0026#39;, executable=\u0026#39;robot_state_publisher\u0026#39;, name=\u0026#39;robot_state_publisher\u0026#39;, output=\u0026#39;screen\u0026#39;, parameters=[{\u0026#39;use_sim_time\u0026#39;: True}], arguments=[urdf_file], ) ë§ˆì§€ë§‰ìœ¼ë¡œ rvizë¥¼ 3ì´ˆ í›„ ì‹¤í–‰ë˜ë„ë¡ í•©ë‹ˆë‹¤. ì´ëŠ” launch.actionsì—ì„œ ì œê³µí•˜ëŠ” TimerAction ê¸°ëŠ¥ì„ ì‚¬ìš©í•œ ê²ƒìœ¼ë¡œ, urdfì˜ ë‚´ìš©ì´ ë„ˆë¬´ ë§ìœ¼ë©´ joint stateì™€ robot stateë¥¼ ë¡œë“œí•˜ëŠ”ë° ì‹œê°„ì´ ì†Œìš”ë˜ê¸° ë•Œë¬¸ì— ì ë‹¹í•œ Delayë¥¼ ê°–ë„ë¡ í•œ ê²ƒì…ë‹ˆë‹¤. # Launch RViz rviz_config_file = os.path.join(description_pkg_path, \u0026#39;rviz\u0026#39;, \u0026#39;description.rvizâ€™) rviz = Node( package=\u0026#39;rviz2\u0026#39;, executable=\u0026#39;rviz2\u0026#39;, name=\u0026#39;rviz2\u0026#39;, output=\u0026#39;screen\u0026#39;, arguments=[\u0026#39;-d\u0026#39;, rviz_config_file] ) ... TimerAction( period=3.0, actions=[rviz] ), Make a Mobile Robot ì§€ê¸ˆê¹Œì§€ì˜ ì˜ˆì‹œë“¤ì€ ëª¨ë‘ ì œê°€ ë¯¸ë¦¬ ì‘ì„±í•´ë‘” xacroë¥¼ ì‚¬ìš©í•˜ì˜€ëŠ”ë°ìš”, ê·¸ëŸ¼ ì´ëŸ° xacroì™€ urdfëŠ” ì–´ë–»ê²Œ ë§Œë“¤ ìˆ˜ ìˆëŠ”ì§€, ì„¤ê³„ëœ ëª¨ë°”ì¼ ë¡œë´‡ì„ ë°”íƒ•ìœ¼ë¡œ Gazebo, ROSì™€ ì—°ë™í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.\në¡œë´‡ì„ ì„¤ê³„í•˜ê¸° ìœ„í•œ ìˆ˜ë§ì€ ì„¤ê³„ í”„ë¡œê·¸ë¨ë“¤ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ì´ë²ˆ ì˜ˆì‹œëŠ” ë¬´ë£Œ ì‚¬ìš©ì´ ê°€ëŠ¥í•œ Autodeskì˜ Fusion 360ì„ ì‚¬ìš©í•˜ì˜€ìœ¼ë©°, Fusion 360ì— Third Party ADD_INì„ ì¶”ê°€í•˜ì—¬ URDFë¥¼ ìƒì„±í•˜ê³ , ìƒì„±ëœ URDFíŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ Rviz ë° Gazeboì™€ ì—°ë™í•˜ê³ ì í•©ë‹ˆë‹¤.\nì‚¬ìš©í•œ Add In ë§í¬ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. â‡’ https://github.com/syuntoku14/fusion2urdf\në§í¬ë¥¼ í†µí•´ FusionBotì˜ ì™¸í˜•ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. â‡’ https://a360.co/3gdOajr\nì™„ì„±ëœ ë¡œë´‡ìœ¼ë¡œë¶€í„° URDFë¥¼ ì¶”ì¶œí•˜ë©´ ì²¨ë¶€íŒŒì¼ê³¼ ê°™ì€ íŒ¨í‚¤ì§€ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nğŸ“‚ fusionbot_description.zip\nROS 1ì˜ ê²½ìš° ë°”ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ì§€ë§Œ, ROS 2ëŠ” ëª‡ê°€ì§€ ì¶”ê°€ ì„¤ì •ë“¤ì´ í•„ìš”í•©ë‹ˆë‹¤. ë”°ë¼ì„œ, ì´ë²ˆ ì˜ˆì‹œì—ì„œëŠ” ROS 2 í™˜ê²½ì„ ê¸°ì¤€ìœ¼ë¡œ ì„¤ì •ì„ ë³€ê²½í•´ë³´ë©´ì„œ URDFì™€ ROS ì—°ë™ì— ëŒ€í•´ í•™ìŠµí•´ë³´ê² ìŠµë‹ˆë‹¤.\nì‹¤ìŠµì„ ìœ„í•´ ìƒˆë¡œìš´ ROS 2 íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. (ament_cmake ì´ìš©) $ ros2 pkg create --build-type ament_cmake \u0026lt;package_name\u0026gt; ros2 pkg create --build-type ament_cmake temp_description ê²°êµ­ ìš°ë¦¬ê°€ ë§Œë“¤ê³ ì í•˜ëŠ” íŒ¨í‚¤ì§€ëŠ” ì œê°€ ë°°í¬í•œ fusionbot_descriptionê³¼ ë™ì¼í•©ë‹ˆë‹¤. ì˜ˆì œë¥¼ ë”°ë¼ì˜¤ì‹œë©´ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œëŠ” fusionbot_descriptionì„ ì°¸ê³ í•˜ì—¬ í•´ê²°í•˜ì‹œë©´ ë©ë‹ˆë‹¤.\nìƒˆë¡­ê²Œ ìƒì„±í•œ ROS 2 íŒ¨í‚¤ì§€ì— fusionbot_descriptionì˜ meshesì™€ urdf í´ë”ë¥¼ ì´ë™ì‹œí‚µë‹ˆë‹¤. (meshesì—ëŠ” í‘œë©´ ì§ˆê° ë“± ì‹œê°í™” ê´€ë ¨ íŒŒì¼ë“¤ì´ ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤.) urdf í´ë” ë‚´ë¶€ì˜ íŒŒì¼ë“¤ì„ ìˆ˜ì •í•´ë´…ì‹œë‹¤.\nfusionbot.gazeboì„ ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•©ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34; \u0026gt; \u0026lt;xacro:property name=\u0026#34;body_color\u0026#34; value=\u0026#34;Gazebo/Silver\u0026#34; /\u0026gt; \u0026lt;gazebo\u0026gt; \u0026lt;plugin filename=\u0026#34;libgazebo_ros_control.so\u0026#34; name=\u0026#34;control\u0026#34;/\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;gazebo reference=\u0026#34;base_link\u0026#34;\u0026gt; \u0026lt;material\u0026gt;${body_color}\u0026lt;/material\u0026gt; \u0026lt;mu1\u0026gt;0.1\u0026lt;/mu1\u0026gt; \u0026lt;mu2\u0026gt;0.1\u0026lt;/mu2\u0026gt; \u0026lt;selfCollide\u0026gt;true\u0026lt;/selfCollide\u0026gt; \u0026lt;gravity\u0026gt;true\u0026lt;/gravity\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;gazebo reference=\u0026#34;lidar_1\u0026#34;\u0026gt; \u0026lt;material\u0026gt;${body_color}\u0026lt;/material\u0026gt; \u0026lt;mu1\u0026gt;0.2\u0026lt;/mu1\u0026gt; \u0026lt;mu2\u0026gt;0.2\u0026lt;/mu2\u0026gt; \u0026lt;selfCollide\u0026gt;true\u0026lt;/selfCollide\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;gazebo reference=\u0026#34;right_wheel_1\u0026#34;\u0026gt; \u0026lt;material\u0026gt;${body_color}\u0026lt;/material\u0026gt; \u0026lt;mu1\u0026gt;100000.0\u0026lt;/mu1\u0026gt; \u0026lt;mu2\u0026gt;100000.0\u0026lt;/mu2\u0026gt; \u0026lt;selfCollide\u0026gt;true\u0026lt;/selfCollide\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;gazebo reference=\u0026#34;left_wheel_1\u0026#34;\u0026gt; \u0026lt;material\u0026gt;${body_color}\u0026lt;/material\u0026gt; \u0026lt;mu1\u0026gt;1500\u0026lt;/mu1\u0026gt; \u0026lt;mu2\u0026gt;1500\u0026lt;/mu2\u0026gt; \u0026lt;selfCollide\u0026gt;true\u0026lt;/selfCollide\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;/robot\u0026gt; libgazebo_ros_controlëŠ” ros controlì˜ gazebo ë²„ì „ì…ë‹ˆë‹¤. ros control interfaceë¥¼ í†µí•´ gazebo ìƒì˜ ë¡œë´‡ê³¼ ì‹¤ì œ ë¡œë´‡ì˜ ì›€ì§ì„ì„ ë³„ë„ì˜ ì¶”ê°€ ê°œë°œ ì—†ì´ í¸ë¦¬í•˜ê²Œ Swap ê°€ëŠ¥í•©ë‹ˆë‹¤.\nmu1, mu2ëŠ” ë§ˆì°°ë ¥ê³¼ ê´€ë ¨ëœ ë³€ìˆ˜ë¡œ ìì„¸í•œ ì„¤ëª…ì€ ì•„ë˜ ë§í¬ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.\n=\u0026gt; https://answers.gazebosim.org//question/13083/explain-gazebo-friction-coefficients-mu-and-mu2/\në‹¤ìŒìœ¼ë¡œ, ì•„ë˜ ì‘ì—…ë“¤ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.\n=\u0026gt; fusionbot.transë¥¼ ì‚­ì œí•©ë‹ˆë‹¤. í•´ë‹¹ íŒŒì¼ì€ ROS 1ì—ì„œë§Œ í•„ìš”í•œ íŒŒì¼ì…ë‹ˆë‹¤. ì´ëŠ” ros_controlì„ gazeboì—ì„œ ì‹¤í–‰í•  ë•Œ í•„ìš”í•œ íŒŒì¼ë¡œ ROS 1 ì‹œê°„ì— í•¨ê»˜ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\n=\u0026gt; fusionbot.xacroë¥¼ fusionbot.urdf.xacroìœ¼ë¡œ ì´ë¦„ì„ ë³€ê²½í•©ë‹ˆë‹¤. (ì´í›„ ìë™ URDF ìƒì„±ì„ ìœ„í•¨ì…ë‹ˆë‹¤.)\n=\u0026gt; ë³€ê²½í•œ fusionbot.urdf.xacroë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.\nì´ì œ, fusionbot.urdf.xacroì—ì„œ fusionbot.trans ë¶€ë¶„ì„ ì‚­ì œí•©ë‹ˆë‹¤. \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/materials.xacro\u0026#34; /\u0026gt; \u0026lt;!-- \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/fusionbot.trans\u0026#34; /\u0026gt; --\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/fusionbot.gazebo\u0026#34; /\u0026gt; È¸ï¿½ï¿½7 ê³¼ ê°™ì´ ì˜ëª» ì¸ì½”ë”©ëœ joint ì´ë¦„ì„ ì ì ˆíˆ ìˆ˜ì •í•©ë‹ˆë‹¤. # From \u0026lt;joint name=\u0026#34;ï¿½ï¿½Ã¼3\u0026#34; type=\u0026#34;fixed\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.05 0.0 0.11\u0026#34;/\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34;/\u0026gt; \u0026lt;child link=\u0026#34;lidar_1\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;joint name=\u0026#34;È¸ï¿½ï¿½7\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0 -0.1 0.05\u0026#34;/\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34;/\u0026gt; \u0026lt;child link=\u0026#34;right_wheel_1\u0026#34;/\u0026gt; \u0026lt;axis xyz=\u0026#34;-0.0 -1.0 0.0\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;joint name=\u0026#34;È¸ï¿½ï¿½8\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0 0.1 0.05\u0026#34;/\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34;/\u0026gt; \u0026lt;child link=\u0026#34;left_wheel_1\u0026#34;/\u0026gt; \u0026lt;axis xyz=\u0026#34;-0.0 1.0 0.0\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; # To \u0026lt;joint name=\u0026#34;lidar_joint\u0026#34; type=\u0026#34;fixed\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.05 0.0 0.11\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;lidar_1\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;joint name=\u0026#34;right_wheel_joint\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0 -0.1 0.05\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;right_wheel_1\u0026#34; /\u0026gt; \u0026lt;axis xyz=\u0026#34;-0.0 -1.0 0.0\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;joint name=\u0026#34;left_wheel_joint\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0 0.1 0.05\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;left_wheel_1\u0026#34; /\u0026gt; \u0026lt;axis xyz=\u0026#34;-0.0 1.0 0.0\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; joint ì¶• ë°©í–¥ì„ ìˆ˜ì •í•©ë‹ˆë‹¤. \u0026lt;joint name=\u0026#34;right_wheel_joint\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0 -0.1 0.05\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;right_wheel_1\u0026#34; /\u0026gt; \u0026lt;axis xyz=\u0026#34;0.0 1.0 0.0\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;joint name=\u0026#34;left_wheel_joint\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0 0.1 0.05\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;left_wheel_1\u0026#34; /\u0026gt; \u0026lt;axis xyz=\u0026#34;0.0 1.0 0.0\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; íŒŒì¼ ìƒë‹¨ base_footprint linkë¥¼ ì¶”ê°€í•˜ê³  base_footprintì™€ base_linkë¥¼ ì—°ê²°í•˜ëŠ” jointë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. base_footprintëŠ” ì¶”í›„ ììœ¨ì£¼í–‰ ì‹œ í•„ìš”í•œ tf IDë¡œ ë¡œë´‡ ì¤‘ì‹¬ì—ì„œ ë°”ë‹¥ë©´ì— projectioní•œ ìœ„ì¹˜ë¥¼ ëœ»í•©ë‹ˆë‹¤. \u0026lt;link name=\u0026#39;base_footprint\u0026#39; /\u0026gt; ... \u0026lt;joint name=\u0026#39;base_link_joint\u0026#39; type=\u0026#39;fixed\u0026#39;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0 0 0\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;base_footprint\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;base_link\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; mesh íŒŒì¼ì˜ uriì™€ xacro ë¼ì¸ì˜ packageëª…ì„ ì—¬ëŸ¬ë¶„ì˜ íŒ¨í‚¤ì§€ë¡œ ìˆ˜ì •í•©ë‹ˆë‹¤. # From \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/materials.xacro\u0026#34; /\u0026gt; ... \u0026lt;mesh filename=\u0026#34;package://fusionbot_description...\u0026#34; /\u0026gt; # To \u0026lt;xacro:include filename=\u0026#34;$(find temp_description)/urdf/materials.xacro\u0026#34; /\u0026gt; ... \u0026lt;mesh filename=\u0026#34;package://temp_description...\u0026#34; /\u0026gt; ìƒ‰ìƒì„ ì…íˆê³  ì‹¶ë‹¤ë©´ materials.xacroë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤. (GazeboëŠ” ê³ ìœ í•œ ìƒ‰ìƒ ì²´ê³„ë¥¼ ê°–ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë§í¬ë¥¼ ì°¸ê³ í•©ë‹ˆë‹¤.) \u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34;\u0026gt; \u0026lt;material name=\u0026#34;silver\u0026#34;\u0026gt; \u0026lt;color rgba=\u0026#34;0.700 0.700 0.700 1.000\u0026#34; /\u0026gt; \u0026lt;/material\u0026gt; \u0026lt;material name=\u0026#34;white\u0026#34;\u0026gt; \u0026lt;color rgba=\u0026#34;1 1 1 0.6\u0026#34; /\u0026gt; \u0026lt;/material\u0026gt; \u0026lt;material name=\u0026#34;black\u0026#34;\u0026gt; \u0026lt;color rgba=\u0026#34;0 0 0 0.7\u0026#34; /\u0026gt; \u0026lt;/material\u0026gt; \u0026lt;material name=\u0026#34;red\u0026#34;\u0026gt; \u0026lt;color rgba=\u0026#34;1 0 0 1\u0026#34; /\u0026gt; \u0026lt;/material\u0026gt; \u0026lt;material name=\u0026#34;blue\u0026#34;\u0026gt; \u0026lt;color rgba=\u0026#34;0 0 0.8 1\u0026#34;/\u0026gt; \u0026lt;/material\u0026gt; \u0026lt;/robot\u0026gt; CMakeLists.txtë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤. ament_package() ì´ì „ ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•˜ì‹œë©´ ë©ë‹ˆë‹¤. ## Install install(DIRECTORY meshes urdf DESTINATION share/${PROJECT_NAME} ) ** ament_package() ì‘ì—…ì„ ë§ˆì¹œ ë’¤, colcon buildë¥¼ í•œì°¨ë¡€ ì‹¤ì‹œí•©ë‹ˆë‹¤. cd ~/ros2_ws colcon build --packages-select temp_description source install/local_setup.bash CMakeLists.txtì— ë‹¤ìŒ ë¼ì¸ì„ ì¶”ê°€í•œ ë’¤ ë‹¤ì‹œ í•œ ë²ˆ colcon buildë¥¼ ì‹¤ì‹œí•©ë‹ˆë‹¤. find_package(xacro REQUIRED) # Xacro files file(GLOB xacro_files urdf/*.urdf.xacro) foreach(it ${xacro_files}) # remove .xacro extension string(REGEX MATCH \u0026#34;(.*)[.]xacro$\u0026#34; unused ${it}) set(output_filename ${CMAKE_MATCH_1}) # create a rule to generate ${output_filename} from {it} xacro_add_xacro_file(${it} ${output_filename}) list(APPEND urdf_files ${output_filename}) endforeach(it) add_custom_target(media_files ALL DEPENDS ${urdf_files}) â‡’ ì´ ê³¼ì •ì´ í•„ìš”í•œ ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\nì²«ë²ˆì§¸ colcon buildë¡œ í•„ìš” íŒŒì¼ë“¤ì˜ symbolic linkê°€ install í´ë” ë‚´ ìƒì„±ë©ë‹ˆë‹¤. ë‘ë²ˆì§¸ colcon build ì‹œ CMakeLists.txtì— ì‘ì„±í•œ xacro ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ xacro â‡’ urdfë¡œ ë³€í™˜ë˜ë©°, ì´ ê³¼ì •ì—ì„œ CMakeëŠ” install í´ë” ë‚´ symbolic linkë“¤ì„ í•„ìš”ë¡œ í•©ë‹ˆë‹¤. ë§Œì•½ ì²«ë²ˆì§¸ ì‘ì—…ì´ ì—†ë‹¤ë©´, mesh, urdf ê´€ë ¨ íŒŒì¼ì´ ì—†ë‹¤ëŠ” ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤. ìœ„ ê³¼ì •ì„ ë§ˆì¹˜ë©´ ìë™ìœ¼ë¡œ fusionbot.urdfê°€ ìƒì„±ë˜ë©°, ì´í›„ í•´ë‹¹ urdfëŠ” descriptionê³¼ gazebo ë“± ë‹¤ì–‘í•œ ëª©ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;!-- =================================================================================== --\u0026gt; \u0026lt;!-- | This document was autogenerated by xacro from /home/kimsooyoung/ros2_ws/src/du2023-gz/test_description/urdf/fusionbot.urdf.xacro | --\u0026gt; \u0026lt;!-- | EDITING THIS FILE BY HAND IS NOT RECOMMENDED | --\u0026gt; \u0026lt;!-- =================================================================================== --\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34;\u0026gt; \u0026lt;material name=\u0026#34;silver\u0026#34;\u0026gt; \u0026lt;color rgba=\u0026#34;0.700 0.700 0.700 1.000\u0026#34;/\u0026gt; \u0026lt;/material\u0026gt; ... Description launch ì‹¤í–‰í•´ë³´ê¸° robot state publisherì™€ joint_state_publisher_guië¥¼ í†µí•´ robot_description topicì„ ìƒì„±í•˜ê³  rvizë¥¼ í†µí•´ ì´ë¥¼ ì‹œê°í™”í•´ë´…ì‹œë‹¤.\nì˜ˆì‹œë¥¼ ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ í´ë” êµ¬ì¡°ê°€ í•„ìš”í•©ë‹ˆë‹¤. (launch í´ë”ì™€ rviz í´ë”ë¥¼ ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.) launch í´ë”ë¥¼ ìƒì„±í•˜ê³ , í•´ë‹¹ í´ë” ë‚´ë¶€ì— launch íŒŒì¼ì„ ì‘ì„±í•´ë³¼ ê²ƒì…ë‹ˆë‹¤. í•„ìš”í•œ NodeëŠ” ì•„ë˜ì™€ ê°™ì€ 3ê°œ ì´ë©°, fusionbot_description.launch.pyë¥¼ ì°¸ê³ í•˜ì—¬ ì§ì ‘ launch fileì„ ì‘ì„±í•´ë³´ì„¸ìš”! return LaunchDescription([ joint_state_publisher_gui, robot_state_publisher, rviz, ]) rviz í´ë”ë„ ìƒì„±í•˜ê³  ê¸°ì¡´ fusionbot_descriptionì—ì„œ config íŒŒì¼ì„ ê°€ì ¸ì˜µë‹ˆë‹¤. ìƒˆë¡œìš´ í´ë”ê°€ ì¶”ê°€ë˜ë©´ í•­ìƒ CMakeLists.txtë¥¼ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤. ## Install install(DIRECTORY meshes urdf launch rviz DESTINATION share/${PROJECT_NAME} ) íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œí•œ ë’¤, ì—¬ëŸ¬ë¶„ì´ ì‘ì„±í•œ launch fileì„ ì‹¤í–‰í•´ë³´ì„¸ìš”! colcon build --symlink-install --packages-select temp_description source install/local_setup.bash ros2 launch temp_description description.launch.py "
},
{
	"uri": "/kr/ros_and_gazebo/lecture2/",
	"title": "Lecture2 - Gazebo and Robot(2)",
	"tags": [],
	"description": "",
	"content": "FusionBotê³¼ Gazebo Description ì˜ˆì‹œë¥¼ í†µí•´ URDFì— ëŒ€í•´ ìŠµë“í•˜ì˜€ë‹¤ë©´, ì´ì œ Gazeboì— ë¡œë´‡ì„ ë“±ì¥ì‹œí‚¤ê³ , ì´ë™, ì„¼ì‹±ì„ êµ¬í˜„í•  ì°¨ë¡€ì…ë‹ˆë‹¤. FusionBotì„ í†µí•´ ì‹¤ìŠµì„ ì§„í–‰í•´ë³´ê³ , ì´ì „ ì˜ˆì‹œì—ì„œì˜ ë¡œë´‡ë“¤ë„ í•¨ê»˜ ë¶„ì„í•´ ë³´ê² ìŠµë‹ˆë‹¤.\nê°•ì˜ì—ì„œëŠ”, Gazeboì—ì„œ ë¡œë´‡ì„ ë“±ì¥ì‹œí‚¤ëŠ” 2ê°€ì§€ ë°©ë²•ì„ ì œì‹œí•˜ê³ ì í•©ë‹ˆë‹¤.\nXacro íŒŒì¼ì„ í†µí•œ ë¡œë´‡ Spawn URDF íŒŒì¼ì„ í†µí•œ ë¡œë´‡ Spawn ë‘ ë°©ì‹ ëª¨ë‘ launch fileì—ì„œ ì‹¤í–‰ë˜ëŠ” Nodeë“¤ì€ ë™ì¼í•©ë‹ˆë‹¤.\ngazebo_rosë¥¼ í†µí•´ gazebo serverì™€ clientë¥¼ ì‹¤í–‰í•˜ê³  robot_state_publisherì™€ joint_state_publisherë¥¼ í†µí•´ robot_description topicì„ ì¤€ë¹„í•©ë‹ˆë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ, gazebo_rosì—ì„œ ì œê³µí•˜ëŠ” spawn_entityë¼ëŠ” Nodeë¥¼ í†µí•´ ë¡œë´‡ì„ Gazebo ìƒì— ë“±ì¥ì‹œí‚µë‹ˆë‹¤. ì €ëŠ” ìƒˆë¡œìš´ ì˜ˆì‹œë¥¼ ìœ„í•´ íŒ¨í‚¤ì§€ë¥¼ ë¶„ë¦¬í•˜ê³ , launch fileì˜ ì´ë¦„ì„ empty_gazebo.launch.pyë¡œ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤. LaunchDescriptionì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. (ì—¬ëŸ¬ë¶„ì€ íŒ¨í‚¤ì§€ë¥¼ ë¶„ë¦¬í•˜ì§€ ì•Šìœ¼ì…”ë„ ì¢‹ìŠµë‹ˆë‹¤.)\nreturn LaunchDescription([ start_gazebo_server_cmd, start_gazebo_client_cmd, robot_state_publisher, joint_state_publisher, spawn_entity, ]) Xacro íŒŒì¼ì„ í†µí•œ ë¡œë´‡ Spawn GazeboëŠ” package://ë¥¼ í†µí•œ íŒŒì¼ ì ‘ê·¼ì„ ì¸ì‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, fusionbot.urdf.xacro íŒŒì¼ ì•ˆì˜ ê´€ë ¨ëœ ë¶€ë¶„ì„ ëª¨ë‘ $(find pkg) í˜•íƒœë¡œ ë³€í˜•í•´ì¤ë‹ˆë‹¤. # From \u0026lt;link name=\u0026#34;base_link\u0026#34;\u0026gt; \u0026lt;inertial\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0038631391370923516 -1.6603718341471133e-17 0.05277089743549162\u0026#34;/\u0026gt; \u0026lt;mass value=\u0026#34;2.3225264704023765\u0026#34;/\u0026gt; \u0026lt;inertia ixx=\u0026#34;0.00792\u0026#34; ixy=\u0026#34;-0.0\u0026#34; ixz=\u0026#34;-0.000339\u0026#34; iyy=\u0026#34;0.008432\u0026#34; iyz=\u0026#34;-0.0\u0026#34; izz=\u0026#34;0.014814\u0026#34;/\u0026gt; \u0026lt;/inertial\u0026gt; \u0026lt;visual\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0 0 0\u0026#34;/\u0026gt; \u0026lt;geometry\u0026gt; \u0026lt;mesh filename=\u0026#34;package://temp_description/meshes/base_link.stl\u0026#34; scale=\u0026#34;0.001 0.001 0.001\u0026#34;/\u0026gt; \u0026lt;/geometry\u0026gt; # To \u0026lt;link name=\u0026#34;base_link\u0026#34;\u0026gt; \u0026lt;inertial\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0038631391370923516 -1.6603718341471133e-17 0.05277089743549162\u0026#34;/\u0026gt; \u0026lt;mass value=\u0026#34;2.3225264704023765\u0026#34;/\u0026gt; \u0026lt;inertia ixx=\u0026#34;0.00792\u0026#34; ixy=\u0026#34;-0.0\u0026#34; ixz=\u0026#34;-0.000339\u0026#34; iyy=\u0026#34;0.008432\u0026#34; iyz=\u0026#34;-0.0\u0026#34; izz=\u0026#34;0.014814\u0026#34;/\u0026gt; \u0026lt;/inertial\u0026gt; \u0026lt;visual\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0 0 0\u0026#34;/\u0026gt; \u0026lt;geometry\u0026gt; \u0026lt;mesh filename=\u0026#34;$(find temp_description)/meshes/base_link.stl\u0026#34; scale=\u0026#34;0.001 0.001 0.001\u0026#34;/\u0026gt; \u0026lt;/geometry\u0026gt; xacro íŒŒì¼ì˜ ê²½ë¡œë¥¼ íƒìƒ‰í•œ ë’¤, robot_descriptionê³¼ í˜¸í™˜ì„ ìœ„í•œ ëª‡ê°€ì§€ ë³€ê²½ì„ ì ìš©í•˜ì—¬ argumentë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤. xacro_file = os.path.join(description_pkg_path, \u0026#39;urdf\u0026#39;, \u0026#39;fusionbot.urdf.xacro\u0026#39;) robot_description_content = Command( [ PathJoinSubstitution([FindExecutable(name=\u0026#34;xacro\u0026#34;)]), \u0026#34; \u0026#34;, xacro_file, \u0026#34; \u0026#34;, \u0026#34;name:=fusionbot\u0026#34;, \u0026#34; \u0026#34;, \u0026#34;prefix:=\u0026#39;\u0026#39;\u0026#34;, \u0026#34; \u0026#34;, \u0026#34;is_sim:=true\u0026#34;, ] ) robot_description = {\u0026#34;robot_description\u0026#34;: robot_description_content} í•­ìƒ ì •ì  íŒŒì¼ì´ ìˆ˜ì •ëœ ë‹¤ìŒì—ëŠ” colcon buildë¥¼ ìŠì§€ ë§™ì‹œë‹¤!\nURDF íŒŒì¼ì„ í†µí•œ ë¡œë´‡ Spawn urdfë¥¼ ìƒì„±í•˜ê³ , ì´ë¥¼ í†µí•´ gazeboì—ì„œ ë¡œë´‡ì„ ë“±ì¥ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. xacro file â‡’ URDFë¡œì˜ ë³€í™˜ì„ ì§„í–‰í•©ë‹ˆë‹¤. cd ~/ros2_ws/src/du2023-gz/\u0026lt;your-pkg\u0026gt;/urdf xacro fusionbot.urdf.xacro \u0026gt; fusionbot.urdf # í˜¹ì€ colcon buildë¥¼ ì‚¬ìš©í•´ë„ ë©ë‹ˆë‹¤. colcon build --packages-select temp_description ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ URDF íŒŒì¼ì€ ì•„ë˜ì™€ ê°™ì´ ì ˆëŒ€ ê²½ë¡œê°€ ì‚½ì…ë˜ê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ë¶„ì˜ í™˜ê²½ì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥í•¨ì— ìœ ì˜í•©ë‹ˆë‹¤. \u0026lt;collision\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;-0.05 -0.0 -0.11\u0026#34;/\u0026gt; \u0026lt;geometry\u0026gt; \u0026lt;mesh filename=\u0026#34;/home/kimsooyoung/ros2_ws/install/test_description/share/test_description/meshes/lidar_1.stl\u0026#34; scale=\u0026#34;0.001 0.001 0.001\u0026#34;/\u0026gt; \u0026lt;/geometry\u0026gt; \u0026lt;/collision\u0026gt; \u0026lt;/link\u0026gt; URDF íŒŒì¼ì„ robot_state_publisherì—ê²Œ ì „ë‹¬í•˜ëŠ” ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. xacro íŒ¨í‚¤ì§€ì˜ ë‚´ì¥ í•¨ìˆ˜ë¥¼ í†µí•´ ì†ì‰¬ìš´ ë³€í™˜ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. urdf_file = os.path.join(description_pkg_path, \u0026#39;urdf\u0026#39;, \u0026#39;fusionbot.urdf\u0026#39;) doc = xacro.parse(open(urdf_file)) xacro.process_doc(doc) robot_description = {\u0026#39;robot_description\u0026#39;: doc.toxml()} ì´ë ‡ê²Œ ë‘ê°€ì§€ ë°©ë²•ì„ ë°°ìš°ëŠ” ê¹Œë‹­ì€ ì‹¤ì œ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ë‹¤ë³´ë©´ xacroì™€ urdfë¥¼ í˜¼ìš©í•˜ì—¬ ë°°í¬í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.\nì´ì œ, ì™„ì„±ëœ launch íŒŒì¼ì„ í†µí•´ gazeboìƒì— ë¡œë´‡ì„ ë“±ì¥ì‹œì¼œë´…ì‹œë‹¤. ros2 launch temp_description empty_gazebo.launch.py ì§€ê¸ˆ ë“±ì¥ì‹œí‚¨ ë¡œë´‡ì€ ìƒ‰ë„ ì—†ê³  ì œì–´ê¸°, ì„¼ì„œë„ ì—†ê¸° ë•Œë¬¸ì— ë‹¨ìˆœ ì§ˆëŸ‰ ë©ì–´ë¦¬ì— ë¶ˆê³¼í•©ë‹ˆë‹¤. ì´ì œë¶€í„° ë¡œë´‡ì— ì—¬ëŸ¬ ìš”ì†Œë“¤ì„ ì¶”ê°€í•˜ì—¬ ì‹¤ì œ ë¡œë´‡ê³¼ ìœ ì‚¬í•˜ê²Œ ë³€ì‹ ì‹œì¼œë³´ê² ìŠµë‹ˆë‹¤.\nGazebo Plugins Gazeboì—ì„œ ì¸ì‹í•  ìˆ˜ ìˆëŠ” ìƒ‰ìƒì„ ì§€ì •í•˜ê³ , ì„¼ì„œì™€ ì œì–´ê¸°ë¥¼ ì—°ë™í•˜ì—¬ ì‹¤ì œ ë¡œë´‡ ì‹œë®¬ë ˆì´ì…˜ì„ ì™„ì„±í•´ë³´ê³ ì í•©ë‹ˆë‹¤. ì§€ê¸ˆë¶€í„° fusionbot.gazebo íŒŒì¼ì„ ìˆ˜ì •í•˜ì—¬ ì´ë¥¼ êµ¬í˜„í•´ë´…ì‹œë‹¤.\nìš°ì„ , ë¹„êµì  ì‰¬ìš´ ìƒ‰ìƒ ë³€ê²½ë¶€í„° ì§„í–‰í•´ë´…ì‹œë‹¤.\níŒŒì¼ ìµœìƒë‹¨ ì—¬ëŸ¬ ìƒ‰ìƒì„ ë³€ìˆ˜ë¡œ ì§€ì •í•©ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34; \u0026gt; \u0026lt;xacro:property name=\u0026#34;body_color\u0026#34; value=\u0026#34;Gazebo/Silver\u0026#34; /\u0026gt; \u0026lt;xacro:property name=\u0026#34;lidar_color\u0026#34; value=\u0026#34;Gazebo/Blue\u0026#34; /\u0026gt; \u0026lt;xacro:property name=\u0026#34;wheel_color\u0026#34; value=\u0026#34;Gazebo/Black\u0026#34; /\u0026gt; ê° Link ë‚´ material íƒœê·¸ ì†ì„±ìœ¼ë¡œ ì„ ì–¸í•œ ë³€ìˆ˜ë¥¼ í• ë‹¹í•©ë‹ˆë‹¤. \u0026lt;gazebo reference=\u0026#34;base_link\u0026#34;\u0026gt; \u0026lt;material\u0026gt;${body_color}\u0026lt;/material\u0026gt; \u0026lt;mu1\u0026gt;0.1\u0026lt;/mu1\u0026gt; \u0026lt;mu2\u0026gt;0.1\u0026lt;/mu2\u0026gt; \u0026lt;selfCollide\u0026gt;true\u0026lt;/selfCollide\u0026gt; \u0026lt;gravity\u0026gt;true\u0026lt;/gravity\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;gazebo reference=\u0026#34;lidar_1\u0026#34;\u0026gt; \u0026lt;material\u0026gt;${lidar_color}\u0026lt;/material\u0026gt; \u0026lt;mu1\u0026gt;0.2\u0026lt;/mu1\u0026gt; \u0026lt;mu2\u0026gt;0.2\u0026lt;/mu2\u0026gt; \u0026lt;selfCollide\u0026gt;true\u0026lt;/selfCollide\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;gazebo reference=\u0026#34;right_wheel_1\u0026#34;\u0026gt; \u0026lt;material\u0026gt;${wheel_color}\u0026lt;/material\u0026gt; \u0026lt;mu1\u0026gt;100000.0\u0026lt;/mu1\u0026gt; \u0026lt;mu2\u0026gt;100000.0\u0026lt;/mu2\u0026gt; \u0026lt;selfCollide\u0026gt;true\u0026lt;/selfCollide\u0026gt; \u0026lt;/gazebo\u0026gt; ... íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œí•œ í›„ ë‹¤ì‹œ Gazebo launch fileì„ ì‹¤í–‰ì‹œì¼œë´…ì‹œë‹¤. ì§€ê¸ˆë¶€í„° ë‹¤ì–‘í•œ Gazebo Pluginë“¤ì„ ì‚¬ìš©í•˜ì—¬ ë¡œë´‡ê³¼ ROS ì‚¬ì´ì˜ ì‹¤ì§ˆì ì¸ ì—°ë™ì„ í•´ë³´ê² ìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ xacro íŒŒì¼ì— ìƒˆë¡œìš´ linkë“¤ì„ ì¶”ê°€í•  ì˜ˆì •ì…ë‹ˆë‹¤.\nMono Camera fusionbot.urdf.xacro ìˆ˜ì • - camera_linkì™€ camera_joint ì¶”ê°€ \u0026lt;link name=\u0026#34;camera_link\u0026#34;\u0026gt; \u0026lt;pose\u0026gt;0 0 0 0 0 0\u0026lt;/pose\u0026gt; \u0026lt;/link\u0026gt; ... \u0026lt;joint name=\u0026#34;camera_joint\u0026#34; type=\u0026#34;fixed\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.1 0.0 0.05\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;camera_link\u0026#34; /\u0026gt; \u0026lt;axis xyz=\u0026#34;0.0 0.0 0.0\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; urdf í´ë” ì•ˆì— sensorsë¼ëŠ” í´ë”ë¥¼ ì¶”ê°€í•œ ë’¤, mono_cam.gazeboë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34; \u0026gt; \u0026lt;gazebo reference=\u0026#34;camera_link\u0026#34;\u0026gt; \u0026lt;sensor name=\u0026#34;front_camera\u0026#34; type=\u0026#34;camera\u0026#34;\u0026gt; \u0026lt;update_rate\u0026gt;30.0\u0026lt;/update_rate\u0026gt; \u0026lt;visualize\u0026gt;false\u0026lt;/visualize\u0026gt; \u0026lt;always_on\u0026gt;1\u0026lt;/always_on\u0026gt; \u0026lt;camera name=\u0026#34;front_camera\u0026#34;\u0026gt; \u0026lt;!-- math.atan(320 / 687.8065795898438) * 2 --\u0026gt; \u0026lt;horizontal_fov\u0026gt;0.8709216071359963\u0026lt;/horizontal_fov\u0026gt; \u0026lt;image\u0026gt; \u0026lt;width\u0026gt;1280\u0026lt;/width\u0026gt; \u0026lt;height\u0026gt;720\u0026lt;/height\u0026gt; \u0026lt;format\u0026gt;R8G8B8\u0026lt;/format\u0026gt; \u0026lt;!-- \u0026lt;format\u0026gt;B8G8R8\u0026lt;/format\u0026gt; --\u0026gt; \u0026lt;/image\u0026gt; \u0026lt;clip\u0026gt; \u0026lt;near\u0026gt;0.02\u0026lt;/near\u0026gt; \u0026lt;far\u0026gt;300\u0026lt;/far\u0026gt; \u0026lt;/clip\u0026gt; \u0026lt;noise\u0026gt; \u0026lt;type\u0026gt;gaussian\u0026lt;/type\u0026gt; \u0026lt;mean\u0026gt;0.0\u0026lt;/mean\u0026gt; \u0026lt;stddev\u0026gt;0.00007\u0026lt;/stddev\u0026gt; \u0026lt;/noise\u0026gt; \u0026lt;/camera\u0026gt; \u0026lt;plugin filename=\u0026#34;libgazebo_ros_camera.so\u0026#34; name=\u0026#34;camera_controller\u0026#34;\u0026gt; \u0026lt;ros\u0026gt; \u0026lt;!-- \u0026lt;namespace\u0026gt;custom_ns\u0026lt;/namespace\u0026gt; --\u0026gt; \u0026lt;remapping\u0026gt;image_raw:=image_raw\u0026lt;/remapping\u0026gt; \u0026lt;remapping\u0026gt;camera_info:=camera_info\u0026lt;/remapping\u0026gt; \u0026lt;/ros\u0026gt; \u0026lt;camera_name\u0026gt;front_camera\u0026lt;/camera_name\u0026gt; \u0026lt;frame_name\u0026gt;camera_link\u0026lt;/frame_name\u0026gt; \u0026lt;hack_baseline\u0026gt;0.07\u0026lt;/hack_baseline\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/sensor\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;/robot\u0026gt; update_rate data publish rate visualize ì‹œê°í™” ì˜µì…˜ horizontal_fov ì¹´ë©”ë¼ì˜ í™”ê° image í™”ì§ˆ ì˜µì…˜ noise ì„¼ì„œ ë…¸ì´ì¦ˆ remapping topic ì´ë¦„ ì¬ì„¤ì • camera_name topicì˜ namespaceê°€ ë©ë‹ˆë‹¤. frame_name cameraê°€ ì¥ì°©ë˜ëŠ” link hack_baseline stereo camera ì‚¬ìš© ì‹œ ì¹´ë©”ë¼ ì‚¬ì´ ê±°ë¦¬ â‡’ ì´ë ‡ê²Œ xml í˜•íƒœì˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¶”ê°€í•˜ì—¬ gazebo pluginì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nfusionbot.gazebo ìˆ˜ì • \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34; \u0026gt; \u0026lt;xacro:property name=\u0026#34;body_color\u0026#34; value=\u0026#34;Gazebo/Silver\u0026#34; /\u0026gt; \u0026lt;xacro:property name=\u0026#34;lidar_color\u0026#34; value=\u0026#34;Gazebo/Blue\u0026#34; /\u0026gt; \u0026lt;xacro:property name=\u0026#34;wheel_color\u0026#34; value=\u0026#34;Gazebo/Black\u0026#34; /\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find temp_description)/urdf/sensors/mono_cam.gazebo\u0026#34; /\u0026gt; \u0026lt;gazebo\u0026gt; \u0026lt;plugin filename=\u0026#34;libgazebo_ros_control.so\u0026#34; name=\u0026#34;control\u0026#34;/\u0026gt; \u0026lt;/gazebo\u0026gt; ì˜ˆì œ ì¬ì‹¤í–‰ colcon build --symlink-install --packages-select temp_description source install/local_setup.bash ros2 launch temp_description empty_gazebo.launch.py rvizë¥¼ í†µí•´ ì¹´ë©”ë¼ ë°ì´í„°ë¥¼ í™•ì¸í•´ë´…ì‹œë‹¤.\nDepth Camera fusionbot.urdf.xacro ìˆ˜ì • - depth_camera_linkì™€ depth_camera_optical_joint ì¶”ê°€ \u0026lt;link name=\u0026#34;depth_camera_link\u0026#34;\u0026gt; \u0026lt;pose\u0026gt;0 0 0 0 0 0\u0026lt;/pose\u0026gt; \u0026lt;/link\u0026gt; ... \u0026lt;joint name=\u0026#34;depth_camera_optical_joint\u0026#34; type=\u0026#34;fixed\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;-1.57079632679 0 -1.57079632679\u0026#34; xyz=\u0026#34;0 0 0\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;depth_camera_link\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;depth_camera_optical_link\u0026#34; /\u0026gt; \u0026lt;axis xyz=\u0026#34;0.0 0.0 0.0\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; urdf í´ë” ì•ˆì— sensorsë¼ëŠ” í´ë”ë¥¼ ì¶”ê°€í•œ ë’¤, depth_cam.gazeboë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34; \u0026gt; \u0026lt;gazebo reference=\u0026#34;depth_camera_link\u0026#34;\u0026gt; \u0026lt;sensor name=\u0026#34;front_depth_camera\u0026#34; type=\u0026#34;depth\u0026#34;\u0026gt; \u0026lt;update_rate\u0026gt;30.0\u0026lt;/update_rate\u0026gt; \u0026lt;visualize\u0026gt;false\u0026lt;/visualize\u0026gt; \u0026lt;always_on\u0026gt;1\u0026lt;/always_on\u0026gt; \u0026lt;camera name=\u0026#34;front_depth_camera\u0026#34;\u0026gt; \u0026lt;!-- math.atan(320 / 687.8065795898438) * 2 --\u0026gt; \u0026lt;horizontal_fov\u0026gt;0.8709216071359963\u0026lt;/horizontal_fov\u0026gt; \u0026lt;image\u0026gt; \u0026lt;width\u0026gt;1280\u0026lt;/width\u0026gt; \u0026lt;height\u0026gt;720\u0026lt;/height\u0026gt; \u0026lt;format\u0026gt;R8G8B8\u0026lt;/format\u0026gt; \u0026lt;!-- \u0026lt;format\u0026gt;B8G8R8\u0026lt;/format\u0026gt; --\u0026gt; \u0026lt;/image\u0026gt; \u0026lt;clip\u0026gt; \u0026lt;near\u0026gt;0.02\u0026lt;/near\u0026gt; \u0026lt;far\u0026gt;300\u0026lt;/far\u0026gt; \u0026lt;/clip\u0026gt; \u0026lt;noise\u0026gt; \u0026lt;type\u0026gt;gaussian\u0026lt;/type\u0026gt; \u0026lt;mean\u0026gt;0.0\u0026lt;/mean\u0026gt; \u0026lt;stddev\u0026gt;0.00007\u0026lt;/stddev\u0026gt; \u0026lt;/noise\u0026gt; \u0026lt;/camera\u0026gt; \u0026lt;plugin filename=\u0026#34;libgazebo_ros_camera.so\u0026#34; name=\u0026#34;camera_controller\u0026#34;\u0026gt; \u0026lt;ros\u0026gt; \u0026lt;!-- \u0026lt;namespace\u0026gt;custom_ns\u0026lt;/namespace\u0026gt; --\u0026gt; \u0026lt;remapping\u0026gt;front_depth_camera/image_raw:=front_depth_camera/image_raw\u0026lt;/remapping\u0026gt; \u0026lt;remapping\u0026gt;front_depth_camera/image_depth:=front_depth_camera/image_depth\u0026lt;/remapping\u0026gt; \u0026lt;remapping\u0026gt;front_depth_camera/camera_info:=front_depth_camera/camera_info\u0026lt;/remapping\u0026gt; \u0026lt;remapping\u0026gt;front_depth_camera/camera_info_depth:=front_depth_camera/camera_info_depth\u0026lt;/remapping\u0026gt; \u0026lt;remapping\u0026gt;front_depth_camera/points:=front_depth_camera/points\u0026lt;/remapping\u0026gt; \u0026lt;/ros\u0026gt; \u0026lt;camera_name\u0026gt;front_depth_camera\u0026lt;/camera_name\u0026gt; \u0026lt;frame_name\u0026gt;depth_camera_optical_link\u0026lt;/frame_name\u0026gt; \u0026lt;hack_baseline\u0026gt;0.07\u0026lt;/hack_baseline\u0026gt; \u0026lt;min_depth\u0026gt;0.001\u0026lt;/min_depth\u0026gt; \u0026lt;max_depth\u0026gt;300.0\u0026lt;/max_depth\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/sensor\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;/robot\u0026gt; sensor type depth min_depth, max_depth depth íƒì§€ê±°ë¦¬ â‡’ depth cameraëŠ” camera ì¢Œí‘œê³„ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë³„ë„ jointë¥¼ ì§€ì •í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.\nfusionbot.gazebo ìˆ˜ì • \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34; \u0026gt; \u0026lt;xacro:property name=\u0026#34;body_color\u0026#34; value=\u0026#34;Gazebo/Silver\u0026#34; /\u0026gt; \u0026lt;xacro:property name=\u0026#34;lidar_color\u0026#34; value=\u0026#34;Gazebo/Blue\u0026#34; /\u0026gt; \u0026lt;xacro:property name=\u0026#34;wheel_color\u0026#34; value=\u0026#34;Gazebo/Black\u0026#34; /\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find temp_description)/urdf/sensors/mono_cam.gazebo\u0026#34; /\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_gazebo)/urdf/sensors/depth_cam.gazebo\u0026#34; /\u0026gt; \u0026lt;gazebo\u0026gt; \u0026lt;plugin filename=\u0026#34;libgazebo_ros_control.so\u0026#34; name=\u0026#34;control\u0026#34;/\u0026gt; \u0026lt;/gazebo\u0026gt; ì˜ˆì œ ì¬ì‹¤í–‰ colcon build --symlink-install --packages-select temp_description source install/local_setup.bash ros2 launch temp_description empty_gazebo.launch.py â‡’ rvizë¥¼ í†µí•´ ì¹´ë©”ë¼ ë°ì´í„°ë¥¼ í™•ì¸í•´ë´…ì‹œë‹¤.\n2D Lidar urdf sensors í´ë” ì•ˆì— lidar_2d.gazeboë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34; \u0026gt; \u0026lt;xacro:property name=\u0026#34;M_PI\u0026#34; value=\u0026#34;3.1415926535897931\u0026#34; /\u0026gt; \u0026lt;gazebo reference=\u0026#34;lidar_1\u0026#34;\u0026gt; \u0026lt;sensor name=\u0026#34;lidar\u0026#34; type=\u0026#34;ray\u0026#34;\u0026gt; \u0026lt;pose\u0026gt;0 0 0 0 0 0\u0026lt;/pose\u0026gt; \u0026lt;always_on\u0026gt;true\u0026lt;/always_on\u0026gt; \u0026lt;visualize\u0026gt;false\u0026lt;/visualize\u0026gt; \u0026lt;update_rate\u0026gt;10\u0026lt;/update_rate\u0026gt; \u0026lt;ray\u0026gt; \u0026lt;scan\u0026gt; \u0026lt;horizontal\u0026gt; \u0026lt;samples\u0026gt;360\u0026lt;/samples\u0026gt; \u0026lt;resolution\u0026gt;1.000000\u0026lt;/resolution\u0026gt; \u0026lt;min_angle\u0026gt;-${M_PI}\u0026lt;/min_angle\u0026gt; \u0026lt;max_angle\u0026gt;${M_PI}\u0026lt;/max_angle\u0026gt; \u0026lt;/horizontal\u0026gt; \u0026lt;/scan\u0026gt; \u0026lt;range\u0026gt; \u0026lt;min\u0026gt;0.15\u0026lt;/min\u0026gt; \u0026lt;max\u0026gt;12.0\u0026lt;/max\u0026gt; \u0026lt;resolution\u0026gt;0.5\u0026lt;/resolution\u0026gt; \u0026lt;/range\u0026gt; \u0026lt;noise\u0026gt; \u0026lt;type\u0026gt;gaussian\u0026lt;/type\u0026gt; \u0026lt;mean\u0026gt;0.0\u0026lt;/mean\u0026gt; \u0026lt;stddev\u0026gt;0.01\u0026lt;/stddev\u0026gt; \u0026lt;/noise\u0026gt; \u0026lt;/ray\u0026gt; \u0026lt;plugin name=\u0026#34;gazebo_ros_head_hokuyo_controller\u0026#34; filename=\u0026#34;libgazebo_ros_ray_sensor.so\u0026#34;\u0026gt; \u0026lt;ros\u0026gt; \u0026lt;remapping\u0026gt;~/out:=scan\u0026lt;/remapping\u0026gt; \u0026lt;/ros\u0026gt; \u0026lt;output_type\u0026gt;sensor_msgs/LaserScan\u0026lt;/output_type\u0026gt; \u0026lt;frame_name\u0026gt;lidar_1\u0026lt;/frame_name\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/sensor\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;/robot\u0026gt; horizontal ë¼ì´ë‹¤ì˜ íƒì§€ ë²”ìœ„ì™€ ìƒ˜í”Œ ìˆ˜ë¥¼ ì§€ì •í•©ë‹ˆë‹¤. range íƒì§€ê±°ë¦¬ì˜ ë²”ìœ„ì…ë‹ˆë‹¤. output_type ROS 2ì—ì„œ ì‚¬ìš©í•˜ëŠ” 2D ë¼ì´ë‹¤ ë°ì´í„°ì…ë‹ˆë‹¤. â‡’ í•´ë‹¹ ë°ì´í„° ìŠ¤í™ì€ ì‹¤ì œ íŒë§¤ì¤‘ì¸ rplidar a1ì„ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.\nfusionbot.gazebo ìˆ˜ì • \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34; \u0026gt; \u0026lt;xacro:property name=\u0026#34;body_color\u0026#34; value=\u0026#34;Gazebo/Silver\u0026#34; /\u0026gt; \u0026lt;xacro:property name=\u0026#34;lidar_color\u0026#34; value=\u0026#34;Gazebo/Blue\u0026#34; /\u0026gt; \u0026lt;xacro:property name=\u0026#34;wheel_color\u0026#34; value=\u0026#34;Gazebo/Black\u0026#34; /\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find temp_description)/urdf/sensors/mono_cam.gazebo\u0026#34; /\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_gazebo)/urdf/sensors/depth_cam.gazebo\u0026#34; /\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find temp_description)/urdf/sensors/lidar_2d.gazebo\u0026#34; /\u0026gt; \u0026lt;gazebo\u0026gt; \u0026lt;plugin filename=\u0026#34;libgazebo_ros_control.so\u0026#34; name=\u0026#34;control\u0026#34;/\u0026gt; \u0026lt;/gazebo\u0026gt; ì˜ˆì œ ì¬ì‹¤í–‰ colcon build --symlink-install --packages-select temp_description source install/local_setup.bash ros2 launch temp_description empty_gazebo.launch.py â‡’ rvizë¥¼ í†µí•´ ë¼ì´ë‹¤ ë°ì´í„°ë¥¼ í™•ì¸í•´ë´…ì‹œë‹¤.\në¹„ìŠ·í•œ ë§¥ë½ì—ì„œ, 3D lidarì™€ GPS, IMU ë“± ë‹¤ì–‘í•œ ì„¼ì„œë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\ngps : https://github.com/RB2023ROS/du2023-gz/blob/main/fusionbot_gazebo/urdf/sensors/gps.gazebo imu : https://github.com/RB2023ROS/du2023-gz/blob/main/fusionbot_gazebo/urdf/sensors/imu.gazebo 3d lidar : https://github.com/RB2023ROS/du2023-gz/blob/main/fusionbot_gazebo/urdf/sensors/lidar_3d.gazebo ì´ë ‡ê²Œ ì„¼ì„œë¥¼ ì¶”ê°€í•˜ëŠ” ë°©ë²•ì€ gazebo_ros_pkgì˜ wiki í˜ì´ì§€ë¥¼ ì°¸ê³ í•˜ì˜€ìŠµë‹ˆë‹¤. í•´ë‹¹ í˜ì´ì§€ì—ëŠ” ROS 1ê³¼ ROS 2ì—ì„œì˜ ì‚¬ìš©ë²• ì°¨ì´ì , ê·¸ë¦¬ê³  ì˜ˆì‹œ worldê¹Œì§€ ì•ˆë‚´í•˜ê³  ìˆìŠµë‹ˆë‹¤. â‡’ gazebo_ros_pkgs\nDiff Drive Controller ë¡œë´‡ ì²­ì†Œê¸°ì™€ ê°™ì´ ì œìë¦¬ íšŒì „ì´ ê°€ëŠ¥í•˜ë©°, ì–‘ìª½ ë°”í€´ íšŒì „ìˆ˜ ì°¨ì´ë¡œ ë¡œë´‡ì„ ì´ë™ì‹œí‚¤ëŠ” íƒ€ì…ì„ DD Typeì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤. gazebo_rosì—ì„œ ì œê³µë˜ëŠ” DD controllerë¥¼ ì‚¬ìš©í•˜ì—¬ Fusionbotì´ ì´ë™í•  ìˆ˜ ìˆê²Œ í•´ë³´ê² ìŠµë‹ˆë‹¤.\nurdf í´ë” ë‚´ë¶€ì— diff_drive.gazebo íŒŒì¼ì„ ì¶”ê°€í•œ ë’¤, ì•„ë˜ ë‚´ìš©ì„ ë¶™ì—¬ë„£ê¸° í•©ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34; \u0026gt; \u0026lt;gazebo\u0026gt; \u0026lt;plugin name=\u0026#39;fusionbot_joint_state\u0026#39; filename=\u0026#39;libgazebo_ros_joint_state_publisher.so\u0026#39;\u0026gt; \u0026lt;ros\u0026gt; \u0026lt;remapping\u0026gt;~/out:=joint_states\u0026lt;/remapping\u0026gt; \u0026lt;/ros\u0026gt; \u0026lt;update_rate\u0026gt;30\u0026lt;/update_rate\u0026gt; \u0026lt;joint_name\u0026gt;right_wheel_joint\u0026lt;/joint_name\u0026gt; \u0026lt;joint_name\u0026gt;left_wheel_joint\u0026lt;/joint_name\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;gazebo\u0026gt; \u0026lt;plugin name=\u0026#39;differential_drive_controller\u0026#39; filename=\u0026#39;libgazebo_ros_diff_drive.so\u0026#39;\u0026gt; \u0026lt;update_rate\u0026gt;30\u0026lt;/update_rate\u0026gt; \u0026lt;left_joint\u0026gt;left_wheel_joint\u0026lt;/left_joint\u0026gt; \u0026lt;right_joint\u0026gt;right_wheel_joint\u0026lt;/right_joint\u0026gt; \u0026lt;wheel_separation\u0026gt;0.2\u0026lt;/wheel_separation\u0026gt; \u0026lt;wheel_diameter\u0026gt;0.1\u0026lt;/wheel_diameter\u0026gt; \u0026lt;max_wheel_torque\u0026gt;50\u0026lt;/max_wheel_torque\u0026gt; \u0026lt;max_wheel_acceleration\u0026gt;1.0\u0026lt;/max_wheel_acceleration\u0026gt; \u0026lt;command_topic\u0026gt;cmd_vel\u0026lt;/command_topic\u0026gt; \u0026lt;publish_odom\u0026gt;1\u0026lt;/publish_odom\u0026gt; \u0026lt;publish_odom_tf\u0026gt;1\u0026lt;/publish_odom_tf\u0026gt; \u0026lt;publish_wheel_tf\u0026gt;0\u0026lt;/publish_wheel_tf\u0026gt; \u0026lt;odometry_topic\u0026gt;odom\u0026lt;/odometry_topic\u0026gt; \u0026lt;odometry_frame\u0026gt;odom\u0026lt;/odometry_frame\u0026gt; \u0026lt;robot_base_frame\u0026gt;base_footprint\u0026lt;/robot_base_frame\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;/robot\u0026gt; fusionbot.gazebo íŒŒì¼ì„ ë‹¤ì‹œ ìˆ˜ì •í•˜ê³ , launch íŒŒì¼ì„ ì‹¤í–‰ì‹œí‚¤ë©´ tfì™€ í•¨ê»˜ ì œì–´ë˜ëŠ” ë¡œë´‡ì„ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ê¸°ë³¸ì ìœ¼ë¡œ /cmd_vel topicì„ í†µí•´ ë¡œë´‡ì„ ì¡°ì¢…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.) ROS 1 Gazebo Package ì œê³µë“œë¦° zip íŒŒì¼ì„ ì‚¬ìš©í•´ì„œ ROS 1ì—ì„œ ë™ì‘í•˜ëŠ” gazebo packageë¥¼ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤. ROS 2ë³´ë‹¤ í›¨ì”¬ ê°„í¸í•©ë‹ˆë‹¤. ğŸ˜Š\nì—°ìŠµì„ ìœ„í•´ ë‹¤ì‹œ í•œ ë²ˆ íŒŒì¼ì„ ë‹¤ìš´ë°›ê² ìŠµë‹ˆë‹¤.\nğŸ“‚ fusionbot_description.zip\nfusionbot.gazeboì„ ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•©ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34; \u0026gt; \u0026lt;xacro:property name=\u0026#34;body_color\u0026#34; value=\u0026#34;Gazebo/Silver\u0026#34; /\u0026gt; \u0026lt;gazebo\u0026gt; \u0026lt;plugin filename=\u0026#34;libgazebo_ros_control.so\u0026#34; name=\u0026#34;control\u0026#34;/\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;gazebo reference=\u0026#34;base_link\u0026#34;\u0026gt; \u0026lt;material\u0026gt;${body_color}\u0026lt;/material\u0026gt; \u0026lt;mu1\u0026gt;0.1\u0026lt;/mu1\u0026gt; \u0026lt;mu2\u0026gt;0.1\u0026lt;/mu2\u0026gt; \u0026lt;selfCollide\u0026gt;true\u0026lt;/selfCollide\u0026gt; \u0026lt;gravity\u0026gt;true\u0026lt;/gravity\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;gazebo reference=\u0026#34;lidar_1\u0026#34;\u0026gt; \u0026lt;material\u0026gt;${body_color}\u0026lt;/material\u0026gt; \u0026lt;mu1\u0026gt;0.2\u0026lt;/mu1\u0026gt; \u0026lt;mu2\u0026gt;0.2\u0026lt;/mu2\u0026gt; \u0026lt;selfCollide\u0026gt;true\u0026lt;/selfCollide\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;gazebo reference=\u0026#34;right_wheel_1\u0026#34;\u0026gt; \u0026lt;material\u0026gt;${body_color}\u0026lt;/material\u0026gt; \u0026lt;mu1\u0026gt;100000.0\u0026lt;/mu1\u0026gt; \u0026lt;mu2\u0026gt;100000.0\u0026lt;/mu2\u0026gt; \u0026lt;selfCollide\u0026gt;true\u0026lt;/selfCollide\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;gazebo reference=\u0026#34;left_wheel_1\u0026#34;\u0026gt; \u0026lt;material\u0026gt;${body_color}\u0026lt;/material\u0026gt; \u0026lt;mu1\u0026gt;1500\u0026lt;/mu1\u0026gt; \u0026lt;mu2\u0026gt;1500\u0026lt;/mu2\u0026gt; \u0026lt;selfCollide\u0026gt;true\u0026lt;/selfCollide\u0026gt; \u0026lt;/gazebo\u0026gt; \u0026lt;/robot\u0026gt; fusionbot.xacroë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤. # From \u0026lt;joint name=\u0026#34;ï¿½ï¿½Ã¼3\u0026#34; type=\u0026#34;fixed\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.05 0.0 0.11\u0026#34;/\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34;/\u0026gt; \u0026lt;child link=\u0026#34;lidar_1\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;joint name=\u0026#34;È¸ï¿½ï¿½7\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0 -0.1 0.05\u0026#34;/\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34;/\u0026gt; \u0026lt;child link=\u0026#34;right_wheel_1\u0026#34;/\u0026gt; \u0026lt;axis xyz=\u0026#34;-0.0 -1.0 0.0\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;joint name=\u0026#34;È¸ï¿½ï¿½8\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0 0.1 0.05\u0026#34;/\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34;/\u0026gt; \u0026lt;child link=\u0026#34;left_wheel_1\u0026#34;/\u0026gt; \u0026lt;axis xyz=\u0026#34;-0.0 1.0 0.0\u0026#34;/\u0026gt; \u0026lt;/joint\u0026gt; # To \u0026lt;joint name=\u0026#34;lidar_joint\u0026#34; type=\u0026#34;fixed\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.05 0.0 0.11\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;lidar_1\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;joint name=\u0026#34;right_wheel_joint\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0 -0.1 0.05\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;right_wheel_1\u0026#34; /\u0026gt; \u0026lt;axis xyz=\u0026#34;0.0 1.0 0.0\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;joint name=\u0026#34;left_wheel_joint\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0 0.1 0.05\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;left_wheel_1\u0026#34; /\u0026gt; \u0026lt;axis xyz=\u0026#34;0.0 1.0 0.0\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; joint ì¶• ë°©í–¥ ìˆ˜ì • \u0026lt;joint name=\u0026#34;right_wheel_joint\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0 -0.1 0.05\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;right_wheel_1\u0026#34; /\u0026gt; \u0026lt;axis xyz=\u0026#34;0.0 1.0 0.0\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; \u0026lt;joint name=\u0026#34;left_wheel_joint\u0026#34; type=\u0026#34;continuous\u0026#34;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0 0.1 0.05\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;base_link\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;left_wheel_1\u0026#34; /\u0026gt; \u0026lt;axis xyz=\u0026#34;0.0 1.0 0.0\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; base_footprint ì¶”ê°€ \u0026lt;link name=\u0026#39;base_footprint\u0026#39; /\u0026gt; ... \u0026lt;joint name=\u0026#39;base_link_joint\u0026#39; type=\u0026#39;fixed\u0026#39;\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0 0 0\u0026#34; /\u0026gt; \u0026lt;parent link=\u0026#34;base_footprint\u0026#34; /\u0026gt; \u0026lt;child link=\u0026#34;base_link\u0026#34; /\u0026gt; \u0026lt;/joint\u0026gt; ë‹¤ì‹œ í•œ ë²ˆ descriptionì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ë²ˆì—ëŠ” launch fileì´ ì´ë¦„ì´ ë°”ë€Œì—ˆìŠµë‹ˆë‹¤. catkin build fusionbot_description source devel/setup.bash roslaunch fusionbot_description display.launch ROS 1ì˜ launch fileì€ xml ë¬¸ë²•ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. joint_state_publisherì™€ robot_state_publisherë¥¼ ì‚¬ìš©í•˜ëŠ” ë¶€ë¶„ì€ ëª¨ë‘ ROS 2ì™€ ë™ì¼í•˜ë©°, robot_state_publisherëŠ” robot_descriptionì„ ìš”êµ¬í•˜ê¸° ë•Œë¬¸ì— argumentë¡œ ì§€ì •í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n# display.launch \u0026lt;launch\u0026gt; \u0026lt;arg default=\u0026#34;$(find fusionbot_description)/urdf/fusionbot.xacro\u0026#34; name=\u0026#34;model\u0026#34;/\u0026gt; \u0026lt;arg default=\u0026#34;true\u0026#34; name=\u0026#34;gui\u0026#34;/\u0026gt; \u0026lt;arg default=\u0026#34;$(find fusionbot_description)/launch/urdf.rviz\u0026#34; name=\u0026#34;rvizconfig\u0026#34;/\u0026gt; \u0026lt;param command=\u0026#34;$(find xacro)/xacro $(arg model)\u0026#34; name=\u0026#34;robot_description\u0026#34;/\u0026gt; \u0026lt;param name=\u0026#34;use_gui\u0026#34; value=\u0026#34;$(arg gui)\u0026#34;/\u0026gt; \u0026lt;node name=\u0026#34;joint_state_publisher\u0026#34; pkg=\u0026#34;joint_state_publisher\u0026#34; type=\u0026#34;joint_state_publisher\u0026#34;/\u0026gt; \u0026lt;node name=\u0026#34;robot_state_publisher\u0026#34; pkg=\u0026#34;robot_state_publisher\u0026#34; type=\u0026#34;robot_state_publisher\u0026#34;/\u0026gt; \u0026lt;node args=\u0026#34;-d $(arg rvizconfig)\u0026#34; name=\u0026#34;rviz\u0026#34; pkg=\u0026#34;rviz\u0026#34; required=\u0026#34;true\u0026#34; type=\u0026#34;rviz\u0026#34;/\u0026gt; \u0026lt;/launch\u0026gt; fusionbot.xacro ìˆ˜ì • - package://ë¥¼ í†µí•œ íŒŒì¼ ì ‘ê·¼ì„ ëª¨ë‘ $(find pkg) í˜•íƒœë¡œ ë³€í˜•í•´ì¤ë‹ˆë‹¤. \u0026lt;link name=\u0026#34;base_link\u0026#34;\u0026gt; \u0026lt;inertial\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0.0037594591254762827 0.0 0.052804115668456025\u0026#34; /\u0026gt; \u0026lt;mass value=\u0026#34;2.3079643337726483\u0026#34; /\u0026gt; \u0026lt;inertia ixx=\u0026#34;0.00789\u0026#34; ixy=\u0026#34;0.0\u0026#34; ixz=\u0026#34;-0.000325\u0026#34; iyy=\u0026#34;0.008347\u0026#34; iyz=\u0026#34;0.0\u0026#34; izz=\u0026#34;0.01475\u0026#34; /\u0026gt; \u0026lt;/inertial\u0026gt; \u0026lt;visual\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0 0 0\u0026#34; /\u0026gt; \u0026lt;geometry\u0026gt; \u0026lt;mesh filename=\u0026#34;$(find fusionbot_description)/meshes/base_link.stl\u0026#34; scale=\u0026#34;0.001 0.001 0.001\u0026#34; /\u0026gt; \u0026lt;/geometry\u0026gt; \u0026lt;material name=\u0026#34;silver\u0026#34; /\u0026gt; \u0026lt;/visual\u0026gt; \u0026lt;collision\u0026gt; \u0026lt;origin rpy=\u0026#34;0 0 0\u0026#34; xyz=\u0026#34;0 0 0\u0026#34; /\u0026gt; \u0026lt;geometry\u0026gt; \u0026lt;mesh filename=\u0026#34;$(find fusionbot_description)/meshes/base_link.stl\u0026#34; scale=\u0026#34;0.001 0.001 0.001\u0026#34; /\u0026gt; \u0026lt;/geometry\u0026gt; \u0026lt;/collision\u0026gt; \u0026lt;/link\u0026gt; ROS 2ì—ì„œ ì„¸íŒ…í•˜ì˜€ë˜ ì„¼ì„œì™€ ì œì–´ pluginì„ ë‹¤ì‹œ ROS 1 ë²„ì „ìœ¼ë¡œ ìˆ˜ì •í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. í•´ë‹¹ ì‘ì—…ì€ gazebo_ros_pkgì˜ wiki í˜ì´ì§€ë¥¼ ì°¸ê³ í•˜ë©´ ë˜ë©° ì´ë²ˆ ì˜ˆì‹œì—ì„œëŠ” ì¹´ë©”ë¼ ì„¼ì„œ í•˜ë‚˜ ì •ë„ë§Œ í•¨ê»˜ ì‘ì—…í•´ë³´ê² ìŠµë‹ˆë‹¤. â‡’ gazebo_ros_pkg \u0026lt;plugin name=\u0026#34;plugin_name\u0026#34; filename=\u0026#34;libgazebo_ros_camera.so\u0026#34;\u0026gt; \u0026lt;alwaysOn\u0026gt;true\u0026lt;/alwaysOn\u0026gt; \u0026lt;updateRate\u0026gt;0.0\u0026lt;/updateRate\u0026gt; \u0026lt;robotNamespace\u0026gt;custom_ns\u0026lt;/robotNamespace\u0026gt; \u0026lt;cameraName\u0026gt;custom_camera\u0026lt;/cameraName\u0026gt; \u0026lt;imageTopicName\u0026gt;custom_image\u0026lt;/imageTopicName\u0026gt; \u0026lt;cameraInfoTopicName\u0026gt;custom_info\u0026lt;/cameraInfoTopicName\u0026gt; \u0026lt;frameName\u0026gt;custom_frame\u0026lt;/frameName\u0026gt; \u0026lt;hackBaseline\u0026gt;0.07\u0026lt;/hackBaseline\u0026gt; \u0026lt;distortionK1\u0026gt;0.1\u0026lt;/distortionK1\u0026gt; \u0026lt;distortionK2\u0026gt;0.2\u0026lt;/distortionK2\u0026gt; \u0026lt;distortionK3\u0026gt;0.3\u0026lt;/distortionK3\u0026gt; \u0026lt;distortionT1\u0026gt;0.5\u0026lt;/distortionT1\u0026gt; \u0026lt;distortionT2\u0026gt;0.5\u0026lt;/distortionT2\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;plugin name=\u0026#34;plugin_name\u0026#34; filename=\u0026#34;libgazebo_ros_camera.so\u0026#34;\u0026gt; \u0026lt;!-- Change namespace, camera name and topics so - * Images are published to: /custom_ns/custom_camera/custom_image * Camera info is published to: /custom_ns/custom_camera/custom_info --\u0026gt; \u0026lt;ros\u0026gt; \u0026lt;namespace\u0026gt;custom_ns\u0026lt;/namespace\u0026gt; \u0026lt;remapping\u0026gt;image_raw:=custom_img\u0026lt;/remapping\u0026gt; \u0026lt;remapping\u0026gt;camera_info:=custom_info\u0026lt;/remapping\u0026gt; \u0026lt;/ros\u0026gt; \u0026lt;!-- Set camera name. If empty, defaults to sensor name (i.e. \u0026#34;sensor_name\u0026#34;) --\u0026gt; \u0026lt;camera_name\u0026gt;custom_camera\u0026lt;/camera_name\u0026gt; \u0026lt;!-- Set TF frame name. If empty, defaults to link name (i.e. \u0026#34;link_name\u0026#34;) --\u0026gt; \u0026lt;frame_name\u0026gt;custom_frame\u0026lt;/frame_name\u0026gt; \u0026lt;hack_baseline\u0026gt;0.07\u0026lt;/hack_baseline\u0026gt; \u0026lt;!-- No need to repeat distortion parameters or to set autoDistortion --\u0026gt; \u0026lt;/plugin\u0026gt; â‡’ ROS 1ì— ì¡´ì¬í–ˆë˜ íƒœí¬ë“¤ì´ ëŒ€ë¶€ë¶„ ROS 2ë„˜ì–´ê°€ë©´ì„œ ì¤‘ë³µ ì œê±°ì™€ ì¬í¸ì„±ì´ ë˜ì—ˆìŠµë‹ˆë‹¤. í•´ë‹¹ ë¶€ë¶„ì„ ì°¸ê³ í•˜ì—¬ ìš°ë¦¬ ìƒí™©ì— ë§ê²Œ ìˆ˜ì •ì„ í•´ë³´ê² ìŠµë‹ˆë‹¤.\nëª¨ë“  ì‘ì—…ì´ ì™„ë£Œëœ íŒ¨í‚¤ì§€ ì••ì¶• íŒŒì¼ì„ ì œê³µë“œë¦¬ë‹ˆ ì‹¤ìŠµ ë„ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ì°¸ê³ í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.\nì´ì œ ëª¨ë“  pluginë“¤ì„ ì¶”ê°€í•˜ì˜€ìœ¼ë‹ˆ, fusionbot.gazeboíŒŒì¼ì— includeë¥¼ ì‘ì„±í•´ì£¼ë©´ urdf ìˆ˜ì •ì€ ëì´ ë‚©ë‹ˆë‹¤. \u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt; \u0026lt;robot name=\u0026#34;fusionbot\u0026#34; xmlns:xacro=\u0026#34;http://www.ros.org/wiki/xacro\u0026#34; \u0026gt; \u0026lt;xacro:property name=\u0026#34;body_color\u0026#34; value=\u0026#34;Gazebo/Silver\u0026#34; /\u0026gt; \u0026lt;xacro:property name=\u0026#34;lidar_color\u0026#34; value=\u0026#34;Gazebo/Blue\u0026#34; /\u0026gt; \u0026lt;xacro:property name=\u0026#34;wheel_color\u0026#34; value=\u0026#34;Gazebo/Black\u0026#34; /\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/sensors/mono_cam.gazebo\u0026#34; /\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/sensors/depth_cam.gazebo\u0026#34; /\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/sensors/lidar_2d.gazebo\u0026#34; /\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/sensors/lidar_3d.gazebo\u0026#34; /\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/sensors/imu.gazebo\u0026#34; /\u0026gt; \u0026lt;!-- hector_gazebo doesn\u0026#39;t supports noetic --\u0026gt; \u0026lt;!-- \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/sensors/gps.gazebo\u0026#34; /\u0026gt; --\u0026gt; \u0026lt;xacro:include filename=\u0026#34;$(find fusionbot_description)/urdf/controllers/diff_drive.gazebo\u0026#34; /\u0026gt; \u0026lt;gazebo reference=\u0026#34;base_link\u0026#34;\u0026gt; \u0026lt;material\u0026gt;${body_color}\u0026lt;/material\u0026gt; gazeboë¥¼ ì‹¤í–‰ì‹œí‚¤ê¸° ìœ„í•œ launch fileì„ ë§Œë“¤ê³  íŒ¨í‚¤ì§€ë¥¼ ì¬ë¹Œë“œí•©ë‹ˆë‹¤. joint_state_publisher, robot_state_publisher, gazebo_rosì™€ urdf_spawnerë¥¼ í†µí•´ gazebo ìƒì— ë¡œë´‡ì„ ìµœì¢… ë“±ì¥ì‹œí‚¤ëŠ” launch file ì…ë‹ˆë‹¤.\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;launch\u0026gt; \u0026lt;!-- Robot pose --\u0026gt; \u0026lt;arg name=\u0026#34;x\u0026#34; default=\u0026#34;0\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;y\u0026#34; default=\u0026#34;0\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;z\u0026#34; default=\u0026#34;0\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;roll\u0026#34; default=\u0026#34;0\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;pitch\u0026#34; default=\u0026#34;0\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;yaw\u0026#34; default=\u0026#34;0\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;world_name\u0026#34; default=\u0026#34;gcamp_world.world\u0026#34;/\u0026gt; \u0026lt;!-- \u0026lt;arg name=\u0026#34;world_file\u0026#34; default=\u0026#34;$(find fusionbot_description)/worlds/$(arg world_name)\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;arg name=\u0026#34;model_name\u0026#34; default=\u0026#34;fusionbot\u0026#34;/\u0026gt; \u0026lt;!-- send urdf to param server --\u0026gt; \u0026lt;!-- xacro --\u0026gt; \u0026lt;param name=\u0026#34;robot_description\u0026#34; command=\u0026#34;$(find xacro)/xacro --inorder \u0026#39;$(find fusionbot_description)/urdf/fusionbot.xacro\u0026#39;\u0026#34; /\u0026gt; \u0026lt;!-- urdf or raw xml file --\u0026gt; \u0026lt;!-- \u0026lt;param name=\u0026#34;robot_description\u0026#34; command=\u0026#34;cat $(find museumGuide)/urdf_model/peoplebot.xml\u0026#34; /\u0026gt; --\u0026gt; \u0026lt;!-- Send fake joint values--\u0026gt; \u0026lt;node name=\u0026#34;joint_state_publisher\u0026#34; pkg=\u0026#34;joint_state_publisher\u0026#34; type=\u0026#34;joint_state_publisher\u0026#34;\u0026gt; \u0026lt;param name=\u0026#34;use_gui\u0026#34; value=\u0026#34;False\u0026#34;/\u0026gt; \u0026lt;/node\u0026gt; \u0026lt;!-- Send robot states to tf --\u0026gt; \u0026lt;node name=\u0026#34;robot_state_publisher\u0026#34; pkg=\u0026#34;robot_state_publisher\u0026#34; type=\u0026#34;robot_state_publisher\u0026#34; respawn=\u0026#34;false\u0026#34; output=\u0026#34;screen\u0026#34;/\u0026gt; \u0026lt;!-- Launch Gazebo World --\u0026gt; \u0026lt;include file=\u0026#34;$(find gazebo_ros)/launch/empty_world.launch\u0026#34;\u0026gt; \u0026lt;arg name=\u0026#34;use_sim_time\u0026#34; value=\u0026#34;true\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;debug\u0026#34; value=\u0026#34;false\u0026#34;/\u0026gt; \u0026lt;arg name=\u0026#34;gui\u0026#34; value=\u0026#34;true\u0026#34; /\u0026gt; \u0026lt;!-- \u0026lt;arg name=\u0026#34;world_name\u0026#34; value=\u0026#34;$(arg world_file)\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;/include\u0026gt; \u0026lt;!-- Spawn My Robot --\u0026gt; \u0026lt;node name=\u0026#34;urdf_spawner\u0026#34; pkg=\u0026#34;gazebo_ros\u0026#34; type=\u0026#34;spawn_model\u0026#34; respawn=\u0026#34;false\u0026#34; output=\u0026#34;screen\u0026#34; args=\u0026#34;-urdf -param robot_description -model $(arg model_name) -x $(arg x) -y $(arg y) -z $(arg z) -R $(arg roll) -P $(arg pitch) -Y $(arg yaw)\u0026#34;/\u0026gt; \u0026lt;/launch\u0026gt; í˜„ì¬ëŠ” ì£¼ì„ì²˜ë¦¬ê°€ ë˜ì–´ ìˆì§€ë§Œ ì—¬ëŸ¬ë¶„ì˜ worldë¥¼ ë§Œë“¤ì–´ ë³´ì‹œê³  world í´ë” ë‚´ ìœ„ì¹˜ì‹œí‚¨ ë‹¤ìŒ í•´ë‹¹ worldì—ì„œ ë¡œë´‡ì„ ë“±ì¥ì‹œí‚¤ëŠ” ì‹¤ìŠµë„ í•´ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤.\nWorld Extensive githubì—ëŠ” ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ ë§Œë“¤ì–´ ë‘” ë‹¤ì–‘í•œ gazebo worldë“¤ì´ ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ìµí˜€ë‘ë©´ ì—¬ëŸ¬ë¶„ì˜ ìˆ˜ê³ ë¥¼ ëœë©´ì„œ ë”ìš± ë‹¤ì±„ë¡œìš´ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì´ë²ˆì— ì‚¬ìš©í•´ë³¼ worldëŠ” clearpathì˜ cpr_gazebo íŒ¨í‚¤ì§€ì•ˆì— ì¡´ì¬í•©ë‹ˆë‹¤. í•´ë‹¹ repoë¥¼ cloneí•˜ê³  ë¹Œë“œí•˜ê² ìŠµë‹ˆë‹¤. cd ~/catkin_ws/src git clone https://github.com/clearpathrobotics/cpr_gazebo.git cd ~/catkin_ws catkin build cpr_office_gazebo source devel/setup.bash ì´ì œ, ìš°ë¦¬ì˜ launch fileì„ ìˆ˜ì •í•´ë³´ê² ìŠµë‹ˆë‹¤. ì œê°€ uncomment ë¼ê³  í•´ë‘” ë¼ì¸ ì•„ë˜ë¥¼ ì£¼ì„ í•´ì œ í•˜ì‹  ë’¤ ë§ˆì§€ë§‰ ë¶€ë¶„ì— ì•„ë˜ì˜ ë¼ì¸ì„ ì¶”ê°€í•˜ì‹­ë‹ˆë‹¤. \u0026lt;!-- Spawn Structure --\u0026gt; \u0026lt;param name=\u0026#34;office_geom\u0026#34; command=\u0026#34;$(find xacro)/xacro --inorder \u0026#39;$(find cpr_office_gazebo)/urdf/office_construction_geometry.urdf.xacro\u0026#39;\u0026#34; /\u0026gt; \u0026lt;node name=\u0026#34;office_world_spawner\u0026#34; pkg=\u0026#34;gazebo_ros\u0026#34; type=\u0026#34;spawn_model\u0026#34; args=\u0026#34;-urdf -model office_construction_geometry -param office_geom -x 0 -y 0 -z 0 -Y 0\u0026#34; /\u0026gt; ì´ì œ ë§ˆì§€ë§‰ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.\ncatkin build fusionbot_description source devel/setup.bash # Terminal 1 roslaunch fusionbot_description gazebo.launch # Terminal 2 rviz ë‹¤ì±„ë¡œìš´ ì‹œë®¬ë ˆì´ì…˜ worldì—ì„œ pluginì„ í†µí•´ ì¶”ê°€í–ˆë˜ ìˆ˜ë§ì€ ì„¼ì„œ ë°ì´í„°ë“¤ì„ rvizë¥¼ ì‚¬ìš©í•˜ì—¬ ë§ˆìŒê» ì‹œê°í™”í•´ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤. ğŸ˜ƒ "
},
{
	"uri": "/kr/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/kr/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
}]